=================================================
This is an automated collection of open reports in
the R-bugs repository.
=================================================

Directory:  Accuracy

* PR# 594 *
Subject: svd() (Linpack) problems/bug for ill-conditioned matrices
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Wed, 5 Jul 2000 18:32:01 +0200 (CEST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 594 <==
From maechler@stat.math.ethz.ch  Wed Jul  5 18:31:44 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA23143
	for <R-bugs@biostat.ku.dk>; Wed, 5 Jul 2000 18:31:44 +0200 (MET DST)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id SAA21080
	for <R-bugs@stat.math.ethz.ch>; Wed, 5 Jul 2000 18:32:04 +0200 (MET DST)
Received: from lynne(129.132.58.30), claiming to be "lynne.ethz.ch"
 via SMTP by hypatia, id smtpdAAAa0059L; Wed Jul  5 18:32:02 2000
Received: (maechler@localhost) by lynne.ethz.ch (8.9.3/D-MATH-client) id SAA08851; Wed, 5 Jul 2000 18:32:01 +0200
X-Authentication-Warning: lynne.ethz.ch: maechler set sender to maechler@stat.math.ethz.ch using -f
From: Martin Maechler <maechler@stat.math.ethz.ch>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <14691.25345.790844.876878@gargle.gargle.HOWL>
Date: Wed, 5 Jul 2000 18:32:01 +0200 (CEST)
To: R-bugs@stat.math.ethz.ch
Subject: svd() (Linpack) problems/bug for ill-conditioned matrices
X-Mailer: VM 6.75 under Emacs 20.6.1
Reply-To: Martin Maechler <maechler@stat.math.ethz.ch>


After fixing princomp(), recently,
	    {tiny negative eigen-values are possible for non-negative
	     definite matrices} 
Fritz Leisch drew my attention to the fact the not only eigen() can be
funny, but also svd().

Adrian Trappleti found that the singular values returned 
can be "-0" instead of "0".  This will be a problem in something like

    sd <- svd(Mat) $ d
    max(sd) / min(sd)

which gives  -Inf  instead of Inf in the above case.

I did some more searching and testing with svd(), could easily 
reproduce the "-0" problem,

    hilbert <- function(n, k=n) { i <- 1:n; 1 / outer(i - 1, i[1:k], "+") }

    M1 <- cbind(hilbert(12,8), pi*1e-15, 0)
    (sd <- svd(M1, nu=0, nv=0) $ d)
    sd[1] / sd[10] #--> -Inf  

but even worse:  On both Solaris (2.5.1, gcc 2.95.1, 
				  f77 "WorkShop Compilers 4.2"
                 and Linux (Redhat 6.2, enhanced with gcc 2.95.2;
			    g77 version egcs-2.91.66 19990314/Linux 
				(egcs-1.1.2 release) 
				(from FSF-g77 version 0.5.24-19981002)
I have managed to make svd() stop with
something like "error  170  in dsvdc"  which basically comes from the
underlying LINPACK routine DSVDC() which did not converge in 30 QR iterations.
example code appended
--- The examples I've found are machine dependent and disjoint for Linux &
Solaris.

HOWEVER:  S-PLUS 5.1 on both machines does NOT fail for the identical
	  matrices!
S-PLUS has basically	.Fortran("dsvdcs" ,
and looks like it is calling Linpack as well, but note that the subroutine
has an extra "s" appended (``S version of Linpack'' ??).

---

Then I had a short look at GSL (GNU scientific library) 
			http://sourceware.cygnus.com/gsl/
which calls a LAPACK (instead of LINPACK) routine for svd  which seems to
use Householder- instead of QR- iterations...

The whole makes me think that we should really shift away from Linpack and
towards Lapack for R's numerical linear algebra....

Here is my code which gives both an error (but not the same!) for R
on Linux and Solaris and all runs through S-PLUS 5.1 on both machines.


hilbert <- function(n) { i <- 1:n; 1 / outer(i - 1, i, "+") }
## "better":
hilbert <- function(n, k=n) { i <- 1:n; 1 / outer(i - 1, i[1:k], "+") }

M1 <- cbind(hilbert(12,8), 3.14e-15, 0)
M2 <- cbind(hilbert(15,8), .2,0)
H2c <- hilbert(200,180)

## Gives SVD error "error  170  in dsvdc" on (MM's) Solaris :
ii.sol <- c(87, 40, 120, 164, 93, 98, 108, 156, 77, 52, 127, 50, 58, 123,
        17, 147, 10, 152, 103, 136, 20, 34, 6, 30, 44, 130, 47, 35, 168,
        4, 115, 3, 29, 71, 56, 128, 90, 18, 60, 25, 125, 74, 91, 16,
        9, 111, 46, 137, 53, 110, 21, 94, 78, 104, 100, 99, 76, 126,
        62, 61, 117, 54, 140, 66, 150, 19, 149, 114, 63, 139, 2, 166,
        135, 23, 107, 8, 158, 39, 69, 75, 92, 112, 86, 124, 13, 118,
        151, 80, 146, 68, 43, 159, 36, 31, 144, 85, 122, 141, 11, 167,
        157, 1, 132, 97, 133, 79, 138, 49, 45, 72, 119, 84, 59, 131,
        5, 22, 116, 154, 142, 48, 73, 67, 161, 7, 155, 42, 41, 143, 57,
        33, 162, 102, 134, 101, 37, 148, 64, 160, 24, 27, 55, 83, 121,
        38, 106, 113, 28, 109, 70, 14, 32, 12, 65, 96, 129, 89, 163,
        88, 105, 15, 95, 145, 81, 165, 51, 153, 82, 169, 26)
H2c.sol <- cbind(H2c[,ii.sol], 1)

## NEW rec: -9.413e+14 ; nc =  164
## Gives SVD error 165 on Linux:
ii <- c(34, 101, 120, 53, 140, 108, 112, 9, 10, 96, 154, 89, 17, 131,
        130, 123, 126, 51, 95, 85, 147, 87, 132, 60, 58, 64, 150, 139,
        116, 36, 78, 107, 118, 104, 127, 61, 82, 84, 63, 23, 114, 124,
        83, 162, 55, 99, 50, 141, 8, 24, 25, 19, 65, 15, 2, 143, 145,
        148, 138, 136, 57, 22, 26, 1, 152, 129, 21, 69, 59, 20, 163,
        98, 92, 106, 88, 56, 70, 117, 37, 48, 115, 79, 68, 142, 4, 122,
        76, 28, 155, 29, 45, 13, 30, 47, 62, 31, 121, 119, 125, 74, 144,
        27, 93, 100, 71, 40, 149, 16, 157, 41, 33, 113, 133, 54, 14,
        156, 11, 97, 72, 75, 77, 49, 111, 128, 18, 35, 42, 6, 160, 32,
        3, 91, 66, 73, 44, 39, 81, 90, 153, 135, 43, 151, 159, 102, 161,
        12, 110, 5, 164, 67, 80, 46, 94, 7, 105, 134, 38, 146, 86, 103,
        137, 52, 158, 109)
H2c.lin <- cbind(H2c[,ii], 1)


(sd <- svd(M1, nu=0, nv=0) $ d) ; sd[1] / sd[length(sd)] #--> -Inf
(sd <- svd(M2, nu=0, nv=0) $ d) ; sd[1] / sd[length(sd)] #--> -Inf

summary(svd(H2c.sol)$d)## Error on Solaris only

summary(svd(H2c.lin)$d)## Error on Linux only (RH 6.2, gcc 2.95.2)
## BTW: quite a strong negative ratio
range( ev <- eigen(var(H2c.lin), only=T)$val )
ev[1] / ev[length(ev)] # -5.868e+15 (solaris);  -1.2115e+16 (linux)

### Try different  ii  and always do the following line :
summary(svd(cbind(H2c[,ii], 1))$d)


## BTW: Negative Eigenvalues
range( eigen(var(M2), only=T)$val )







==> 594.audit <==
Fri Jul 07 06:53:38 2000	maechler	moved from incoming to Accuracy
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Add-ons

* PR# 567 *
Subject: ctest not works
From: George Diniz <george@cpqam.fiocruz.br>
Date: Sun, 12 Mar 2000 12:03:45 -0200
--possibly the RH6.2 Fortran bug
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 567 <==
From george@cpqam.fiocruz.br  Mon Jun 12 13:10:28 2000
Received: from nicc.cpqam.fiocruz.br ([200.133.26.1])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id NAA15969
	for <r-bugs@biostat.ku.dk>; Mon, 12 Jun 2000 13:09:18 +0200 (MET DST)
Received: from cpqam.fiocruz.br (george@[200.199.8.147] (may be forged))
	by nicc.cpqam.fiocruz.br (8.8.6/8.8.6) with ESMTP id MAA20120
	for <r-bugs@biostat.ku.dk>; Sun, 11 Jun 2000 12:19:28 -0300 (EST)
Sender: george@cpqam.fiocruz.br
Message-ID: <38CBA3C1.136B513D@cpqam.fiocruz.br>
Date: Sun, 12 Mar 2000 12:03:45 -0200
From: George Diniz <george@cpqam.fiocruz.br>
X-Mailer: Mozilla 4.72 [en] (X11; U; Linux 2.2.14-5.0 i586)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs@biostat.ku.dk
Subject: ctest not works
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit

I try load ctest, and don't have sucess

> library(ctest)
Error in dyn.load(x, as.logical(local), as.logical(now)) : unable to
load shared library "/usr/local/lib/R/library/ctest/libs/ctest.so":
  /usr/local/lib/R/library/ctest/libs/ctest.so: undefined symbol: ÝfÔ

What I must to do

I will waiting  your answer

George Diniz


==> 567.reply.1 <==
From pd@blueberry.kubism.ku.dk  Mon Jun 12 13:49:16 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id NAA16056
	for <R-bugs@biostat.ku.dk>; Mon, 12 Jun 2000 13:49:15 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id NAA23885;
	Mon, 12 Jun 2000 13:53:14 +0200
Sender: pd@blueberry.kubism.ku.dk
To: george@cpqam.fiocruz.br
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] ctest not works (PR#567)
References: <200006121110.NAA15979@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 12 Jun 2000 13:53:14 +0200
In-Reply-To: george@cpqam.fiocruz.br's message of "Mon, 12 Jun 2000 13:10:29 +0200 (MET DST)"
Message-ID: <x24s6z6rpx.fsf@blueberry.kubism.ku.dk>
Lines: 21
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit

george@cpqam.fiocruz.br writes:

> I try load ctest, and don't have sucess
> 
> > library(ctest)
> Error in dyn.load(x, as.logical(local), as.logical(now)) : unable to
> load shared library "/usr/local/lib/R/library/ctest/libs/ctest.so":
>   /usr/local/lib/R/library/ctest/libs/ctest.so: undefined symbol: ÝfÔ
> 
> What I must to do
> 
> I will waiting  your answer

First of all tell us what system you are on. With that information,
all we can say is that that is not what is supposed to happen...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 567.followup.1 <==
From ripley@stats.ox.ac.uk  Mon Jun 12 13:58:40 2000
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id NAA16101;
	Mon, 12 Jun 2000 13:58:40 +0200 (MET DST)
Received: from toucan.stats (toucan.stats [163.1.20.20])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with SMTP id MAA00504;
	Mon, 12 Jun 2000 12:57:35 +0100 (BST)
Message-Id: <200006121157.MAA00504@toucan.stats.ox.ac.uk>
Date: Mon, 12 Jun 2000 12:57:35 +0100 (BST)
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Reply-To: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Subject: Re: [Rd] ctest not works (PR#567)
To: george@cpqam.fiocruz.br, p.dalgaard@biostat.ku.dk
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
MIME-Version: 1.0
Content-Type: TEXT/plain; charset=ISO-8859-1
Content-MD5: B/7rml5xc3D4PsEG7Znu0A==
X-Mailer: dtmail 1.3.0 @(#)CDE Version 1.3.5 SunOS 5.7 sun4m sparc 
Content-Transfer-Encoding: 8bit
X-MIME-Autoconverted: from QUOTED-PRINTABLE to 8bit by pubhealth.ku.dk id NAA16101


> To: george@cpqam.fiocruz.br
> From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> Date: 12 Jun 2000 13:53:14 +0200
> 
> george@cpqam.fiocruz.br writes:
> 
> > I try load ctest, and don't have sucess
> > 
> > > library(ctest)
> > Error in dyn.load(x, as.logical(local), as.logical(now)) : unable to
> > load shared library "/usr/local/lib/R/library/ctest/libs/ctest.so":
> >   /usr/local/lib/R/library/ctest/libs/ctest.so: undefined symbol: ÝfÔ
> > 
> > What I must to do
> > 
> > I will waiting  your answer
> 
> First of all tell us what system you are on. With that information,
> all we can say is that that is not what is supposed to happen...

True, but we can tell you:

This is Linux/Unix not Windows (and not HP either).

That silly symbol name suggests that this is the Fortran bug in RH6.2
we have met before.  If so, the solution is to compile with gcc-2.95.2.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 567.audit <==
Wed Jun 21 12:02:24 2000	ripley	changed notes
Wed Jun 21 12:02:24 2000	ripley	moved from incoming to Add-ons
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 503 *
Subject: dmvnorm() bug in e1071
From: "Gregory R. Warnes" <warnes@biostat.washington.edu>
Date: Fri, 24 Mar 2000 03:24:45 +0000 (GMT)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 503 <==
From warnes@warnes.net  Fri Mar 24 20:26:17 2000
Received: from hydra.warnes.net (mail@c877378-a.sttln1.wa.home.com [24.9.60.166])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA06279
	for <r-bugs@biostat.ku.dk>; Fri, 24 Mar 2000 20:25:43 +0100 (MET)
Received: from warnes (helo=localhost)
	by hydra.warnes.net with local-esmtp (Exim 3.12 #1 (Debian))
	id 12YKiM-0003AT-00
	for <r-bugs@biostat.ku.dk>; Thu, 23 Mar 2000 19:24:46 -0800
Date: Fri, 24 Mar 2000 03:24:45 +0000 (GMT)
From: "Gregory R. Warnes" <warnes@biostat.washington.edu>
X-Sender: warnes@hydra.warnes.net
To: r-bugs@biostat.ku.dk
Subject: dmvnorm() bug in e1071
Message-ID: <Pine.LNX.4.21.0003240321480.575-100000@hydra.warnes.net>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
Sender: "Gregory R. Warnes" <warnes@warnes.net>


When dmvnorm is applied to matrices it fails.  The offending lines are

  if (length(x) != ncol(sigma)) {
    stop("x and sigma have non-conforming size")
  }

which works fine if x is a dataframe, but not if x is a matrix.

Replacing this test with

  if (ncol(x) != ncol(sigma)) {
    stop("x and sigma have non-conforming size")
  }

Corrects the problem, and still works for data frames and
vectors.  (Vectors have already been converted to matrices).

-Gregory


==> 503.audit <==
Sat Mar 25 09:48:26 2000	maechler	moved from incoming to Add-ons
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 496 *
From: bonneau@epi.roazhon.inra.fr (en148)
Date: Tue, 21 Mar 2000 10:57:13 +0100 (MET)
--base R has no est.variogram function.
--This appears to be a bug report on sgeostat.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 496 <==
From bonneau@epi.roazhon.inra.fr  Tue Mar 21 11:40:23 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA24613
	for <R-bugs@biostat.ku.dk>; Tue, 21 Mar 2000 11:40:21 +0100 (MET)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id LAA00472
	for <r-bugs@hypatia.math.ethz.ch>; Tue, 21 Mar 2000 11:40:33 +0100 (MET)
Received: from epi.roazhon.inra.fr(194.167.76.1)
 via SMTP by hypatia, id smtpdAAAa0007L; Tue Mar 21 11:40:28 2000
Received: from (bonneau@localhost)
          by epi.roazhon.inra.fr (8.8.8/jtpda-5.3) id KAA09010
          for r-bugs@lists.r-project.org; Tue, 21 Mar 2000 10:57:13 +0100 (MET)
Date: Tue, 21 Mar 2000 10:57:13 +0100 (MET)
From: bonneau@epi.roazhon.inra.fr (en148)
Message-Id: <200003210957.KAA09010@epi.roazhon.inra.fr>

I am using R 0.65.1 under linux (Redhat 6.0),
and I have a problem with the est.variogram function when the first lag is empty (I am trying to estimate anisotropic varios)

fittedpnt<-point(fitted, x="X2", y="X3")
fittedpair<-pair(fittedpnt, num.lags=15, type="anisotropic", theta=60, dtheta=20, maxdist=maxfittedist)
fittedvario<-est.variogram(fittedpnt, fittedpair, "fit")

With my datas I have no pair in lags 1 to 3 and the error message is :
Error in psort(x, partial) : index 0 outside bounds

What can I do, in order to fix the bug ?

==> 496.audit <==
Sat Apr 01 07:32:27 2000	ripley	changed notes
Sat Apr 01 07:32:27 2000	ripley	moved from incoming to Add-ons
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Analyses

none

Directory:  Documentation

none

Directory:  Graphics

* PR# 625 *
Subject: Re: [Rd] Re: [R] problem clipping R postscript plots within latex
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Wed, 2 Aug 2000 21:38:31 +0100 (GMT Daylight Time)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 625 <==
From ripley@stats.ox.ac.uk  Wed Aug  2 22:39:37 2000
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA03132;
	Wed, 2 Aug 2000 22:39:36 +0200 (MET DST)
Received: from max147.public.ox.ac.uk (max147.public.ox.ac.uk [192.76.27.147])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id VAA25055;
	Wed, 2 Aug 2000 21:39:54 +0100 (BST)
Date: Wed, 2 Aug 2000 21:38:31 +0100 (GMT Daylight Time)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
To: p.dalgaard@biostat.ku.dk
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Re: [R] problem clipping R postscript plots within latex
 (PR#623)
In-Reply-To: <200008021255.OAA00687@pubhealth.ku.dk>
Message-ID: <Pine.WNT.4.05.10008022134410.230-100000@tern.stats>
Sender: ripley@stats.ox.ac.uk
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Wed, 2 Aug 2000 p.dalgaard@biostat.ku.dk wrote:

> Martin Maechler <maechler@stat.math.ethz.ch> writes:
> 
> > (from R-help)
> >     PD> Stephen Eglen <stephen@cogsci.ed.ac.uk> writes:
> > 
> >     >  > > generated by R into a latex document.  Specifically, the latex package
> >     >  > > graphicsx allow you to specify the bounding box of the postscript
> >     >  > > file, so that you can just show _part_ of the postscript file if you
> >     >  > > tell it to also clip the area outside of the bounding box.
> >     > ...
> >     >  > Ow. This stems from the use of "initclip" in the R-generated PS. One
> >     >  > shouldn't do that, one should bracket clipped graphics within
> >     >  > gsave/grestore instead. Sounds a bit tricky to get right.
> >     > 
> >     > Thanks.  To solve my current problem, I changed the definition of the
> >     > `cl' operator in the postscript file to:
> >     > 
> >     > /cl  { gsave initclip newpath 3 index 3 index moveto 1 index
> >     >        4 -1 roll lineto  exch 1 index lineto lineto
> >     >        closepath clip grestore newpath } def
> >     > 
> >     > [i.e. just adding the gsave ... grestore pair]
> >     > 
> >     > Whether this is the proper solution though is another matter...
> > 
> >     PD> It isn't. It grestore-s before actually plotting the stuff that
> >     PD> needs to be clipped, so effectively you just disabled R's
> >     PD> clipping. A better way would be to start the plotting with a "gs"
> >     PD> and have
> > 
> >     /cl  { gr gs newpath 3 index 3 index moveto 1 index
> > 	   4 -1 roll lineto  exch 1 index lineto lineto
> > 	   closepath clip newpath } def
> > 
> >     PD> and end everything with a "gr". Not too sure that is perfectly
> >     PD> safe, though...
> > 
> > Are you working on this, Peter?
> > Otherwise, "R-bugs" should probably get about the above report..
> 
> Done... 

Just to note that ?postscript says

    The postscript produced by R is EPS (Encapsulated PostScript)
    compatible,

yet initclip is not allowed in EPS files (PostScript Language Reference
Manual, 2nd edition).  I think the statement was possibly true once ....

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 625.reply.1 <==
From pd@blueberry.kubism.ku.dk  Thu Aug  3 17:26:08 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA10115
	for <R-bugs@biostat.ku.dk>; Thu, 3 Aug 2000 17:26:08 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id RAA30504;
	Thu, 3 Aug 2000 17:32:40 +0200
Sender: pd@blueberry.kubism.ku.dk
To: ripley@stats.ox.ac.uk
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Re: [R] problem clipping R postscript plots within latex (PR#625)
References: <200008022039.WAA03146@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 03 Aug 2000 17:32:39 +0200
In-Reply-To: ripley@stats.ox.ac.uk's message of "Wed, 2 Aug 2000 22:39:38 +0200 (MET DST)"
Message-ID: <x2hf92bbs8.fsf@blueberry.kubism.ku.dk>
Lines: 45
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

ripley@stats.ox.ac.uk writes:

> > >     /cl  { gr gs newpath 3 index 3 index moveto 1 index
> > > 	   4 -1 roll lineto  exch 1 index lineto lineto
> > > 	   closepath clip newpath } def
> > > 
> > >     PD> and end everything with a "gr". Not too sure that is perfectly
> > >     PD> safe, though...


>     The postscript produced by R is EPS (Encapsulated PostScript)
>     compatible,
> 
> yet initclip is not allowed in EPS files (PostScript Language Reference
> Manual, 2nd edition).  

Exactly. 

> I think the statement was possibly true once ....

I don't think so. This is a design problem.

Unfortunately, the simple fix above doesn't seem to work [for rather
foreseeable reasons]. mosaicplot() seems to crash ghostview and even
plot(1:10) comes out without axis titles. 

The latter item occurs because we're doing

clip(region1)
set font
draw text
clip(region2)
draw more text in same font

but restoring the graphics context prior to the first clipping 
requires the font to be set once again. And there are probably many
similar problems. Sigh. 

Paul, are you around?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 625.followup.1 <==
From paul@stat.auckland.ac.nz  Fri Aug  4 01:01:37 2000
Received: from mailhost.auckland.ac.nz (mailhost.auckland.ac.nz [130.216.1.4])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA11427;
	Fri, 4 Aug 2000 01:01:33 +0200 (MET DST)
Received: from stat1.stat.auckland.ac.nz (stat1.stat.auckland.ac.nz [130.216.93.1])
	by mailhost.auckland.ac.nz (8.9.2/8.9.2/8.9.2-ua) with ESMTP id LAA07027;
	Fri, 4 Aug 2000 11:01:49 +1200 (NZST)
Received: from murrell (murrell.stat.auckland.ac.nz [130.216.93.23])
	by stat1.stat.auckland.ac.nz (8.9.3+Sun/8.8.8) with SMTP id LAA18617;
	Fri, 4 Aug 2000 11:01:48 +1200 (NZST)
Message-ID: <003d01bffda0$6e4fee30$175dd882@stat.auckland.ac.nz>
From: "Paul Murrell" <paul@stat.auckland.ac.nz>
To: <ripley@stats.ox.ac.uk>, "Peter Dalgaard BSA" <p.dalgaard@biostat.ku.dk>
Cc: <r-devel@stat.math.ethz.ch>, <R-bugs@biostat.ku.dk>
References: <200008022039.WAA03146@pubhealth.ku.dk> <x2hf92bbs8.fsf@blueberry.kubism.ku.dk>
Subject: Re: [Rd] Re: [R] problem clipping R postscript plots within latex (PR#625)
Date: Fri, 4 Aug 2000 11:13:27 +1200
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 5.00.2014.211
X-MimeOLE: Produced By Microsoft MimeOLE V5.00.2014.211

hi


> > yet initclip is not allowed in EPS files (PostScript Language Reference
> > Manual, 2nd edition).
>
> Exactly.
>
> > I think the statement was possibly true once ....
>
> I don't think so. This is a design problem.
>
> Unfortunately, the simple fix above doesn't seem to work [for rather
> foreseeable reasons]. mosaicplot() seems to crash ghostview and even
> plot(1:10) comes out without axis titles.
>
> The latter item occurs because we're doing
>
> clip(region1)
> set font
> draw text
> clip(region2)
> draw more text in same font
>
> but restoring the graphics context prior to the first clipping
> requires the font to be set once again. And there are probably many
> similar problems. Sigh.
>
> Paul, are you around?


Yes I'm around (I'm just concealed by my teaching load).  However, I may not
be much help.  This seems to be a problem with the definitions in the
postscript file header (set up in PSFileHeader).  [Trying not to sound like
I'm dodging a bullet ...] I have never delved too deeply into these so I
cannot really comment on their goodness or badness.  AFAIK this is all
pretty original stuff (by Ross ?), but I'm not sure what it was based on.
Something Ross has mentioned to me a couple of times is a library which
allows you to write C-like code which then gets processed into (correct,
efficient) postscript.  Maybe this would be a good solution (i.e., piggyback
on some other code which has got all of the postscript stuff properly sorted
out).  Sorry I can't be more help at this stage.

paul



==> 625.reply.2 <==
From pd@blueberry.kubism.ku.dk  Fri Aug  4 17:38:57 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA19524;
	Fri, 4 Aug 2000 17:38:56 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id RAA30378;
	Fri, 4 Aug 2000 17:45:43 +0200
Sender: pd@blueberry.kubism.ku.dk
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Cc: ripley@stats.ox.ac.uk, r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Re: [R] problem clipping R postscript plots within latex (PR#625)
References: <200008022039.WAA03146@pubhealth.ku.dk> <x2hf92bbs8.fsf@blueberry.kubism.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 04 Aug 2000 17:45:42 +0200
In-Reply-To: Peter Dalgaard BSA's message of "03 Aug 2000 17:32:39 +0200"
Message-ID: <x2u2d158t5.fsf@blueberry.kubism.ku.dk>
Lines: 70
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

> ripley@stats.ox.ac.uk writes:
> 
> > > >     /cl  { gr gs newpath 3 index 3 index moveto 1 index
> > > > 	   4 -1 roll lineto  exch 1 index lineto lineto
> > > > 	   closepath clip newpath } def
> > > > 
> > > >     PD> and end everything with a "gr". Not too sure that is perfectly
> > > >     PD> safe, though...
...
> 
> Unfortunately, the simple fix above doesn't seem to work [for rather
> foreseeable reasons]. mosaicplot() seems to crash ghostview and even
> plot(1:10) comes out without axis titles. 

However, fixing the font issue seems to have done the trick. Fix
committed to the development branch (to become R 1.2). I'm not
trusting that fix enough to let it go into 1.1.1.

Here's the patch in case someone needs it:


$ cvs diff -ur 1.29 src/main/devPS.c
Index: src/main/devPS.c
===================================================================
RCS file: /home/rdevel/CVS-ARCHIVE/R/src/main/devPS.c,v
retrieving revision 1.29
retrieving revision 1.30
diff -u -r1.29 -r1.30
--- src/main/devPS.c    2000/06/27 22:26:19     1.29
+++ src/main/devPS.c    2000/08/04 15:35:33     1.30
@@ -549,10 +549,10 @@
     fprintf(fp, "/gs  { gsave } def\n");
     fprintf(fp, "/gr  { grestore } def\n");
     if (landscape)
-       fprintf(fp, "/bp  { gs %.2f 0 translate 90 rotate} def\n", paperwidth);
+       fprintf(fp, "/bp  { gs %.2f 0 translate 90 rotate gs } def\n", paperwidth);
     else
-       fprintf(fp, "/bp  { gs } def\n");
-    fprintf(fp, "/ep  { showpage gr } def\n");
+       fprintf(fp, "/bp  { gs gs } def\n");
+    fprintf(fp, "/ep  { showpage gr gr } def\n");
     fprintf(fp, "/m   { moveto } def\n");
     fprintf(fp, "/l   { lineto } def\n");
     fprintf(fp, "/np  { newpath } def\n");
@@ -569,7 +569,7 @@
     fprintf(fp, "       ps mul neg 0 2 1 roll rmoveto\n");
     fprintf(fp, "       1 index stringwidth pop\n");
     fprintf(fp, "       mul neg 0 rmoveto show grestore } def\n");
-    fprintf(fp, "/cl  { initclip newpath 3 index 3 index moveto 1 index\n");
+    fprintf(fp, "/cl  { gr gs newpath 3 index 3 index moveto 1 index\n");
     fprintf(fp, "       4 -1 roll lineto  exch 1 index lineto lineto\n");
     fprintf(fp, "       closepath clip newpath } def\n");
     fprintf(fp, "/rgb { setrgbcolor } def\n");
@@ -1133,6 +1133,8 @@
     PostScriptDesc *pd = (PostScriptDesc *) dd->deviceSpecific;
 
     PostScriptSetClipRect(pd->psfp, x0, x1, y0, y1);
+    /* clipping does grestore so invalidate current font */
+    pd->fontsize = -1; 
 }
 
 static void PS_Resize(DevDesc *dd)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 625.audit <==
Mon Aug 07 13:16:55 2000	ripley	moved from incoming to Graphics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 623 *
Subject: Re: [R] problem clipping R postscript plots within latex
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 02 Aug 2000 15:01:52 +0200
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 623 <==
From postmaster@franz.stat.wisc.edu  Wed Aug  2 14:55:37 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id OAA00677
	for <R-bugs@biostat.ku.dk>; Wed, 2 Aug 2000 14:55:36 +0200 (MET DST)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id OAA05245
	for <r-bugs@hypatia.math.ethz.ch>; Wed, 2 Aug 2000 14:55:55 +0200 (MET DST)
Received: from franz.stat.wisc.edu(128.105.174.95)
 via SMTP by hypatia, id smtpdAAAa001Hu; Wed Aug  2 14:55:52 2000
Received: from blueberry.kubism.ku.dk (really [130.225.108.193]) by franz.stat.wisc.edu
	via in.smtpd with esmtp
	id <m13Jy5y-000ZScC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <r-bugs@r-project.org>; Wed, 2 Aug 2000 07:58:02 -0500 (CDT) 
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id PAA18316;
	Wed, 2 Aug 2000 15:01:52 +0200
Sender: pd@blueberry.kubism.ku.dk
To: Martin Maechler <maechler@stat.math.ethz.ch>
Cc: r-bugs@r-project.org
Subject: Re: [R] problem clipping R postscript plots within latex
References: <14726.51562.209899.470361@cogsci.ed.ac.uk> <x28zuh3xvo.fsf@blueberry.kubism.ku.dk> <14726.61410.360349.907058@cogsci.ed.ac.uk> <x24s553qq5.fsf@blueberry.kubism.ku.dk> <14728.5856.593135.727374@gargle.gargle.HOWL>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 02 Aug 2000 15:01:52 +0200
In-Reply-To: Martin Maechler's message of "Wed, 2 Aug 2000 14:41:04 +0200 (CEST)"
Message-ID: <x2ittj95q7.fsf@blueberry.kubism.ku.dk>
Lines: 47
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> (from R-help)
>     PD> Stephen Eglen <stephen@cogsci.ed.ac.uk> writes:
> 
>     >  > > generated by R into a latex document.  Specifically, the latex package
>     >  > > graphicsx allow you to specify the bounding box of the postscript
>     >  > > file, so that you can just show _part_ of the postscript file if you
>     >  > > tell it to also clip the area outside of the bounding box.
>     > ...
>     >  > Ow. This stems from the use of "initclip" in the R-generated PS. One
>     >  > shouldn't do that, one should bracket clipped graphics within
>     >  > gsave/grestore instead. Sounds a bit tricky to get right.
>     > 
>     > Thanks.  To solve my current problem, I changed the definition of the
>     > `cl' operator in the postscript file to:
>     > 
>     > /cl  { gsave initclip newpath 3 index 3 index moveto 1 index
>     >        4 -1 roll lineto  exch 1 index lineto lineto
>     >        closepath clip grestore newpath } def
>     > 
>     > [i.e. just adding the gsave ... grestore pair]
>     > 
>     > Whether this is the proper solution though is another matter...
> 
>     PD> It isn't. It grestore-s before actually plotting the stuff that
>     PD> needs to be clipped, so effectively you just disabled R's
>     PD> clipping. A better way would be to start the plotting with a "gs"
>     PD> and have
> 
>     /cl  { gr gs newpath 3 index 3 index moveto 1 index
> 	   4 -1 roll lineto  exch 1 index lineto lineto
> 	   closepath clip newpath } def
> 
>     PD> and end everything with a "gr". Not too sure that is perfectly
>     PD> safe, though...
> 
> Are you working on this, Peter?
> Otherwise, "R-bugs" should probably get about the above report..

Done... 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 623.audit <==
Mon Aug 07 13:16:55 2000	ripley	moved from incoming to Graphics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 584 *
Subject: par(lty = "1") -- lty storage-etc bug
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Tue, 27 Jun 2000 09:11:36 +0200 (CEST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 584 <==
From maechler@stat.math.ethz.ch  Tue Jun 27 09:11:35 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id JAA22037
	for <R-bugs@biostat.ku.dk>; Tue, 27 Jun 2000 09:11:34 +0200 (MET DST)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id JAA18836;
	Tue, 27 Jun 2000 09:11:47 +0200 (MET DST)
Received: from lynne(129.132.58.30), claiming to be "lynne.ethz.ch"
 via SMTP by hypatia, id smtpdAAAa004aH; Tue Jun 27 09:11:38 2000
Received: (maechler@localhost) by lynne.ethz.ch (8.9.3/D-MATH-client) id JAA03318; Tue, 27 Jun 2000 09:11:36 +0200
X-Authentication-Warning: lynne.ethz.ch: maechler set sender to maechler@stat.math.ethz.ch using -f
From: Martin Maechler <maechler@stat.math.ethz.ch>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Message-ID: <14680.21416.663333.728401@gargle.gargle.HOWL>
Date: Tue, 27 Jun 2000 09:11:36 +0200 (CEST)
To: r-bugs@stat.math.ethz.ch
CC: Jim Lemon <bitwrit@ozemail.com.au>
Subject: par(lty = "1") -- lty storage-etc bug
In-Reply-To: <39532E3D.CE3CF631@ozemail.com.au>
References: <39532E3D.CE3CF631@ozemail.com.au>
X-Mailer: VM 6.75 under Emacs 20.6.1
Reply-To: Martin Maechler <maechler@stat.math.ethz.ch>
X-MIME-Autoconverted: from 8bit to quoted-printable by lynne.ethz.ch id JAA03318
Content-Transfer-Encoding: 8bit
X-MIME-Autoconverted: from quoted-printable to 8bit by pubhealth.ku.dk id JAA22037

Bug report, rather than R-help;
This is at least since 1.0.0; didn't try even older versions ..

    Jim> Anon wrote:

    Anon> ...However, if I use Fred <- c(1,"33")...  Is this a
    Anon> bug, or am I missing something?

this made use it  essentially something like   
      par(lty = "1")

    Jim> This is an interesting problem.  It boils down to the fact that
    Jim> PostScript expects an array (even if it's empty) and an offset for
    Jim> "setdash".  Normally, a solid line is specified with an empty
    Jim> array and zero offset.  However, if R gets specs that convert to
    Jim> zero and puts a zero in the array, the PostScript interpreter will
    Jim> barf.  Zero can appear, but there must be at least one non-zero
    Jim> number in the array.  Hexadecimal strings supplied to lty are
    Jim> converted to array elements, but a single character "1" seems to
    Jim> produce "0.00".  Remember that the c() operater will coerce the
    Jim> number 1 to the string "1" when combining it with "33".  That is,
    Jim> it's probably a bad idea to mix the two methods of specifying line
    Jim> types with "lty".

I think there's at least another (maybe the only one) bug in main/graphics.c
which is not related to postscript at all, see below.

    Jim> A possible fix is to insert a test for zero in the function
    Jim> SetLineStyle() - devPS.c:

 >> static void SetLineStyle(int newlty, double newlwd, DevDesc *dd)
 >> {
 >>     PostScriptDesc *pd = (PostScriptDesc *) dd->deviceSpecific;
 >>     int i, ltyarray[8];
 >>     int sum = 0;
 >>     if (pd->lty != newlty || pd->lwd != newlwd) {
 >>       pd->lwd = newlwd;
 >>       pd->lty = newlty;
 >>       PostScriptSetLineWidth(pd->psfp, dd->gp.lwd*0.75);
 >>       for(i = 0; i < 8 && newlty & 15 ; i++) {
 >>           ltyarray[i] = newlty & 15;
 >>           sum += ltyarray[i];
 >>           newlty = newlty >> 4;
 >>       }
 >>       if(!sum) i = 0;
 >>       PostScriptSetLineTexture(pd->psfp, ltyarray, i, dd->gp.lwd * 0.75);
 >>     }
 >> }

    Jim> producing a solid line when all elements of 'ltyarray' are zero.

yes, but I think this shouldn't be necessary.

The real bug is uglier:
If you use something like   par(lty="1")  
or any other one-letter (hex digit) string,
this leads to an invalid `code', and further, the storage location 
(such dd->lty in C) of that string somehow loses it's final string
terminator (\0 in C) and gets mangled.
I can reproduce this most easily with the following


for(i in seq(along=dev.list())) dev.off()
par(lty="1")
example(barplot) 
## (almost!) always ends in an error, see below,

## and then
for(i in 1:4) print(par("lty"))

--------

Note that in the Error message below,
    "invalid hex digit in color" 
has been changed in the very latest R-release sources to
    "invalid hex digit in color or lty" 
which is ``more helpful'' here :

> example(barplot) ## (almost!) always ends in an error, see below,

barplt> tN <- table(Ni <- rpois(100, lambda = 5))
barplt> r <- barplot(tN, col = "gray")

barplt> lines(r, tN, type = "h", col = "red", lwd = 2)
Error in plot.xy(xy.coords(x, y), type = type, col = col, lty = lty, ...) : 
	invalid hex digit in color

> traceback()
[1] "plot.xy(xy.coords(x, y), type = type, col = col, lty = lty, ...)"         
[2] "lines.default(r, tN, type = \"h\", col = \"red\", lwd = 2)"               
[3] "lines(r, tN, type = \"h\", col = \"red\", lwd = 2)"                       
[4] "eval.with.vis(expr, envir, enclos)"                                       
[5] "eval.with.vis(ei, envir)"                                                 
[6] "source(zfile, echo = echo, prompt.echo = prompt.echo, verbose = verbose, "
[7] "    max.deparse.length = 250)"                                            
[8] "example(barplot)"                                                         

> for(i in 1:4) print(par("lty"))
[1] "1r"
[1] "1ÂSÂ°I@ø}@gMG@\\¨}@\"ªJ@ô}@U\\F@4}@?D@üþ|@A@èþ|@Ü]G@èþ|@(¼B@names"
[1] "1|@ult"
[1] "1"
> 

---------
Peter D., I'd like to learn how to use watchpoints to debug this...

Martin

==> 584.audit <==
Fri Jul 07 06:49:07 2000	maechler	moved from incoming to Graphics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--The persp algorithm does not apply the occlusion rules to the frame, 
--which is always plotted first. 
--A bug, but not very simple to fix.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 202 <==
From wsi@gcal.ac.uk  Wed Jun  2 15:02:10 1999
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA27126
	for <R-bugs@biostat.ku.dk>; Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
From: wsi@gcal.ac.uk
Message-Id: <199906021302.PAA27126@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: persp box occlusion bug

Full_Name: Bill Simpson
Version: 64.1
OS: linux
Submission from: (NULL) (193.62.250.209)


Bug in persp() bounding box:
If the surface being plotted extends below the lower z-axis boundary, the box
is
drawn with the wrong occlusion. The box is shown as being occluded by the
surface
even though it should be in front of the surface.

The box is correct for surface extending above the box. Problem is only for
surface extending below the box.

This exhibits the bug:

std<-rep(seq(-32,32,8),9)/1000 * 60
cf<-rep(seq(-32,32,8),rep(9,9))/1000 *60 
dp<-(cf-std)/.6
std<-unique(std)
cf<-unique(cf)
dp<-t(matrix(dp,length(cf),length(std)))
persp(std,cf,dp, xlim=c(-2,2), ylim=c(-2,2), zlim=c(0,5),theta=-40,    
phi=45,
box=TRUE,ltheta=-120, lphi=120,
d=1.5, shade=.7)


==> 202.audit <==
Wed Jun 30 19:31:18 1999	pd	moved from incoming to Graphics
Thu Jul 01 18:19:48 1999	pd	changed notes
Sun Feb 20 10:07:11 2000	ripley	changed notes
Mon Feb 28 17:17:51 2000	pd	changed notes
Mon Feb 28 17:18:28 2000	pd	changed notes
Mon Feb 28 17:19:35 2000	pd	changed notes
Mon Feb 28 17:20:17 2000	pd	changed notes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  In-Out

none

Directory:  Installation

* PR# 597 *
Subject: multiply defined symbols
From: plucas@csd.abdn.ac.uk
Date: Fri, 7 Jul 2000 12:23:44 +0200 (MET DST)
--Probably system-specific due to use of fort77
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 597 <==
From plucas@csd.abdn.ac.uk  Fri Jul  7 12:23:44 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id MAA07677
	for <R-bugs@biostat.ku.dk>; Fri, 7 Jul 2000 12:23:44 +0200 (MET DST)
Date: Fri, 7 Jul 2000 12:23:44 +0200 (MET DST)
From: plucas@csd.abdn.ac.uk
Message-Id: <200007071023.MAA07677@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: multiply defined symbols

Full_Name: Peter Lucas
Version: 1.1.0
OS: redHat 6.2 Linux
Submission from: (NULL) (139.133.200.15)


I tried to install R 1.1.0 on my i686 PC with Redhat 6.2 Linux on it.
I am using fort77 with f2c. I am not able to build R, as libc.a contains
regex.o, causing a conflict with src/main/regex.o. the ONEWS mentions
that this problem was solved, but it obviously was not. I am not a real
Unix hacker, so I wonder how to proceed.

Peter

==> 597.reply.1 <==
From pd@blueberry.kubism.ku.dk  Fri Jul  7 16:43:29 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA10694
	for <R-bugs@biostat.ku.dk>; Fri, 7 Jul 2000 16:43:28 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id QAA15185;
	Fri, 7 Jul 2000 16:46:02 +0200
Sender: pd@blueberry.kubism.ku.dk
To: plucas@csd.abdn.ac.uk
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] multiply defined symbols (PR#597)
References: <200007071023.MAA07687@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 07 Jul 2000 16:46:02 +0200
In-Reply-To: plucas@csd.abdn.ac.uk's message of "Fri, 7 Jul 2000 12:23:45 +0200 (MET DST)"
Message-ID: <x2wviyrob9.fsf@blueberry.kubism.ku.dk>
Lines: 21
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

plucas@csd.abdn.ac.uk writes:

> I tried to install R 1.1.0 on my i686 PC with Redhat 6.2 Linux on it.
> I am using fort77 with f2c. I am not able to build R, as libc.a contains
> regex.o, causing a conflict with src/main/regex.o. the ONEWS mentions
> that this problem was solved, but it obviously was not. I am not a real
> Unix hacker, so I wonder how to proceed.

One possibility would be to use f2c directly. Pseudo Fortran compilers
like fort77 (which is just a script around f2c) do strange things
occasionally. Use the --with-f2c flag to configure.

The egcs-g77 package that comes with RH6.2 should work for compiling R
itself, but seems to be having trouble with some add-on packages.
gcc-2.95.1 and later seems to be OK.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 597.audit <==
Mon Jul 10 12:30:34 2000	ripley	changed notes
Mon Jul 10 12:30:34 2000	ripley	moved from incoming to Installation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 467 *
Subject: Re: [R] Re: R-1.0.0 is released
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 01 Mar 2000 20:26:40 +0100
--followup to PR#466
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 467 <==
From pd@biostat.ku.dk  Wed Mar  1 20:27:42 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA01870
	for <R-bugs@biostat.ku.dk>; Wed, 1 Mar 2000 20:27:42 +0100 (MET)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id UAA07371;
	Wed, 1 Mar 2000 20:26:49 +0100 (MET)
Received: from kubism.kubism.ku.dk(130.225.108.10), claiming to be "pubhealth.ku.dk"
 via SMTP by hypatia, id smtpdAAAa001n5; Wed Mar  1 20:26:44 2000
Received: from biostat.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA01866;
	Wed, 1 Mar 2000 20:26:30 +0100 (MET)
Received: (from pd@localhost)
	by biostat.ku.dk (8.9.3/8.9.3) id UAA10344;
	Wed, 1 Mar 2000 20:26:40 +0100
Sender: pd@blueberry.kubism.ku.dk
To: bhoel@server.python.net (Berthold H?llmann)
Cc: r-help@stat.math.ethz.ch, r-bugs@stat.math.ethz.ch
Subject: Re: [R] Re: R-1.0.0 is released
References: <x23dqc5obk.fsf@blueberry.kubism.ku.dk> <m2zosienvd.fsf@pchoel.privat.uni-hamburg.de>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 01 Mar 2000 20:26:40 +0100
In-Reply-To: bhoel@server.python.net's message of "01 Mar 2000 16:00:54 +0100"
Message-ID: <x29002cwzz.fsf@blueberry.kubism.ku.dk>
Lines: 52
X-Mailer: Gnus v5.7/Emacs 20.4
Mime-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
X-MIME-Autoconverted: from 8bit to quoted-printable by pubhealth.ku.dk id UAA01866
Content-Transfer-Encoding: 8bit
X-MIME-Autoconverted: from quoted-printable to 8bit by pubhealth.ku.dk id UAA01870

bhoel@server.python.net (Berthold Höllmann) writes:

> Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
> 
> > I've rolled up R-1.0.0.tgz a short while ago. 
> > 
> I've build R-1.0.0 on my
> 
> >uname -a
> Linux pchoel 2.2.14 #3 Mit Jan 5 08:57:39 MET 2000 i686 unknown
> 
> box. Calling "make check" fails with 
....
> > all(tx == tx0)
> Error in all(tx == tx0) : dim<- length of dims do not match the length of object
> Execution halted
> 
> Don't shure what I should think about it. 
> 
> my compiler is:
> 
> >gcc --version
> 2.95.2
> 
> R is compiled using the
> 
> "-fPIC -O3 -fstrict-aliasing -ffast-math -funroll-loops -mpentiumpro -march=pentiumpro -fschedule-insns2"
> 
> compiler switches. I used 
> 
> ./configure --with-g77 --enable-blas_risc --enable-readline --with-x
> 
> for configuring.

That's a pretty heavy set of optimization options you're using there!

Basically, there are two possibilities:

1) You've triggered a compiler bug
2) You've triggered a bug in R

In either case, you'll have to dig deeper and see if you can catch the
exact spot where things go wrong. You might start R with the debugger,
run the base-Ex.R with it while having a breakpoint set at the error
message you are getting. But before that try running the example that
triggers the bug by itself and see if the bug is still tickled.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 467.reply.1 <==
From pd@biostat.ku.dk  Wed Mar  1 20:40:32 2000
Received: from biostat.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA01920;
	Wed, 1 Mar 2000 20:40:32 +0100 (MET)
Received: (from pd@localhost)
	by biostat.ku.dk (8.9.3/8.9.3) id UAA10356;
	Wed, 1 Mar 2000 20:40:48 +0100
Sender: pd@blueberry.kubism.ku.dk
To: p.dalgaard@biostat.ku.dk
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk, r-help@stat.math.ethz.ch
Subject: Re: [Rd] Re: [R] Re: R-1.0.0 is released (PR#467)
References: <200003011927.UAA01880@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 01 Mar 2000 20:40:48 +0100
In-Reply-To: p.dalgaard@biostat.ku.dk's message of "Wed, 1 Mar 2000 20:27:43 +0100 (MET)"
Message-ID: <x266v6cwcf.fsf@blueberry.kubism.ku.dk>
Lines: 11
X-Mailer: Gnus v5.7/Emacs 20.4
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

p.dalgaard@biostat.ku.dk writes:

...and notice that it is a very bad idea to mail to both r-help and
r-bugs. Anyone who answers the one on r-help without resetting the
Cc's will generate a new PR# , like I just did!

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 467.audit <==
Sat Apr 01 07:37:57 2000	ripley	moved from incoming to Installation
Sat Apr 01 07:38:40 2000	ripley	changed notes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 466 *
Subject: Re: R-1.0.0 is released
From: bhoel@server.python.net (Berthold=?iso-8859-1?q?_H=F6llmann?=)
Date: 01 Mar 2000 16:00:54 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 466 <==
From bhoel@server.python.net  Wed Mar  1 18:12:56 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA01317
	for <R-bugs@biostat.ku.dk>; Wed, 1 Mar 2000 18:12:55 +0100 (MET)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id SAA03990
	for <r-bugs@hypatia.math.ethz.ch>; Wed, 1 Mar 2000 18:13:07 +0100 (MET)
Received: from public.rrz.uni-hamburg.de(134.100.32.55), claiming to be "public.uni-hamburg.de"
 via SMTP by hypatia, id smtpdBAAa000yI; Wed Mar  1 18:12:57 2000
Received: from pchoel.privat.uni-hamburg.de (root@max1-055.public.uni-hamburg.de [134.100.43.55])
	by public.uni-hamburg.de (8.8.8/8.8.8) with ESMTP id SAA10846;
	Wed, 1 Mar 2000 18:12:54 +0100
Received: (from hoel@localhost)
	by pchoel.privat.uni-hamburg.de (8.9.3/8.9.3) id QAA27467;
	Wed, 1 Mar 2000 16:00:54 +0100
X-Authentication-Warning: pchoel.privat.uni-hamburg.de: hoel set sender to bhoel@starship.python.net using -f
Sender: hoel@public.uni-hamburg.de
To: r-help@stat.math.ethz.ch, r-bugs@stat.math.ethz.ch
Subject: Re: R-1.0.0 is released
References: <x23dqc5obk.fsf@blueberry.kubism.ku.dk>
From: bhoel@server.python.net (Berthold=?iso-8859-1?q?_H=F6llmann?=)
Date: 01 Mar 2000 16:00:54 +0100
In-Reply-To: Peter Dalgaard BSA's message of "29 Feb 2000 10:51:27 +0100"
Message-ID: <m2zosienvd.fsf@pchoel.privat.uni-hamburg.de>
Lines: 63
User-Agent: Gnus/5.0803 (Gnus v5.8.3) Emacs/20.6
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

> I've rolled up R-1.0.0.tgz a short while ago. 
> 
I've build R-1.0.0 on my

>uname -a
Linux pchoel 2.2.14 #3 Mit Jan 5 08:57:39 MET 2000 i686 unknown

box. Calling "make check" fails with 

...
make[4]: Entering directory `/opt/src/devel/R-1.0.0/tests/Examples'
updating base-Ex.R ...
make[5]: Entering directory `/opt/src/devel/R-1.0.0/src/library'
 >>> Building/Updating help pages for package `base'
     Formats: text example 
make[5]: Leaving directory `/opt/src/devel/R-1.0.0/src/library'
running code in base-Ex.R ...
../../bin/R --vanilla < base-Ex.R > base-Ex.Rout
make[4]: *** [base-Ex.Rout] Error 1
...

and 

>tail tests/Examples/base-Ex.Rout
> 
> cut(rep(1,5),4)#-- dummy
[1] (0.9995,1] (0.9995,1] (0.9995,1] (0.9995,1] (0.9995,1]
Levels:  (0.999,0.9995] (0.9995,1] (1,1.0005] (1.0005,1.001] 
> tx0 <- c(9, 4, 6, 5, 3, 10, 5, 3, 5)
> x <- rep(0:8, tx0)
> tx <- table(x)
> all(tx == tx0)
Error in all(tx == tx0) : dim<- length of dims do not match the length of object
Execution halted

Don't shure what I should think about it. 

my compiler is:

>gcc --version
2.95.2

R is compiled using the

"-fPIC -O3 -fstrict-aliasing -ffast-math -funroll-loops -mpentiumpro -march=pentiumpro -fschedule-insns2"

compiler switches. I used 

./configure --with-g77 --enable-blas_risc --enable-readline --with-x

for configuring.

Cheers

Berthold

-- 
bhoel@starship.python.net / http://starship.python.net/crew/bhoel/
        It is unlawful to use this email address for unsolicited ads
        (USC Title 47 Sec.227). I will assess a US$500 charge for
        reviewing and deleting each unsolicited ad.

==> 466.followup.1 <==
From plummer@iarc.fr  Thu Mar  2 10:59:27 2000
Received: from smtp02.iarc.fr (IDENT:root@uu194-7-167-221.unknown.uunet.be [194.7.167.221])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id KAA06126
	for <R-bugs@biostat.ku.dk>; Thu, 2 Mar 2000 10:59:27 +0100 (MET)
Received: from xena.iarc.fr ([10.10.150.125])
	by smtp02.iarc.fr (8.9.3/8.9.3) with ESMTP id KAA13613;
	Thu, 2 Mar 2000 10:58:59 +0100
Message-ID: <XFMail.000302110739.plummer@iarc.fr>
X-Mailer: XFMail 1.3 [p0] on Linux
X-Priority: 3 (Normal)
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 8bit
MIME-Version: 1.0
In-Reply-To: <200003011712.SAA01327@pubhealth.ku.dk>
Date: Thu, 02 Mar 2000 11:07:39 +0100 (CET)
Organization: International Agency for Research on Cancer
Sender: martyn@xena.iarc.fr
From: Martyn Plummer <plummer@iarc.fr>
To: bhoel@server.python.net
Subject: RE: [Rd] Re: R-1.0.0 is released (PR#466)
Cc: R-bugs@biostat.ku.dk, r-devel@stat.math.ethz.ch

On 01-Mar-00 bhoel@server.python.net wrote:
> R is compiled using the
> 
> "-fPIC -O3 -fstrict-aliasing -ffast-math -funroll-loops -mpentiumpro
> -march=pentiumpro -fschedule-insns2"
> 
> compiler switches. I used 
> 
> ./configure --with-g77 --enable-blas_risc --enable-readline --with-x
> 
> for configuring.

I can't help noticing that you are configuring for a RISC optimized BLAS
library on an Intel x86 processor.  I have no idea if this is serious,
but it seems a bit odd.

Martyn

==> 466.followup.2 <==
From bacon@aerodyne.com  Thu Mar  2 18:01:00 2000
Received: from chi6-1.relay.mail.uu.net (chi6-1.relay.mail.uu.net [199.171.54.98])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA11561
	for <R-bugs@biostat.ku.dk>; Thu, 2 Mar 2000 18:00:59 +0100 (MET)
From: bacon@aerodyne.com
Received: from aerodyne.com by chi6sosrv11.alter.net with ESMTP 
	(peer crosschecked as: [198.4.243.2])
	id QQieuf23702;
	Thu, 2 Mar 2000 15:27:53 GMT
Received: from aerodyne.com (keeshond.aerodyne.com [198.4.242.196]) by aerodyne.com (Hah!/nope) with ESMTP id KAA01933; Thu, 2 Mar 2000 10:27:39 -0500 (EST)
Message-Id: <200003021527.KAA01933@aerodyne.com>
Date: Thu, 2 Mar 2000 10:36:46 -0500 (EST)
Reply-To: bacon@aerodyne.com
Subject: RE: [Rd] Re: R-1.0.0 is released (PR#466)
To: plummer@iarc.fr
cc: bhoel@server.python.net, R-bugs@biostat.ku.dk, r-devel@stat.math.ethz.ch
In-Reply-To: <XFMail.000302110739.plummer@iarc.fr>
MIME-Version: 1.0
Content-Type: TEXT/plain; CHARSET=US-ASCII

On  2 Mar, Martyn Plummer wrote:
>  On 01-Mar-00 bhoel@server.python.net wrote:
> > R is compiled using the
> > 
> > "-fPIC -O3 -fstrict-aliasing -ffast-math -funroll-loops -mpentiumpro
> > -march=pentiumpro -fschedule-insns2"
> > 
> > compiler switches. I used 
> > 
> > ./configure --with-g77 --enable-blas_risc --enable-readline --with-x
> > 
> > for configuring.
>  
>  I can't help noticing that you are configuring for a RISC optimized BLAS
>  library on an Intel x86 processor.  I have no idea if this is serious,
>  but it seems a bit odd.
>  

Since this feature was added for PowerPC Linux distributions at my
request, I'll comment on this.  I would say that it is very unlikely to
be of any help, but it probably won't hurt.  The configure script will
check to see if libblas_risc can be located.  If it can't be found, it
won't be used.  Configure won't even look for it unless you request it
with --enable-blas_risc.

Furthermore, I don't believe that configure will actually use
libblas_risc unless you also --enable-blas.  I could be wrong in that
regard.  Using --enable-blas_risc could implicitly --enable-blas as
well. It's been many months since I wrote that configure option.  I do
know that configure will test if linking -lblas works first.  If that
fails, it won't even bother with -lblas_risc.  

Hope this helps,

-- 
Fred Bacon

==============================================================================
Aerodyne Research, Inc.                        Phone:  (978) 663-9500 ext. 273
45 Manning Rd.                                   FAX:  (978) 663-4918
Billerica, MA 01821-3976                        http://www.aerodyne.com
==============================================================================
"Oh my God!  Space aliens!  Don't eat me, I have a wife and kids!  Eat them."
                                                             -- Homer Simpson



==> 466.audit <==
Sat Apr 01 07:37:27 2000	ripley	moved from incoming to Installation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 571 *
Subject:  Missing -lc for compilation on AIX (R 1.1.0) 
From: Thomas Vogels <tov@infiniti.ece.cmu.edu>
Date: Thu, 15 Jun 2000 13:42:50 -0400
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 571 <==
From tov@infiniti.ece.cmu.edu  Thu Jun 15 19:42:32 2000
Received: from infiniti.ece.cmu.edu (INFINITI.ECE.CMU.EDU [128.2.216.84])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA25539
	for <r-bugs@biostat.ku.dk>; Thu, 15 Jun 2000 19:42:32 +0200 (MET DST)
Received: (from tov@localhost) by infiniti.ece.cmu.edu (AIX4.3/UCB 8.8.8/8.8.8) id NAA15666; Thu, 15 Jun 2000 13:42:50 -0400
Date: Thu, 15 Jun 2000 13:42:50 -0400
From: Thomas Vogels <tov@infiniti.ece.cmu.edu>
Message-Id: <200006151742.NAA15666@infiniti.ece.cmu.edu>
To: r-bugs@biostat.ku.dk
Subject:  Missing -lc for compilation on AIX (R 1.1.0) 
Cc: tov@infiniti.ece.cmu.edu

Hi,

  Kudos to all who've worked on getting 1.1 out.  It installs cleanly on
  Linux and Sun.  But AIX, of course, is a problem...

  When linking shared libs, the symbols from libc.a are not found.  I
  apologize for not investigating this further at the moment - they
  may not be properly or not all exported from R.bin.

  Fix: I've added ' -lc' to SHLIBLDFLAGS in Makeconf and etc/Makeconf in
  my build directory after running configure.  Then compilation proceeds
  without problems.
  (Alternatively, you could use cc instead of ld to link.)

  Regards,
  -tom
 

P.S. Any reason the status field is empty?  It is stable, right? ;-)

--please do not edit the information below--

Version:
 platform = powerpc-ibm-aix4.3.2.0
 arch = powerpc
 os = aix4.3.2.0
 system = powerpc, aix4.3.2.0
 status = 
 major = 1
 minor = 1.0
 year = 2000
 month = June
 day = 15
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

==> 571.audit <==
Wed Jun 21 12:05:32 2000	ripley	moved from incoming to Installation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 485 *
Subject: Install R1.0.0
From: Lynn Zhang <lyzhang@umich.edu>
Date: Mon, 13 Mar 2000 16:10:52 -0500 (EST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 485 <==
From lyzhang@umich.edu  Mon Mar 13 22:13:28 2000
Received: from shiwala.admin.lsa.umich.edu (shiwala.admin.lsa.umich.edu [141.211.75.248])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA13925
	for <r-bugs@biostat.ku.dk>; Mon, 13 Mar 2000 22:13:26 +0100 (MET)
Received: from kongzi.admin.lsa.umich.edu (lyzhang@kongzi.admin.lsa.umich.edu [141.211.32.160])
	by shiwala.admin.lsa.umich.edu (8.9.3/8.9.3/LSA 8.9.3 1999/10/05 22:57:41 lyzhang) with ESMTP id QAA15200
	for <r-bugs@biostat.ku.dk>; Mon, 13 Mar 2000 16:13:31 -0500 (EST)
Received: from localhost by kongzi.admin.lsa.umich.edu (8.9.3/8.9.3) with SMTP id QAA23357
	for <r-bugs@biostat.ku.dk>; Mon, 13 Mar 2000 16:10:52 -0500 (EST)
X-Authentication-Warning: kongzi.admin.lsa.umich.edu: lyzhang owned process doing -bs
Date: Mon, 13 Mar 2000 16:10:52 -0500 (EST)
From: Lynn Zhang <lyzhang@umich.edu>
X-Sender: lyzhang@kongzi.admin.lsa.umich.edu
To: r-bugs@biostat.ku.dk
Subject: Install R1.0.0
Message-ID: <Pine.SOL.3.95.1000313160825.18282A-100000@kongzi.admin.lsa.umich.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


Hello,

I tried to compile and install R. After I ran
make 2>&1 | tee log
., I got the following error:

making system.d from system.c
system.c:37: readline/readline.h: No such file or directory
make[3]: *** [system.d] Error 1
make[3]: Leaving directory
`/afs/lsa.umich.edu/group/admin/software/build/R/R-1.
0.0/src/unix'
make[2]: *** [R] Error 2
make[2]: Leaving directory
`/afs/lsa.umich.edu/group/admin/software/build/R/R-1.
0.0/src/unix'
make[1]: *** [R] Error 1
make[1]: Leaving directory
`/afs/lsa.umich.edu/group/admin/software/build/R/R-1.
0.0/src'
make: *** [R] Error 1



Please help.

Lots aof thanks!

*=======================================* 
*	Lynn Zhang             	        *
*	LS&A System Services Team       *
*	lyzhang@umich.edu               *
*=======================================*


==> 485.reply.1 <==
From thomas@biostat.washington.edu  Mon Mar 13 22:24:59 2000
Received: from mail.biostat.washington.edu (mail.biostat.washington.edu [128.95.113.21])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA13978
	for <R-bugs@biostat.ku.dk>; Mon, 13 Mar 2000 22:24:58 +0100 (MET)
Received: from mail.biostat.washington.edu (mail.biostat.washington.edu [128.95.113.21])
	by mail.biostat.washington.edu (8.9.3+Sun/8.9.1-fetrow-99-05-16b) with ESMTP id NAA03758;
	Mon, 13 Mar 2000 13:25:00 -0800 (PST)
Date: Mon, 13 Mar 2000 13:24:59 -0800 (PST)
From: Thomas Lumley <thomas@biostat.washington.edu>
To: lyzhang@umich.edu
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Install R1.0.0 (PR#485)
In-Reply-To: <200003132113.WAA13935@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.21.0003131315460.18281-100000@mail.biostat.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Mon, 13 Mar 2000 lyzhang@umich.edu wrote:

> 
> Hello,
> 
> I tried to compile and install R. After I ran
> make 2>&1 | tee log
> ., I got the following error:
> 
> making system.d from system.c
> system.c:37: readline/readline.h: No such file or directory

It looks as though you are trying to use GNU readline without it being
present.  This shouldn't be allowed by configure.

Try 
     make distclean
     ./configure
     make

again, to see if the problem goes away. If it doesn't then
look at src/include/config.h to see if you have something like
/* GNU Readline Library */
#define HAVE_LIBREADLINE 1
#define HAVE_READLINE_HISTORY_H 1
#define HAVE_READLINE_READLINE_H 1
indicating that configure thinks you have readline or like
/* GNU Readline Library */
/* #undef HAVE_LIBREADLINE */
/* #undef HAVE_READLINE_HISTORY_H */
/* #undef HAVE_READLINE_READLINE_H */
indicating that it doesn't.

In either case there would be a problem with configure, but a different
one. It's possible, for example, that configure is finding the readline
headers but that the compiler isn't looking in the same place.

Of course this is assuming you do have the GNU readline library and
headers. If you don't, then
	./configure --without-readline
is a workaround, though we would still like to know why configure thinks
you have it.


	-thomas

Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle




> make[3]: *** [system.d] Error 1
> make[3]: Leaving directory
> `/afs/lsa.umich.edu/group/admin/software/build/R/R-1.
> 0.0/src/unix'
> make[2]: *** [R] Error 2
> make[2]: Leaving directory
> `/afs/lsa.umich.edu/group/admin/software/build/R/R-1.
> 0.0/src/unix'
> make[1]: *** [R] Error 1
> make[1]: Leaving directory
> `/afs/lsa.umich.edu/group/admin/software/build/R/R-1.
> 0.0/src'
> make: *** [R] Error 1
> 
> 
> 
> Please help.
> 
> Lots aof thanks!
> 
> *=======================================* 
> *	Lynn Zhang             	        *
> *	LS&A System Services Team       *
> *	lyzhang@umich.edu               *
> *=======================================*
> 
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
> 

Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle


==> 485.followup.1 <==
From lyzhang@umich.edu  Tue Mar 14 22:36:11 2000
Received: from shiwala.admin.lsa.umich.edu (shiwala.admin.lsa.umich.edu [141.211.75.248])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA25640
	for <R-bugs@biostat.ku.dk>; Tue, 14 Mar 2000 22:36:10 +0100 (MET)
Received: from kongzi.admin.lsa.umich.edu (lyzhang@kongzi.admin.lsa.umich.edu [141.211.32.160])
	by shiwala.admin.lsa.umich.edu (8.9.3/8.9.3/LSA 8.9.3 1999/10/05 22:57:41 lyzhang) with ESMTP id QAA22968;
	Tue, 14 Mar 2000 16:36:17 -0500 (EST)
Received: from localhost by kongzi.admin.lsa.umich.edu (8.9.3/8.9.3) with SMTP id QAA09313;
	Tue, 14 Mar 2000 16:33:30 -0500 (EST)
X-Authentication-Warning: kongzi.admin.lsa.umich.edu: lyzhang owned process doing -bs
Date: Tue, 14 Mar 2000 16:33:30 -0500 (EST)
From: Lynn Zhang <lyzhang@umich.edu>
X-Sender: lyzhang@kongzi.admin.lsa.umich.edu
To: Thomas Lumley <thomas@biostat.washington.edu>
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Install R1.0.0 (PR#485)
In-Reply-To: <Pine.GSO.4.21.0003131315460.18281-100000@mail.biostat.washington.edu>
Message-ID: <Pine.SOL.3.95.1000314163154.17926J-100000@kongzi.admin.lsa.umich.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


Hello,

After I run make, I got the following error,

__d_sign                            /usr/lsa/lib/libblas.a(drotg.o)
ld: fatal: Symbol referencing errors. No output written to ../../bin/R.X11
make[3]: *** [../../bin/R.X11] Error 1
make[3]: Leaving directory
`/afs/lsa.umich.edu/group/admin/software/build/R/R-1.0.0/src/main'
make[2]: *** [R] Error 2
make[2]: Leaving directory
`/afs/lsa.umich.edu/group/admin/software/build/R/R-1.0.0/src/main'
make[1]: *** [R] Error 1
make[1]: Leaving directory
`/afs/lsa.umich.edu/group/admin/software/build/R/R-1.0.0/src'
make: *** [R] Error 1


Would you please help me on that?

Lots of thanks!




*=======================================* 
*	Lynn Zhang             	        *
*	LS&A System Services Team       *
*	lyzhang@umich.edu               *
*=======================================*


==> 485.audit <==
Sat Mar 25 09:40:03 2000	maechler	moved from incoming to Installation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Language

* PR# 589 *
Subject: Bug with lists and expressions
From: dmurdoch@pair.com (Duncan Murdoch)
Date: Tue, 04 Jul 2000 02:26:41 GMT
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 589 <==
From dmurdoch@pair.com  Tue Jul  4 04:20:03 2000
Received: from pony.its.uwo.ca (pony.its.uwo.ca [129.100.2.63])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id EAA10115
	for <r-bugs@biostat.ku.dk>; Tue, 4 Jul 2000 04:20:02 +0200 (MET DST)
Received: from ts12-9.slip.uwo.ca (ts12-9.slip.uwo.ca [129.100.154.230])
	by pony.its.uwo.ca (8.10.0/8.10.0) with SMTP id e642KIs10649;
	Mon, 3 Jul 2000 22:20:18 -0400 (EDT)
From: dmurdoch@pair.com (Duncan Murdoch)
To: r-devel@stat.math.ethz.ch
Cc: r-bugs@biostat.ku.dk
Subject: Bug with lists and expressions
Date: Tue, 04 Jul 2000 02:26:41 GMT
Message-ID: <39614504.13951296@julian.uwo.ca>
X-Mailer: Forte Agent 1.5/32.451
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

 I'm running R 1.1.0 for Windows; the behaviour is the same in 1.0.1.

 # create a list containing an expression: no problem
  x _ list(NA, expression(1))

 # Try to assign an expression to a list element, and get an error:
  x[[1]] _ expression(1)

 # Try again with a named list element:  no problem!
  x _ list(a=NA,expression(1))
  x$a _ expression(1)

The error message is: 

Error in "[[<-"(*tmp*, 1, value = expression(1))  :
	incompatible types

I think the error is in "[[<-", but that's a primitive, and I don't
know how to track it down any further.

Duncan Murdoch

==> 589.audit <==
Mon Jul 10 12:41:51 2000	ripley	moved from incoming to Language
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 587 *
Subject: dim(a <- ...) sets invisible flag erronously
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 30 Jun 2000 20:15:59 +0200 (MET DST)
--Not specific to dim: R differs from S for most functions here.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 587 <==
From maechler@stat.math.ethz.ch  Fri Jun 30 20:15:50 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA02851
	for <R-bugs@biostat.ku.dk>; Fri, 30 Jun 2000 20:15:50 +0200 (MET DST)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id UAA18670
	for <R-bugs@stat.math.ethz.ch>; Fri, 30 Jun 2000 20:16:09 +0200 (MET DST)
Received: from jessica(129.132.58.24), claiming to be "homes.stat.math.ethz.ch"
 via SMTP by hypatia, id smtpdAAAa004Zd; Fri Jun 30 20:16:00 2000
Received: (maechler@localhost) by homes.stat.math.ethz.ch (8.8.8+Sun/D-MATH-client) id UAA17303; Fri, 30 Jun 2000 20:15:59 +0200 (MET DST)
X-Authentication-Warning: homes.stat.math.ethz.ch: maechler set sender to maechler@stat.math.ethz.ch using -f
From: Martin Maechler <maechler@stat.math.ethz.ch>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <14684.58335.571324.541557@homes.stat.math.ethz.ch>
Date: Fri, 30 Jun 2000 20:15:59 +0200 (MET DST)
To: R-bugs@stat.math.ethz.ch
Subject: dim(a <- ...) sets invisible flag erronously
X-Mailer: VM 6.75 under Emacs 20.6.1
Reply-To: Martin Maechler <maechler@stat.math.ethz.ch>

{Nothing really harmful;  R 1.1.0}

dim(.) sets (or doesn't clear) the  ``invisible flag'' for printing in
certain circumstances:

  > dim(a <- cbind(1))
  >

does *not* print as it should :

  > dim(a)
  [1] 1 1

---

Question to the real "hackers" :

How can I check this using R code alone (not using files),
i.e. (how) can I ask an R expression if its ``invisible flag'' is set or not ?

{help(invisible) doesn't help here}.

Maybe one would want an

      is.invisible(.)

function?

-- 
Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

==> 587.followup.1 <==
From ripley@stats.ox.ac.uk  Mon Jul 10 15:36:34 2000
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA20903
	for <R-bugs@biostat.ku.dk>; Mon, 10 Jul 2000 15:36:34 +0200 (MET DST)
Received: from toucan.stats (toucan.stats [163.1.20.20])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with SMTP id OAA12626;
	Mon, 10 Jul 2000 14:36:51 +0100 (BST)
Message-Id: <200007101336.OAA12626@toucan.stats.ox.ac.uk>
Date: Mon, 10 Jul 2000 14:36:51 +0100 (BST)
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Reply-To: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Subject: Re: [Rd] dim(a <- ...) sets invisible flag erronously (PR#587)
To: r-devel@stat.math.ethz.ch, maechler@stat.math.ethz.ch
Cc: R-bugs@biostat.ku.dk
MIME-Version: 1.0
Content-Type: TEXT/plain; charset=us-ascii
Content-MD5: vCXar+2yNs/52Q2nsVCl1Q==
X-Mailer: dtmail 1.3.0 @(#)CDE Version 1.3.5 SunOS 5.7 sun4m sparc 


> Date: Fri, 30 Jun 2000 20:15:51 +0200 (MET DST)
> From: maechler@stat.math.ethz.ch
> To: r-devel@stat.math.ethz.ch
> Subject: [Rd] dim(a <- ...) sets invisible flag erronously (PR#587)
> CC: R-bugs@biostat.ku.dk
> X-Loop: R-bugs@biostat.ku.dk
> 
> {Nothing really harmful;  R 1.1.0}
> 
> dim(.) sets (or doesn't clear) the  ``invisible flag'' for printing in
> certain circumstances:
> 
>   > dim(a <- cbind(1))
>   >
> 
> does *not* print as it should :
> 
>   > dim(a)
>   [1] 1 1

This is nothing to do with dim: any function will do this.

> foo <- function(x) x
> foo(a <- cbind(1))

It happens because the way invisible is implemented is different in R and S:
in S there is a .Auto.print var in frame 1, and in R there is a global
variable R_visible, so anything during the evaluation that unsets the
flag will ensure that the result is invisible.

I don't see how to avoid this without checking the `depth' in the evaluation
pretty carefully (and R's semantics differ from those of S in that
braced expressions do not generate a frame).

Is this worth fixing?  print(.Last.value) works all the time, and perhaps
you might be persuaded not to write code that uses assignments as arguments?

> ---
> 
> Question to the real "hackers" :
> 
> How can I check this using R code alone (not using files),
> i.e. (how) can I ask an R expression if its ``invisible flag'' is set or not ?
> 
> {help(invisible) doesn't help here}.
> 
> Maybe one would want an
> 
>       is.invisible(.)
> 
> function?

There seems to be an unused internal function do_visibleflag in print.c.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 587.audit <==
Mon Jul 10 12:42:47 2000	ripley	moved from incoming to Language
Mon Jul 10 13:40:28 2000	ripley	changed notes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 412 *
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 412 <==
From postmaster@franz.stat.wisc.edu  Sun Feb  6 01:16:33 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA26868
	for <R-bugs@biostat.ku.dk>; Sun, 6 Feb 2000 01:16:31 +0100 (MET)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id BAA18080
	for <r-bugs@hypatia.math.ethz.ch>; Sun, 6 Feb 2000 01:16:38 +0100 (MET)
Received: from franz.stat.wisc.edu(128.105.174.95)
 via SMTP by hypatia, id smtpdAAAa004QS; Sun Feb  6 01:16:33 2000
Received: from pubhealth.ku.dk (really [130.225.108.10]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m12HFNP-000ZSxC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <r-bugs@r-project.org>; Sat, 5 Feb 2000 18:16:31 -0600 (CST) 
Received: from biostat.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA26864
	for <r-bugs@r-project.org>; Sun, 6 Feb 2000 01:16:18 +0100 (MET)
Received: (from pd@localhost)
	by biostat.ku.dk (8.9.3/8.9.3) id BAA12311;
	Sun, 6 Feb 2000 01:18:51 +0100
Sender: pd@blueberry.kubism.ku.dk
To: r-bugs@r-project.org
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
Message-ID: <x2900zyyhh.fsf@blueberry.kubism.ku.dk>
Lines: 51
X-Mailer: Gnus v5.7/Emacs 20.4
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit


Call objects don't always behave as you'd expect. They're mostly
list-like, but with exceptions:

> f<-function(x,y,...)match.call(expand.dots=FALSE)
> xx <- f(y=1,2,z=3,4)
> dd <- xx$...
> xx$... <- NULL
> c(xx,dd)
[[1]]
f(x = 2, y = 1)

$z
[1] 3

[[3]]
[1] 4

> as.call(c(as.list(xx),dd))
f(x = 2, y = 1, z = 3, 4)

(Splus has this rather differently, since dd becomes a call to list()
rather than a list of promises:

S> c(xx,dd)
f(x = 2, y = 1, list, z = 3, 4)
S> as.call(c(as.list(xx),dd))
f(x = 2, y = 1, list, z = 3, 4)

...but at least gives the same in both cases)

Also, the names of arguments added with [[<- is getting dropped if a
new element is required:

> xx[["abc"]]<-123
> xx
f(x = 2, y = 1, 123)

S has what I'd expect there:

S> xx[["abc"]]<-123
S> xx
f(x = 2, y = 1, abc = 123)

[R-0.99.0 prerelease on RedHat6.1, but this is likely not a new thing.]

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 412.audit <==
Wed Feb 16 19:26:57 2000	ripley	moved from incoming to Language
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 408 *
Subject: convolution bug
From: wsimpson@gcal.ac.uk
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 408 <==
From wsimpson@gcal.ac.uk  Fri Jan 28 11:17:36 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA11325
	for <R-bugs@biostat.ku.dk>; Fri, 28 Jan 2000 11:17:36 +0100 (MET)
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)
From: wsimpson@gcal.ac.uk
Message-Id: <200001281017.LAA11325@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: convolution bug

Full_Name: Bill Simpson
Version: 65.1 , 0.90.1
OS: Linux
Submission from: (NULL) (193.62.250.209)


I reported this on r-help, but here is official bug report.

The present convolve() does not do convolution by default. Its default behaviour
is
correlation. This is a bug.

The default argument conj should be set to FALSE.

The zero-padding should be on the right for linear convolution (don't ask me
why you call this type="open"; I suggest type="linear").

Here is what I expect linear convolution to do:
myconvolve<-function (x,h) 
{
    nx <- length(x)
    nh <- length(h)
    #zero pad
    if(nx>nh)
       {
       x <- c(x,rep(0, nh-1))
       h<-c(h,rep(0,nx-1))
       }
    else
       {
       h <- c(h,rep(0, nx-1))
       x<-c(x,rep(0,nh-1))
       }
    x <- fft(fft(x) * fft(h), inv = TRUE)
    Re(x)/length(x)
#I am not sure about this, the R IFFT is weird
}

What "circular" convolution should do is just
eliminate the zero-padding:

myconvolve2<-function (x,h)
{
#no padding, circular convolution
    nx <- length(x)
    nh <- length(h)
    x <- fft(fft(x) * fft(h), inv = TRUE)
    Re(x)/(nx)
}


I suggest that you create two functions, convolve() and correlate(), and get
rid
of the conj argument in convolve().

==> 408.audit <==
Wed Feb 16 19:28:42 2000	ripley	moved from incoming to Language
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Low-level

* PR# 608 *
Subject: seg.fault in eval.c
From: Adrian Vance Custer <acuster@nopause.berkeley.edu>
Date: Sat, 15 Jul 2000 01:22:23 -0700
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 608 <==
From acuster@nopause.berkeley.edu  Sat Jul 15 10:19:34 2000
Received: from nopause.berkeley.edu (nopause.Berkeley.EDU [128.32.251.234])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id KAA17904
	for <r-bugs@biostat.ku.dk>; Sat, 15 Jul 2000 10:19:33 +0200 (MET DST)
Received: by nopause.berkeley.edu (Postfix, from userid 1000)
	id 7BDF322002; Sat, 15 Jul 2000 01:22:23 -0700 (PDT)
Date: Sat, 15 Jul 2000 01:22:23 -0700
From: Adrian Vance Custer <acuster@nopause.berkeley.edu>
To: r-bugs@biostat.ku.dk
Subject: seg.fault in eval.c
Message-ID: <20000715012223.A2206@nopause.berkeley.edu>
Mime-Version: 1.0
Content-Type: multipart/mixed; boundary="/9DWx/yDrRhgMJTb"
X-Mailer: Mutt 1.0.1us


--/9DWx/yDrRhgMJTb
Content-Type: text/plain; charset=us-ascii

Hello everyone,

verison: 1.0.1
platform: Gnu/linux mandrake 7.1beta

I'm running a user function to step through a frame and plot one column against
the next. This crashes the program fairly reliably although not on the first
try.

Here is a log of the session run through gdb. First I launch R, print out the
top of the frame and the function. (The function I wrote is probably ugly,
especially the for loop, and if you want to suggest how to make it better I'm
always ready to learn.) Then I run the magic incantation three times and seg
fault. From the shell at that point R crashes and closes the plot window. In
gdb the window stays open and only closes when I quit gdb.

I have appended the .RData file. I also have a core produced in the same way
from the terminal. If you can use it I can send it but it's huge.

Thanks for the great software,
adrian



***************************************************************************

tsetse$ /usr/local/bin/R --debugger=gdb
(gdb) run --vsize 12M --nsize 1200k

> ls()
[1] "my.frame"     "my.plot.func"
> my.frame[1:2,]
  viltid sept97 oct97 nov97beg nov97end dec97beg dec97end jan98 feb98 mar98
1    501    148    53       32       23       17       14     4     3     3
2    502     44    54       45       36       24        9     5     3     2
  apr98 may98 jun98 jul98 aug98 sep98 nov98 dec98
1     2     2     1     0     0     0     2     1
2     2     2     1     0     0     0     2     1
> my.plot.func
function(the.frame){

#first do the parameter checking:
if (missing(the.frame)){
   cat("\n")
   cat("Need a data frame argument with 17 monthly catches (sept, oct ...)\n")
   cat("   for tsetse use A.FRAME.tsetse.97n98, for adjtse roll your own.\n")
}   #fi

else{
   #next cache the initial conditions:
   start.par_par(no.readonly = TRUE)           #store the inital parameters
   on.exit(par(start.par),append=TRUE)         #restore the graphics parameters
   par(mfrow=c(2,8),mar=c(1,1,1,0),oma=c(0,1,2,1))

   #next initialize the function
   attach(the.frame)
   on.exit(detach(the.frame),append=TRUE)

   #function body:
   for (i in 1:16){
      plot(the.frame[,i],the.frame[,i+1])
      abline(lm(the.frame[,i+1]~the.frame[,i]))
   }
   mtext("Correlation of tsetse samples: sample to sample
plots",side=3,outer=TRUE,cex=1.5)


}   #end else
}
> my.plot.func(my.frame[,2:18])
> my.plot.func(my.frame[,2:18])
> my.plot.func(my.frame[,2:18])

Program received signal SIGSEGV, Segmentation fault.
0x807c367 in Rf_eval (e=0x1, rho=0x15d9eb8) at eval.c:83
83	eval.c: No such file or directory.
(gdb) backtrace
#0  0x807c367 in Rf_eval (e=0x1, rho=0x15d9eb8) at eval.c:83
#1  0x807d660 in do_begin (call=0x15e135c, op=0x3a59a4, args=0x15e1348, 
    rho=0x15d9eb8) at eval.c:640
#2  0x807c5f8 in Rf_eval (e=0x15e135c, rho=0x15d9eb8) at eval.c:172
#3  0x806bc30 in Rf_endcontext (cptr=0xbfffee34) at context.c:147
#4  0x807cb40 in Rf_applyClosure (call=0x15d9e54, op=0x7e332c, 
    arglist=0x15d9e90, rho=0x3adf3c, suppliedenv=0x3a5008) at eval.c:345
#5  0x807c74d in Rf_eval (e=0x15d9e54, rho=0x3adf3c) at eval.c:192
#6  0x8091274 in R_ReplConsole (rho=0x3adf3c, savestack=0, browselevel=0)
    at main.c:173
#7  0x8091955 in run_Rmainloop () at main.c:457
#8  0x8091994 in Rf_mainloop () at main.c:471
#9  0x80e6bfc in main (ac=0, av=0xbffff894) at system.c:490
(gdb) quit
The program is running.  Exit anyway? (y or n) y
[acuster@tsetse tocrashR]$ 


--/9DWx/yDrRhgMJTb
Content-Type: application/octet-stream
Content-Disposition: attachment; filename=RData
Content-Transfer-Encoding: base64

UkRYMQoAAAAlAAAAAAAAAAYAAAAGc291cmNlAAAAAAADAAAAA2NleAAAAAAFAAAABW91dGVy
AAAAAAAABAAAAARzaWRlAAAABQAAAAVtdGV4dAAAAAAAAAEAAAABfgAAAAAAAAIAAAACbG0A
AAAAAAYAAAAGYWJsaW5lAAAAAAABAAAAASsAAAAAAAABAAAAAVsAAAAAAAAEAAAABHBsb3QA
AAABAAAAAToAAAAAAAABAAAAAWkAAAAAAAADAAAAA2ZvcgAAAAAGAAAABmRldGFjaAAAAAAA
BgAAAAZhdHRhY2gAAAAAAAMAAAADb21hAAAAAAMAAAADbWFyAAAAAAEAAAABYwAAAAAAAAUA
AAAFbWZyb3cAAAAAAAAGAAAABmFwcGVuZAAAAAAABwAAAAdvbi5leGl0AAAAAAsAAAALbm8u
cmVhZG9ubHkAAAAAAwAAAANwYXIAAAAACQAAAAlzdGFydC5wYXIAAAAAAAACAAAAAjwtAAAA
AAADAAAAA2NhdAAAAAAHAAAAB21pc3NpbmcAAAAAAgAAAAJpZgAAAAAAAQAAAAF7AAAAAAAA
CQAAAAl0aGUuZnJhbWUAAAAAAAAMAAAADG15LnBsb3QuZnVuYwAAAAUAAAAFY2xhc3MAAAAA
AAAJAAAACXJvdy5uYW1lcwAAAAAAAAUAAAAFbmFtZXMAAAAAAAAIAAAACG15LmZyYW1lAAAA
CgAAAAouVHJhY2ViYWNrAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAl//////////8A
AAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAk/////wAAABMAAAAAAAAAAQAAABIAAAAOAAAA
AAAAAAAAAAAyQH9QAAAAAABAf2AAAAAAAEB/cAAAAAAAQH+AAAAAAABAf5AAAAAAAECCyAAA
AAAAQILQAAAAAABAgtgAAAAAAECC4AAAAAAAQILoAAAAAABAjCgAAAAAAECMMAAAAAAAQIw4
AAAAAABAjEAAAAAAAECMSAAAAAAAQI9IAAAAAABAj1AAAAAAAECPWAAAAAAAQI9gAAAAAABA
j2gAAAAAAECh+gAAAAAAQKH8AAAAAABAof4AAAAAAECiAAAAAAAAQKICAAAAAABApeIAAAAA
AECl5AAAAAAAQKXmAAAAAABApegAAAAAAECl6gAAAAAAQKaqAAAAAABApqwAAAAAAECmrgAA
AAAAQKawAAAAAABAprIAAAAAAECncgAAAAAAQKd0AAAAAABAp3YAAAAAAECneAAAAAAAQKd6
AAAAAABAsZUAAAAAAECxlgAAAAAAQLGXAAAAAABAsZgAAAAAAECxmQAAAAAAQMmWgAAAAABA
yZcAAAAAAEDJl4AAAAAAQMmYAAAAAABAyZiAAAAAAP////8AAAAOAAAAAAAAAAAAAAAyQGKA
AAAAAABARgAAAAAAAEBWgAAAAAAAQFOAAAAAAABAQYAAAAAAAEBNgAAAAAAAQEGAAAAAAABA
TYAAAAAAAEBGAAAAAAAAQFDAAAAAAABAR4AAAAAAAEBDAAAAAAAAQFVAAAAAAABAQwAAAAAA
AEBaQAAAAAAAQFhAAAAAAABAToAAAAAAAEBiIAAAAAAAQFMAAAAAAABATYAAAAAAAEBOAAAA
AAAAQE4AAAAAAABAXYAAAAAAAEBMgAAAAAAAQEwAAAAAAABAU4AAAAAAAEBcQAAAAAAAQFMA
AAAAAABAY2AAAAAAAEBIAAAAAAAAQFRAAAAAAABAYiAAAAAAAEBMgAAAAAAAQFYAAAAAAABA
YGAAAAAAAEBgAAAAAAAAQFEAAAAAAABAXIAAAAAAAEBYwAAAAAAAQFWAAAAAAABARwAAAAAA
AEBcwAAAAAAAQFEAAAAAAABAUwAAAAAAAEBXAAAAAAAAQGGAAAAAAABAXkAAAAAAAEBnIAAA
AAAAQFdAAAAAAABAZMAAAAAAAP////8AAAAOAAAAAAAAAAAAAAAyQEqAAAAAAABASwAAAAAA
AEBBgAAAAAAAQEkAAAAAAABAVQAAAAAAAEA+AAAAAAAAQDsAAAAAAABAQwAAAAAAAEBDgAAA
AAAAQEcAAAAAAABAQwAAAAAAAEA6AAAAAAAAQFBAAAAAAABAOwAAAAAAAEBYQAAAAAAAQFJA
AAAAAABASoAAAAAAAEA9AAAAAAAAQFTAAAAAAABASAAAAAAAAEBAAAAAAAAAQEoAAAAAAABA
WsAAAAAAAEBIgAAAAAAAQEWAAAAAAABASYAAAAAAAEA7AAAAAAAAQEWAAAAAAABAUcAAAAAA
AEBAgAAAAAAAQFUAAAAAAABATYAAAAAAAEBEAAAAAAAAQEsAAAAAAABASwAAAAAAAEBTgAAA
AAAAQEwAAAAAAABAR4AAAAAAAEBKgAAAAAAAQE4AAAAAAABAQgAAAAAAAEBIAAAAAAAAQEQA
AAAAAABAQgAAAAAAAEBNAAAAAAAAQF7AAAAAAABAR4AAAAAAAEBQQAAAAAAAQFAAAAAAAABA
UAAAAAAAAP////8AAAAOAAAAAAAAAAAAAAAyQEAAAAAAAABARoAAAAAAAEBLAAAAAAAAQEEA
AAAAAABAPQAAAAAAAEAyAAAAAAAAQEEAAAAAAABAPAAAAAAAAEA1AAAAAAAAQDoAAAAAAABA
MwAAAAAAAEA6AAAAAAAAQDUAAAAAAABANwAAAAAAAEA3AAAAAAAAQDsAAAAAAABAQIAAAAAA
AEA6AAAAAAAAQDwAAAAAAABAQQAAAAAAAEA/AAAAAAAAQEaAAAAAAABAPgAAAAAAAEBCgAAA
AAAAQEQAAAAAAABAOwAAAAAAAEAwAAAAAAAAQDwAAAAAAABAOQAAAAAAAEA1AAAAAAAAQDkA
AAAAAABANgAAAAAAAEAxAAAAAAAAQCgAAAAAAABAMgAAAAAAAEBBAAAAAAAAQD4AAAAAAABA
QYAAAAAAAEA7AAAAAAAAQEIAAAAAAABAOwAAAAAAAEBCAAAAAAAAQDUAAAAAAABAOQAAAAAA
AEA9AAAAAAAAQEAAAAAAAABAOwAAAAAAAEBHAAAAAAAAQD0AAAAAAABALAAAAAAAAP////8A
AAAOAAAAAAAAAAAAAAAyQDcAAAAAAABAQgAAAAAAAEA3AAAAAAAAQDsAAAAAAABAOgAAAAAA
AEAuAAAAAAAAQDsAAAAAAABANwAAAAAAAEAxAAAAAAAAQDQAAAAAAABALgAAAAAAAEA2AAAA
AAAAQDEAAAAAAABALAAAAAAAAEAyAAAAAAAAQDMAAAAAAABAOQAAAAAAAEAzAAAAAAAAQDYA
AAAAAABAMwAAAAAAAEA4AAAAAAAAQEGAAAAAAABANQAAAAAAAEA+AAAAAAAAQDwAAAAAAABA
MwAAAAAAAEAkAAAAAAAAQDcAAAAAAABAMgAAAAAAAEAwAAAAAAAAQDQAAAAAAABALgAAAAAA
AEAsAAAAAAAAQCIAAAAAAABAKAAAAAAAAEA5AAAAAAAAQD4AAAAAAABANQAAAAAAAEAxAAAA
AAAAQDoAAAAAAABANgAAAAAAAEA1AAAAAAAAQC4AAAAAAABALgAAAAAAAEA0AAAAAAAAQDcA
AAAAAABANwAAAAAAAEBFgAAAAAAAQDcAAAAAAABALgAAAAAAAP////8AAAAOAAAAAAAAAAAA
AAAyQDEAAAAAAABAOAAAAAAAAEAxAAAAAAAAQDIAAAAAAABAMwAAAAAAAEAmAAAAAAAAQDAA
AAAAAABANAAAAAAAAEAoAAAAAAAAQCwAAAAAAABAJAAAAAAAAEAuAAAAAAAAQDAAAAAAAABA
JgAAAAAAAEAmAAAAAAAAQCwAAAAAAABAMgAAAAAAAEAqAAAAAAAAQDEAAAAAAABALAAAAAAA
AEAyAAAAAAAAQDsAAAAAAABALAAAAAAAAEA2AAAAAAAAQDUAAAAAAABALgAAAAAAAEAgAAAA
AAAAQDIAAAAAAABAKAAAAAAAAEAuAAAAAAAAQC4AAAAAAABAKAAAAAAAAEAkAAAAAAAAQCgA
AAAAAABAIAAAAAAAAEAwAAAAAAAAQDcAAAAAAABALgAAAAAAAEAoAAAAAAAAQDQAAAAAAABA
NQAAAAAAAEAuAAAAAAAAQCYAAAAAAABAKgAAAAAAAEAzAAAAAAAAQDEAAAAAAABALAAAAAAA
AEA+AAAAAAAAQDEAAAAAAABAMAAAAAAAAP////8AAAAOAAAAAAAAAAAAAAAyQCwAAAAAAABA
IgAAAAAAAEAkAAAAAAAAQCwAAAAAAABAMAAAAAAAAEAiAAAAAAAAQCYAAAAAAABAMAAAAAAA
AEAgAAAAAAAAQCAAAAAAAABAGAAAAAAAAEAmAAAAAAAAQCYAAAAAAABAFAAAAAAAAEAcAAAA
AAAAQCIAAAAAAABALAAAAAAAAEAkAAAAAAAAQBwAAAAAAABAIgAAAAAAAEAuAAAAAAAAQDEA
AAAAAABAKAAAAAAAAEAyAAAAAAAAQC4AAAAAAABAJAAAAAAAAEAYAAAAAAAAQCwAAAAAAABA
IgAAAAAAAEAkAAAAAAAAQCYAAAAAAABAIAAAAAAAAEAcAAAAAAAAQCQAAAAAAABAIAAAAAAA
AEAmAAAAAAAAQDEAAAAAAABAKAAAAAAAAEAiAAAAAAAAQCwAAAAAAABAMgAAAAAAAEAsAAAA
AAAAQCIAAAAAAABAIAAAAAAAAEAwAAAAAAAAQCgAAAAAAABAJgAAAAAAAEA1AAAAAAAAQCoA
AAAAAABAKAAAAAAAAP////8AAAAOAAAAAAAAAAAAAAAyQBAAAAAAAABAFAAAAAAAAEAYAAAA
AAAAQBQAAAAAAABAIAAAAAAAAEAcAAAAAAAAQBwAAAAAAABAJgAAAAAAAEAUAAAAAAAAQBgA
AAAAAABAGAAAAAAAAEAcAAAAAAAAQBQAAAAAAABACAAAAAAAAEAUAAAAAAAAQBgAAAAAAABA
IgAAAAAAAEAQAAAAAAAAQBQAAAAAAABAHAAAAAAAAEAgAAAAAAAAQBwAAAAAAABAGAAAAAAA
AEAgAAAAAAAAQCAAAAAAAABAFAAAAAAAAEAQAAAAAAAAQBQAAAAAAABAEAAAAAAAAEAUAAAA
AAAAQCIAAAAAAABAGAAAAAAAAEAcAAAAAAAAQBQAAAAAAABAHAAAAAAAAEAQAAAAAAAAQBgA
AAAAAABAHAAAAAAAAEAYAAAAAAAAQAgAAAAAAABAIAAAAAAAAEAiAAAAAAAAQAgAAAAAAABA
GAAAAAAAAEAUAAAAAAAAQBwAAAAAAABAGAAAAAAAAEAiAAAAAAAAQCQAAAAAAABAGAAAAAAA
AP////8AAAAOAAAAAAAAAAAAAAAyQAgAAAAAAABACAAAAAAAAEAAAAAAAAAAQBAAAAAAAABA
EAAAAAAAAEAIAAAAAAAAQBAAAAAAAABAFAAAAAAAAEAIAAAAAAAAQBwAAAAAAABAFAAAAAAA
AEAIAAAAAAAAQBAAAAAAAABACAAAAAAAAEAYAAAAAAAAQBAAAAAAAABACAAAAAAAAEAIAAAA
AAAAQAAAAAAAAABAFAAAAAAAAEAUAAAAAAAAQAAAAAAAAABAEAAAAAAAAEAUAAAAAAAAQCIA
AAAAAABAGAAAAAAAAEAQAAAAAAAAQAgAAAAAAABAEAAAAAAAAEAAAAAAAAAAQBgAAAAAAABA
FAAAAAAAAEAIAAAAAAAAQAgAAAAAAABAEAAAAAAAAEAAAAAAAAAAQAgAAAAAAABAAAAAAAAA
AEAQAAAAAAAAQAgAAAAAAABAAAAAAAAAAEAIAAAAAAAAQAgAAAAAAABAHAAAAAAAAEAcAAAA
AAAAQBAAAAAAAABAGAAAAAAAAEAYAAAAAAAAQCIAAAAAAABAIAAAAAAAAP////8AAAAOAAAA
AAAAAAAAAAAyQAgAAAAAAABAAAAAAAAAAD/wAAAAAAAAQAgAAAAAAABACAAAAAAAAEAAAAAA
AAAAQAAAAAAAAABAEAAAAAAAAEAAAAAAAAAAQBAAAAAAAABACAAAAAAAAEAAAAAAAAAAQAgA
AAAAAABAAAAAAAAAAEAQAAAAAAAAQAgAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAgAAAAAAABA
EAAAAAAAAEAIAAAAAAAAQAAAAAAAAABACAAAAAAAAEAAAAAAAAAAQBQAAAAAAABAEAAAAAAA
AEAIAAAAAAAAQAgAAAAAAABAFAAAAAAAAEAIAAAAAAAAQAgAAAAAAABAEAAAAAAAAEAYAAAA
AAAAQBQAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAA/8AAAAAAAAEAIAAAAAAAAQAAA
AAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABACAAAAAAAAEAQAAAAAAAAQAAAAAAAAABA
EAAAAAAAAEAQAAAAAAAAQBAAAAAAAABAEAAAAAAAAP////8AAAAOAAAAAAAAAAAAAAAyQAAA
AAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAA/8AAAAAAAAAAAAAAAAAAAQAAAAAAAAABA
AAAAAAAAAEAAAAAAAAAAQAgAAAAAAAA/8AAAAAAAAEAIAAAAAAAAP/AAAAAAAABAAAAAAAAA
AEAAAAAAAAAAQAAAAAAAAABACAAAAAAAAEAAAAAAAAAAQAAAAAAAAABACAAAAAAAAEAAAAAA
AAAAP/AAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAgAAAAAAABACAAAAAAAAEAAAAAAAAAAQAAA
AAAAAABAEAAAAAAAAEAIAAAAAAAAQBAAAAAAAABAFAAAAAAAAEAQAAAAAAAAQAAAAAAAAABA
AAAAAAAAAD/wAAAAAAAAQAAAAAAAAABAAAAAAAAAAD/wAAAAAAAAQAAAAAAAAABAAAAAAAAA
AEAAAAAAAAAAQAAAAAAAAABACAAAAAAAAEAAAAAAAAAAQAAAAAAAAABACAAAAAAAAEAAAAAA
AAAAQAAAAAAAAABACAAAAAAAAP////8AAAAOAAAAAAAAAAAAAAAyQAAAAAAAAABAAAAAAAAA
AEAIAAAAAAAAQAAAAAAAAAA/8AAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAD/wAAAA
AAAAQAgAAAAAAABAAAAAAAAAAEAAAAAAAAAAP/AAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAA
AAAAAABAAAAAAAAAAEAIAAAAAAAAQAAAAAAAAABACAAAAAAAAD/wAAAAAAAAQAAAAAAAAAA/
8AAAAAAAAEAAAAAAAAAAQAgAAAAAAABAFAAAAAAAAEAIAAAAAAAAQAAAAAAAAABACAAAAAAA
AEAIAAAAAAAAQAAAAAAAAABAAAAAAAAAAD/wAAAAAAAAQAgAAAAAAABAAAAAAAAAAEAAAAAA
AAAAQAAAAAAAAAA/8AAAAAAAAD/wAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAIAAAAAAAAQAAA
AAAAAAA/8AAAAAAAAEAAAAAAAAAAQAgAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAgAAAAAAABA
AAAAAAAAAP////8AAAAOAAAAAAAAAAAAAAAyP/AAAAAAAAA/8AAAAAAAAEAAAAAAAAAAQAAA
AAAAAAAAAAAAAAAAAD/wAAAAAAAAQAgAAAAAAABAAAAAAAAAAAAAAAAAAAAAP/AAAAAAAABA
AAAAAAAAAD/wAAAAAAAAQAAAAAAAAAAAAAAAAAAAAD/wAAAAAAAAQAAAAAAAAAAAAAAAAAAA
AD/wAAAAAAAAP/AAAAAAAABAAAAAAAAAAD/wAAAAAAAAP/AAAAAAAAA/8AAAAAAAAEAQAAAA
AAAAQAAAAAAAAABAAAAAAAAAAD/wAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAA
AAAAAABACAAAAAAAAD/wAAAAAAAAP/AAAAAAAABAAAAAAAAAAD/wAAAAAAAAAAAAAAAAAAA/
8AAAAAAAAD/wAAAAAAAAQAAAAAAAAABAAAAAAAAAAD/wAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAQAAAAAAAAAA/8AAAAAAAAEAAAAAAAAAAQAgAAAAAAABAAAAAAAAAAP////8A
AAAOAAAAAAAAAAAAAAAyAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAFAAAAAAAAEAQAAAAAAAAQBAAAAAAAABAAAAAAAAA
AEAAAAAAAAAAQAgAAAAAAABAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQBQA
AAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAOAAAAAAAAAAAA
AAAyAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAEAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAGAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAEAUAAAAAAAAQBgAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQBAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAOAAAAAAAAAAAAAAAyAAAAAAAAAAAA
AAAAAAAAAEAIAAAAAAAAQAAAAAAAAABAFAAAAAAAAEAQAAAAAAAAQAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/wAAAA
AAAAQAAAAAAAAAAAAAAAAAAAAD/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA
EAAAAAAAAEAYAAAAAAAAQBAAAAAAAABAGAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAA
AEAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAEAgAAAAAAAAQBgAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAP////8AAAAOAAAAAAAAAAAAAAAyQAAAAAAAAABAAAAAAAAAAAAAAAAA
AAAAQAAAAAAAAABAIAAAAAAAAEAUAAAAAAAAP/AAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAA
AAAAAAAAAAAAAAAAAD/wAAAAAAAAQAgAAAAAAAA/8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAD/wAAAAAAAAAAAAAAAAAABAAAAAAAAAAD/wAAAAAAAAQAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAIAAAAAAAAAAAAAAAAAAA/8AAAAAAAAEAIAAAA
AAAAQBAAAAAAAAAAAAAAAAAAAD/wAAAAAAAAQAAAAAAAAAA/8AAAAAAAAEAUAAAAAAAAP/AA
AAAAAAAAAAAAAAAAAD/wAAAAAAAAP/AAAAAAAABAAAAAAAAAAEAIAAAAAAAAQAgAAAAAAABA
AAAAAAAAAAAAAAAAAAAAQBQAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAgAAAAAAABACAAAAAAA
AP////8AAAAOAAAAAAAAAAAAAAAyP/AAAAAAAAA/8AAAAAAAAAAAAAAAAAAAAAAAAAAAAABA
CAAAAAAAAD/wAAAAAAAAP/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAA/8AAAAAAAAEAAAAAAAAAAQAAAAAAAAAA/8AAAAAAAAAAAAAAA
AAAAAAAAAAAAAAA/8AAAAAAAAD/wAAAAAAAAP/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAA/8AAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAA/
8AAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AEAAAAAAAAAAP/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/8AAAAAAAAEAIAAAA
AAAAQBAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABACAAAAAAAAP////8AAAACAAAA
AAAAAAAAAAABAAAAAAAAAAAAAAAj/////wAAABAAAAAAAAAAAAAAABIAAAAGAAAABnZpbHRp
ZAAAAAAABgAAAAZzZXB0OTcAAAAAAAUAAAAFb2N0OTcAAAAAAAAIAAAACG5vdjk3YmVnAAAA
CAAAAAhub3Y5N2VuZAAAAAgAAAAIZGVjOTdiZWcAAAAIAAAACGRlYzk3ZW5kAAAABQAAAAVq
YW45OAAAAAAAAAUAAAAFZmViOTgAAAAAAAAFAAAABW1hcjk4AAAAAAAABQAAAAVhcHI5OAAA
AAAAAAUAAAAFbWF5OTgAAAAAAAAFAAAABWp1bjk4AAAAAAAABQAAAAVqdWw5OAAAAAAAAAUA
AAAFYXVnOTgAAAAAAAAFAAAABXNlcDk4AAAAAAAABQAAAAVub3Y5OAAAAAAAAAUAAAAFZGVj
OTgAAAD/////AAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAIv////8AAAAQAAAAAAAAAAAA
AAAyAAAAAQAAAAExAAAAAAAAAQAAAAEyAAAAAAAAAQAAAAEzAAAAAAAAAQAAAAE0AAAAAAAA
AQAAAAE1AAAAAAAAAQAAAAE2AAAAAAAAAQAAAAE3AAAAAAAAAQAAAAE4AAAAAAAAAQAAAAE5
AAAAAAAAAgAAAAIxMAAAAAAAAgAAAAIxMQAAAAAAAgAAAAIxMgAAAAAAAgAAAAIxMwAAAAAA
AgAAAAIxNAAAAAAAAgAAAAIxNQAAAAAAAgAAAAIxNgAAAAAAAgAAAAIxNwAAAAAAAgAAAAIx
OAAAAAAAAgAAAAIxOQAAAAAAAgAAAAIyMAAAAAAAAgAAAAIyMQAAAAAAAgAAAAIyMgAAAAAA
AgAAAAIyMwAAAAAAAgAAAAIyNAAAAAAAAgAAAAIyNQAAAAAAAgAAAAIyNgAAAAAAAgAAAAIy
NwAAAAAAAgAAAAIyOAAAAAAAAgAAAAIyOQAAAAAAAgAAAAIzMAAAAAAAAgAAAAIzMQAAAAAA
AgAAAAIzMgAAAAAAAgAAAAIzMwAAAAAAAgAAAAIzNAAAAAAAAgAAAAIzNQAAAAAAAgAAAAIz
NgAAAAAAAgAAAAIzNwAAAAAAAgAAAAIzOAAAAAAAAgAAAAIzOQAAAAAAAgAAAAI0MAAAAAAA
AgAAAAI0MQAAAAAAAgAAAAI0MgAAAAAAAgAAAAI0MwAAAAAAAgAAAAI0NAAAAAAAAgAAAAI0
NQAAAAAAAgAAAAI0NgAAAAAAAgAAAAI0NwAAAAAAAgAAAAI0OAAAAAAAAgAAAAI0OQAAAAAA
AgAAAAI1MAAA/////wAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAACH/////AAAAEAAAAAAA
AAAAAAAAAQAAAAoAAAAKZGF0YS5mcmFtZQAA//////////////////////////8AAAACAAAA
AAAAAAAAAAABAAAAAAAAAAAAAAAg/////wAAAAMAAAAAAAAAAP////4AAAACAAAAAAAAAAAA
AAABAAAAAAAAAAAAAAAf//////////z//////////wAAAAYAAAAAAAAAAP////8AAAABAAAA
AAAAAAAAAAAe/////wAAAAIAAAAAAAAAAP////8AAAAGAAAAAAAAAAD/////AAAAAQAAAAAA
AAAAAAAAHf////8AAAACAAAAAAAAAAD/////AAAABgAAAAAAAAAA/////wAAAAEAAAAAAAAA
AAAAABz/////AAAAAgAAAAAAAAAA/////wAAAAEAAAAAAAAAAAAAAB//////////////////
////AAAAAgAAAAAAAAAA/////wAAAAYAAAAAAAAAAP////8AAAABAAAAAAAAAAAAAAAe////
/wAAAAIAAAAAAAAAAP////8AAAAGAAAAAAAAAAD/////AAAAAQAAAAAAAAAAAAAAG/////8A
AAACAAAAAAAAAAD/////AAAAEAAAAAAAAAAAAAAAAQAAAAEAAAABCgAAAP//////////////
//////8AAAACAAAAAAAAAAD/////AAAABgAAAAAAAAAA/////wAAAAEAAAAAAAAAAAAAABv/
////AAAAAgAAAAAAAAAA/////wAAABAAAAAAAAAAAAAAAAEAAABDAAAAQ05lZWQgYSBkYXRh
IGZyYW1lIGFyZ3VtZW50IHdpdGggMTcgbW9udGhseSBjYXRjaGVzIChzZXB0LCBvY3QgLi4u
KQoA/////////////////////wAAAAIAAAAAAAAAAP////8AAAAGAAAAAAAAAAD/////AAAA
AQAAAAAAAAAAAAAAG/////8AAAACAAAAAAAAAAD/////AAAAEAAAAAAAAAAAAAAAAQAAAEIA
AABCICAgZm9yIHRzZXRzZSB1c2UgQS5GUkFNRS50c2V0c2UuOTduOTgsIGZvciBhZGp0c2Ug
cm9sbCB5b3VyIG93bi4KAAD///////////////////////////////////////////////8A
AAACAAAAAAAAAAD/////AAAABgAAAAAAAAAA/////wAAAAEAAAAAAAAAAAAAAB7/////AAAA
AgAAAAAAAAAA/////wAAAAYAAAAAAAAAAP////8AAAABAAAAAAAAAAAAAAAa/////wAAAAIA
AAAAAAAAAP////8AAAABAAAAAAAAAAAAAAAZ/////wAAAAIAAAAAAAAAAP////8AAAAGAAAA
AAAAAAD/////AAAAAQAAAAAAAAAAAAAAGP////8AAAACAAAAAAAAAAAAAAABAAAAAAAAAAAA
AAAX/////wAAAAoAAAAAAAAAAAAAAAEAAAAB////////////////////////////////////
//////8AAAACAAAAAAAAAAD/////AAAABgAAAAAAAAAA/////wAAAAEAAAAAAAAAAAAAABb/
////AAAAAgAAAAAAAAAA/////wAAAAYAAAAAAAAAAP////8AAAABAAAAAAAAAAAAAAAY////
/wAAAAIAAAAAAAAAAP////8AAAABAAAAAAAAAAAAAAAZ/////////////////////wAAAAIA
AAAAAAAAAAAAAAEAAAAAAAAAAAAAABX/////AAAACgAAAAAAAAAAAAAAAQAAAAH/////////
/////////////////wAAAAIAAAAAAAAAAP////8AAAAGAAAAAAAAAAD/////AAAAAQAAAAAA
AAAAAAAAGP////8AAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAU/////wAAAAYAAAAAAAAA
AP////8AAAABAAAAAAAAAAAAAAAT/////wAAAAIAAAAAAAAAAP////8AAAAOAAAAAAAAAAAA
AAABQAAAAAAAAAD/////AAAAAgAAAAAAAAAA/////wAAAA4AAAAAAAAAAAAAAAFAIAAAAAAA
AP//////////////////////////AAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAEv////8A
AAAGAAAAAAAAAAD/////AAAAAQAAAAAAAAAAAAAAE/////8AAAACAAAAAAAAAAD/////AAAA
DgAAAAAAAAAAAAAAAT/wAAAAAAAA/////wAAAAIAAAAAAAAAAP////8AAAAOAAAAAAAAAAAA
AAABP/AAAAAAAAD/////AAAAAgAAAAAAAAAA/////wAAAA4AAAAAAAAAAAAAAAE/8AAAAAAA
AP////8AAAACAAAAAAAAAAD/////AAAADgAAAAAAAAAAAAAAAQAAAAAAAAAA////////////
/////////////////////////wAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAABH/////AAAA
BgAAAAAAAAAA/////wAAAAEAAAAAAAAAAAAAABP/////AAAAAgAAAAAAAAAA/////wAAAA4A
AAAAAAAAAAAAAAEAAAAAAAAAAP////8AAAACAAAAAAAAAAD/////AAAADgAAAAAAAAAAAAAA
AT/wAAAAAAAA/////wAAAAIAAAAAAAAAAP////8AAAAOAAAAAAAAAAAAAAABQAAAAAAAAAD/
////AAAAAgAAAAAAAAAA/////wAAAA4AAAAAAAAAAAAAAAE/8AAAAAAAAP//////////////
/////////////////////////////////////////////////wAAAAIAAAAAAAAAAP////8A
AAAGAAAAAAAAAAD/////AAAAAQAAAAAAAAAAAAAAEP////8AAAACAAAAAAAAAAD/////AAAA
AQAAAAAAAAAAAAAAH/////////////////////8AAAACAAAAAAAAAAD/////AAAABgAAAAAA
AAAA/////wAAAAEAAAAAAAAAAAAAABb/////AAAAAgAAAAAAAAAA/////wAAAAYAAAAAAAAA
AP////8AAAABAAAAAAAAAAAAAAAP/////wAAAAIAAAAAAAAAAP////8AAAABAAAAAAAAAAAA
AAAf/////////////////////wAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAABX/////AAAA
CgAAAAAAAAAAAAAAAQAAAAH//////////////////////////wAAAAIAAAAAAAAAAP////8A
AAAGAAAAAAAAAAD/////AAAAAQAAAAAAAAAAAAAADv////8AAAACAAAAAAAAAAD/////AAAA
AQAAAAAAAAAAAAAADf////8AAAACAAAAAAAAAAD/////AAAABgAAAAAAAAAA/////wAAAAEA
AAAAAAAAAAAAAAz/////AAAAAgAAAAAAAAAA/////wAAAA4AAAAAAAAAAAAAAAE/8AAAAAAA
AP////8AAAACAAAAAAAAAAD/////AAAADgAAAAAAAAAAAAAAAUAwAAAAAAAA////////////
//////////////8AAAACAAAAAAAAAAD/////AAAABgAAAAAAAAAA/////wAAAAEAAAAAAAAA
AAAAAB7/////AAAAAgAAAAAAAAAA/////wAAAAYAAAAAAAAAAP////8AAAABAAAAAAAAAAAA
AAAL/////wAAAAIAAAAAAAAAAP////8AAAAGAAAAAAAAAAD/////AAAAAQAAAAAAAAAAAAAA
Cv////8AAAAGAAAAAAAAAAD/////AAAAAQAAAAAAAAAAAAAAH/////8AAAACAAAAAAAAAAD/
/////////AAAAAIAAAAAAAAAAP////8AAAABAAAAAAAAAAAAAAAN////////////////////
////////////AAAAAgAAAAAAAAAA/////wAAAAYAAAAAAAAAAP////8AAAABAAAAAAAAAAAA
AAAK/////wAAAAYAAAAAAAAAAP////8AAAABAAAAAAAAAAAAAAAf/////wAAAAIAAAAAAAAA
AP/////////8AAAAAgAAAAAAAAAA/////wAAAAYAAAAAAAAAAP////8AAAABAAAAAAAAAAAA
AAAJ/////wAAAAIAAAAAAAAAAP////8AAAABAAAAAAAAAAAAAAAN/////wAAAAIAAAAAAAAA
AP////8AAAAOAAAAAAAAAAAAAAABP/AAAAAAAAD/////////////////////////////////
/////////////////////////////////////////wAAAAIAAAAAAAAAAP////8AAAAGAAAA
AAAAAAD/////AAAAAQAAAAAAAAAAAAAACP////8AAAACAAAAAAAAAAD/////AAAABgAAAAAA
AAAA/////wAAAAEAAAAAAAAAAAAAAAf/////AAAAAgAAAAAAAAAA/////wAAAAYAAAAAAAAA
AP////8AAAABAAAAAAAAAAAAAAAG/////wAAAAIAAAAAAAAAAP////8AAAAGAAAAAAAAAAD/
////AAAAAQAAAAAAAAAAAAAACv////8AAAAGAAAAAAAAAAD/////AAAAAQAAAAAAAAAAAAAA
H/////8AAAACAAAAAAAAAAD//////////AAAAAIAAAAAAAAAAP////8AAAAGAAAAAAAAAAD/
////AAAAAQAAAAAAAAAAAAAACf////8AAAACAAAAAAAAAAD/////AAAAAQAAAAAAAAAAAAAA
Df////8AAAACAAAAAAAAAAD/////AAAADgAAAAAAAAAAAAAAAT/wAAAAAAAA////////////
/////////////////////////////////////////wAAAAIAAAAAAAAAAP////8AAAAGAAAA
AAAAAAD/////AAAAAQAAAAAAAAAAAAAACv////8AAAAGAAAAAAAAAAD/////AAAAAQAAAAAA
AAAAAAAAH/////8AAAACAAAAAAAAAAD//////////AAAAAIAAAAAAAAAAP////8AAAABAAAA
AAAAAAAAAAAN////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////
/wAAAAIAAAAAAAAAAP////8AAAAGAAAAAAAAAAD/////AAAAAQAAAAAAAAAAAAAABf////8A
AAACAAAAAAAAAAD/////AAAAEAAAAAAAAAAAAAAAAQAAADUAAAA1Q29ycmVsYXRpb24gb2Yg
dHNldHNlIHNhbXBsZXM6IHNhbXBsZSB0byBzYW1wbGUgcGxvdHMAAAD/////AAAAAgAAAAAA
AAAAAAAAAQAAAAAAAAAAAAAABP////8AAAAOAAAAAAAAAAAAAAABQAgAAAAAAAD/////AAAA
AgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAA/////8AAAAKAAAAAAAAAAAAAAABAAAAAf////8A
AAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAC/////wAAAA4AAAAAAAAAAAAAAAE/+AAAAAAA
AP//////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////wAAAAIAAAAAAAAA
AAAAAAEAAAAAAAAAAAAAAAH/////AAAAEAAAAAAAAAAAAAAAHQAAABQAAAAUZnVuY3Rpb24o
dGhlLmZyYW1lKXsAAAAAAAAAAAAAACEAAAAhI2ZpcnN0IGRvIHRoZSBwYXJhbWV0ZXIgY2hl
Y2tpbmc6AAAAAAAAGAAAABhpZiAobWlzc2luZyh0aGUuZnJhbWUpKXsAAAAMAAAADCAgIGNh
dCgiXG4iKQAAAE4AAABOICAgY2F0KCJOZWVkIGEgZGF0YSBmcmFtZSBhcmd1bWVudCB3aXRo
IDE3IG1vbnRobHkgY2F0Y2hlcyAoc2VwdCwgb2N0IC4uLilcbiIpAAAAAABNAAAATSAgIGNh
dCgiICAgZm9yIHRzZXRzZSB1c2UgQS5GUkFNRS50c2V0c2UuOTduOTgsIGZvciBhZGp0c2Ug
cm9sbCB5b3VyIG93bi5cbiIpAAAAAAAABwAAAAd9ICAgI2ZpAAAAAAAAAAAAAAAABQAAAAVl
bHNlewAAAAAAACYAAAAmICAgI25leHQgY2FjaGUgdGhlIGluaXRpYWwgY29uZGl0aW9uczoA
AAAAAEsAAABLICAgc3RhcnQucGFyX3Bhcihuby5yZWFkb25seSA9IFRSVUUpICAgICAgICAg
ICAjc3RvcmUgdGhlIGluaXRhbCBwYXJhbWV0ZXJzAAAAAE8AAABPICAgb24uZXhpdChwYXIo
c3RhcnQucGFyKSxhcHBlbmQ9VFJVRSkgICAgICAgICAjcmVzdG9yZSB0aGUgZ3JhcGhpY3Mg
cGFyYW1ldGVycwAAAAAyAAAAMiAgIHBhcihtZnJvdz1jKDIsOCksbWFyPWMoMSwxLDEsMCks
b21hPWMoMCwxLDIsMSkpAAAAAAAAAAAAAAAAACAAAAAgICAgI25leHQgaW5pdGlhbGl6ZSB0
aGUgZnVuY3Rpb24AAAAUAAAAFCAgIGF0dGFjaCh0aGUuZnJhbWUpAAAAKQAAACkgICBvbi5l
eGl0KGRldGFjaCh0aGUuZnJhbWUpLGFwcGVuZD1UUlVFKQAAAAAAAAAAAAAAAAAAEgAAABIg
ICAjZnVuY3Rpb24gYm9keToAAAAAABMAAAATICAgZm9yIChpIGluIDE6MTYpewAAAAApAAAA
KSAgICAgIHBsb3QodGhlLmZyYW1lWyxpXSx0aGUuZnJhbWVbLGkrMV0pAAAAAAAALwAAAC8g
ICAgICBhYmxpbmUobG0odGhlLmZyYW1lWyxpKzFdfnRoZS5mcmFtZVssaV0pKQAAAAAEAAAA
BCAgIH0AAABbAAAAWyAgIG10ZXh0KCJDb3JyZWxhdGlvbiBvZiB0c2V0c2Ugc2FtcGxlczog
c2FtcGxlIHRvIHNhbXBsZSBwbG90cyIsc2lkZT0zLG91dGVyPVRSVUUsY2V4PTEuNSkAAAAA
AAAAAAAAAAAAAAAAAAAAAA0AAAANfSAgICNlbmQgZWxzZQAAAAAAAAEAAAABfQAAAP//////
//////////////////////////////8=

--/9DWx/yDrRhgMJTb--

==> 608.audit <==
Sun Jul 16 06:23:23 2000	ripley	moved from incoming to Low-level
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 536 *
Subject: Problem with match.arg()
From: kjetikj@astro.uio.no
Date: Sun, 7 May 2000 13:58:21 +0200 (MET DST)
--1.0.0 bug fixed for 1.0.1 ??
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 536 <==
From kjetikj@astro.uio.no  Sun May  7 13:58:22 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id NAA29341
	for <R-bugs@biostat.ku.dk>; Sun, 7 May 2000 13:58:21 +0200 (MET DST)
Date: Sun, 7 May 2000 13:58:21 +0200 (MET DST)
From: kjetikj@astro.uio.no
Message-Id: <200005071158.NAA29341@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: Problem with match.arg()

Full_Name: Kjetil Kjernsmo
Version: Version 1.0.0
OS: osf1
Submission from: (NULL) (129.240.28.227)


Hello again!

This is a follow-up to my message on R-help about a problem with match.arg()
I have a little more on the topic, but not much really. 

First, it was not entirely true what I wrote in r-help that I call match.arg()
in my ramp(), because ramp() just calls qamp() with runif() as argument, but 
I have found that it happens both in ramp() and qamp().

Last night, just before I went home, R crashed with a segmentation fault. 
Unfortunately, I had limit coredumpsize 0, because I seldom want core-files,
so I haven't got it. I have removed that limit now. I have not been able to 
reproduce the crash, however.

Now, for a
> last.dump
$"apply(cbind(rep(1e+05, 25000)), 1, lineprofile, 10, 100, 1, "point")"
<environment: 140e187f0>

$"FUN(newX[, i], ...)"
<environment: 1404b6608>

$"apply(cbind(-as.integer(numberofbins/2):as.integer(numberofbins/2)), "
<environment: 1404b5460>

$"FUN(newX[, i], ...)"
<environment: 1400f6798>

$"photonsdetectedbin(ncb, intensityfromcloud(ncb, intensityfromcloud, "
<environment: 1400f55c8>

$"sum(rpois(ncloudsbin, sensitivity * intensityfromcloud))"
<environment: 1400f53e8>

$"rpois(ncloudsbin, sensitivity * intensityfromcloud)"
<environment: 1400f5168>

$"intensityfromcloud(ncb, intensityfromcloud, exptime, amptype)"
<environment: 1400f4c68>

$"ramp(ncloudsbin, amptype)"
<environment: 1400f4920>

$"qamp(runif(n), type)"
<environment: 1400ebdc0>

$"match.arg(type)"
<environment: 1400e97f0>

$"all(arg == choices)"
<environment: 140e2d740>

attr(,"error.message")
[1] "Error in arg == choices : comparison (1) is possible only for vector
types\n"
attr(,"class")
[1] "dump.frames"

I have also inserted some print statements at some places in the code. First:
qamp <- function(p,  type=c("point", "nolens"))
{
  print(c(2,type))
  type <- match.arg(type)
  if(type == "point")
    return(1 / (2 * sqrt(1 - p)))
  else return(1)
}
  
ramp <- function(n, type=c("point", "nolens"))
{
  print(c(1,type))
  type <- match.arg(type)
  if(type == "point")
    return(qamp(runif(n), type))
  else return(rep(1, n))
}
(I'll rewrite these to use switch eventually).

And, also in match.arg():
match.arg <- function (arg, choices) {
    if (missing(choices)) {
	formal.args <- formals(sys.function(sys.parent()))
	choices <- eval(formal.args[[deparse(substitute(arg))]])
    }
    print(c(2, arg, choices))
    if (all(arg == choices)) return(choices[1])
[...]
Upon running, I get
[1] "1"     "point"
[1] "point"  "point"  "nolens"
[1] "2"     "point"
[1] "point"  "point"  "nolens"
[thousands of these... :-) ]
[1] "1"     "point"
[1] "point"  "point"  "nolens"
[1] "2"     "point"
[1] "point"  "point"  "nolens"
[1] "1"     "point"
[1] "point"  "point"  "nolens"
[1] "2"     "point"
[1] "point"
Error in arg == choices : comparison (1) is possible only for vector types
So, suddenly, "choices" doesn't have a value, and consequently, the error.
FWIW, I have also printed formals(qamp)$type inside qamp, and it has the 
right value. 

Now, it seems hard to reproduce, I just did 100000 runs of ramp(10000, "point")

directly with no problems. In my code, ramp is called by a function that is
called
by a function, that is... :-) 

However, the code isn't very involved, really, so if you want to try, here it
is:
ncloudsbin <- function(binno, ntotalclouds, numberofbins = 100,
                       linewidth = numberofbins / 6)
  return(ntotalclouds * dnorm(binno, sd = linewidth))

intensityfromcloud <- function(ncloudsbin, cloudintensity, exptime, amptype)
  return(cloudintensity * exptime * ramp(ncloudsbin, amptype))

photonsdetectedbin <- function(ncloudsbin, intensityfromcloud,
                               continuumintensity, exptime, amptype,
                               sensitivity)
  return(sum(rpois(ncloudsbin, sensitivity * intensityfromcloud))
         + rgeom(1, 1 /(1 + (sensitivity * exptime * continuumintensity))))



lineprofile <- function(ntotalclouds, intensityfromcloud, continuumintensity,
                        exptime, amptype, sensitivity = 0.1, numberofbins =
100,
                        linewidth = numberofbins / 6)
{
  tf <- function(binno, ntotalclouds, intensityfromcloud, continuumintensity,
                 exptime, amptype, sensitivity, numberofbins, linewidth)
  {
    ncb <- ncloudsbin(binno, ntotalclouds, numberofbins, linewidth)
    return(photonsdetectedbin(ncb,
                   intensityfromcloud(
                            ncb, intensityfromcloud, exptime, amptype),
                   continuumintensity, exptime, amptype, sensitivity))
  }
  return(apply(cbind(-as.integer(numberofbins/2):as.integer(numberofbins/2)),
               1, tf,
               ntotalclouds, intensityfromcloud, continuumintensity,
               exptime, amptype, sensitivity, numberofbins, linewidth)) 
}

Note that "amptype" is here the "type" of the ?amp-functions. 
I call this by e.g. 
ll25000 <- apply(cbind(rep(100000, 25000)), 1, lineprofile, 10, 100, 1,
"point")


Just an idea: I have some problems in an entirely unrelated and more involved 
piece of code where it seems like sometimes, arguments are not returned from a 
function, that is, one variable of an object suddenly has no value. I haven't
really figured out if that is a bug of mine or in R, but could it be possible 
that something in
	formal.args <- formals(sys.function(sys.parent()))
	choices <- eval(formal.args[[deparse(substitute(arg))]])
doesn't get a value because there is an error in how objects are returned 
from a function?

BTW, I was exiting R (my ESS buffer was getting rather large), and I got the
following:
Save workspace image? [y/n/c]: y
Error: NewWriteItem: unknown type 17

Well, I guess this isn't much go on, but I know you are really good at this!
By running the above code, the error happens on every run here, it is just a
matter
of letting it run for long enough. I hope it is something to start on. I have a
few
more last.dumps on file too, if they are of use.

Kjetil

==> 536.reply.1 <==
From pd@blueberry.kubism.ku.dk  Mon May  8 00:35:02 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id AAA00947
	for <R-bugs@biostat.ku.dk>; Mon, 8 May 2000 00:35:02 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id AAA28561;
	Mon, 8 May 2000 00:41:09 +0200
Sender: pd@blueberry.kubism.ku.dk
To: kjetikj@astro.uio.no
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Problem with match.arg() (PR#536)
References: <200005071158.NAA29351@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 08 May 2000 00:41:09 +0200
In-Reply-To: kjetikj@astro.uio.no's message of "Sun, 7 May 2000 13:58:23 +0200 (MET DST)"
Message-ID: <x2u2gac7ay.fsf@blueberry.kubism.ku.dk>
Lines: 22
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

kjetikj@astro.uio.no writes:

> Full_Name: Kjetil Kjernsmo
> Version: Version 1.0.0
> OS: osf1
> Submission from: (NULL) (129.240.28.227)
> 
...
> BTW, I was exiting R (my ESS buffer was getting rather large), and I got the
> following:
> Save workspace image? [y/n/c]: y
> Error: NewWriteItem: unknown type 17

That one was fixed in 1.0.1, I believe. (Perhaps you should upgrade
and see if the other problem goes away too... I don't see anything
obviously relevant in the NEWS file though)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 536.audit <==
Wed Jun 07 06:48:33 2000	maechler	changed notes
Fri Jul 07 06:53:24 2000	maechler	moved from incoming to Low-level
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 505 *
Subject: interrupted save 
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Sat, 25 Mar 2000 12:16:50 -0800 (PST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 505 <==
From thomas@biostat.washington.edu  Sat Mar 25 21:16:39 2000
Received: from mail.biostat.washington.edu (mail.biostat.washington.edu [128.95.113.21])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA08785
	for <R-bugs@biostat.ku.dk>; Sat, 25 Mar 2000 21:16:38 +0100 (MET)
Received: from mail.biostat.washington.edu (mail.biostat.washington.edu [128.95.113.21])
	by mail.biostat.washington.edu (8.9.3+Sun/8.9.1-fetrow-99-05-16b) with ESMTP id MAA24561
	for <R-bugs@biostat.ku.dk>; Sat, 25 Mar 2000 12:16:50 -0800 (PST)
Date: Sat, 25 Mar 2000 12:16:50 -0800 (PST)
From: Thomas Lumley <thomas@biostat.washington.edu>
To: R-bugs@biostat.ku.dk
Subject: interrupted save 
In-Reply-To: <Pine.GSO.4.21.0003251204350.22429-100000@mail.biostat.washington.edu>
Message-ID: <Pine.GSO.4.21.0003251207350.22429-100000@mail.biostat.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


If an error occurs during a save the file does not appear to be
closed and buffers flushed.  This can lead to corruption if the same
filename is used later and then the buffer is flushed on program exit.

For example, tn the context of PR #504

 f<-function(x,...){ function(y) list(x=x,y=y,...)}
 a<-f(1,2,3)
 save(list="a",file="a.rdata")  ## -- error --
 b<-1:10
 save(list="b",file="a.rdata")
 load("a.rdata")  ## works
 q("no")
 
 R

 load("a.rdata")  ## error



This is R1.0 on Linux

	-thomas

Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle


==> 505.audit <==
Thu Apr 13 06:21:36 2000	ripley	moved from incoming to Low-level
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 551 *
Subject: Bus Error crash
From: kjetikj@astro.uio.no
Date: Mon, 22 May 2000 13:06:48 +0200 (MET DST)
--- ??? -- not (yet) reproducible with small examples
--- after load()ing large objects
--- on two different DEC alpha versions
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 551 <==
From kjetikj@astro.uio.no  Mon May 22 13:06:49 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id NAA20951
	for <R-bugs@biostat.ku.dk>; Mon, 22 May 2000 13:06:48 +0200 (MET DST)
Date: Mon, 22 May 2000 13:06:48 +0200 (MET DST)
From: kjetikj@astro.uio.no
Message-Id: <200005221106.NAA20951@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: Bus Error crash

Full_Name: Kjetil Kjernsmo
Version: 1.0.1
OS: osf1
Submission from: (NULL) (129.240.28.227)


Ouch, another obscure bug...
I just had a bus error crash, with a core dump, a small one this time.
Usual <URL:http://www.astro.uio.no/~kjetikj/tmp/core>.
I had done a few simulations, and done a chisq.test() on them.
These simulations also write about 190MB's to file, but
I have no idea whether that is relevant, and those data are not
used. The calls I do look like this:
> ch1 <- chisq.test(t(apply(cbind(rep(5000000, 4)), 1, lineprofile, 1, 100,
"point")))
> ch1

	 Pearson's Chi-square test 

data:  t(apply(cbind(rep(5e+06, 4)), 1, lineprofile, 1, 100, "point")) 
X-squared = 463.8359, df = 300, p-value = 3.726e-09 

> ch1$observed

Process R bus error (core dumped) at Mon May 22 12:38:49 2000


....so it doesn't crash when I print the whole object, but when I 
a vector of the object, it crashes... And, restarting R, it doesn't
happen.

I heard the sysadm who did the installation had some problems,
I don't know what it was about, but if I understood him correctly,
it only happened when he tuned for EV6, so it shouldn't be a problem now, 
I guess....

Kjetil


==> 551.followup.1 <==
From mcneney@cs.sfu.ca  Thu May 25 00:21:11 2000
Received: from cs.sfu.ca (cs.sfu.ca [142.58.111.1])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id AAA21037
	for <R-bugs@biostat.ku.dk>; Thu, 25 May 2000 00:21:10 +0200 (MET DST)
Received: from smahlt.math.sfu.ca (smahlt [199.60.17.25])
	by cs.sfu.ca (8.9.1/8.9.1) with ESMTP id PAA15921;
	Wed, 24 May 2000 15:21:29 -0700 (PDT)
Received: from localhost by smahlt.math.sfu.ca (8.8.8/1.1.20.8/23Nov99-0751PM)
	id PAA0000118354; Wed, 24 May 2000 15:21:29 -0700 (PDT)
X-Authentication-Warning: smahlt.math.sfu.ca: mcneney owned process doing -bs
Date: Wed, 24 May 2000 15:21:29 -0700 (PDT)
From: Brad McNeney <mcneney@cs.sfu.ca>
X-Sender: mcneney@smahlt.math.sfu.ca
To: kjetikj@astro.uio.no
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Bus Error crash (PR#551)
In-Reply-To: <200005221106.NAA20961@pubhealth.ku.dk>
Message-ID: <Pine.OSF.4.21.0005241508010.116565-100000@smahlt.math.sfu.ca>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Mon, 22 May 2000 kjetikj@astro.uio.no wrote:

> Full_Name: Kjetil Kjernsmo
> Version: 1.0.1
> OS: osf1
> Submission from: (NULL) (129.240.28.227)
> 
> 
> Ouch, another obscure bug...
> I just had a bus error crash, with a core dump, a small one this time.
> Usual <URL:http://www.astro.uio.no/~kjetikj/tmp/core>.
> I had done a few simulations, and done a chisq.test() on them.
> These simulations also write about 190MB's to file, but
> I have no idea whether that is relevant, and those data are not
> used. The calls I do look like this:
> > ch1 <- chisq.test(t(apply(cbind(rep(5000000, 4)), 1, lineprofile, 1, 100,
> "point")))
> > ch1
> 
> 	 Pearson's Chi-square test 
> 
> data:  t(apply(cbind(rep(5e+06, 4)), 1, lineprofile, 1, 100, "point")) 
> X-squared = 463.8359, df = 300, p-value = 3.726e-09 
> 
> > ch1$observed
> 
> Process R bus error (core dumped) at Mon May 22 12:38:49 2000
> 
> 
> ....so it doesn't crash when I print the whole object, but when I 
> a vector of the object, it crashes... And, restarting R, it doesn't
> happen.
> 
> I heard the sysadm who did the installation had some problems,
> I don't know what it was about, but if I understood him correctly,
> it only happened when he tuned for EV6, so it shouldn't be a problem now, 
> I guess....
> 
> Kjetil

I can't reproduce the problem on my system (R Version: 1.0.0, OS: osf1
V5.0). Compiled with gcc/g77 using optimisation level -O2 (determined by
configure script).

> ch1 <- chisq.test(t(apply(cbind(rep(5000000, 4)), 1, lineprofile, 1,
100,"point")))


> ch1

         Pearson's Chi-square test 

data:  t(apply(cbind(rep(5e+06, 4)), 1, lineprofile, 1, 100, "point")) 
X-squared = 404.6772, df = 300, p-value = 5.125e-05 

> ch1$observed
     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]
[1,]  160  144  205  244  273  314  395  454  521   592   713   864   905 1043
[2,]  139  175  210  232  276  369  372  459  525   566   687   781   886  981

... etc ...


Brad


==> 551.followup.2 <==
From kjetikj@astro.uio.no  Thu May 25 11:51:59 2000
Received: from mons.uio.no (7411@mons.uio.no [129.240.130.14])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA25230
	for <R-bugs@biostat.ku.dk>; Thu, 25 May 2000 11:51:59 +0200 (MET DST)
Received: from alnair.uio.no ([129.240.28.227])
	by mons.uio.no with esmtp (Exim 2.12 #7)
	id 12uuJM-0000Xk-00; Thu, 25 May 2000 11:52:16 +0200
Received: from localhost ([127.0.0.1])
	by alnair.uio.no with esmtp (Exim 2.12 #1)
	id 12uuJE-0003bJ-00; Thu, 25 May 2000 11:52:08 +0200
Date: Thu, 25 May 2000 11:52:08 +0200 (MET DST)
From: Kjetil Kjernsmo <kjetil.kjernsmo@astro.uio.no>
X-Sender: kjetikj@alnair.uio.no
To: Brad McNeney <mcneney@cs.sfu.ca>
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Bus Error crash (PR#551)
In-Reply-To: <Pine.OSF.4.21.0005241508010.116565-100000@smahlt.math.sfu.ca>
Message-ID: <Pine.OSF.4.21.0005251145100.13610-100000@alnair.uio.no>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Wed, 24 May 2000, Brad McNeney wrote:

>I can't reproduce the problem on my system (R Version: 1.0.0, OS: osf1
>V5.0).

OK. I had a similar crash yesterday on a different machine but I think
with rather identical hardware, it was a batch job that was running
so I don't know exactly what caused the crash (after about 48 CPU hours,
arrgh), but I have a (small) core dump at
<URL:http://www.astro.uio.no/~kjetikj/tmp/core3>

Anyway, Uwe suggested it might be a RAM hardware problem, which is not
impossible. I think these machines were bought while still in beta-test,
and hopefully, Compaq will drop by tomorrow to have a look. 

Best,

Kjetil
-- 
Kjetil Kjernsmo
Graduate astronomy-student                    Problems worthy of attack
University of Oslo, Norway            Prove their worth by hitting back
E-mail: kjetikj@astro.uio.no                                - Piet Hein
Homepage <URL:http://www.astro.uio.no/~kjetikj/>
Webmaster@skepsis.no 


==> 551.followup.3 <==
From kjetikj@astro.uio.no  Fri Jun  9 16:33:08 2000
Received: from mons.uio.no (7411@mons.uio.no [129.240.130.14])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA05935
	for <r-bugs@biostat.ku.dk>; Fri, 9 Jun 2000 16:33:07 +0200 (MET DST)
Received: from alnair.uio.no ([129.240.28.227])
	by mons.uio.no with esmtp (Exim 2.12 #7)
	id 130Pqg-0004Lh-00
	for r-bugs@biostat.ku.dk; Fri, 9 Jun 2000 16:33:26 +0200
Received: from localhost ([127.0.0.1])
	by alnair.uio.no with esmtp (Exim 2.12 #1)
	id 130Pqf-0000aE-00
	for r-bugs@biostat.ku.dk; Fri, 9 Jun 2000 16:33:25 +0200
Date: Fri, 9 Jun 2000 16:33:24 +0200 (MET DST)
From: Kjetil Kjernsmo <kjetil.kjernsmo@astro.uio.no>
X-Sender: kjetikj@alnair.uio.no
To: r-bugs@biostat.ku.dk
Subject: Disappearing values (PR#551)
Message-ID: <Pine.OSF.4.05.10006091627560.847-100000@alnair.uio.no>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

Dear all,

Uwe e-mailed me yesterday about the problems some time ago. I had hoped
someone would have a look at our computers, but due to some unfortunate
circumstances, it hasn't happened. However, it seems unlikely that it is
connected to a specific piece of hardware. It could be an
architecture-dependent problem though. I also had a word with those who
did the installation of R, and they had some problems when tuning it for
alphaev6, but it all went smoothly when tuning for alphaev56, and that is
the build I'm running. This is basically the stuff I sent to Uwe
yesterday. 

I have been testing it on three different machines:
alnair, a XP1000 with a 500MHz alphaev6 processor and 619 MB RAM
rukbat, a PWS500au with a 500MHz alphaev56 processor with 238 MB RAM
mirfak, a DEC255/233 with a 233MHz (?) alphaev4 (?) processor with 245MB
(RAM is according to top). All show the same problems consistently. 
I'm not using the match.arg()-approach anymore, BTW, I have moved on to
some object-oriented stuff. 

However, some apparently related (?) problem occurs. Yesterday, I started
working on some simulations I have done (with R of course! :-) ). I did
exactly the same operations on rukbat and mirfak (using ESS-elsewhere
while sitting on alnair), starting with the same calls, vsize=80M,
nsize=800k, no-restore. I loaded a 58MB file with load, and there are a
few variables with arrays of htest-objects. Then, I did 
as.vector(sapply(chisq5M11000, function(x) x$statistic))
to get a vector of the test statistics. Now, occasionally, it prints a
nice vector with all the values intact. Occasionally, one of the entries
are NULL, and then it prints a list, e.g.
[[892]]
X-squared 
 1933.637 

[[893]]
NULL

[[894]]
X-squared 
 1741.416 

The funny thing is that when I did this sapply thing on mirfak and rukbat,
it happened on at exactly the same place on the two machines. First,
mirfak would produce a vector then rukbat would produce a vector, mirfak
would give a list where element # 238 (if I remember correctly) was NULL,
rukbat would produce a list with element #238 NULL, both would produce a
vector again, both would produce a list with element #602 NULL, etc... 

This is pretty much what I've got now... :-)

Best,

Kjetil
-- 
Kjetil Kjernsmo
Graduate astronomy-student                    Problems worthy of attack
University of Oslo, Norway            Prove their worth by hitting back
E-mail: kjetikj@astro.uio.no                                - Piet Hein
Homepage <URL:http://www.astro.uio.no/~kjetikj/>
Webmaster@skepsis.no 





==> 551.audit <==
Fri Jul 07 06:44:08 2000	maechler	changed notes
Fri Jul 07 06:44:08 2000	maechler	moved from incoming to Low-level

==> 551.followup.4 <==
From kjetikj@astro.uio.no  Fri Jul 14 19:18:42 2000
Received: from pat.uio.no (pat.uio.no [129.240.130.16])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA16705
	for <r-bugs@biostat.ku.dk>; Fri, 14 Jul 2000 19:18:42 +0200 (MET DST)
Received: from alnair.uio.no ([129.240.28.227])
	by pat.uio.no with esmtp (Exim 2.12 #7)
	id 13D977-0000KT-00
	for r-bugs@biostat.ku.dk; Fri, 14 Jul 2000 19:19:01 +0200
Received: from localhost ([127.0.0.1])
	by alnair.uio.no with esmtp (Exim 2.12 #1)
	id 13D976-0004qm-00
	for r-bugs@biostat.ku.dk; Fri, 14 Jul 2000 19:19:00 +0200
Date: Fri, 14 Jul 2000 19:19:00 +0200 (MET DST)
From: Kjetil Kjernsmo <kjetil.kjernsmo@astro.uio.no>
X-Sender: kjetikj@alnair.uio.no
To: r-bugs@biostat.ku.dk
Subject: Re: Disappearing values (PR#551)
In-Reply-To: <Pine.OSF.4.05.10006091627560.847-100000@alnair.uio.no>
Message-ID: <Pine.OSF.4.05.10007141906260.3963-100000@alnair.uio.no>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Fri, 9 Jun 2000, I wrote:
[...]
> Now, occasionally, it prints a
>nice vector with all the values intact. Occasionally, one of the entries
>are NULL, and then it prints a list, e.g.
[lots of things along these lines]

Now, it seems like this problem has been solved. Reading some old
r-help e-mail I had missed, I came across a message from Brad McNeney
(<URL:http://www.ens.gu.edu.au/robertk/R/help/00a/2068.html>), and it was
apparent that he has had the same problems as I, but solved it by using
gcc instead of cc. Recent communication between Ray Brownrigg and Prof
Brian D Ripley enabled me to compile and get R running myself, and indeed,
the problem has not occured in a number of runs after I did this, I look
upon it as solved.

So, it seems like it may be problematic to use the standard cc compiler on
the alpha platform with Digital UNIX to compile R. Just a minor status
report... :-)

Best,

Kjetil
-- 
Kjetil Kjernsmo
Graduate astronomy-student                    Problems worthy of attack
University of Oslo, Norway            Prove their worth by hitting back
E-mail: kjetikj@astro.uio.no                                - Piet Hein
Homepage <URL:http://www.astro.uio.no/~kjetikj/>
Webmaster@skepsis.no 




~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 545 *
Subject: Segmentation Fault of unknown cause
From: kjetikj@astro.uio.no
Date: Mon, 15 May 2000 16:29:29 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 545 <==
From kjetikj@astro.uio.no  Mon May 15 16:29:29 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA13643
	for <R-bugs@biostat.ku.dk>; Mon, 15 May 2000 16:29:29 +0200 (MET DST)
Date: Mon, 15 May 2000 16:29:29 +0200 (MET DST)
From: kjetikj@astro.uio.no
Message-Id: <200005151429.QAA13643@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: Segmentation Fault of unknown cause

Full_Name: Kjetil Kjernsmo
Version: 1.0.0
OS: osf1
Submission from: (NULL) (129.240.28.227)


Hello!

I'm afraid I have another obscure bug. 
R has just crashed with a segmentation fault. 
This time, I have even failed to reproduce it, but fortunately, 
I have a core dump. It's at 
<URL:http://www.astro.uio.no/~kjetikj/tmp/core>

The call I did was 
log10(quantile(chisqtests5M11001, c(0.05, 0.95)))
where chisqtests5M11001 is an array of length 1500 
(it's an array of p-values produced by the chisq.test, but I 
doubt that it is relevant). 

I did lots of strange things prior to the crash, some even 
involving for-loops, but I can't tell what is relevant. Anyway,
a transcript of the session is at 
<URL:http://www.astro.uio.no/~kjetikj/tmp/crash.Rt>

That's all I've got.... 

Kjetil

==> 545.audit <==
Wed Jun 07 06:49:39 2000	maechler	moved from incoming to Low-level
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Misc

none

Directory:  Models

* PR# 621 *
Subject: anova() on three or more objects behaves inconsistently
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Tue, 1 Aug 2000 10:02:18 +0100 (BST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 621 <==
From ripley@stats.ox.ac.uk  Tue Aug  1 11:02:04 2000
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA18673
	for <R-bugs@biostat.ku.dk>; Tue, 1 Aug 2000 11:02:04 +0200 (MET DST)
Received: from max140.public.ox.ac.uk (max140.public.ox.ac.uk [192.76.27.140])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id KAA21582
	for <R-bugs@biostat.ku.dk>; Tue, 1 Aug 2000 10:02:20 +0100 (BST)
Date: Tue, 1 Aug 2000 10:02:18 +0100 (BST)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Sender: ripley@auk.stats
To: R-bugs@biostat.ku.dk
Subject: anova() on three or more objects behaves inconsistently
Message-ID: <Pine.GSO.4.05.10008010950450.23682-100000@auk.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

anova() on three or more objects behaves inconsistently in R.

In R anovalist.lm does a sequential ANOVA using pairwise F tests,
ignoring all the other objects, so the larger of the two models
provides the denominator.

In S anova.lmlist uses the denominator from the largest model (smallest
residual df) in the set, as does anova.glmlist in both.

I suggest that R's anovalist.lm is wrong (that might be a matter of opinion
and can certainly be argued), but anovalist.lm and anova.glmlist should
agree.

?anova says in R

     When given a sequence of objects, `anova' tests the models against
     one another in the order specified.

and in S

       When two or more objects are used in the call,  a  similar
       table  is  produced  showing  the  effects of the pairwise
       differences between the  models,  considered  sequentially
       from first to last.

neither of which are clear enough to disambiguate this.


Example:

library(MASS)
data(quine)
quine.hi <- aov(log(Days + 2.5) ~ .^4, quine)
quine.nxt <- update(quine.hi, . ~ . - Eth:Sex:Age:Lrn)
quine.lo <- aov(log(Days+2.5) ~ 1, quine)
anova(quine.hi, quine.nxt, quine.lo)

quine.hi1 <- glm(log(Days + 2.5) ~ .^4, data=quine)
quine.nxt1 <- update(quine.hi1, . ~ . - Eth:Sex:Age:Lrn)
quine.lo1 <- glm(log(Days+2.5) ~ 1, data=quine)
anova(quine.hi1, quine.nxt1, quine.lo1, test="F")

S:

  Resid. Df      RSS             Test  Df Sum of Sq  F Value     Pr(F) 
1       118  63.3104                                                  
2       120  64.0990 -Eth:Sex:Age:Lrn  -2  -0.78865 0.734957 0.4817083
3       145 106.7871                  -25 -42.68810 3.182542 0.0000131

...

  Resid. Df Resid. Dev             Test  Df  Deviance  F Value     Pr(F) 
1       118    63.3104                                                  
2       120    64.0990 -Eth:Sex:Age:Lrn  -2  -0.78865 0.734957 0.4817083
3       145   106.7871                  -25 -42.68810 3.182542 0.0000131

R:
Analysis of Variance Table

Model 1: log(Days + 2.5) ~ Eth + Sex + Age + Lrn + Eth:Sex + Eth:Age + 
Model 2: log(Days + 2.5) ~ Eth + Sex + Age + Lrn + Eth:Sex + Eth:Age + 
Model 3: log(Days + 2.5) ~ 1
  Res.Df Res.Sum Sq  Df  Sum Sq F value    Pr(>F)
1    118     63.310                              
2    120     64.099  -2  -0.789  0.7350    0.4817
3    145    106.787 -25 -42.688  3.1967 1.148e-05

[The F value and p value are different here.]

...

  Resid. Df Resid. Dev  Df Deviance       F    Pr(>F)
1       118     63.310                               
2       120     64.099  -2   -0.789   0.735    0.4817
3       145    106.787 -25  -42.688   3.183 1.306e-05

As of the current patched version of R anova.glmlist is consistent when
reversing the order of the objects.


Also, the labelling is inconsistent, and for both is not very helpful:

> anova(quine.hi1, quine.nxt1, quine.lo1)
Analysis of Deviance Table 

Response: log(Days + 2.5)
                                                                         Resid. Df
c(\"Eth + Sex + Age + Lrn + Eth:Sex + Eth:Age + Eth:Lrn + Sex:Age + \",        118
c(\"Eth + Sex + Age + Lrn + Eth:Sex + Eth:Age + Eth:Lrn + Sex:Age + \",        120
1                                                                              145
                                                                         Resid. Dev
c(\"Eth + Sex + Age + Lrn + Eth:Sex + Eth:Age + Eth:Lrn + Sex:Age + \",      63.310
c(\"Eth + Sex + Age + Lrn + Eth:Sex + Eth:Age + Eth:Lrn + Sex:Age + \",      64.099
1                                                                           106.787
                                                                          Df
c(\"Eth + Sex + Age + Lrn + Eth:Sex + Eth:Age + Eth:Lrn + Sex:Age + \",     
c(\"Eth + Sex + Age + Lrn + Eth:Sex + Eth:Age + Eth:Lrn + Sex:Age + \",   -2
1                                                                        -25
                                                                         Deviance
c(\"Eth + Sex + Age + Lrn + Eth:Sex + Eth:Age + Eth:Lrn + Sex:Age + \",          
c(\"Eth + Sex + Age + Lrn + Eth:Sex + Eth:Age + Eth:Lrn + Sex:Age + \",    -0.789
1                                                                         -42.68

which gives problems later as the row names are not unique.



--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.6
 arch = sparc
 os = solaris2.6
 system = sparc, solaris2.6
 status = Patched
 major = 1
 minor = 1.0
 year = 2000
 month = July
 day = 28
 language = R

Search Path:
 .GlobalEnv, package:MASS, Autoloads, package:base

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 621.audit <==
Wed Aug 02 10:41:31 2000	ripley	moved from incoming to Models
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 614 *
Subject: scoping problems
From: halvorsen <kjetilh@umsanet.edu.bo>
Date: Mon, 24 Jul 2000 17:48:49 -0400
--issue here is the definition of quasi().
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 614 <==
From kjetilh@umsanet.edu.bo  Mon Jul 24 23:51:12 2000
Received: from jupiter.umsanet.edu.bo (IDENT:root@jupiter.umsanet.edu.bo [166.114.17.4])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA03956
	for <r-bugs@biostat.ku.dk>; Mon, 24 Jul 2000 23:49:49 +0200 (MET DST)
Received: from umsanet.edu.bo (host6.umsanet.edu.bo [166.114.17.6])
	by jupiter.umsanet.edu.bo (8.9.3/8.9.3) with ESMTP id RAA15586
	for <r-bugs@biostat.ku.dk>; Mon, 24 Jul 2000 17:26:16 -0400
Message-ID: <397CB9C1.C3FCDE14@umsanet.edu.bo>
Date: Mon, 24 Jul 2000 17:48:49 -0400
From: halvorsen <kjetilh@umsanet.edu.bo>
Reply-To: kjetilh@umsanet.edu.bo
Organization: IETA
X-Mailer: Mozilla 4.7 [en] (Win95; I)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs@biostat.ku.dk
Subject: scoping problems
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

I am resubmitting this to r-bugs, since Thomas Lumley indicates that it
might be an error:

On Wed, 5 Jul 2000, Thomas Lumley wrote:

> On Wed, 5 Jul 2000, halvorsen wrote:
>
> > Hola!
> >
> > I have the following simple function:
> >
> > > testcar
> > function(pow){
> >            ob <- glm(Pound~CG+Age+Vage,data=car,weights=No,
> >
subset=No>0,family=quasi(link=power(pow),var=mu^2))
> >
> >            deviance(ob)
> > }
> > But trying to run it gives:
> >
> > > testcar(1/2)
> > Error in power(pow) : Object "pow" not found
>
> 'pow' isn't found because quasi() is looking for it in a strange
place.
> Normally you would expect this sort of syntax to work, but the family
> functions do some tricky things to allow you to specify things with or

> without quotes and without or without parentheses.
>
> I suspect this might count as a bug.
>
> In any case, you can fix it by doing
> eval(substitute(glm(Pound~CG+Age+Vage,data=car,weights=No subset=No>0,

> family=quasi(link=power(pow),var=mu^2))))
>

As an additional note. This probably won't work if the argument to
testcar
is a variable.

A more reliable version is
 eval(substitute(glm(Pound~CG+Age+Vage,data=car,weights=No subset=No>0,
 family=quasi(link=power(pow),var=mu^2))),list(pow=pow))

( I moved the ,list argument from "substitute" to "eval" to get it
work.)

Kjetil Halvorsen




==> 614.reply.1 <==
From rgentlem@stat.auckland.ac.nz  Tue Jul 25 00:22:09 2000
Received: from mailhost.auckland.ac.nz (mailhost.auckland.ac.nz [130.216.1.4] (may be forged))
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id AAA04076
	for <R-bugs@biostat.ku.dk>; Tue, 25 Jul 2000 00:21:55 +0200 (MET DST)
Received: from stat1.stat.auckland.ac.nz (stat1.stat.auckland.ac.nz [130.216.93.1])
	by mailhost.auckland.ac.nz (8.9.2/8.9.2/8.9.2-ua) with ESMTP id KAA10397;
	Tue, 25 Jul 2000 10:21:43 +1200 (NZST)
Received: (from rgentlem@localhost)
	by stat1.stat.auckland.ac.nz (8.9.3+Sun/8.8.8) id KAA29430;
	Tue, 25 Jul 2000 10:21:09 +1200 (NZST)
Date: Tue, 25 Jul 2000 10:21:09 +1200
From: Robert Gentleman <rgentlem@stat.auckland.ac.nz>
To: kjetilh@umsanet.edu.bo
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] scoping problems (PR#614)
Message-ID: <20000725102109.Z6896@stat1.stat.auckland.ac.nz>
Mail-Followup-To: kjetilh@umsanet.edu.bo, r-devel@stat.math.ethz.ch,
	R-bugs@biostat.ku.dk
References: <200007242151.XAA03966@pubhealth.ku.dk>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 0.95.3i
In-Reply-To: <200007242151.XAA03966@pubhealth.ku.dk>; from kjetilh@umsanet.edu.bo on Mon, Jul 24, 2000 at 11:51:12PM +0200

On Mon, Jul 24, 2000 at 11:51:12PM +0200, kjetilh@umsanet.edu.bo wrote:
> I am resubmitting this to r-bugs, since Thomas Lumley indicates that it
> might be an error:
> 
> On Wed, 5 Jul 2000, Thomas Lumley wrote:
> 
> > On Wed, 5 Jul 2000, halvorsen wrote:
> >
> > > Hola!
> > >
> > > I have the following simple function:
> > >
> > > > testcar
> > > function(pow){
> > >            ob <- glm(Pound~CG+Age+Vage,data=car,weights=No,
> > >
> subset=No>0,family=quasi(link=power(pow),var=mu^2))
> > >
> > >            deviance(ob)
> > > }
> > > But trying to run it gives:
> > >
> > > > testcar(1/2)
> > > Error in power(pow) : Object "pow" not found
> >
> > 'pow' isn't found because quasi() is looking for it in a strange
> place.
> > Normally you would expect this sort of syntax to work, but the family
> > functions do some tricky things to allow you to specify things with or
> 
> > without quotes and without or without parentheses.
> >
> > I suspect this might count as a bug.
> >
> > In any case, you can fix it by doing
> > eval(substitute(glm(Pound~CG+Age+Vage,data=car,weights=No subset=No>0,
> 
> > family=quasi(link=power(pow),var=mu^2))))
> >
> 
> As an additional note. This probably won't work if the argument to
> testcar
> is a variable.
> 
> A more reliable version is
>  eval(substitute(glm(Pound~CG+Age+Vage,data=car,weights=No subset=No>0,
>  family=quasi(link=power(pow),var=mu^2))),list(pow=pow))
> 
> ( I moved the ,list argument from "substitute" to "eval" to get it
> work.)
> 
> Kjetil Halvorsen
> 
> 
  The problem is with quasi:
> quasi
function (link = "identity", variance = "constant") 
{
    linktemp <- substitute(link)
    if (is.expression(linktemp)) 
        linktemp <- eval(linktemp)
    if (!is.character(linktemp)) {
        linktemp <- deparse(linktemp)
        if (linktemp == "link") 
            linktemp <- eval(link)
    }
   ...

  Note that neither of the eval's is what is wanted. At this point
  you just want to force the promise, ie evaluate the argument in
  the calling environment.
  The following piece of code seems to do that:

 > quasi
function (link = "identity", variance = "constant") 
{
    linktemp <- substitute(link)
    if ( is.expression(linktemp) || is.call(linktemp) ) 
        linktemp <- link
    else if (!is.character(linktemp)) 
        linktemp <- deparse(linktemp)
    if( is.character(linktemp) )
        stats <- make.link(linktemp)
    else
        stats <- linktemp
...
> 
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-- 
+-------------------------------------------------------------------------+
| Robert Gentleman              phone : (64-9) 3737-599 ext 3946          | 
| Senior Lecturer               fax :   (64-9) 3737-018                   |
| Department of Statistics      office : Room 206 Maths/Physics           |
| University of Auckland	email : rgentlem@stat.auckland.ac.nz      |
+-------------------------------------------------------------------------+

==> 614.followup.1 <==
From kjetilh@umsanet.edu.bo  Tue Jul 25 23:49:39 2000
Received: from jupiter.umsanet.edu.bo (IDENT:root@jupiter.umsanet.edu.bo [166.114.17.4])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA13287
	for <R-bugs@biostat.ku.dk>; Tue, 25 Jul 2000 23:48:53 +0200 (MET DST)
Received: from umsanet.edu.bo (host6.umsanet.edu.bo [166.114.17.6])
	by jupiter.umsanet.edu.bo (8.9.3/8.9.3) with ESMTP id RAA22050;
	Tue, 25 Jul 2000 17:23:57 -0400
Message-ID: <397E0AA0.BF1E20D@umsanet.edu.bo>
Date: Tue, 25 Jul 2000 17:46:08 -0400
From: halvorsen <kjetilh@umsanet.edu.bo>
Reply-To: kjetilh@umsanet.edu.bo
Organization: IETA
X-Mailer: Mozilla 4.7 [en] (Win95; I)
X-Accept-Language: en
MIME-Version: 1.0
To: Robert Gentleman <rgentlem@stat.auckland.ac.nz>
CC: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] scoping problems (PR#614)
References: <200007242151.XAA03966@pubhealth.ku.dk> <20000725102109.Z6896@stat1.stat.auckland.ac.nz>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit



Robert Gentleman wrote:

>

I tested the proposed change with thre original problem, and now it works fine.
Kjetil Halvorsen

>
>   The problem is with quasi:
> > quasi
> function (link = "identity", variance = "constant")
> {
>     linktemp <- substitute(link)
>     if (is.expression(linktemp))
>         linktemp <- eval(linktemp)
>     if (!is.character(linktemp)) {
>         linktemp <- deparse(linktemp)
>         if (linktemp == "link")
>             linktemp <- eval(link)
>     }
>    ...
>
>   Note that neither of the eval's is what is wanted. At this point
>   you just want to force the promise, ie evaluate the argument in
>   the calling environment.
>   The following piece of code seems to do that:
>
>  > quasi
> function (link = "identity", variance = "constant")
> {
>     linktemp <- substitute(link)
>     if ( is.expression(linktemp) || is.call(linktemp) )
>         linktemp <- link
>     else if (!is.character(linktemp))
>         linktemp <- deparse(linktemp)
>     if( is.character(linktemp) )
>         stats <- make.link(linktemp)
>     else
>         stats <- linktemp
> ...
> >
> >
> > -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> > r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> > Send "info", "help", or "[un]subscribe"
> > (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> > _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
>
> --
> +-------------------------------------------------------------------------+
> | Robert Gentleman              phone : (64-9) 3737-599 ext 3946          |
> | Senior Lecturer               fax :   (64-9) 3737-018                   |
> | Department of Statistics      office : Room 206 Maths/Physics           |
> | University of Auckland        email : rgentlem@stat.auckland.ac.nz      |
> +-------------------------------------------------------------------------+
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._


==> 614.audit <==
Mon Aug 07 13:23:46 2000	ripley	changed notes
Mon Aug 07 13:23:46 2000	ripley	moved from incoming to Models
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Startup

* PR# 486 *
Subject: Re: autoload error in profile {was anova-bug in R-version  1.0.0?}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Tue, 14 Mar 2000 10:32:43 +0100 (MET)
--workaround to the origin problem in 1.0.1
--New report: try does not work from the profile.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 486 <==
From maechler@stat.math.ethz.ch  Tue Mar 14 10:32:36 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id KAA17249
	for <R-bugs@biostat.ku.dk>; Tue, 14 Mar 2000 10:32:35 +0100 (MET)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id KAA21252;
	Tue, 14 Mar 2000 10:32:48 +0100 (MET)
Received: from lynne(129.132.58.30), claiming to be "lynne.ethz.ch"
 via SMTP by hypatia, id smtpdAAAa005C1; Tue Mar 14 10:32:44 2000
Received: (maechler@localhost) by lynne.ethz.ch (8.9.3/D-MATH-client) id KAA03934; Tue, 14 Mar 2000 10:32:44 +0100
X-Authentication-Warning: lynne.ethz.ch: maechler set sender to maechler@stat.math.ethz.ch using -f
From: Martin Maechler <maechler@stat.math.ethz.ch>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <14542.1851.731086.380@lynne.ethz.ch>
Date: Tue, 14 Mar 2000 10:32:43 +0100 (MET)
To: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Cc: R-bugs@stat.math.ethz.ch
Subject: Re: autoload error in profile {was anova-bug in R-version  1.0.0?}
 (PR#470)
In-Reply-To: <Pine.GSO.4.05.10003071100180.20079-100000@auk.stats>
References: <14532.56910.278837.379365@lynne.ethz.ch>
	<Pine.GSO.4.05.10003071100180.20079-100000@auk.stats>
X-Mailer: VM 6.75 under Emacs 20.6.1
Reply-To: Martin Maechler <maechler@stat.math.ethz.ch>

>>>>> "BDR" == Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

    BDR> On Tue, 7 Mar 2000, Martin Maechler wrote:
    >> >>>>> "BDR" == Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
    >> 
    BDR> On Tue, 7 Mar 2000, Trenkler, Dietrich wrote:
    >> >> I think I've discovered what went wrong.
    >> >> 
    >> >> My workspace included a function wilcox.test formerly copied from
    >> >> ctest. Now ctest ist part of the distribution and because of that I
    >> >> always got the message:
    >> >> 
    >> >> [Previously saved workspace restored]
    >> >> 
    >> >> Error in autoload("wilcox.test", "ctest") :
    >> >> Object already exists
    >> >> 
    >> >> I didn't take care of this message. Now I removed wilcox.test, saved
    >> >> the WS, restarted R without the vanilla-option and alas, anova
    >> >> now works.
    >> >> 
    >> >> It seems that R stops initializing after encountering the error
    >> >> mentioned above. Is this correct?   
    >> 
    BDR> Yes, in that the rest of the system Rprofile file is skipped
    BDR> and hence options show.signif.stars and show.coef.Pvalues are not set.
    >> but other options as well..
    >> I think this shouldn't happen and *is* a bug.

    BDR> It looks to me as if a bit more protection is needed in print.coefmat,
    BDR> at least.

	 which Brian has implemented in the mean time.

	 ....

    >> For the 1.0.x patches, at least, I'll move the autoload()'s to the end of
    >> profile/Common.R

    BDR> I _think_ they should have try() around them, which is what S-PLUS 
    BDR> now does with all startup code.

I tried this, but it does not work :

try(autoload(..)) works okay when used after startup, but not *during*
startup.  However, I'll put a workaround into Common.R

Should this {try(.) not working during startup} be another bug report ?

Martin

==> 486.audit <==
Sat Mar 25 09:44:47 2000	maechler	moved from incoming to Startup
Sat Apr 08 07:41:36 2000	ripley	changed notes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  System-specific

* PR# 592 *
Subject: tseries bug
From: przemat@itti.com.pl
Date: Tue, 4 Jul 2000 14:52:17 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 592 <==
From przemat@itti.com.pl  Tue Jul  4 14:54:06 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id OAA14962
	for <R-bugs@biostat.ku.dk>; Tue, 4 Jul 2000 14:52:17 +0200 (MET DST)
Date: Tue, 4 Jul 2000 14:52:17 +0200 (MET DST)
From: przemat@itti.com.pl
Message-Id: <200007041252.OAA14962@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: tseries bug
MIME-Version: 1.0
Content-Type: text/plain; charset=unknown-8bit
Content-Transfer-Encoding: 8bit

Full_Name: Przemys³aw Matuszewski
Version: R-1.1.0
OS: Linux RH 6.2
Submission from: (NULL) (195.117.211.244)


I have a problem with the package tseries_0.5-2.
The source of tseries_0.5-2 was compiled by command R INSTALL /path/to/package.

There was build the tseries library. Now when I try to load the package I get
the message:
...........................
    
    Type	"demo()" for some demos, "help()" for on-line help, or
    	"help.start()" for a HTML browser interface to help.
    Type	"q()" to quit R.

    > library(tseries)

    Segmentation fault (core dumped)

............................
                        
I would be appreciated if you could give me any suggestion what to do with it.

Best regards

Przemys³aw Matuszewski

przemat@itti.com.pl


==> 592.followup.1 <==
From plummer@iarc.fr  Tue Jul  4 15:19:12 2000
Received: from smtp02.iarc.fr (IDENT:root@uu194-7-167-221.unknown.uunet.be [194.7.167.221])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA15580
	for <R-bugs@biostat.ku.dk>; Tue, 4 Jul 2000 15:19:11 +0200 (MET DST)
Received: from xena.iarc.fr ([10.10.150.125])
	by smtp02.iarc.fr (8.9.3/8.9.3) with ESMTP id PAA06989;
	Tue, 4 Jul 2000 15:19:02 +0200
Message-ID: <XFMail.000704152137.plummer@iarc.fr>
X-Mailer: XFMail 1.3 [p0] on Linux
X-Priority: 3 (Normal)
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 8bit
MIME-Version: 1.0
In-Reply-To: <200007041254.OAA15000@pubhealth.ku.dk>
Date: Tue, 04 Jul 2000 15:21:37 +0200 (CEST)
Organization: International Agency for Research on Cancer
Sender: martyn@xena.iarc.fr
From: Martyn Plummer <plummer@iarc.fr>
To: przemat@itti.com.pl
Subject: RE: [Rd] tseries bug (PR#592)
Cc: R-bugs@biostat.ku.dk, r-devel@stat.math.ethz.ch

Not a problem with the tseries package, I think, but with Red Hat 6.2,
which has some serious problems dynamically loading Fortran.

Peter Dalgaard has reported that upgrading the C/fortran compilers to 
gcc 2.95.1 or later cures the problem.

I'll see if I can find an RPM of gcc-2.95.1 for RH 6.2 and put it in
the RedHat directory of CRAN.

Martyn

On 04-Jul-00 przemat@itti.com.pl wrote:
> Full_Name: Przemys³aw Matuszewski
> Version: R-1.1.0
> OS: Linux RH 6.2
> Submission from: (NULL) (195.117.211.244)
> 
> 
> I have a problem with the package tseries_0.5-2.
> The source of tseries_0.5-2 was compiled by command R INSTALL
> /path/to/package.
> 
> There was build the tseries library. Now when I try to load the package I get
> the message:
> ...........................
>     
>     Type      "demo()" for some demos, "help()" for on-line help, or
>       "help.start()" for a HTML browser interface to help.
>     Type      "q()" to quit R.
> 
>     > library(tseries)
> 
>     Segmentation fault (core dumped)
> 
> ............................
>                         
> I would be appreciated if you could give me any suggestion what to do with
> it.

==> 592.followup.2 <==
From plummer@iarc.fr  Tue Jul  4 17:01:47 2000
Received: from smtp02.iarc.fr (IDENT:root@uu194-7-167-221.unknown.uunet.be [194.7.167.221])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA16295
	for <R-bugs@biostat.ku.dk>; Tue, 4 Jul 2000 17:01:46 +0200 (MET DST)
Received: from xena.iarc.fr ([10.10.150.125])
	by smtp02.iarc.fr (8.9.3/8.9.3) with ESMTP id QAA07615;
	Tue, 4 Jul 2000 16:59:12 +0200
Message-ID: <XFMail.000704170148.plummer@iarc.fr>
X-Mailer: XFMail 1.3 [p0] on Linux
X-Priority: 3 (Normal)
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 8bit
MIME-Version: 1.0
In-Reply-To: <XFMail.000704152137.plummer@iarc.fr>
Date: Tue, 04 Jul 2000 17:01:48 +0200 (CEST)
Organization: International Agency for Research on Cancer
Sender: martyn@xena.iarc.fr
From: Martyn Plummer <plummer@iarc.fr>
To: przemat@itti.com.pl
Subject: RE: [Rd] tseries bug (PR#592)
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk

On 04-Jul-00 Martyn Plummer wrote:
> Not a problem with the tseries package, I think, but with Red Hat 6.2,
> which has some serious problems dynamically loading Fortran.
> 
> Peter Dalgaard has reported that upgrading the C/fortran compilers to 
> gcc 2.95.1 or later cures the problem.

I'm sorry to say that I still get the segfault with gcc-2.95.1 on 
RedHat 6.2.

Martyn

==> 592.audit <==
Fri Jul 07 06:52:28 2000	maechler	moved from incoming to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 490 *
Subject: R-1.0.0 on alpha/osf1 memory glitch
From: Ray Brownrigg <Ray.Brownrigg@mcs.vuw.ac.nz>
Date: Fri, 17 Mar 2000 11:25:30 +1300 (NZDT)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 490 <==
From ray@mcs.vuw.ac.nz  Thu Mar 16 23:25:28 2000
Received: from kaukau.mcs.vuw.ac.nz (kaukau.mcs.vuw.ac.nz [130.195.5.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA21828
	for <r-bugs@biostat.ku.dk>; Thu, 16 Mar 2000 23:25:25 +0100 (MET)
Received: from aqua.mcs.vuw.ac.nz (aqua.mcs.vuw.ac.nz [130.195.6.201])
	by kaukau.mcs.vuw.ac.nz (8.10.0.Beta6/8.10.0.Beta6) with ESMTP id e2GMPUS01452
	for <r-bugs@biostat.ku.dk>; Fri, 17 Mar 2000 11:25:31 +1300 (NZDT)
From: Ray Brownrigg <Ray.Brownrigg@mcs.vuw.ac.nz>
Received: (from ray@localhost)
	by aqua.mcs.vuw.ac.nz (8.9.2/8.8.6) id LAA25041
	for r-bugs@biostat.ku.dk; Fri, 17 Mar 2000 11:25:30 +1300 (NZDT)
Date: Fri, 17 Mar 2000 11:25:30 +1300 (NZDT)
Message-Id: <200003162225.LAA25041@aqua.mcs.vuw.ac.nz>
To: r-bugs@biostat.ku.dk
Subject: R-1.0.0 on alpha/osf1 memory glitch

Digital Alpha (various), Digital UNIX V4.0[EF], R-1.0.0, gcc, f77

When using batch mode with the save option, an error message is issued.
However [I have just discovered that] it appears that the operation
does complete, i.e. the .RData file is saved successfully.  The main
problem is that the return code is non-zero (and so it is impossible to
distinguish this "non-error" from some other error in a script).

Reproduce by:

    bats>  echo 'x <- 1' | R --save
    
    R : Copyright 2000, The R Development Core Team
    Version 1.0.0  (February 29, 2000)
    
    R is free software and comes with ABSOLUTELY NO WARRANTY.
    You are welcome to redistribute it under certain conditions.
    Type    "?license" or "?licence" for distribution details.
    
    R is a collaborative project with many contributors.
    Type    "?contributors" for a list.
    
    Type    "demo()" for some demos, "help()" for on-line help, or
            "help.start()" for a HTML browser interface to help.
    Type    "q()" to quit R.
    
    > x <- 1
    >
    xmalloc: out of virtual memory
    bats> 

Note that an alternate form that achieves the same desired effect does
not issue any error messages:

    echo 'x <- 1; save(list = ls(), file = ".RData")' | R --no-save

I can't find any record of the configure summary output (is it saved
anywhere, or does it only appear on the screen?) but I could reproduce
this if necessary.

Ray Brownrigg

==> 490.audit <==
Sat Apr 01 07:28:48 2000	ripley	moved from incoming to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 452 *
Subject: problem with glm
From: Brad McNeney <mcneney@cs.sfu.ca>
Date: Fri, 18 Feb 2000 17:51:54 -0800 (PST)
--Problems on Alpha's with glm. Status unclear
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 452 <==
From mcneney@cs.sfu.ca  Sat Feb 19 02:51:57 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id CAA15326
	for <R-bugs@biostat.ku.dk>; Sat, 19 Feb 2000 02:51:56 +0100 (MET)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id CAA05839
	for <r-bugs@stat.math.ethz.ch>; Sat, 19 Feb 2000 02:52:05 +0100 (MET)
Received: from cs.sfu.ca(142.58.111.1)
 via SMTP by hypatia, id smtpdAAAa001RB; Sat Feb 19 02:51:57 2000
Received: from smahlt.math.sfu.ca (smahlt [199.60.17.25])
	by cs.sfu.ca (8.9.1/8.9.1) with ESMTP id RAA10291
	for <r-bugs@stat.math.ethz.ch>; Fri, 18 Feb 2000 17:51:55 -0800 (PST)
Received: from localhost by smahlt.math.sfu.ca (8.8.8/1.1.20.8/23Nov99-0751PM)
	id RAA0000400367; Fri, 18 Feb 2000 17:51:54 -0800 (PST)
X-Authentication-Warning: smahlt.math.sfu.ca: mcneney owned process doing -bs
Date: Fri, 18 Feb 2000 17:51:54 -0800 (PST)
From: Brad McNeney <mcneney@cs.sfu.ca>
X-Sender: mcneney@smahlt.math.sfu.ca
To: r-bugs@stat.math.ethz.ch
Subject: problem with glm
Message-ID: <Pine.OSF.4.21.0002181750080.400767-100000@smahlt.math.sfu.ca>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

I'm having sporadic problems with glm on my alpha workstation running
Compaq Tru64 UNIX V5.0 (I can't replicate the problem on my Linux PC). I
have the same problem whether I use a version of R built with the native
C-compiler or a version compiled with gcc. In both cases I've built with
g77.

I want to do some simulations with a call to glm in each rep. A simplified
version would be something like:

N_100; NREPS_100; lam.e_5; logit.inv_function(x){ exp(x)/(1+exp(x)) }
for(i in (1:NREPS)) {
   cat(paste("REP",i,"\n"))
   T_rexp(N,(lam.e))
   Delta_rbinom(N,1,logit.inv(1+T))
   ff_glm(Delta ~ T,family=binomial(logit))
}
 
It often completes all reps, but I occasionally get errors related to
lengths of various objects, etc.:

REP 1 
REP 2
<snip>
REP 9 
Error in model.matrix(t, data) : variable lengths differ


REP 1 
<snip>
REP 53 
Error: subscript out of bounds

REP 1 
<snip>
REP 41 
Error in model.matrix(t, data) : invalid variable type

Different error messages, different numbers of reps. When I call glm again
using the values of T and Delta just before the error, it runs error-free.
When I put the data in a data frame before calling glm I can also get
messages like:

REP 1 
<snip>
REP 64 
Error in model.frame(formula, rownames, variables, varnames, extras, extranames,  : 
        invalid variable type


--please do not edit the information below--

Version:
 platform = alpha-dec-osf5.0
 arch = alpha
 os = osf5.0
 system = alpha, osf5.0
 status = Patched
 major = 0
 minor = 99.0
 year = 2000
 month = February
 day = 9
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-------------------------------------------------------------------------
Brad McNeney                               email: mcneney@stat.sfu.ca
Department of Mathematics and Statistics   web: www.math.sfu.ca/~mcneney/
Simon Fraser University                    phone: 604.291.4815
8888 University Drive                      fax: 604.291.4947
Burnaby, British Columbia
Canada V5A 1S6


==> 452.reply.1 <==
From pd@biostat.ku.dk  Sat Feb 19 13:57:47 2000
Received: from biostat.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id NAA16134;
	Sat, 19 Feb 2000 13:57:46 +0100 (MET)
Received: (from pd@localhost)
	by biostat.ku.dk (8.9.3/8.9.3) id NAA30569;
	Sat, 19 Feb 2000 13:59:28 +0100
Sender: pd@blueberry.kubism.ku.dk
To: mcneney@cs.sfu.ca
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] problem with glm (PR#452)
References: <200002190151.CAA15336@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 19 Feb 2000 13:59:27 +0100
In-Reply-To: mcneney@cs.sfu.ca's message of "Sat, 19 Feb 2000 02:51:58 +0100 (MET)"
Message-ID: <x24sb5l55c.fsf@blueberry.kubism.ku.dk>
Lines: 47
X-Mailer: Gnus v5.7/Emacs 20.4
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

mcneney@cs.sfu.ca writes:

> N_100; NREPS_100; lam.e_5; logit.inv_function(x){ exp(x)/(1+exp(x)) }
> for(i in (1:NREPS)) {
>    cat(paste("REP",i,"\n"))
>    T_rexp(N,(lam.e))
>    Delta_rbinom(N,1,logit.inv(1+T))
>    ff_glm(Delta ~ T,family=binomial(logit))
> }
>  
> It often completes all reps, but I occasionally get errors related to
> lengths of various objects, etc.:
...
> --please do not edit the information below--
> 
> Version:
>  platform = alpha-dec-osf5.0
>  arch = alpha
>  os = osf5.0
>  system = alpha, osf5.0
>  status = Patched
>  major = 0
>  minor = 99.0
>  year = 2000
>  month = February
>  day = 9
>  language = R
> 
> Search Path:
>  .GlobalEnv, Autoloads, package:base

I just did the above ~10 times on i386 and nothing happened. We've had
previous reports on trouble in the lm/glm/model.matrix etc. region on
Alpha. 

If you compile with all warnings on, are you getting warnings on
pointer/integer comparisons or assignments?

Can you create a reproducible case (with set.seed to keep the random
generator sequence constant) and would you know how run a debugger on
your version so that we can figure out what is going wrong?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 452.followup.1 <==
From mcneney@cs.sfu.ca  Sun Feb 20 05:11:05 2000
Received: from cs.sfu.ca (cs.sfu.ca [142.58.111.1])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id FAA17753;
	Sun, 20 Feb 2000 05:11:03 +0100 (MET)
Received: from smahlt.math.sfu.ca (smahlt [199.60.17.25])
	by cs.sfu.ca (8.9.1/8.9.1) with ESMTP id UAA15662;
	Sat, 19 Feb 2000 20:11:12 -0800 (PST)
Received: from localhost by smahlt.math.sfu.ca (8.8.8/1.1.20.8/23Nov99-0751PM)
	id UAA0000433332; Sat, 19 Feb 2000 20:11:12 -0800 (PST)
X-Authentication-Warning: smahlt.math.sfu.ca: mcneney owned process doing -bs
Date: Sat, 19 Feb 2000 20:11:12 -0800 (PST)
From: Brad McNeney <mcneney@cs.sfu.ca>
X-Sender: mcneney@smahlt.math.sfu.ca
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] problem with glm (PR#452)
In-Reply-To: <x24sb5l55c.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.OSF.4.21.0002191945010.433325-100000@smahlt.math.sfu.ca>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


> If you compile with all warnings on, are you getting warnings on
> pointer/integer comparisons or assignments?
> 

Yes, all the ones in regex.c that Doug mentioned. Here's a sample
of these and others (warnings related to graphics/X stuff have been
omitted):

uncmin.c: In function `lltslv':
uncmin.c:281: warning: type mismatch in implicit declaration for built-in
function `memcpy'
character.c: In function `stripchars':
character.c:269: warning: subscript has type `char'
character.c:281: warning: subscript has type `char'
character.c:296: warning: subscript has type `char'
character.c:296: warning: subscript has type `char'
character.c:304: warning: subscript has type `char'
character.c:312: warning: subscript has type `char'
character.c:312: warning: subscript has type `char'
character.c:312: warning: subscript has type `char'
character.c:320: warning: subscript has type `char'
character.c:320: warning: subscript has type `char'
character.c:330: warning: subscript has type `char'
character.c:330: warning: subscript has type `char'
character.c:341: warning: subscript has type `char'
character.c: In function `do_makenames':
character.c:384: warning: subscript has type `char'
character.c:395: warning: subscript has type `char'
/usr/share/misc/bison.simple: In function `Rf_yyparse':
/usr/share/misc/bison.simple:254: warning: `yyval' might be used
uninitialized in this function
regex.c: In function `re_match_2':
regex.c:3770: warning: cast from pointer to integer of different size
regex.c:3770: warning: cast from pointer to integer of different size
regex.c:3776: warning: cast to pointer from integer of different size
regex.c:3776: warning: cast to pointer from integer of different size
regex.c:3923: warning: cast to pointer from integer of different size
regex.c:3923: warning: cast to pointer from integer of different size
regex.c:3976: warning: cast to pointer from integer of different size
regex.c:3976: warning: cast to pointer from integer of different size
regex.c:4082: warning: cast from pointer to integer of different size
regex.c:4083: warning: cast from pointer to integer of different size
regex.c:4115: warning: cast to pointer from integer of different size
regex.c:4115: warning: cast to pointer from integer of different size
regex.c:4128: warning: cast to pointer from integer of different size
regex.c:4128: warning: cast to pointer from integer of different size
regex.c:4296: warning: cast from pointer to integer of different size
regex.c:4297: warning: cast from pointer to integer of different size
saveload.c:495: warning: `BinarySave' defined but not used
saveload.c:1775: warning: `NewBinarySave' defined but not used


I'll see what I can do about getting a more reproducible error. 

Any tips on what to look for if I'm running R within GDB? I don't have
much experience with the debugger. I mostly just use it to see where my
programs are dying. But R is not -- it just gives strange error messages.

TIA,
Brad


==> 452.followup.2 <==
From ripley@stats.ox.ac.uk  Sun Feb 20 09:33:06 2000
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id JAA17966;
	Sun, 20 Feb 2000 09:33:05 +0100 (MET)
Received: from max168.public.ox.ac.uk (max168.public.ox.ac.uk [192.76.27.168])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id IAA20341;
	Sun, 20 Feb 2000 08:33:06 GMT
Date: Sun, 20 Feb 2000 08:32:05 +0000 (GMT)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Sender: ripley@auk.stats
To: Brad McNeney <mcneney@cs.sfu.ca>
cc: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>, r-devel@stat.math.ethz.ch,
        R-bugs@biostat.ku.dk
Subject: Re: [Rd] problem with glm (PR#452)
In-Reply-To: <Pine.OSF.4.21.0002191945010.433325-100000@smahlt.math.sfu.ca>
Message-ID: <Pine.GSO.4.05.10002200807420.5046-100000@auk.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Sat, 19 Feb 2000, Brad McNeney wrote:

> 
> > If you compile with all warnings on, are you getting warnings on
> > pointer/integer comparisons or assignments?
> > 
> 
> Yes, all the ones in regex.c that Doug mentioned. Here's a sample
> of these and others (warnings related to graphics/X stuff have been
> omitted):

(Two suggestions which are in the current snapshot follow. Looks like
what is which header varies a bit.)

> uncmin.c: In function `lltslv':
> uncmin.c:281: warning: type mismatch in implicit declaration for built-in
> function `memcpy'

Add a line (third one here) to src/include/R_ext/RS.h:

#ifndef R_RS_H
#define R_RS_H

#include <string.h> /* for memcpy */
#include "Rconfig.h" /* for F77_SYMBOL */


> character.c: In function `stripchars':
> character.c:269: warning: subscript has type `char'
> character.c:281: warning: subscript has type `char'
> character.c:296: warning: subscript has type `char'
> character.c:296: warning: subscript has type `char'
> character.c:304: warning: subscript has type `char'
> character.c:312: warning: subscript has type `char'
> character.c:312: warning: subscript has type `char'
> character.c:312: warning: subscript has type `char'
> character.c:320: warning: subscript has type `char'
> character.c:320: warning: subscript has type `char'
> character.c:330: warning: subscript has type `char'
> character.c:330: warning: subscript has type `char'
> character.c:341: warning: subscript has type `char'
> character.c: In function `do_makenames':
> character.c:384: warning: subscript has type `char'
> character.c:395: warning: subscript has type `char'
> /usr/share/misc/bison.simple: In function `Rf_yyparse':
> /usr/share/misc/bison.simple:254: warning: `yyval' might be used
> uninitialized in this function

Those are all normal.

> regex.c: In function `re_match_2':
> regex.c:3770: warning: cast from pointer to integer of different size
> regex.c:3770: warning: cast from pointer to integer of different size

That looks like a regex bug, with a why? comment in the code. Change
(int) to (long), twice.

> regex.c:3776: warning: cast to pointer from integer of different size
> regex.c:3776: warning: cast to pointer from integer of different size
> regex.c:3923: warning: cast to pointer from integer of different size
> regex.c:3923: warning: cast to pointer from integer of different size
> regex.c:3976: warning: cast to pointer from integer of different size
> regex.c:3976: warning: cast to pointer from integer of different size
> regex.c:4082: warning: cast from pointer to integer of different size
> regex.c:4083: warning: cast from pointer to integer of different size
> regex.c:4115: warning: cast to pointer from integer of different size
> regex.c:4115: warning: cast to pointer from integer of different size
> regex.c:4128: warning: cast to pointer from integer of different size
> regex.c:4128: warning: cast to pointer from integer of different size
> regex.c:4296: warning: cast from pointer to integer of different size
> regex.c:4297: warning: cast from pointer to integer of different size

I've never seen those, but try adding

#define STDC_HEADERS 1

at the top of regex.c.  (I am not convinced that is the cause here.)

> saveload.c:495: warning: `BinarySave' defined but not used
> saveload.c:1775: warning: `NewBinarySave' defined but not used

Normal, on a platform with xdr.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 452.reply.2 <==
From pd@biostat.ku.dk  Sun Feb 20 13:28:12 2000
Received: from biostat.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id NAA18510;
	Sun, 20 Feb 2000 13:28:12 +0100 (MET)
Received: (from pd@localhost)
	by biostat.ku.dk (8.9.3/8.9.3) id NAA31926;
	Sun, 20 Feb 2000 13:30:08 +0100
Sender: pd@blueberry.kubism.ku.dk
To: Brad McNeney <mcneney@cs.sfu.ca>
Cc: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>, r-devel@stat.math.ethz.ch,
        R-bugs@biostat.ku.dk
Subject: Re: [Rd] problem with glm (PR#452)
References: <Pine.OSF.4.21.0002191945010.433325-100000@smahlt.math.sfu.ca>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 20 Feb 2000 13:30:07 +0100
In-Reply-To: Brad McNeney's message of "Sat, 19 Feb 2000 20:11:12 -0800 (PST)"
Message-ID: <x2snyogipc.fsf@blueberry.kubism.ku.dk>
Lines: 34
X-Mailer: Gnus v5.7/Emacs 20.4
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

Brad McNeney <mcneney@cs.sfu.ca> writes:

> I'll see what I can do about getting a more reproducible error. 
> 
> Any tips on what to look for if I'm running R within GDB? I don't have
> much experience with the debugger. I mostly just use it to see where my
> programs are dying. But R is not -- it just gives strange error messages.

One technique is to set a breakpoint at the line that displays the
error, then you can inspect the condition that caused it (you may have
to go "up" a couple of times to get into an interesting environment.)

Sometimes, it turns out that a variable contains something that it
shouldn't due to memory corruption and then you may have to set a
breakpoint earlier in the code and then maybe a watchpoint on the
memory location.

Another thing that is useful even without gdb is to investigate the
output of traceback() and maybe set 

options(error=quote(DUMP <<- sys.status()))

which allows you to subsequently investigate any active environment at
the time of the error, e.g. using ls(envir=DUMP$sys.frames[[3]]), and
get("x",envir=DUMP$sys.frames[[3]]).

(Newer snapshots have a more elaborate dump.frames function, but the
above should do). 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 452.audit <==
Sun Feb 20 21:27:15 2000	ripley	moved from incoming to System-specific
Mon Feb 28 17:30:41 2000	pd	changed notes

==> 452.followup.3 <==
From mcneney@cs.sfu.ca  Sat Mar  4 19:23:48 2000
Received: from cs.sfu.ca (cs.sfu.ca [142.58.111.1])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA25981;
	Sat, 4 Mar 2000 19:23:42 +0100 (MET)
Received: from smahlt.math.sfu.ca (smahlt [199.60.17.25])
	by cs.sfu.ca (8.9.1/8.9.1) with ESMTP id KAA07172;
	Sat, 4 Mar 2000 10:23:52 -0800 (PST)
Received: from localhost by smahlt.math.sfu.ca (8.8.8/1.1.20.8/23Nov99-0751PM)
	id KAA0000263254; Sat, 4 Mar 2000 10:23:52 -0800 (PST)
X-Authentication-Warning: smahlt.math.sfu.ca: mcneney owned process doing -bs
Date: Sat, 4 Mar 2000 10:23:52 -0800 (PST)
From: Brad McNeney <mcneney@cs.sfu.ca>
X-Sender: mcneney@smahlt.math.sfu.ca
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] problem with glm (PR#452)
In-Reply-To: <x2snyogipc.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.OSF.4.21.0003041022320.263210-100000@smahlt.math.sfu.ca>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

I looked into the glm problem some more. Seems to be a memory problem that
occurs just after garbage collection. The easiest way for me to
reproduce  the error is in lapply. I take a list and ask lapply to provide
the descriptive stat summary. I do this several times with the same list.
Most often it gives the correct summary, but just after allocSExp calls
R_gc, one of the summaries for a list element will be NULL. 

E.g for a data frame dat with five columns I get the following (having added
print statements in summary.default and in allocSExp just after the test
for whether gc is necessary):

> lapply(as.list(dat), summary, maxsum = maxsum)
[1] "exiting summary.default"
R_FreeSEXP == NULL  
[1] "exiting summary.default"
[1] "exiting summary.default"
[1] "exiting summary.default"
[1] "exiting summary.default"
$Delta
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00    1.00    1.00    1.19    2.00    2.00 

$D
NULL

$R
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00    1.00    1.00    0.86    1.00    1.00 

$V
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.004552 0.740700 1.575000 1.754000 3.205000 3.390000 

$X
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    0.0     0.0     0.5     0.5     1.0     1.0 


I don't know if the following is relevant, but for some reason I've found 
I can avoid this particular problem if I make a small change in lapply in 
its main loop.  Around line 50 of apply.c:

    PROTECT(ans = allocVector(VECSXP, n));
    for(i = 0; i < n; i++) {
        INTEGER(ind)[0] = i + 1;
        VECTOR(ans)[i] = eval(R_fcall, rho);
    }

if I change it to make an assignment to a
temporary variable first everything seems to work fine:

    PROTECT(ans = allocVector(VECSXP, n));
    for(i = 0; i < n; i++) {
        INTEGER(ind)[0] = i + 1;
        tem = eval(R_fcall, rho);
        VECTOR(ans)[i] = tem;
    }

hasn't given me any NULLs yet. 



On 20 Feb 2000, Peter Dalgaard BSA wrote:

> Brad McNeney <mcneney@cs.sfu.ca> writes:
> 
> > I'll see what I can do about getting a more reproducible error. 
> > 


==> 452.reply.3 <==
From pd@biostat.ku.dk  Sun Mar  5 01:02:38 2000
Received: from biostat.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA26687;
	Sun, 5 Mar 2000 01:02:37 +0100 (MET)
Received: (from pd@localhost)
	by biostat.ku.dk (8.9.3/8.9.3) id BAA17617;
	Sun, 5 Mar 2000 01:03:15 +0100
Sender: pd@blueberry.kubism.ku.dk
To: Brad McNeney <mcneney@cs.sfu.ca>
Cc: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>, r-devel@stat.math.ethz.ch,
        R-bugs@biostat.ku.dk
Subject: Re: [Rd] problem with glm (PR#452)
References: <Pine.OSF.4.21.0003041022320.263210-100000@smahlt.math.sfu.ca>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 05 Mar 2000 01:03:15 +0100
In-Reply-To: Brad McNeney's message of "Sat, 4 Mar 2000 10:23:52 -0800 (PST)"
Message-ID: <x2putauvuk.fsf@blueberry.kubism.ku.dk>
Lines: 47
X-Mailer: Gnus v5.7/Emacs 20.4
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

Brad McNeney <mcneney@cs.sfu.ca> writes:

> I don't know if the following is relevant, but for some reason I've found 
> I can avoid this particular problem if I make a small change in lapply in 
> its main loop.  Around line 50 of apply.c:
> 
>     PROTECT(ans = allocVector(VECSXP, n));
>     for(i = 0; i < n; i++) {
>         INTEGER(ind)[0] = i + 1;
>         VECTOR(ans)[i] = eval(R_fcall, rho);
>     }
> 
> if I change it to make an assignment to a
> temporary variable first everything seems to work fine:
> 
>     PROTECT(ans = allocVector(VECSXP, n));
>     for(i = 0; i < n; i++) {
>         INTEGER(ind)[0] = i + 1;
>         tem = eval(R_fcall, rho);
>         VECTOR(ans)[i] = tem;
>     }
> 
> hasn't given me any NULLs yet. 

Now that is pretty darn odd... Looks quite a bit like a compiler bug.
Those two pieces of code should be equivalent as far as I can see.

One thing that you might do: objdump -dS apply.o allows you to see
what code the compiler generates for the two cases. Also, of course,
you can try reducing the level of optimization.


Alternatively, the mere addition of "tem" changes the local memory use
of that function so that something that got clobbered before doesn't
get clobbered now.

The effect doesn't seem to be present on Intels:

> dfr<-do.call("data.frame",lapply(1:100,function(i)rnorm(100)))
> any(sapply(lapply(dfr,summary),is.null))
[1] FALSE

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 452.followup.4 <==
From mcneney@cs.sfu.ca  Mon May 22 03:22:00 2000
Received: from cs.sfu.ca (cs.sfu.ca [142.58.111.1])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id DAA14134;
	Mon, 22 May 2000 03:21:55 +0200 (MET DST)
Received: from smahlt.math.sfu.ca (smahlt [199.60.17.25])
	by cs.sfu.ca (8.9.1/8.9.1) with ESMTP id SAA09685;
	Sun, 21 May 2000 18:22:13 -0700 (PDT)
Received: from localhost by smahlt.math.sfu.ca (8.8.8/1.1.20.8/23Nov99-0751PM)
	id SAA0000086979; Sun, 21 May 2000 18:22:12 -0700 (PDT)
X-Authentication-Warning: smahlt.math.sfu.ca: mcneney owned process doing -bs
Date: Sun, 21 May 2000 18:22:12 -0700 (PDT)
From: Brad McNeney <mcneney@cs.sfu.ca>
X-Sender: mcneney@smahlt.math.sfu.ca
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
cc: R-bugs@biostat.ku.dk
Subject: Re: [Rd] memory problem with DEC C (was: problem with glm (PR#452))
In-Reply-To: <x2putauvuk.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.OSF.4.21.0005211817440.86959-100000@smahlt.math.sfu.ca>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

Just to update: What I originally thought was a glm problem appears to be
a memory problem that occurs only when R is compiled with the DEC C
compiler. Some variables that are still in use get clobbered during
garbage collection. No problems if I compile with gcc though. I've made
some attempts to see if I can identify a specific compiler optimization
that is responsible, but so far no luck.

Brad

On 5 Mar 2000, Peter Dalgaard BSA wrote:

> Brad McNeney <mcneney@cs.sfu.ca> writes:
> 
> > I don't know if the following is relevant, but for some reason I've found 
> > I can avoid this particular problem if I make a small change in lapply in 
> > its main loop.  Around line 50 of apply.c:
> > 
> >     PROTECT(ans = allocVector(VECSXP, n));
> >     for(i = 0; i < n; i++) {
> >         INTEGER(ind)[0] = i + 1;
> >         VECTOR(ans)[i] = eval(R_fcall, rho);
> >     }
> > 
> > if I change it to make an assignment to a
> > temporary variable first everything seems to work fine:
> > 
> >     PROTECT(ans = allocVector(VECSXP, n));
> >     for(i = 0; i < n; i++) {
> >         INTEGER(ind)[0] = i + 1;
> >         tem = eval(R_fcall, rho);
> >         VECTOR(ans)[i] = tem;
> >     }
> > 
> > hasn't given me any NULLs yet. 
> 
> Now that is pretty darn odd... Looks quite a bit like a compiler bug.
> Those two pieces of code should be equivalent as far as I can see.
> 
> One thing that you might do: objdump -dS apply.o allows you to see
> what code the compiler generates for the two cases. Also, of course,
> you can try reducing the level of optimization.
> 
> 
> Alternatively, the mere addition of "tem" changes the local memory use
> of that function so that something that got clobbered before doesn't
> get clobbered now.
> 
> The effect doesn't seem to be present on Intels:
> 
> > dfr<-do.call("data.frame",lapply(1:100,function(i)rnorm(100)))
> > any(sapply(lapply(dfr,summary),is.null))
> [1] FALSE
> 
> -- 
>    O__  ---- Peter Dalgaard             Blegdamsvej 3  
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
> 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 533 *
Subject: acepack, akima and tripack will not load 
From: mallen@tntech.edu
Date: Thu, 4 May 2000 19:18:59 +0200 (MET DST)
--related to PR#521: probably compiler-specific
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 533 <==
From mallen@tntech.edu  Thu May  4 19:19:00 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA11041
	for <R-bugs@biostat.ku.dk>; Thu, 4 May 2000 19:18:59 +0200 (MET DST)
Date: Thu, 4 May 2000 19:18:59 +0200 (MET DST)
From: mallen@tntech.edu
Message-Id: <200005041718.TAA11041@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: acepack, akima and tripack will not load 

Full_Name: Michael R. Allen
Version: 1.01
OS: linux redhat
Submission from: (NULL) (149.149.32.46)


Hello,

	Thought you might be interested.  I tried to load the package tripack
needed by the sgeostat package.  After some careful searching,  three packages
were 
found which had the same error.  Here is the output.

Mike
  
> library(acepack) Error in dyn.load(x, as.logical(local),
as.logical(now)) :
        unable to load shared library
"/usr/lib/R/library/acepack/libs/acepack.so":
  /usr/lib/R/library/acepack/libs/acepack.so: undefined symbol: e_wsfe 
>library(tripack) Error in dyn.load(x, as.logical(local), as.logical(now))
:
        unable to load shared library
"/usr/lib/R/library/tripack/libs/tripack.so":
  /usr/lib/R/library/tripack/libs/tripack.so: undefined symbol: e_wsfe 
>library(akima) Error in dyn.load(x, as.logical(local), as.logical(now)) :
        unable to load shared library
"/usr/lib/R/library/akima/libs/akima.so":
  /usr/lib/R/library/akima/libs/akima.so: undefined symbol: e_wsfe      

==> 533.followup.1 <==
From ripley@stats.ox.ac.uk  Thu May  4 19:41:38 2000
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA11202
	for <R-bugs@biostat.ku.dk>; Thu, 4 May 2000 19:41:35 +0200 (MET DST)
Received: from max126.public.ox.ac.uk (max126.public.ox.ac.uk [192.76.27.126])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id SAA09846;
	Thu, 4 May 2000 18:41:45 +0100 (BST)
Date: Thu, 4 May 2000 18:40:42 +0100 (BST)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Sender: ripley@auk.stats
To: mallen@tntech.edu
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] acepack, akima and tripack will not load (PR#533)
In-Reply-To: <200005041719.TAA11051@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.10005041827230.26380-100000@auk.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Thu, 4 May 2000 mallen@tntech.edu wrote:

> Full_Name: Michael R. Allen
> Version: 1.01
> OS: linux redhat
> Submission from: (NULL) (149.149.32.46)
> 
> 
> Hello,
> 
> 	Thought you might be interested.  I tried to load the package tripack
> needed by the sgeostat package.  After some careful searching,  three packages
> were 
> found which had the same error.  Here is the output.

> Mike
>   
> > library(acepack) Error in dyn.load(x, as.logical(local),
> as.logical(now)) :
>         unable to load shared library
> "/usr/lib/R/library/acepack/libs/acepack.so":
>   /usr/lib/R/library/acepack/libs/acepack.so: undefined symbol: e_wsfe 
> >library(tripack) Error in dyn.load(x, as.logical(local), as.logical(now))
> :
>         unable to load shared library
> "/usr/lib/R/library/tripack/libs/tripack.so":
>   /usr/lib/R/library/tripack/libs/tripack.so: undefined symbol: e_wsfe 
> >library(akima) Error in dyn.load(x, as.logical(local), as.logical(now)) :
>         unable to load shared library
> "/usr/lib/R/library/akima/libs/akima.so":
>   /usr/lib/R/library/akima/libs/akima.so: undefined symbol: e_wsfe      

That's a symbol from the Fortran I/O code.  There is no problem on RH6.0
on R 1.0.1, where the symbol is resolved from libg2c.a.

(1) Does FLIBS in etc/Makeconf include -lg2c?

(2) If so, do those packages have Makefiles in src? If so delete them
and reinstall.  (The latest version of akima does not, but earlier versions
did.)

(3) Does lg2c include e_wsfe?  (nm -g on it).  Is it finding the right
libg2c.a?

(4) I get nm -g ..../akima.so  giving

00013c5c T e_wsfe

and so I think it should be resolved in the *.so.

Which version of RedHat?  I suspect a RedHat inconsistency here, and other
people have reported that upgrading to the gcc-2.95.2 compiler set
solved the problem.  But it might just be old package versions.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 533.reply.1 <==
From bates@franz.stat.wisc.edu  Thu May  4 19:44:14 2000
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA11222
	for <R-bugs@biostat.ku.dk>; Thu, 4 May 2000 19:44:13 +0200 (MET DST)
Received: by franz.stat.wisc.edu
	via sendmail from stdin
	id <m12nPhM-000ZTOC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for R-bugs@biostat.ku.dk; Thu, 4 May 2000 12:46:04 -0500 (CDT) 
Sender: bates@franz.stat.wisc.edu
To: mallen@tntech.edu
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] acepack, akima and tripack will not load (PR#533)
References: <200005041719.TAA11051@pubhealth.ku.dk>
From: Douglas Bates <bates@stat.wisc.edu>
Date: 04 May 2000 12:46:04 -0500
In-Reply-To: mallen@tntech.edu's message of "Thu, 4 May 2000 19:19:01 +0200 (MET DST)"
Message-ID: <6rog6m2opv.fsf@franz.stat.wisc.edu>
Lines: 12
X-Mailer: Gnus v5.7/Emacs 20.6

mallen@tntech.edu writes:

> > library(acepack) Error in dyn.load(x, as.logical(local),
> as.logical(now)) :
>         unable to load shared library
> "/usr/lib/R/library/acepack/libs/acepack.so":
>   /usr/lib/R/library/acepack/libs/acepack.so: undefined symbol: e_wsfe 

That name e_wsfe probably comes from Fortran input/output routines.
Check if some Fortran code is trying to use a WRITE statement.  I
think there was another message this morning about this.


==> 533.reply.2 <==
From pd@blueberry.kubism.ku.dk  Thu May  4 22:04:44 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA11927
	for <R-bugs@biostat.ku.dk>; Thu, 4 May 2000 22:04:44 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id WAA04273;
	Thu, 4 May 2000 22:10:21 +0200
Sender: pd@blueberry.kubism.ku.dk
To: mallen@tntech.edu
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] wsfe bug report just made (PR#533)
References: <200005041720.TAA11084@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 04 May 2000 22:10:21 +0200
In-Reply-To: mallen@tntech.edu's message of "Thu, 4 May 2000 19:20:36 +0200 (MET DST)"
Message-ID: <x2bt2m13gy.fsf@blueberry.kubism.ku.dk>
Lines: 29
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

mallen@tntech.edu writes:

> Full_Name: Michael R. Allen
> Version: 1.01
> OS: linux redhat 6.2
> Submission from: (NULL) (149.149.32.46)
> 
> 
> Sorry, I forgot to tell you.  I am running version 6.2 of redhat.  Also, I have
> loaded the latest version of R as well.
> 
> Mike
> 

But did you build the packages yourself and if so, how? (using which
compilers).

BTW: when you follow up on an earlier report via the web interface,
please do it as a follow-up. If you do it by mail, say for PR#533,
please include (PR#533) in the Subject line. That way things get filed
together. (I've fixed the number on this mail)



-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 533.audit <==
Thu May 18 18:06:13 2000	ripley	changed notes
Thu May 18 18:06:13 2000	ripley	moved from incoming to Add-ons
Wed Jun 07 15:09:34 2000	pd	moved from Add-ons to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 521 *
Subject: akima core dumps on loading
From: santini@dsi.unimi.it
Date: Mon, 17 Apr 2000 11:30:41 +0200 (MET DST)
--Probably compiler-specific
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 521 <==
From santini@dsi.unimi.it  Mon Apr 17 11:30:42 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA01559
	for <R-bugs@biostat.ku.dk>; Mon, 17 Apr 2000 11:30:41 +0200 (MET DST)
Date: Mon, 17 Apr 2000 11:30:41 +0200 (MET DST)
From: santini@dsi.unimi.it
Message-Id: <200004170930.LAA01559@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: akima core dumps on loading

Full_Name: Massimo santini
Version: 1.0.1
OS: Linux
Submission from: (NULL) (159.149.147.89)


I've just dl the .rpm of R 1.0.1, installed it and then launched 

	insatll.packages("akima")

after re-launching R [--vanilla], the command

	library(akima)

has the only effect to coredump the program. Here is the output of gdb and
strace...

--- GDB (commands given can be seen from the except)

$ R -d gdb
GNU gdb 19991004
Copyright 1998 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i386-redhat-linux"...
(gdb) run --vanilla
Starting program: /usr/lib/R/bin/R.X11 --vanilla

R : Copyright 2000, The R Development Core Team
Version 1.0.1  (April 14, 2000)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type	"?license" or "?licence" for distribution details.

R is a collaborative project with many contributors.
Type	"?contributors" for a list.

Type	"demo()" for some demos, "help()" for on-line help, or
    	"help.start()" for a HTML browser interface to help.
Type	"q()" to quit R.

> library(akima)

Program received signal SIGSEGV, Segmentation fault.
_dl_lookup_symbol (undef_name=0x2d2e3b3 <Address 0x2d2e3b3 out of bounds>,
ref=0xbfffabb4, 
    symbol_scope=0x81ec65c, reference_name=0x81e8b20
"/usr/lib/R/library/akima/libs/akima.so", reloc_type=208)
    at ../sysdeps/generic/dl-hash.h:31
31	../sysdeps/generic/dl-hash.h: No such file or directory.
(gdb) 

--- STRACE (echo "library(akima)" | strace R --vanilla)

[...]
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
stat("/usr/lib/R/library/akima/libs/akima.so", {st_mode=S_IFREG|0755,
st_size=289367, ...}) = 0
stat("/usr/lib/R/library/base/libs/akima.so", 0xbfffdb60) = -1 ENOENT (No such
file or directory)
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0
open("/usr/lib/R/library/akima/libs/akima.so", O_RDONLY) = 4
fstat(4, {st_mode=S_IFREG|0755, st_size=289367, ...}) = 0
read(4, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0000F\0\000"..., 4096) =
4096
old_mmap(NULL, 115364, PROT_READ|PROT_EXEC, MAP_PRIVATE, 4, 0) = 0x40f3d000
mprotect(0x40f55000, 17060, PROT_NONE)  = 0
old_mmap(0x40f55000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED, 4,
0x17000) = 0x40f55000
old_mmap(0x40f57000, 8868, PROT_READ|PROT_WRITE,
MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x40f57000
close(4)                                = 0
mprotect(0x40f3d000, 98304, PROT_READ|PROT_WRITE) = 0
--- SIGSEGV (Segmentation fault) ---
+++ killed by SIGSEGV +++

==> 521.reply.1 <==
From pd@blueberry.kubism.ku.dk  Mon Apr 17 12:00:35 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id MAA01944
	for <R-bugs@biostat.ku.dk>; Mon, 17 Apr 2000 12:00:35 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id MAA31083;
	Mon, 17 Apr 2000 12:03:19 +0200
Sender: pd@blueberry.kubism.ku.dk
To: santini@dsi.unimi.it
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] akima core dumps on loading (PR#521)
References: <200004170930.LAA01569@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 17 Apr 2000 12:03:19 +0200
In-Reply-To: santini@dsi.unimi.it's message of "Mon, 17 Apr 2000 11:30:43 +0200 (MET DST)"
Message-ID: <x2zoqtkpso.fsf@blueberry.kubism.ku.dk>
Lines: 52
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

santini@dsi.unimi.it writes:

> Full_Name: Massimo santini
> Version: 1.0.1
> OS: Linux
> Submission from: (NULL) (159.149.147.89)
> 
> 
> I've just dl the .rpm of R 1.0.1, installed it and then launched 
> 
> 	insatll.packages("akima")
> 
> after re-launching R [--vanilla], the command
> 
> 	library(akima)
> 
> has the only effect to coredump the program. Here is the output of gdb and
> strace...

Hmm. Doesn't happen here. (BTW: Remember to include as much
information about your system as you can think of. It's not obvious
whether you're running RedHat or SuSE for instance and in what
version.) 

> Program received signal SIGSEGV, Segmentation fault.
> _dl_lookup_symbol (undef_name=0x2d2e3b3 <Address 0x2d2e3b3 out of bounds>,
> ref=0xbfffabb4, 
>     symbol_scope=0x81ec65c, reference_name=0x81e8b20
> "/usr/lib/R/library/akima/libs/akima.so", reloc_type=208)
>     at ../sysdeps/generic/dl-hash.h:31
> 31	../sysdeps/generic/dl-hash.h: No such file or directory.
> (gdb) 
> 
> --- STRACE (echo "library(akima)" | strace R --vanilla)
> 
> [...]
> rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
> stat("/usr/lib/R/library/akima/libs/akima.so", {st_mode=S_IFREG|0755,
> st_size=289367, ...}) = 0
> stat("/usr/lib/R/library/base/libs/akima.so", 0xbfffdb60) = -1 ENOENT (No such
> file or directory)

This would seem to be the problem: the dynamic library isn't there.
Did you get any error messages while compiling the package? (Except
for "...might be used uninitialized..." of which there are quite a few
here too).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 521.reply.2 <==
From pd@blueberry.kubism.ku.dk  Mon Apr 17 15:47:37 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA05177
	for <r-bugs@biostat.ku.dk>; Mon, 17 Apr 2000 15:47:36 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id PAA31429;
	Mon, 17 Apr 2000 15:50:37 +0200
Sender: pd@blueberry.kubism.ku.dk
To: Massimo Santini <santini@dsi.unimi.it>
Subject: Re: [Rd] akima core dumps on loading (PR#521)
Cc: r-bugs@biostat.ku.dk
References: <Pine.LNX.4.21.0004171357340.30022-100000@zorn.usr.dsi.unimi.it>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 17 Apr 2000 15:50:36 +0200
In-Reply-To: Massimo Santini's message of "Mon, 17 Apr 2000 14:00:28 +0200 (CEST)"
Message-ID: <x2snwkalar.fsf@blueberry.kubism.ku.dk>
Lines: 80
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

Massimo Santini <santini@dsi.unimi.it> writes:

> > Hmm. Doesn't happen here. (BTW: Remember to include as much
> > information about your system as you can think of. It's not obvious
> > whether you're running RedHat or SuSE for instance and in what
> > version.) 
> 
> You are perfectly right. My system is an updated RedHat 6.2.

Same here...

> > > stat("/usr/lib/R/library/akima/libs/akima.so", {st_mode=S_IFREG|0755,
> > > st_size=289367, ...}) = 0
> > > stat("/usr/lib/R/library/base/libs/akima.so", 0xbfffdb60) = -1 ENOENT (No such
> > > file or directory)
> > 
> > This would seem to be the problem: the dynamic library isn't there.
> > Did you get any error messages while compiling the package? (Except
> > for "...might be used uninitialized..." of which there are quite a few
> > here too).
> 
> Non errors during the installation phase. The akima.so library is in 
> 
> 	/usr/lib/R/library/akima/libs/akima.so
> 
> where it should be (with correct premissions), but is not in
> 
> 	/usr/lib/R/library/base/libs/akima.so
> 
> (the dir /usr/lib/R/library/base/libs is missing, to be precise).

Oh. Didn't see that. Then that part is OK. Sorry.

> Have you some hint about what to do now?

Hmmm. Interesting: I can provoke the crash on *my other* RedHat6.2
computer (the one still running the egcs compiler). My stack trace says

#0  _dl_lookup_symbol (
    undef_name=0xcbf203b4 <Address 0xcbf203b4 out of bounds>,
    ref=0xbfffb234, 
    symbol_scope=0x81d3cac, 
    reference_name=0x81d3a60
    "/usr/local/src/misc/r-release/BUILD/library/akima/libs/akima.so",
    reloc_type=64) at ../sysdeps/generic/dl-hash.h:31
#1  0x400096ad in _dl_relocate_object (l=0x81d3aa8, scope=0x81d3cac, lazy=0, 
    consider_profiling=0) at ../sysdeps/i386/dl-machine.h:326
#2  0x40255be4 in dl_open_worker (a=0xbfffb3a0) at dl-open.c:182
#3  0x4000ac3b in _dl_catch_error (errstring=0xbfffb39c, 
    operate=0x40255990 <dl_open_worker>, args=0xbfffb3a0) at dl-error.c:141
#4  0x40255d3d in _dl_open (
    file=0xbfffc51c 
"/usr/local/src/misc/r-release/BUILD/library/akima/libs/akima.so",
mode=2, caller=0xbfffb39c) at dl-open.c:232
#5  0x401323d3 in dlopen_doit (a=0xbfffb4b0) at dlopen.c:41
#6  0x4000ac3b in _dl_catch_error (errstring=0x40134080, 
    operate=0x401323a8 <dlopen_doit>, args=0xbfffb4b0) at
dl-error.c:141
#7  0x401328b9 in _dlerror_run (operate=0x401323a8 <dlopen_doit>, 
    args=0xbfffb4b0) at dlerror.c:125
#8  0x40132393 in __dlopen_check (
    file=0xbfffc51c
"/usr/local/src/misc/r-release/BUILD/library/akima/libs/akima.so",
mode=2) at dlopen.c:53
#9  0x80d9cc3 in AddDLL (
    path=0xbfffc51c
"/usr/local/src/misc/r-release/BUILD/library/akima/libs/akim
a.so", asLocal=1, now=1) at ../../../R/src/unix/dynload.c:207


Looks like it is happening during the dynamic linking itself. Doesn't
look nice. (But installing gcc 2.95.2 might fix your problem.)

[diverted back to r-bugs]

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 521.audit <==
Tue Apr 25 07:04:44 2000	ripley	changed notes
Tue Apr 25 07:04:44 2000	ripley	moved from incoming to Add-ons
Wed Jun 07 15:09:34 2000	pd	moved from Add-ons to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 547 *
Subject: system(.., ignore.stderr = TRUE)  problem on Solaris
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 19 May 2000 21:12:02 +0200 (CEST)
--redirection of stderr to /dev/null in system occurs before the command
--is tried on some systems and after on others.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 547 <==
From maechler@stat.math.ethz.ch  Fri May 19 21:11:52 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA02032
	for <R-bugs@biostat.ku.dk>; Fri, 19 May 2000 21:11:51 +0200 (MET DST)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id VAA08262
	for <R-bugs@stat.math.ethz.ch>; Fri, 19 May 2000 21:12:10 +0200 (MET DST)
Received: from lynne(129.132.58.30), claiming to be "lynne.ethz.ch"
 via SMTP by hypatia, id smtpdAAAa00214; Fri May 19 21:12:03 2000
Received: (maechler@localhost) by lynne.ethz.ch (8.9.3/D-MATH-client) id VAA02922; Fri, 19 May 2000 21:12:02 +0200
X-Authentication-Warning: lynne.ethz.ch: maechler set sender to maechler@stat.math.ethz.ch using -f
From: Martin Maechler <maechler@stat.math.ethz.ch>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <14629.37378.591438.574955@lynne.ethz.ch>
Date: Fri, 19 May 2000 21:12:02 +0200 (CEST)
To: R-bugs@stat.math.ethz.ch
Subject: system(.., ignore.stderr = TRUE)  problem on Solaris
X-Mailer: VM 6.75 under Emacs 20.6.1
Reply-To: Martin Maechler <maechler@stat.math.ethz.ch>

(i.e. my version Solaris, see below...)

Note that system() is not only implemented quite system-dependently
(which you'd very much expect!) but also Unix and Windows have quite
different arguments apart from the first two.

Hence all the following is ``Unix-only'' :


A user stumbled across this when using read.table.url(.) on a platform
where no "wget" is installed: 

The data is read ok, but an ugly message appears *before* the command is
completed :
	  -------------------
	  sh: wget: not found
	  -------------------
which made the user believe that the data wasn't read properly.

The problem is easily tracked to the system(..) call in download.file()
{which does not (yet) have the "ignore.stderr = TRUE" setting, btw}
and found that on our Solaris environment, 
the ignore.stderr argument does not seem to have any effect, i.e.

  > system("bla", ignore.stderr = TRUE)

gives the same as  system("bla"), namely
  
  sh: bla: not found
 
On my Linux environment,  ignore.stderr works as advertized.

Further note that  help(system)  should probably also say something about which
shell may or may not be used (I think we decided that we want it to be `sh'
on Unix).


--please do not edit the information below-- {did anyway ;=)}

Version:
 platform = sparc-sun-solaris2.5.1
 arch = sparc
 os = solaris2.5.1
 system = sparc, solaris2.5.1

 --- either R-devel of today, or also 1.0.1 ---

 year = 2000
 month = May
 day = 18
 language = R

Search Path:
 .GlobalEnv, package:SfS, Autoloads, package:base



==> 547.followup.1 <==
From ripley@stats.ox.ac.uk  Fri May 19 23:47:26 2000
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA02579
	for <R-bugs@biostat.ku.dk>; Fri, 19 May 2000 23:47:25 +0200 (MET DST)
Received: from max163.public.ox.ac.uk (max163.public.ox.ac.uk [192.76.27.163])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id WAA06872;
	Fri, 19 May 2000 22:47:38 +0100 (BST)
Date: Fri, 19 May 2000 22:46:09 +0100 (BST)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Sender: ripley@auk.stats
To: maechler@stat.math.ethz.ch
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] system(.., ignore.stderr = TRUE)  problem on Solaris (PR#547)
In-Reply-To: <200005191911.VAA02042@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.10005192223470.4118-100000@auk.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Fri, 19 May 2000 maechler@stat.math.ethz.ch wrote:

> (i.e. my version Solaris, see below...)
> 
> Note that system() is not only implemented quite system-dependently
> (which you'd very much expect!) but also Unix and Windows have quite
> different arguments apart from the first two.
> 
> Hence all the following is ``Unix-only'' :
> 
> 
> A user stumbled across this when using read.table.url(.) on a platform
> where no "wget" is installed: 
> 
> The data is read ok, but an ugly message appears *before* the command is
> completed :
> 	  -------------------
> 	  sh: wget: not found
> 	  -------------------
> which made the user believe that the data wasn't read properly.
> 
> The problem is easily tracked to the system(..) call in download.file()
> {which does not (yet) have the "ignore.stderr = TRUE" setting, btw}
> and found that on our Solaris environment, 
> the ignore.stderr argument does not seem to have any effect, i.e.
> 
>   > system("bla", ignore.stderr = TRUE)
> 
> gives the same as  system("bla"), namely
>   
>   sh: bla: not found

Under sh you cannot redirect the output from a command until the command
is running.  That is, you are not redirecting the error messages from sh,
only from the command.  Unless the command runs, ignore.stderr has no
effect.

> On my Linux environment,  ignore.stderr works as advertized.

Depends how you read the advertising.

> Further note that  help(system)  should probably also say something about which
> shell may or may not be used (I think we decided that we want it to be `sh'
> on Unix).

Yes, and you almost certainly got bash *not* sh on your Linux, and that
behaves differently.  I think you will find that a closer sh clone (such as
ash) does show the error message.  That some Linux systems claim to have sh
and do not is a major compatibility problem in writing shell scripts and
Makefiles, as we keep finding.

BTW, Solaris will use ksh not sh for the shell if it needs to be POSIX
compatible. And ksh behaves like bash in this respect.


I believe that to define this portably we are going to have to do something
a lot more complicated than accept what the system() call gives us. Are you
volunteering, Martin?


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 547.audit <==
Sun May 21 07:18:08 2000	ripley	changed notes
Sun May 21 07:18:08 2000	ripley	moved from incoming to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 537 *
Subject: eigen broken on AIX with R-devel?
From: Thomas J Vogels <tov@ece.cmu.edu>
Date: 08 May 2000 12:01:04 -0400
--AIX, probably compiler-specific
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 537 <==
From tov@ece.cmu.edu  Mon May  8 18:00:51 2000
Received: from ece.cmu.edu (ECE.CMU.EDU [128.2.236.200])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA10501
	for <r-bugs@biostat.ku.dk>; Mon, 8 May 2000 18:00:51 +0200 (MET DST)
Received: from bavaria.ece.cmu.edu (root@BAVARIA.ECE.CMU.EDU [128.2.216.38])
	by ece.cmu.edu (8.9.2/8.8.8) with ESMTP id MAA09223;
	Mon, 8 May 2000 12:01:04 -0400 (EDT)
Received: (from tov@localhost)
	by bavaria.ece.cmu.edu (8.9.3/8.9.3/Debian 8.9.3-21) id MAA00641;
	Mon, 8 May 2000 12:01:04 -0400
Sender: tov@bavaria.ece.cmu.edu
To: r-bugs@biostat.ku.dk
Cc: Thomas Vogels <tov@ece.cmu.edu>
Subject: eigen broken on AIX with R-devel?
Reply-To: Thomas Vogels <tov@ece.cmu.edu>
X-URI: http://www.ece.cmu.edu/~tov
From: Thomas J Vogels <tov@ece.cmu.edu>
Date: 08 May 2000 12:01:04 -0400
Message-ID: <87ln1ldoan.fsf@bavaria.ece.cmu.edu>
Lines: 61
User-Agent: Gnus/5.0803 (Gnus v5.8.3) Emacs/20.5
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii


Hi,  I get the wrong eigen values on an AIX machine with R-devel of 5/3/00.

Here are the results:

R> m <- matrix (c(6.8, 2.4, 2.4, 8.2), nrow=2)
R> m
     [,1] [,2]
[1,]  6.8  2.4
[2,]  2.4  8.2
R> eigen(m)
$values
[1] 19.281403  6.337993

$vectors
          [,1]       [,2]
[1,] 0.1918866  0.9967987
[2,] 0.9967987 -0.1918866


And for comparison, here is what I get on a Sun (with r-stable):

R> m <- matrix (c(6.8, 2.4, 2.4, 8.2), nrow=2)
R> eigen (m)
$values
[1] 10  5

$vectors
     [,1] [,2]
[1,]  0.6  0.8
[2,]  0.8 -0.6


I found this by running "make check" which also stumbles over svd.
Please let me know how I can help to investigate this.

  -tom


--please do not edit the information below--

Version:
 platform = powerpc-ibm-aix4.3.2.0
 arch = powerpc
 os = aix4.3.2.0
 system = powerpc, aix4.3.2.0
 status = Under development (unstable)
 major = 1
 minor = 1.0
 year = 2000
 month = May
 day = 3
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base


-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


==> 537.reply.1 <==
From pd@blueberry.kubism.ku.dk  Mon May  8 20:41:00 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA11280
	for <R-bugs@biostat.ku.dk>; Mon, 8 May 2000 20:40:59 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id UAA29246;
	Mon, 8 May 2000 20:47:12 +0200
Sender: pd@blueberry.kubism.ku.dk
To: tov@ece.cmu.edu
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] eigen broken on AIX with R-devel? (PR#537)
References: <200005081600.SAA10511@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 08 May 2000 20:47:12 +0200
In-Reply-To: tov@ece.cmu.edu's message of "Mon, 8 May 2000 18:00:52 +0200 (MET DST)"
Message-ID: <x2hfc86frj.fsf@blueberry.kubism.ku.dk>
Lines: 25
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

tov@ece.cmu.edu writes:

> Hi,  I get the wrong eigen values on an AIX machine with R-devel of 5/3/00.

Hmm. We had a similar report a while back and it turned out to be
system specific. I believe the report was from Chong Gu.

> Version:
>  platform = powerpc-ibm-aix4.3.2.0
>  arch = powerpc
>  os = aix4.3.2.0
>  system = powerpc, aix4.3.2.0
>  status = Under development (unstable)
>  major = 1
>  minor = 1.0
>  year = 2000
>  month = May
>  day = 3
>  language = R

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 537.reply.2 <==
From thomas@biostat.washington.edu  Tue May  9 17:38:55 2000
Received: from mail.biostat.washington.edu (mail.biostat.washington.edu [128.95.113.21])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA21900
	for <R-bugs@biostat.ku.dk>; Tue, 9 May 2000 17:38:54 +0200 (MET DST)
Received: from mail.biostat.washington.edu (mail.biostat.washington.edu [128.95.113.21])
	by mail.biostat.washington.edu (8.9.3+Sun/8.9.1-fetrow-99-05-16b) with ESMTP id IAA05789;
	Tue, 9 May 2000 08:39:05 -0700 (PDT)
Date: Tue, 9 May 2000 08:39:05 -0700 (PDT)
From: Thomas Lumley <thomas@biostat.washington.edu>
To: tov@ece.cmu.edu
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] eigen broken on AIX with R-devel? (PR#537)
In-Reply-To: <200005081600.SAA10511@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.21.0005090837420.4639-100000@mail.biostat.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Mon, 8 May 2000 tov@ece.cmu.edu wrote:

> 
> Hi,  I get the wrong eigen values on an AIX machine with R-devel of 5/3/00.
> 

When we last saw this bug it was compiler-specific.  gcc/g77 worked but
cc/f77 didn't (and I think gcc/f77 wouldn't even configure). 

I don't think we understand the bug, though.

	-thomas


==> 537.audit <==
Thu May 18 18:07:40 2000	ripley	changed notes
Thu May 18 18:07:40 2000	ripley	moved from incoming to System-specific

==> 537.followup.1 <==
From tov@ece.cmu.edu  Thu Jun 15 19:57:37 2000
Received: from ece.cmu.edu (ECE.CMU.EDU [128.2.236.200])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA25634
	for <R-bugs@biostat.ku.dk>; Thu, 15 Jun 2000 19:57:36 +0200 (MET DST)
Received: from bavaria.ece.cmu.edu (root@BAVARIA.ECE.CMU.EDU [128.2.216.38])
	by ece.cmu.edu (8.9.2/8.8.8) with ESMTP id NAA24895;
	Thu, 15 Jun 2000 13:57:55 -0400 (EDT)
Received: (from tov@localhost)
	by bavaria.ece.cmu.edu (8.9.3/8.9.3/Debian 8.9.3-21) id NAA03271;
	Thu, 15 Jun 2000 13:57:55 -0400
Sender: tov@bavaria.ece.cmu.edu
To: r-devel@stat.math.ethz.ch
Cc: R-bugs@biostat.ku.dk
Subject: Re: [Rd] eigen broken on AIX with R-devel? (PR#537)
References: <200005081600.SAA10511@pubhealth.ku.dk>
Reply-To: Thomas Vogels <tov@ece.cmu.edu>
X-URI: http://www.ece.cmu.edu/~tov
From: Thomas J Vogels <tov@ece.cmu.edu>
Date: 15 Jun 2000 13:57:55 -0400
In-Reply-To: tov@ece.cmu.edu's message of "Mon, 8 May 2000 18:00:52 +0200 (MET DST)"
Message-ID: <87vgzax1wc.fsf@bavaria.ece.cmu.edu>
Lines: 50
User-Agent: Gnus/5.0803 (Gnus v5.8.3) Emacs/20.6
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii


Hi, I ran the test again with the newly released version of R (1.1) and I
now get the correct eigen values.  ("make check" succeeds.)

The scary part is that I think that I also used gcc+f77 last time and
the libs weren't changed.  Maybe the scary part is that I think...

So the comments that this is compiler specific probably hold.

Thanks,
  -tom


tov@ece.cmu.edu writes:

> Hi,  I get the wrong eigen values on an AIX machine with R-devel of 5/3/00.
> 
> Here are the results:
> 
> R> m <- matrix (c(6.8, 2.4, 2.4, 8.2), nrow=2)
> R> m
>      [,1] [,2]
> [1,]  6.8  2.4
> [2,]  2.4  8.2
> R> eigen(m)
> $values
> [1] 19.281403  6.337993
> 
> $vectors
>           [,1]       [,2]
> [1,] 0.1918866  0.9967987
> [2,] 0.9967987 -0.1918866
> 
> 
> And for comparison, here is what I get on a Sun (with r-stable):

(same results now on AIX 4.3 with R 1.1.0 

> R> m <- matrix (c(6.8, 2.4, 2.4, 8.2), nrow=2)
> R> eigen (m)
> $values
> [1] 10  5
> 
> $vectors
>      [,1] [,2]
> [1,]  0.6  0.8
> [2,]  0.8 -0.6

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 534 *
Subject: wsfe bug report just made
From: mallen@tntech.edu
Date: Thu, 4 May 2000 19:20:35 +0200 (MET DST)
--follow up to PR#533
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 534 <==
From mallen@tntech.edu  Thu May  4 19:20:35 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA11074
	for <R-bugs@biostat.ku.dk>; Thu, 4 May 2000 19:20:35 +0200 (MET DST)
Date: Thu, 4 May 2000 19:20:35 +0200 (MET DST)
From: mallen@tntech.edu
Message-Id: <200005041720.TAA11074@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: wsfe bug report just made

Full_Name: Michael R. Allen
Version: 1.01
OS: linux redhat 6.2
Submission from: (NULL) (149.149.32.46)


Sorry, I forgot to tell you.  I am running version 6.2 of redhat.  Also, I have
loaded the latest version of R as well.

Mike

==> 534.audit <==
Thu May 18 18:06:31 2000	ripley	changed notes
Thu May 18 18:06:31 2000	ripley	moved from incoming to Add-ons
Wed Jun 07 15:09:34 2000	pd	moved from Add-ons to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  TooMuchAtOnce

* PR# 532 *
Subject: Bug report -- 1.0.1, HP-UX
From: Russ Lenth <russell-lenth@uiowa.edu>
Date: Wed, 03 May 2000 12:15:26 -0500
--1) is a user error.
--2) command-line history has no information
--3) help.start looks like a permissions problem. 
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 532 <==
From russell-lenth@uiowa.edu  Wed May  3 19:15:10 2000
Received: from ns-mx.uiowa.edu (ns-mx.uiowa.edu [128.255.56.78])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA27659
	for <r-bugs@biostat.ku.dk>; Wed, 3 May 2000 19:15:09 +0200 (MET DST)
Received: from uiowa.edu (dhcp80ff429a.dynamic.uiowa.edu [128.255.66.154])
	by ns-mx.uiowa.edu (8.9.3/8.9.1/ns-mx-1.7) with ESMTP id MAA48478
	for <r-bugs@biostat.ku.dk>; Wed, 3 May 2000 12:15:27 -0500
Message-ID: <39105EAE.38DCEB94@uiowa.edu>
Date: Wed, 03 May 2000 12:15:26 -0500
From: Russ Lenth <russell-lenth@uiowa.edu>
Organization: University of Iowa
X-Mailer: Mozilla 4.61 [en] (Win98; U)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs@biostat.ku.dk
Subject: Bug report -- 1.0.1, HP-UX
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Dear R folks,

Additional problem... bug.report() failed, so am sending it from another
mailer.  The file it generated is appended.

Thanks

Russ
-- 
Russell V. Lenth -- Department of Statistics & Actuarial Science
The University of Iowa -- Iowa City, IA 52242  USA
Tel (319)335-0814 -- FAX (319)335-3017
mailto:Russell-Lenth@uiowa.edu - http://www.stat.uiowa.edu/~rlenth/


===== R.bug.report =============================================
Hello,

We're experiencing problems with R 1.0.1 on the HP-UX system.
The most serious one is that the random-number generators don't work:

        R> runif(100)
        Error in runif(100) : .Random.seed[0] is not a valid Normal type

        R> .Random.seed
        [1] 18851  3338  2439

Is this a subscripting error?  Strange because building it on linux
works just fine.

Smaller errors I've noticed...  The command-line history doesn't work.
It was built by our computer-support people, and I think they had
trouble with the libraries for that.  (Contact is Ben Sherman,
bsherman@divms.uiowa.edu).  Also help.start() generates a bunch of
error messages:

R> help.start()
If netscape  is already running,        it is *not* restarted,
 and you must switch to its window.
Otherwise, be patient..
/usr/pkg/R/1.0.1/lib/R/bin/help.links[29]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[30]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[42]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[49]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[50]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.
/usr/pkg/R/1.0.1/lib/R/bin/help.links[53]:
/space/rlenth/.R/doc/html/packages.ht
ml: Cannot create the specified file.



Any idea what the problems are?

Thanks

Russ Lenth

--please do not edit the information below--

Version:
 platform = hppa1.1-hp-hpux10.20
 arch = hppa1.1
 os = hpux10.20
 system = hppa1.1, hpux10.20
 status = 
 major = 1
 minor = 0.1
 year = 2000
 month = April
 day = 14
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

==> 532.followup.1 <==
From ripley@stats.ox.ac.uk  Wed May  3 20:28:52 2000
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA27986
	for <R-bugs@biostat.ku.dk>; Wed, 3 May 2000 20:28:49 +0200 (MET DST)
Received: from max118.public.ox.ac.uk (max118.public.ox.ac.uk [192.76.27.118])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id TAA13192;
	Wed, 3 May 2000 19:28:59 +0100 (BST)
Date: Wed, 3 May 2000 19:27:57 +0100 (BST)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Sender: ripley@auk.stats
To: russell-lenth@uiowa.edu
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Bug report -- 1.0.1, HP-UX (PR#532)
In-Reply-To: <200005031715.TAA27669@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.10005031926360.24579-100000@auk.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Wed, 3 May 2000 russell-lenth@uiowa.edu wrote:

> Dear R folks,
> 
> Additional problem... bug.report() failed, so am sending it from another
> mailer.  The file it generated is appended.
> 
> Thanks
> 
> Russ
> -- 
> Russell V. Lenth -- Department of Statistics & Actuarial Science
> The University of Iowa -- Iowa City, IA 52242  USA
> Tel (319)335-0814 -- FAX (319)335-3017
> mailto:Russell-Lenth@uiowa.edu - http://www.stat.uiowa.edu/~rlenth/
> 
> 
> ===== R.bug.report =============================================
> Hello,
> 
> We're experiencing problems with R 1.0.1 on the HP-UX system.
> The most serious one is that the random-number generators don't work:
> 
>         R> runif(100)
>         Error in runif(100) : .Random.seed[0] is not a valid Normal type
> 
>         R> .Random.seed
>         [1] 18851  3338  2439
> 
> Is this a subscripting error?  Strange because building it on linux
> works just fine.

I think you've got a (very) old workspace being loaded there. Try starting
with R --vanilla to cross-check.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 532.audit <==
Thu May 11 10:16:22 2000	ripley	changed notes
Thu May 11 10:16:22 2000	ripley	moved from incoming to TooMuchAtOnce
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Windows

none

Directory:  incoming

* PR# 629 *
Subject: circles overshoot
From: Valerio Aimale <valerio.aimale@biosgroup.com>
Date: Wed, 9 Aug 2000 14:33:37 -0600 
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 629 <==
From valerio.aimale@biosgroup.com  Wed Aug  9 22:33:22 2000
Received: from davis.biosgroup.com (ftp.biosgroup.com [216.161.38.125])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA22488
	for <R-bugs@biostat.ku.dk>; Wed, 9 Aug 2000 22:33:21 +0200 (MET DST)
Received: by ftp.biosgroup.com with Internet Mail Service (5.5.2650.21)
	id <PTWCWSP7>; Wed, 9 Aug 2000 14:33:46 -0600
Message-ID: <CD62E40B9F85D3118C490060B08744EF6BE3A2@ftp.biosgroup.com>
From: Valerio Aimale <valerio.aimale@biosgroup.com>
To: r-devel@stat.math.ethz.ch
Cc: R-bugs@biostat.ku.dk
Subject: circles overshoot
Date: Wed, 9 Aug 2000 14:33:37 -0600 
MIME-Version: 1.0
X-Mailer: Internet Mail Service (5.5.2650.21)
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01C00241.18831EF0"

This message is in MIME format. Since your mail reader does not understand
this format, some or all of this message may not be legible.

------_=_NextPart_001_01C00241.18831EF0
Content-Type: text/plain;
	charset="iso-8859-1"


Anyone ever tried to

plot(c(1.0,0,2),c(1.0,0,2));
symbols(c(1.0),c(1.0),circles=(c(1.0)),inch=FALSE,add=TRUE); #?

Why does the circle overshoot ?

The problem is the same on all devices (even with my pictex, which needs a
lot of refurbishing), so I'd think it's something upstream to the devices
code. 

Thanks,

Valerio.

(R-1.1.0 on Linux)

---
Valerio Aimale
Scientist                       direct: 505.992.6741
Bios Group LP                     main: 505.992.6700
317 Paseo de Peralta               fax: 505.988.2229
Santa Fe, New Mexico 87501
USA 

------_=_NextPart_001_01C00241.18831EF0
Content-Type: text/html;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV=3D"Content-Type" CONTENT=3D"text/html; =
charset=3Diso-8859-1">
<META NAME=3D"Generator" CONTENT=3D"MS Exchange Server version =
5.5.2652.35">
<TITLE>circles overshoot</TITLE>
</HEAD>
<BODY>
<BR>

<P><FONT SIZE=3D2>Anyone ever tried to</FONT>
</P>

<P><FONT SIZE=3D2>plot(c(1.0,0,2),c(1.0,0,2));</FONT>
<BR><FONT =
SIZE=3D2>symbols(c(1.0),c(1.0),circles=3D(c(1.0)),inch=3DFALSE,add=3DTRU=
E); #?</FONT>
</P>

<P><FONT SIZE=3D2>Why does the circle overshoot ?</FONT>
</P>

<P><FONT SIZE=3D2>The problem is the same on all devices (even with my =
pictex, which needs a lot of refurbishing), so I'd think it's something =
upstream to the devices code. </FONT></P>

<P><FONT SIZE=3D2>Thanks,</FONT>
</P>

<P><FONT SIZE=3D2>Valerio.</FONT>
</P>

<P><FONT SIZE=3D2>(R-1.1.0 on Linux)</FONT>
</P>

<P><FONT SIZE=3D2>---</FONT>
<BR><FONT SIZE=3D2>Valerio Aimale</FONT>
<BR><FONT =
SIZE=3D2>Scientist&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp; direct: 505.992.6741</FONT>
<BR><FONT SIZE=3D2>Bios Group =
LP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; main: =
505.992.6700</FONT>
<BR><FONT SIZE=3D2>317 Paseo de =
Peralta&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp; fax: 505.988.2229</FONT>
<BR><FONT SIZE=3D2>Santa Fe, New Mexico 87501</FONT>
<BR><FONT SIZE=3D2>USA </FONT>
</P>

</BODY>
</HTML>
------_=_NextPart_001_01C00241.18831EF0--

==> 629.reply.1 <==
From pd@blueberry.kubism.ku.dk  Wed Aug  9 23:43:58 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA22660
	for <R-bugs@biostat.ku.dk>; Wed, 9 Aug 2000 23:43:58 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id XAA29753;
	Wed, 9 Aug 2000 23:46:20 +0200
Sender: pd@blueberry.kubism.ku.dk
To: valerio.aimale@biosgroup.com
Cc: R-bugs@biostat.ku.dk
Subject: Re: [Rd] circles overshoot (PR#629)
References: <200008092033.WAA22498@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 09 Aug 2000 23:46:20 +0200
In-Reply-To: valerio.aimale@biosgroup.com's message of "Wed, 9 Aug 2000 22:33:23 +0200 (MET DST)"
Message-ID: <x2snsem7kj.fsf@blueberry.kubism.ku.dk>
Lines: 32
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

valerio.aimale@biosgroup.com writes:

> Anyone ever tried to
> 
> plot(c(1.0,0,2),c(1.0,0,2));
> symbols(c(1.0),c(1.0),circles=(c(1.0)),inch=FALSE,add=TRUE); #?
> 
> Why does the circle overshoot ?
> 
> The problem is the same on all devices (even with my pictex, which needs a
> lot of refurbishing), so I'd think it's something upstream to the devices
> code. 

Because the *plotting region* is not square... Try resizing the plot
window and you'll see the effect quite clearly.

> <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
> <HTML>
....
> SIZE=3D2>Scientist&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
> &nbsp; direct: 505.992.6741</FONT>
> <BR><FONT SIZE=3D2>Bios Group =
> LP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=

Ahem. There are ways to turn that stuff off, you know....

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 628 *
Subject: Re: [Rd] predict.lm is broken in 1.1.0-patched (2000-August-7)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Mon, 7 Aug 2000 22:41:50 +0100 (BST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 628 <==
From ripley@stats.ox.ac.uk  Mon Aug  7 23:41:48 2000
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA03873;
	Mon, 7 Aug 2000 23:41:47 +0200 (MET DST)
Received: from max118.public.ox.ac.uk (max118.public.ox.ac.uk [192.76.27.118])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id WAA13377;
	Mon, 7 Aug 2000 22:42:04 +0100 (BST)
Date: Mon, 7 Aug 2000 22:41:50 +0100 (BST)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Sender: ripley@auk.stats
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
cc: thomas@biostat.washington.edu, r-devel@stat.math.ethz.ch,
        R-bugs@biostat.ku.dk
Subject: Re: [Rd] predict.lm is broken in 1.1.0-patched (2000-August-7)
 (PR#627)
In-Reply-To: <x2og34232n.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.05.10008072237330.18074-100000@auk.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On 7 Aug 2000, Peter Dalgaard BSA wrote:

> thomas@biostat.washington.edu writes:
> 
> > > > coef.aov
> > > function (object, ...) 
> > > {
> > >     z <- object$coef
> > >     z[!is.na(z)]
> > > }
> > > > coef.lm 
> > > function (object, ...) 
> > > object$coefficients
> > 
> > Ok, this explains it.  I *did* test it with a singular fit, but only with
> > lm(), not with aov().
> > 
> > coef.lm seems a more sensible convention, since it's a lot easy to remove
> > the NAs than to add them.
> 
> I've committed a fix for predict.lm to use object$coefficients
> directly, but I haven't done anything with the coef() methods.

As far as I recall coef.aov is different for easier compatibility with S
output: coef.lm is definitely not compatible.  I think there should
probably be a distinction between the raw information in the object and the
information given by the coef accessor function, and each has its place.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 627 *
Subject: Re: [Rd] predict.lm is broken in 1.1.0-patched (2000-August-7)
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Mon, 7 Aug 2000 12:58:22 -0700 (PDT)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 627 <==
From thomas@biostat.washington.edu  Mon Aug  7 21:58:17 2000
Received: from mail.biostat.washington.edu (mail.biostat.washington.edu [128.95.113.21])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA03501;
	Mon, 7 Aug 2000 21:58:16 +0200 (MET DST)
Received: from atlas (atlas [128.95.21.66])
	by mail.biostat.washington.edu (8.9.3+Sun/8.9.1-fetrow-2000-05-16a) with ESMTP id MAA26551;
	Mon, 7 Aug 2000 12:58:22 -0700 (PDT)
Date: Mon, 7 Aug 2000 12:58:22 -0700 (PDT)
From: Thomas Lumley <thomas@biostat.washington.edu>
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
cc: ripley@stats.ox.ac.uk, r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] predict.lm is broken in 1.1.0-patched (2000-August-7)
 (PR#626)
In-Reply-To: <x2n1iouavw.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.21.0008071248130.17749-100000@atlas.biostat.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On 7 Aug 2000, Peter Dalgaard BSA wrote:

> ripley@stats.ox.ac.uk writes:
> 
> > predict.lm has been broken by recent changes to the patched branch.
> > 
> > It fails for all singular fits.  An example:
<snip>
> Sometimes the fix for one bug uncovers another. We have
> 
> > coef.aov
> function (object, ...) 
> {
>     z <- object$coef
>     z[!is.na(z)]
> }
> > coef.lm 
> function (object, ...) 
> object$coefficients

Ok, this explains it.  I *did* test it with a singular fit, but only with
lm(), not with aov().

coef.lm seems a more sensible convention, since it's a lot easy to remove
the NAs than to add them.


	-thomas



==> 627.reply.1 <==
From pd@blueberry.kubism.ku.dk  Mon Aug  7 22:59:42 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA03686
	for <R-bugs@biostat.ku.dk>; Mon, 7 Aug 2000 22:59:41 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id XAA19788;
	Mon, 7 Aug 2000 23:06:56 +0200
Sender: pd@blueberry.kubism.ku.dk
To: thomas@biostat.washington.edu
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] predict.lm is broken in 1.1.0-patched (2000-August-7) (PR#627)
References: <200008071958.VAA03515@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 07 Aug 2000 23:06:56 +0200
In-Reply-To: thomas@biostat.washington.edu's message of "Mon, 7 Aug 2000 21:58:18 +0200 (MET DST)"
Message-ID: <x2og34232n.fsf@blueberry.kubism.ku.dk>
Lines: 26
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

thomas@biostat.washington.edu writes:

> > > coef.aov
> > function (object, ...) 
> > {
> >     z <- object$coef
> >     z[!is.na(z)]
> > }
> > > coef.lm 
> > function (object, ...) 
> > object$coefficients
> 
> Ok, this explains it.  I *did* test it with a singular fit, but only with
> lm(), not with aov().
> 
> coef.lm seems a more sensible convention, since it's a lot easy to remove
> the NAs than to add them.

I've committed a fix for predict.lm to use object$coefficients
directly, but I haven't done anything with the coef() methods.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 626 *
Subject: predict.lm is broken in 1.1.0-patched (2000-August-7)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Mon, 7 Aug 2000 19:43:38 +0100 (BST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 626 <==
From ripley@stats.ox.ac.uk  Mon Aug  7 20:43:37 2000
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA03226
	for <R-bugs@biostat.ku.dk>; Mon, 7 Aug 2000 20:43:37 +0200 (MET DST)
Received: from max143.public.ox.ac.uk (max143.public.ox.ac.uk [192.76.27.143])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id TAA13202
	for <R-bugs@biostat.ku.dk>; Mon, 7 Aug 2000 19:43:54 +0100 (BST)
Date: Mon, 7 Aug 2000 19:43:38 +0100 (BST)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Sender: ripley@auk.stats
To: R-bugs@biostat.ku.dk
Subject: predict.lm is broken in 1.1.0-patched (2000-August-7)
Message-ID: <Pine.GSO.4.05.10008071936440.15895-100000@auk.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

predict.lm has been broken by recent changes to the patched branch.

It fails for all singular fits.  An example:

library(MASS)
data(quine)
quine.hi <- aov(log(Days + 2.5) ~ .^4, quine)
quine.nxt <- update(quine.hi, . ~ . - Eth:Sex:Age:Lrn)
predict(quine.nxt)
  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20 
 NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA 
 21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40 
 NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA 
 41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60 
 NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA 
 61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80 
 NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA 
 81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 
 NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA 
101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 
 NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA 
121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 
 NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA 
141 142 143 144 145 146 
 NA  NA  NA  NA  NA  NA 

The answeer should be (e.g. R 1.1.0)

> predict(quine.nxt)
      1       2       3       4       5       6       7       8 
2.19247 2.19247 2.19247 2.68311 2.68311 2.68311 2.68311 2.68311 
      9      10      11      12      13      14      15      16 
2.37260 2.37260 2.37260 2.53960 2.53960 3.53516 3.53516 3.53516 
     17      18      19      20      21      22      23      24 
3.53516 3.24298 3.24298 3.24298 3.24298 3.24298 3.24298 3.24298 
     25      26      27      28      29      30      31      32 
3.31368 3.31368 3.31368 3.31368 3.31368 3.31368 3.31368 2.03746 
...

I believe this is a lot worse than that which the changes were intended to
fix. (Are we not supposed to be ultra-cautious about not making things
worse in that branch?)

--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.6
 arch = sparc
 os = solaris2.6
 system = sparc, solaris2.6
status   Patched             
major    1                   
minor    1.0                 
year     2000                
month    August              
day      7                   
language R                   

Search Path:
 .GlobalEnv, Autoloads, package:base

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 626.reply.1 <==
From pd@blueberry.kubism.ku.dk  Mon Aug  7 21:23:28 2000
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA03363
	for <R-bugs@biostat.ku.dk>; Mon, 7 Aug 2000 21:23:27 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id VAA19717;
	Mon, 7 Aug 2000 21:30:43 +0200
Sender: pd@blueberry.kubism.ku.dk
To: ripley@stats.ox.ac.uk
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] predict.lm is broken in 1.1.0-patched (2000-August-7) (PR#626)
References: <200008071843.UAA03236@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 07 Aug 2000 21:30:43 +0200
In-Reply-To: ripley@stats.ox.ac.uk's message of "Mon, 7 Aug 2000 20:43:38 +0200 (MET DST)"
Message-ID: <x2n1iouavw.fsf@blueberry.kubism.ku.dk>
Lines: 40
X-Mailer: Gnus v5.7/Emacs 20.5
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

ripley@stats.ox.ac.uk writes:

> predict.lm has been broken by recent changes to the patched branch.
> 
> It fails for all singular fits.  An example:
> 
> library(MASS)
> data(quine)
> quine.hi <- aov(log(Days + 2.5) ~ .^4, quine)
> quine.nxt <- update(quine.hi, . ~ . - Eth:Sex:Age:Lrn)
> predict(quine.nxt)
>   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20 
>  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA 
...
> I believe this is a lot worse than that which the changes were intended to
> fix. (Are we not supposed to be ultra-cautious about not making things
> worse in that branch?)

Sometimes the fix for one bug uncovers another. We have

> coef.aov
function (object, ...) 
{
    z <- object$coef
    z[!is.na(z)]
}
> coef.lm 
function (object, ...) 
object$coefficients

and both of these cannot be right when predict.lm calls coef(object)
and object$coefficients contains NA's. Using object$coefficients
inside predict.lm fixes things, but I'm still not happy with the two
different conventions for coef...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
