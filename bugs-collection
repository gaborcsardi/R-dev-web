=================================================
This is an automated collection of open reports in
the R-bugs repository.
=================================================

Directory:  Accuracy

* PR# 1218 *
Subject:  behavior of r* and d* functions at boundaries 
From: Ben Bolker <bolker@zoo.ufl.edu>
Date: Mon, 17 Dec 2001 11:04:27 -0500
--points 1 and 2 were fixed for 1.4.0
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1218 <==
From postmaster@franz.stat.wisc.edu  Mon Dec 17 16:58:24 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA07768
	for <r-bugs@biostat.ku.dk>; Mon, 17 Dec 2001 16:58:23 +0100 (MET)
Received: from triarch.zoo.ufl.edu (really [128.227.60.248]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m16G09O-000IXfC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Mon, 17 Dec 2001 09:57:58 -0600 (CST) 
Received: from bolker.zoo.ufl.edu ([10.227.60.45]) by triarch.zoo.ufl.edu
          (Netscape Messaging Server 3.5)  with ESMTP id 345;
          Mon, 17 Dec 2001 10:57:53 -0500
Received: (from ben@localhost)
	by bolker.zoo.ufl.edu (8.11.0/8.11.0) id fBHG4RA31551;
	Mon, 17 Dec 2001 11:04:27 -0500
Date: Mon, 17 Dec 2001 11:04:27 -0500
From: Ben Bolker <bolker@zoo.ufl.edu>
Message-Id: <200112171604.fBHG4RA31551@bolker.zoo.ufl.edu>
To: r-bugs@r-project.org
Subject:  behavior of r* and d* functions at boundaries 
Cc: ben@bolker.zoo.ufl.edu


  (Sent this to r-help back in October, got no comments, forgot
to re-submit it as a bug report.)

There are a few inconsistencies, at least, in some of the functions that 
generate random deviates from particular distributions (I think they're 
bugs because they're inconvenient, but maybe someone can make an argument 
for the current behavior). If people think these are really bugs I can 
submit them, together or separately. 

1. rlnorm(n,mean,sd) gives NaN for sd=0, rather than always returning 
the mean. This is inconsistent with rnorm(), which returns the mean. 

2. rnbinom(n,prob,size) gives NaN when prob=1; always returning 0 would be 
reasonable, and consistent with the output of dnbinom(). [This is 
equivalent to rnbinom(n,mu=0,size) in the new parameterization.] 

3. rgamma(n,shape,scale) happily returns 0 when shape=0 or scale=0. However, 
dgamma(x,shape=0) [and pgamma(x,shape=0)] gives NaN. This behavior is 
actually convenient for me, but I could make an argument for returning a 
warning in this case. 

  In general, I don't know what (e.g.) dnorm(m,mean=m,sd=0)
should return: NaN (as at present) or Inf?  I guess it depends
how fussy you're being and how you're taking limits.

  The fixes seem straightforward. 

  Ben Bolker 

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = 
 major = 1
 minor = 3.1
 year = 2001
 month = 08
 day = 31
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base

==> 1218.reply.1 <==
From maechler@stat.math.ethz.ch  Tue Dec 18 14:52:16 2001
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id OAA19153
	for <R-bugs@biostat.ku.dk>; Tue, 18 Dec 2001 14:52:16 +0100 (MET)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id OAA29011;
	Tue, 18 Dec 2001 14:50:57 +0100 (MET)
Received: from lynne(129.132.58.30), claiming to be "lynne.ethz.ch"
 via SMTP by hypatia, id smtpdAAAa0075G; Tue Dec 18 14:50:51 2001
Received: (from maechler@localhost)
	by lynne.ethz.ch (8.11.6/8.11.2) id fBIDp5614463;
	Tue, 18 Dec 2001 14:51:05 +0100
From: Martin Maechler <maechler@stat.math.ethz.ch>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15391.18888.225046.355632@gargle.gargle.HOWL>
Date: Tue, 18 Dec 2001 14:51:04 +0100
To: bolker@zoo.ufl.edu
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] behavior of r* and d* functions at boundaries (PR#1218)
In-Reply-To: <200112171558.QAA07778@pubhealth.ku.dk>
References: <200112171558.QAA07778@pubhealth.ku.dk>
X-Mailer: VM 6.97 under Emacs 21.1.1
Reply-To: Martin Maechler <maechler@stat.math.ethz.ch>

>>>>> "Ben" == Ben Bolker <bolker@zoo.ufl.edu> writes:

    Ben>   (Sent this to r-help back in October, got no
    Ben> comments, forgot to re-submit it as a bug report.)

    Ben> There are a few inconsistencies, at least, in some of
    Ben> the functions that generate random deviates from
    Ben> particular distributions (I think they're bugs because
    Ben> they're inconvenient, but maybe someone can make an
    Ben> argument for the current behavior). If people think
    Ben> these are really bugs I can submit them, together or
    Ben> separately.

    Ben> 1. rlnorm(n,mean,sd) gives NaN for sd=0, rather than
    Ben> always returning the mean. This is inconsistent with
    Ben> rnorm(), which returns the mean.

    Ben> 2. rnbinom(n,prob,size) gives NaN when prob=1; always
    Ben> returning 0 would be reasonable, and consistent with
    Ben> the output of dnbinom(). [This is equivalent to
    Ben> rnbinom(n,mu=0,size) in the new parameterization.]

these two above are fixed for 1.4

    Ben> 3. rgamma(n,shape,scale) happily returns 0 when shape=0
    Ben> or scale=0. However, dgamma(x,shape=0) [and
    Ben> pgamma(x,shape=0)] gives NaN. This behavior is actually
    Ben> convenient for me, but I could make an argument for
    Ben> returning a warning in this case.

    Ben>   In general, I don't know what (e.g.)
    Ben> dnorm(m,mean=m,sd=0) should return: NaN (as at present)
    Ben> or Inf?

    Ben> I guess it depends how fussy you're being and how
    Ben> you're taking limits.

My approach would be to always return the limit if it's well
defined (as here).  
For any random variate X, when Var(X) = 0, r<dist>()  should
return E(X) (if that is defined) I think.  
This would mean that rgamma() is fine and dnorm() could be
improved.  
dgamma(0,shape=0) should give Inf as well and pgamma(0,shape=0) |-> 1.
The fact that pnorm(mu, mu, sd = 0) currently gives NaN instead
of 1 is a bug IMO.

Another line of reasoning could be that "shape=0" (or less
clearly "sd = 0") are not allowed (as per ?rgamma), and giving
NaN would reflect this.  I'm not share this view
but leave all this for after release.

    Ben>   The fixes seem straightforward.
(yes, at least for 1) and 2))

Thank you, Ben, for reporting these!

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

==> 1218.audit <==
Mon Dec 17 21:00:39 2001	ripley	moved from incoming to Accuracy
Fri Dec 21 06:38:21 2001	ripley	changed notes
Fri Dec 21 06:38:21 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1228 *
Subject: bug with var(rep(1e30, 3))
From: Emmanuel Paradis <paradis@isem.univ-montp2.fr>
Date: Wed, 26 Dec 2001 13:03:31 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1228 <==
From postmaster@franz.stat.wisc.edu  Wed Dec 26 13:07:55 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id NAA13232
	for <r-bugs@biostat.ku.dk>; Wed, 26 Dec 2001 13:07:55 +0100 (MET)
Received: from isem.isem.univ-montp2.fr (really [162.38.183.200]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m16JCqF-000IZvC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Wed, 26 Dec 2001 06:07:27 -0600 (CST) 
Received: from diversi (diversi.isem.univ-montp2.fr [162.38.183.45])
	by isem.isem.univ-montp2.fr (8.9.1b+Sun/8.9.1) with SMTP id MAA19343
	for <r-bugs@r-project.org>; Wed, 26 Dec 2001 12:58:33 +0100 (MET)
Message-Id: <3.0.32.20011226130330.00910b80@162.38.183.200>
X-Sender: paradis@162.38.183.200
X-Mailer: Windows Eudora Pro Version 3.0 (32)
Date: Wed, 26 Dec 2001 13:03:31 +0100
To: r-bugs@r-project.org
From: Emmanuel Paradis <paradis@isem.univ-montp2.fr>
Subject: bug with var(rep(1e30, 3))
Mime-Version: 1.0
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: 8bit
X-MIME-Autoconverted: from quoted-printable to 8bit by pubhealth.ku.dk id NAA13232

There seems to be a bug with var() when the argument is a vector with
exactly three values of 1e30 (or close to this value). This does not happen
with twice, four (or more) times this value, or another value.


> var(rep(1e30, 3))
[1] 2.971056e+28
> var(rep(1.2e30, 3))
[1] 2.971056e+28
> var(rep(0.9e30, 3))
[1] 2.971056e+28
> var(rep(0.8e30, 3))
[1] 0
> var(rep(1e29, 3))
[1] 0
> var(rep(1e30, 2))
[1] 0
> var(rep(1e30, 4))
[1] 0
> var(rep(1e31, 3))
[1] 0


The bug is repeatable, and I got the same results with R 1.3.1 (binary from
CRAN) and R 1.4.0 (binary from BD Ripley's site) both on Windows NT, and R
1.4.0 on Solaris (compiled from sources).



Emmanuel Paradis
Laboratoire de Paléontologie
Institut des Sciences de l'Évolution
Université Montpellier II
F-34095 Montpellier cédex 05
France
   phone: +33  4 67 14 39 64
     fax: +33  4 67 14 36 10
  mailto:paradis@isem.univ-montp2.fr

==> 1228.reply.1 <==
From p.dalgaard@biostat.ku.dk  Wed Dec 26 15:32:38 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA13516;
	Wed, 26 Dec 2001 15:32:38 +0100 (MET)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id fBQEVRP24017;
	Wed, 26 Dec 2001 15:31:27 +0100
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: paradis@isem.univ-montp2.fr
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] bug with var(rep(1e30, 3)) (PR#1228)
References: <200112261207.NAA13242@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 26 Dec 2001 15:31:27 +0100
In-Reply-To: <200112261207.NAA13242@pubhealth.ku.dk>
Message-ID: <x2heqet5mo.fsf@blueberry.kubism.ku.dk>
Lines: 56
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

paradis@isem.univ-montp2.fr writes:

> There seems to be a bug with var() when the argument is a vector with
> exactly three values of 1e30 (or close to this value). This does not happen
> with twice, four (or more) times this value, or another value.
> 
> 
> > var(rep(1e30, 3))
> [1] 2.971056e+28
> > var(rep(1.2e30, 3))
> [1] 2.971056e+28
> > var(rep(0.9e30, 3))
> [1] 2.971056e+28
> > var(rep(0.8e30, 3))
> [1] 0
> > var(rep(1e29, 3))
> [1] 0
> > var(rep(1e30, 2))
> [1] 0
> > var(rep(1e30, 4))
> [1] 0
> > var(rep(1e31, 3))
> [1] 0
> 
> 
> The bug is repeatable, and I got the same results with R 1.3.1 (binary from
> CRAN) and R 1.4.0 (binary from BD Ripley's site) both on Windows NT, and R
> 1.4.0 on Solaris (compiled from sources).

Not a bug, roundoff:

> (1e30+1e30+1e30)/3-1e30
[1] 1.407375e+14
> 3*((1e30+1e30+1e30)/3-1e30)^2/2
[1] 2.971056e+28

Relative errors of the order 1e-16 are completely expectable in
floating point arithmetic.

For illustration, look at it in octal, after removing a bunch of
trailing zeroes:

> x<-1e30/(8^16)
> structure(x, class="octmode")
[1] "144762623464043165"
> structure(x+x+x, class="octmode")
[1] "456730272634151540"

If you look carefully, you will see that a bit is lost in the process
since 5+5+5 is 17 octal.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1228.followup.1 <==
From ripley@stats.ox.ac.uk  Wed Dec 26 16:52:52 2001
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA13677;
	Wed, 26 Dec 2001 16:52:51 +0100 (MET)
Received: from gannet.stats (IDENT:root@gannet.stats [163.1.20.127])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id PAA29226;
	Wed, 26 Dec 2001 15:52:25 GMT
Received: from localhost (ripley@localhost)
	by gannet.stats (8.11.3/8.11.3) with ESMTP id fBQFqPg12750;
	Wed, 26 Dec 2001 15:52:25 GMT
X-Authentication-Warning: gannet.stats: ripley owned process doing -bs
Date: Wed, 26 Dec 2001 15:52:25 +0000 (GMT)
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
X-X-Sender:  <ripley@gannet.stats>
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
cc: <paradis@isem.univ-montp2.fr>, <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] bug with var(rep(1e30, 3)) (PR#1228)
In-Reply-To: <x2heqet5mo.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.LNX.4.31.0112261550130.12728-100000@gannet.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

But there are better algorithms that are not subject to this sort
of rounding error.

I reckon that computing a variance this way is not the quality of
algorithm one should expect from R.

On 26 Dec 2001, Peter Dalgaard BSA wrote:

> paradis@isem.univ-montp2.fr writes:
>
> > There seems to be a bug with var() when the argument is a vector with
> > exactly three values of 1e30 (or close to this value). This does not happen
> > with twice, four (or more) times this value, or another value.
> >
> >
> > > var(rep(1e30, 3))
> > [1] 2.971056e+28
> > > var(rep(1.2e30, 3))
> > [1] 2.971056e+28
> > > var(rep(0.9e30, 3))
> > [1] 2.971056e+28
> > > var(rep(0.8e30, 3))
> > [1] 0
> > > var(rep(1e29, 3))
> > [1] 0
> > > var(rep(1e30, 2))
> > [1] 0
> > > var(rep(1e30, 4))
> > [1] 0
> > > var(rep(1e31, 3))
> > [1] 0
> >
> >
> > The bug is repeatable, and I got the same results with R 1.3.1 (binary from
> > CRAN) and R 1.4.0 (binary from BD Ripley's site) both on Windows NT, and R
> > 1.4.0 on Solaris (compiled from sources).
>
> Not a bug, roundoff:
>
> > (1e30+1e30+1e30)/3-1e30
> [1] 1.407375e+14
> > 3*((1e30+1e30+1e30)/3-1e30)^2/2
> [1] 2.971056e+28
>
> Relative errors of the order 1e-16 are completely expectable in
> floating point arithmetic.
>
> For illustration, look at it in octal, after removing a bunch of
> trailing zeroes:
>
> > x<-1e30/(8^16)
> > structure(x, class="octmode")
> [1] "144762623464043165"
> > structure(x+x+x, class="octmode")
> [1] "456730272634151540"
>
> If you look carefully, you will see that a bit is lost in the process
> since 5+5+5 is 17 octal.
>
> --
>    O__  ---- Peter Dalgaard             Blegdamsvej 3
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 1228.reply.2 <==
From p.dalgaard@biostat.ku.dk  Wed Dec 26 18:01:10 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA13867;
	Wed, 26 Dec 2001 18:01:10 +0100 (MET)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id fBQGxxE24151;
	Wed, 26 Dec 2001 17:59:59 +0100
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Cc: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>,
        <paradis@isem.univ-montp2.fr>, <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] bug with var(rep(1e30, 3)) (PR#1228)
References: <Pine.LNX.4.31.0112261550130.12728-100000@gannet.stats>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 26 Dec 2001 17:59:59 +0100
In-Reply-To: <Pine.LNX.4.31.0112261550130.12728-100000@gannet.stats>
Message-ID: <x2vgetrk6o.fsf@blueberry.kubism.ku.dk>
Lines: 33
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> But there are better algorithms that are not subject to this sort
> of rounding error.
> 
> I reckon that computing a variance this way is not the quality of
> algorithm one should expect from R.

Hmm. Which algorithms are there? Surely almost any kind of provisional
means subtraction could avoid the the extreme case where the mean of a
bunch of identical numbers is different from all of them, but will it
also improve precision in the general case?

Essentially our current algorithm in cov.c is

xm<- sum(x)/n
v <- 1/(n-1)*sum((x-xm)^2)

> > > x<-1e30/(8^16)
> > > structure(x, class="octmode")
> > [1] "144762623464043165"
> > > structure(x+x+x, class="octmode")
> > [1] "456730272634151540"
> >
> > If you look carefully, you will see that a bit is lost in the process
> > since 5+5+5 is 17 octal.


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1228.audit <==
Fri Dec 28 20:08:08 2001	thomas	moved from incoming to Accuracy
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1244 *
Subject: possible bug in det using method="qr"
From: armin@approximity.com
Date: Sat, 5 Jan 2002 01:48:13 +0100 (MET)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1244 <==
From armin@approximity.com  Sat Jan  5 01:48:24 2002
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA12646
	for <R-bugs@biostat.ku.dk>; Sat, 5 Jan 2002 01:48:13 +0100 (MET)
Date: Sat, 5 Jan 2002 01:48:13 +0100 (MET)
From: armin@approximity.com
Message-Id: <200201050048.BAA12646@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: possible bug in det using method="qr"

Full_Name: Armin Roehrl
Version: 1.4.0(2001-12-19)
OS: Linux; Suse 7.3
Submission from: (NULL) (217.84.18.204)


Hello,

On a given matrix det returns different results whether
I use the method "qr" or "eivenvalues".

The matrix:
> m2
             [,1]         [,2]        [,3]
[1,] 9.822616e+09 3.841723e+09    79790.09
[2,] 3.841723e+09 1.502536e+09    31251.82
[3,] 7.979009e+04 3.125182e+04 64156419.36

> det(m2, method="eigenvalues")
[1] -9.331893e+19


> det(m2, method="qr")
[1] 9.331893e+19

I think the result based on the eigenvalues is correct.

Good night.
	Armin

==> 1244.reply.1 <==
From p.dalgaard@biostat.ku.dk  Sat Jan  5 03:10:18 2002
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id DAA12779;
	Sat, 5 Jan 2002 03:10:18 +0100 (MET)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id g052AFo18131;
	Sat, 5 Jan 2002 03:10:15 +0100
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: armin@approximity.com
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] possible bug in det using method="qr" (PR#1244)
References: <200201050048.BAA12656@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 05 Jan 2002 03:10:15 +0100
In-Reply-To: <200201050048.BAA12656@pubhealth.ku.dk>
Message-ID: <x2itahtuns.fsf@blueberry.kubism.ku.dk>
Lines: 47
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

armin@approximity.com writes:

> Full_Name: Armin Roehrl
> Version: 1.4.0(2001-12-19)
> OS: Linux; Suse 7.3
> Submission from: (NULL) (217.84.18.204)
> 
> 
> Hello,
> 
> On a given matrix det returns different results whether
> I use the method "qr" or "eivenvalues".
> 
> The matrix:
> > m2
>              [,1]         [,2]        [,3]
> [1,] 9.822616e+09 3.841723e+09    79790.09
> [2,] 3.841723e+09 1.502536e+09    31251.82
> [3,] 7.979009e+04 3.125182e+04 64156419.36

That format is a bit awkward to key back in. Could you do a dput(m2)
so that it becomes easier for us to reproduce the effect?

> > det(m2, method="eigenvalues")
> [1] -9.331893e+19
> 
> 
> > det(m2, method="qr")
> [1] 9.331893e+19
> 
> I think the result based on the eigenvalues is correct.
> 
> Good night.
> 	Armin
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
> 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1244.followup.1 <==
From armin@approximity.com  Sat Jan  5 10:51:14 2002
Received: from approximity.com (IDENT:root@[12.104.71.75])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id KAA13562;
	Sat, 5 Jan 2002 10:51:13 +0100 (MET)
Received: from there (pD95412CC.dip.t-dialin.net [217.84.18.204])
	by approximity.com (8.11.3/8.11.3) with SMTP id g05AkWW29240;
	Sat, 5 Jan 2002 02:46:32 -0800
Message-Id: <200201051046.g05AkWW29240@approximity.com>
Content-Type: text/plain;
  charset="iso-8859-1"
From: Armin Roehrl <armin@approximity.com>
Organization: Approximity
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Subject: Re: [Rd] possible bug in det using method="qr" (PR#1244)
Date: Sat, 5 Jan 2002 10:50:25 +0100
X-Mailer: KMail [version 1.3.1]
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
References: <200201050048.BAA12656@pubhealth.ku.dk> <x2itahtuns.fsf@blueberry.kubism.ku.dk>
In-Reply-To: <x2itahtuns.fsf@blueberry.kubism.ku.dk>
MIME-Version: 1.0
Content-Transfer-Encoding: 8bit

Good morning,

>dput(m2)
structure(c(9822616000, 3841723000, 79790.09, 3841723000, 1502536000, 
31251.82, 79790.09, 31251.82, 64156419.36), .Dim = c(3, 3))

> det(m2, method="eigenvalues")
[1] -9.331893e+19
> det(m2, method="qr")
[1] 9.331893e+19

I hope it's not just some numerical accuracy thing and therefore
wasting your time.

Thx,
	Armin

On Saturday 05 January 2002 03:10, Peter Dalgaard BSA wrote:
> 64156419.36

-- 
Armin.

-----------------------------------------------
Armin Roehrl, http://www.approximity.com

==> 1244.reply.2 <==
From p.dalgaard@biostat.ku.dk  Sat Jan  5 12:46:02 2002
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id MAA13875;
	Sat, 5 Jan 2002 12:46:01 +0100 (MET)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id g05BjtI18454;
	Sat, 5 Jan 2002 12:45:55 +0100
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: Armin Roehrl <armin@approximity.com>
Cc: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>, r-devel@stat.math.ethz.ch,
        R-bugs@biostat.ku.dk
Subject: Re: [Rd] possible bug in det using method="qr" (PR#1244)
References: <200201050048.BAA12656@pubhealth.ku.dk>
	<x2itahtuns.fsf@blueberry.kubism.ku.dk>
	<200201051046.g05AkWW29240@approximity.com>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 05 Jan 2002 12:45:55 +0100
In-Reply-To: <200201051046.g05AkWW29240@approximity.com>
Message-ID: <x2heq110ng.fsf@blueberry.kubism.ku.dk>
Lines: 34
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Armin Roehrl <armin@approximity.com> writes:

> Good morning,
> 
> >dput(m2)
> structure(c(9822616000, 3841723000, 79790.09, 3841723000, 1502536000, 
> 31251.82, 79790.09, 31251.82, 64156419.36), .Dim = c(3, 3))
> 
> > det(m2, method="eigenvalues")
> [1] -9.331893e+19
> > det(m2, method="qr")
> [1] 9.331893e+19
> 
> I hope it's not just some numerical accuracy thing and therefore
> wasting your time.

It's a numerical accuracy thing, but not a waste of time. The issue
is that qr() thinks that the matrix is singular:

> prod(diag(qr(m,tol=1e-9)$qr))
[1] -9.331893e+19
> prod(diag(qr(m)$qr))
[1] 9.331893e+19

Two issues here: 
(a) if qr() thinks a matrix is singular, I think det() should take the
consequences and return zero.
(b) Perhaps there ought to be a way to pass the tol= argument to det. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1244.audit <==
Mon Jan  7 10:32:21 2002	ripley	moved from incoming to Accuracy
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Add-ons

* PR# 974 *
Subject: Lattice: panel.superpose with ordered factor groups
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Sat, 9 Jun 2001 11:08:51 +1000 (EST)
--The warning is standard S and R behaviour.
--Probably xyplot needs to avoid it (by unclassing?)
--Still there in lattice 0.3-0.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 974 <==
From postmaster@franz.stat.wisc.edu  Sat Jun  9 03:09:10 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id DAA20814
	for <r-bugs@biostat.ku.dk>; Sat, 9 Jun 2001 03:09:09 +0200 (MET DST)
Received: from leonard.anu.edu.au (really [150.203.2.15]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m158XFN-000JbdC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Fri, 8 Jun 2001 20:09:01 -0500 (CDT) 
Received: (from u9801539@localhost)
	by leonard.anu.edu.au (8.9.3/8.9.3) id LAA01081;
	Sat, 9 Jun 2001 11:08:51 +1000 (EST)
Date: Sat, 9 Jun 2001 11:08:51 +1000 (EST)
From: John Maindonald <john.maindonald@anu.edu.au>
Message-Id: <200106090108.LAA01081@leonard.anu.edu.au>
To: r-bugs@r-project.org
Subject: Lattice: panel.superpose with ordered factor groups
Cc: deepayan@stat.wisc.edu


#       r-bugs@r-project.org
The panel.superpose() function for xyplot() complains when 
the groups parameter is set to be an ordered factor.

> library(mass)
> data(cabbages)
> library(lattice)
> xyplot(HeadWt~VitC|Cult, panel=panel.superpose,
+   groups=Date, data=cabbages)
> cabbages$Date <- ordered(cabbages$Date)  # Make Date an ordered factor
> xyplot(HeadWt~VitC|Cult, panel=panel.superpose,
+   groups=Date, data=cabbages)
Warning messages: 
1: Incompatible methods ("Ops.ordered", "Ops.factor") for "==" 
2: Incompatible methods ("Ops.ordered", "Ops.factor") for "==" 
3: Incompatible methods ("Ops.ordered", "Ops.factor") for "==" 
4: Incompatible methods ("Ops.ordered", "Ops.factor") for "==" 
5: Incompatible methods ("Ops.ordered", "Ops.factor") for "==" 
6: Incompatible methods ("Ops.ordered", "Ops.factor") for "==" 

--please do not edit the information below--

Version:
 platform = i386-pc-mingw32
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 major = 1
 minor = 2.3
 year = 2001
 month = 04
 day = 26
 language = R

Windows ME 4.90 (build 3000)  

Search Path:
 .GlobalEnv, package:grid, package:lattice, package:mass, package:ctest, Autoloads, package:base
John Maindonald            email: john.maindonald@anu.edu.au        
phone : (6125)3998         fax   : (6125)5549 
Statistical Consulting Unit, Room 1194,
John Dedman Mathematical Sciences Building
(Centre for Mathematics & Its Applications.)

==> 974.audit <==
Sun Jun 17 09:39:36 2001	ripley	changed notes
Sun Jun 17 09:39:36 2001	ripley	foobar
Sun Jun 17 09:39:36 2001	ripley	moved from incoming to Add-ons
Sun Sep 30 15:13:56 2001	ripley	changed notes
Sun Sep 30 15:13:56 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1038 *
Subject: nlme: bug in getCovariateFormula
From: Setzer.Woodrow@epamail.epa.gov
Date: Tue, 31 Jul 2001 11:24:09 -0400
--change needed in package nlme
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1038 <==
From Setzer.Woodrow@epamail.epa.gov  Tue Jul 31 17:47:13 2001
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA10358
	for <R-bugs@biostat.ku.dk>; Tue, 31 Jul 2001 17:47:12 +0200 (MET DST)
From: Setzer.Woodrow@epamail.epa.gov
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id RAA29279
	for <r-bugs@lists.r-project.org>; Tue, 31 Jul 2001 17:47:07 +0200 (MET DST)
Received: from marconi.rtp.epa.gov(134.67.208.99)
 via SMTP by hypatia, id smtpdAAAa0079S; Tue Jul 31 17:47:02 2001
Received: from epahub11.rtp.epa.gov (epahub11.rtp.epa.gov [134.67.213.52])
 by epamail.epa.gov (PMDF V5.2-33 #42056)
 with ESMTP id <0GHC004FLGOB26@epamail.epa.gov> for r-bugs@lists.r-project.org;
 Tue, 31 Jul 2001 11:40:58 -0400 (EDT)
Date: Tue, 31 Jul 2001 11:24:09 -0400
Subject: nlme: bug in getCovariateFormula
To: r-bugs@hypatia.math.ethz.ch
Message-id: <OF64B799E7.BEBD283E-ON85256A9A.0052DE38@rtp.epa.gov>
MIME-version: 1.0
X-Mailer: Lotus Notes Release 5.0.3  March 21, 2000
Content-type: text/plain; charset=us-ascii
X-MIMETrack: Serialize by Router on EPAHUB11/USEPA/US(Release 5.0.6a |January
 17, 2001) at 07/31/2001 11:40:58 AM

I found that predict.gnls failed with a wierd error message about a
non-numeric argument to a binary vector in one of three nearly identical
uses.

Error in Inh/Ki : non-numeric argument to binary operator

(Inh and Ki are arguments to the function used in the formula for the
object whose predictions were requested).

It turns out that the problem is in getCovariateFormula().

The final line in getCovariateFormula() in the nlme package (version
3.1-16) is:
    eval(parse(text = paste("~", deparse(form))))

however, if deparse(form) exceeds 'width.cutoff (which defaults to 60)',
this results in inappropriately placed "~" signs:
For example, in my application with the error, form is

UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, Ki)

the result of the paste() operation in the last line of getCovariateFormula
is:

> paste("~",deparse(form))
[1] "~ UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, "
[2] "~     Ki)"

extending width.cutoff gives the intended value:

> paste("~",deparse(form,width.cutoff=500))
[1] "~ UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, Ki)"

Seems a bit risky for an enforced cutoff in deparse, though.

R. Woodrow Setzer, Jr.                                            Phone:
(919) 541-0128
Experimental Toxicology Division                       Fax:  (919) 541-5394
Pharmacokinetics Branch
NHEERL MD-74; US EPA; RTP, NC 27711


==> 1038.reply.1 <==
From pd@blueberry.kubism.ku.dk  Tue Jul 31 18:12:16 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA10513;
	Tue, 31 Jul 2001 18:12:16 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id SAA26023;
	Tue, 31 Jul 2001 18:21:47 +0200
Sender: pd@pubhealth.ku.dk
To: Setzer.Woodrow@epamail.epa.gov
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] nlme: bug in getCovariateFormula (PR#1038)
References: <200107311547.RAA10368@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 31 Jul 2001 18:21:46 +0200
In-Reply-To: Setzer.Woodrow@epamail.epa.gov's message of "Tue, 31 Jul 2001 17:47:14 +0200 (MET DST)"
Message-ID: <x2d76h6pd1.fsf@blueberry.kubism.ku.dk>
Lines: 50
X-Mailer: Gnus v5.7/Emacs 20.7
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

Setzer.Woodrow@epamail.epa.gov writes:

> The final line in getCovariateFormula() in the nlme package (version
> 3.1-16) is:
>     eval(parse(text = paste("~", deparse(form))))
> 
> however, if deparse(form) exceeds 'width.cutoff (which defaults to 60)',
> this results in inappropriately placed "~" signs:
> For example, in my application with the error, form is
> 
> UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, Ki)
> 
> the result of the paste() operation in the last line of getCovariateFormula
> is:
> 
> > paste("~",deparse(form))
> [1] "~ UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, "
> [2] "~     Ki)"
> 
> extending width.cutoff gives the intended value:
> 
> > paste("~",deparse(form,width.cutoff=500))
> [1] "~ UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, Ki)"
> 
> Seems a bit risky for an enforced cutoff in deparse, though.

parse(...deparse(...)) always looks wrong to me anyway. Couldn't one
use something like

f <- ~1
f[[2]] <- form
eval(f)

or 

eval(as.call(list(as.name("~"),form)))

or

eval(substitute(~form)) # that's not going to work in S, though...

??

(What is the eval for? Doesn't usually do anything to a
formula argument.)
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1038.reply.2 <==
From bates@stat.wisc.edu  Tue Jul 31 21:17:07 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA11163;
	Tue, 31 Jul 2001 21:17:06 +0200 (MET DST)
Received: by franz.stat.wisc.edu
	via sendmail from stdin
	id <m15RegF-000JP1C@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for R-bugs@biostat.ku.dk; Tue, 31 Jul 2001 13:55:47 -0500 (CDT) 
Sender: bates@franz.stat.wisc.edu
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Cc: Setzer.Woodrow@epamail.epa.gov, r-devel@stat.math.ethz.ch,
        R-bugs@biostat.ku.dk
Subject: Re: [Rd] nlme: bug in getCovariateFormula (PR#1038)
References: <200107311547.RAA10368@pubhealth.ku.dk>
	<x2d76h6pd1.fsf@blueberry.kubism.ku.dk>
From: Douglas Bates <bates@stat.wisc.edu>
Date: 31 Jul 2001 13:55:47 -0500
In-Reply-To: <x2d76h6pd1.fsf@blueberry.kubism.ku.dk>
Message-ID: <6relqxorm4.fsf@franz.stat.wisc.edu>
Lines: 55
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

> Setzer.Woodrow@epamail.epa.gov writes:
> 
> > The final line in getCovariateFormula() in the nlme package (version
> > 3.1-16) is:
> >     eval(parse(text = paste("~", deparse(form))))
> > 
> > however, if deparse(form) exceeds 'width.cutoff (which defaults to 60)',
> > this results in inappropriately placed "~" signs:
> > For example, in my application with the error, form is
> > 
> > UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, Ki)
> > 
> > the result of the paste() operation in the last line of getCovariateFormula
> > is:
> > 
> > > paste("~",deparse(form))
> > [1] "~ UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, "
> > [2] "~     Ki)"
> > 
> > extending width.cutoff gives the intended value:
> > 
> > > paste("~",deparse(form,width.cutoff=500))
> > [1] "~ UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, Ki)"
> > 
> > Seems a bit risky for an enforced cutoff in deparse, though.
> 
> parse(...deparse(...)) always looks wrong to me anyway. Couldn't one
> use something like
> 
> f <- ~1
> f[[2]] <- form
> eval(f)
> 
> or 
> 
> eval(as.call(list(as.name("~"),form)))

> or
> 
> eval(substitute(~form)) # that's not going to work in S, though...

Exactly.  The code was originally written for S and ported to R.  Some
of the contorted expressions were things that we found by
experimentation would work in both systems.

> ??
> 
> (What is the eval for? Doesn't usually do anything to a
> formula argument.)

In Sv3 at least it assigns a class to the object.

I'll change it to eval(substitute(~form)) for the R package.

==> 1038.followup.1 <==
From Setzer.Woodrow@epamail.epa.gov  Tue Jul 31 22:19:22 2001
Received: from marconi.rtp.epa.gov (marconi.rtp.epa.gov [134.67.208.99])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA11392;
	Tue, 31 Jul 2001 22:19:19 +0200 (MET DST)
From: Setzer.Woodrow@epamail.epa.gov
Received: from epahub11.rtp.epa.gov (epahub11.rtp.epa.gov [134.67.213.52])
 by epamail.epa.gov (PMDF V5.2-33 #42056)
 with ESMTP id <0GHC00AQNTEESU@epamail.epa.gov>; Tue,
 31 Jul 2001 16:11:02 -0400 (EDT)
Date: Tue, 31 Jul 2001 16:10:54 -0400
Subject: Re: [Rd] nlme: bug in getCovariateFormula (PR#1038)
To: Douglas Bates <bates@stat.wisc.edu>
Cc: bates@franz.stat.wisc.edu, Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>,
        R-bugs@biostat.ku.dk, r-devel@stat.math.ethz.ch
Message-id: <OF7528A682.B9E78D2C-ON85256A9A.006E9C38@rtp.epa.gov>
MIME-version: 1.0
X-Mailer: Lotus Notes Release 5.0.3  March 21, 2000
Content-type: text/plain; charset=us-ascii
X-MIMETrack: Serialize by Router on EPAHUB11/USEPA/US(Release 5.0.6a |January
 17, 2001) at 07/31/2001 04:11:02 PM


It looks clunky, but you could maintain consistency across S and R forms
with

eval(parse(text=paste("~",paste(deparse(form),collapse=" "))))


R. Woodrow Setzer, Jr.                                            Phone:
(919) 541-0128
Experimental Toxicology Division                       Fax:  (919) 541-5394
Pharmacokinetics Branch
NHEERL MD-74; US EPA; RTP, NC 27711


                                                                                                                
                    Douglas Bates                                                                               
                    <bates@stat.wis        To:     Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>                
                    c.edu>                 cc:     Woodrow Setzer/RTP/USEPA/US@EPA, r-devel@stat.math.ethz.ch,  
                    Sent by:               R-bugs@biostat.ku.dk                                                 
                    bates@franz.sta        Subject:     Re: [Rd] nlme: bug in getCovariateFormula (PR#1038)     
                    t.wisc.edu                                                                                  
                                                                                                                
                                                                                                                
                    07/31/01 02:55                                                                              
                    PM                                                                                          
                                                                                                                
                                                                                                                




Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

> Setzer.Woodrow@epamail.epa.gov writes:
>
> > The final line in getCovariateFormula() in the nlme package (version
> > 3.1-16) is:
> >     eval(parse(text = paste("~", deparse(form))))
> >
> > however, if deparse(form) exceeds 'width.cutoff (which defaults to
60)',
> > this results in inappropriately placed "~" signs:
> > For example, in my application with the error, form is
> >
> > UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, Ki)
> >
> > the result of the paste() operation in the last line of
getCovariateFormula
> > is:
> >
> > > paste("~",deparse(form))
> > [1] "~ UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km, "
> > [2] "~     Ki)"
> >
> > extending width.cutoff gives the intended value:
> >
> > > paste("~",deparse(form,width.cutoff=500))
> > [1] "~ UnCompetitive(MethoxyresorufinConc, InhibitorConc, Vmax, Km,
Ki)"
> >
> > Seems a bit risky for an enforced cutoff in deparse, though.
>
> parse(...deparse(...)) always looks wrong to me anyway. Couldn't one
> use something like
>
> f <- ~1
> f[[2]] <- form
> eval(f)
>
> or
>
> eval(as.call(list(as.name("~"),form)))

> or
>
> eval(substitute(~form)) # that's not going to work in S, though...

Exactly.  The code was originally written for S and ported to R.  Some
of the contorted expressions were things that we found by
experimentation would work in both systems.

> ??
>
> (What is the eval for? Doesn't usually do anything to a
> formula argument.)

In Sv3 at least it assigns a class to the object.

I'll change it to eval(substitute(~form)) for the R package.





==> 1038.reply.3 <==
From pd@blueberry.kubism.ku.dk  Tue Jul 31 23:16:31 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA11578;
	Tue, 31 Jul 2001 23:16:30 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id XAA26225;
	Tue, 31 Jul 2001 23:26:04 +0200
Sender: pd@pubhealth.ku.dk
To: Douglas Bates <bates@stat.wisc.edu>
Cc: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>,
        Setzer.Woodrow@epamail.epa.gov, r-devel@stat.math.ethz.ch,
        R-bugs@biostat.ku.dk
Subject: Re: [Rd] nlme: bug in getCovariateFormula (PR#1038)
References: <200107311547.RAA10368@pubhealth.ku.dk> <x2d76h6pd1.fsf@blueberry.kubism.ku.dk> <6relqxorm4.fsf@franz.stat.wisc.edu>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 31 Jul 2001 23:26:04 +0200
In-Reply-To: Douglas Bates's message of "31 Jul 2001 13:55:47 -0500"
Message-ID: <x2ae1k23kj.fsf@blueberry.kubism.ku.dk>
Lines: 25
X-Mailer: Gnus v5.7/Emacs 20.7
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

Douglas Bates <bates@stat.wisc.edu> writes:

> Exactly.  The code was originally written for S and ported to R.  Some
> of the contorted expressions were things that we found by
> experimentation would work in both systems.
> 
> > ??
> > 
> > (What is the eval for? Doesn't usually do anything to a
> > formula argument.)
> 
> In Sv3 at least it assigns a class to the object.

Aha. In R too.

> I'll change it to eval(substitute(~form)) for the R package.

Great. I would have thought that one of the two other forms would be
portable, though. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1038.audit <==
Fri Aug  3 12:00:14 2001	ripley	changed notes
Fri Aug  3 12:00:14 2001	ripley	foobar
Fri Aug  3 12:00:14 2001	ripley	moved from incoming to Add-ons
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1044 *
Subject: Polymarsall.c
From: pleu@hotmail.com
Date: Tue, 7 Aug 2001 22:42:07 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1044 <==
From pleu@hotmail.com  Tue Aug  7 22:42:07 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA01752
	for <R-bugs@biostat.ku.dk>; Tue, 7 Aug 2001 22:42:07 +0200 (MET DST)
Date: Tue, 7 Aug 2001 22:42:07 +0200 (MET DST)
From: pleu@hotmail.com
Message-Id: <200108072042.WAA01752@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: Polymarsall.c

Full_Name: Paul Leu
Version: 1.2.3
OS: Windows NT
Submission from: (NULL) (12.2.142.7)


There is a bug in the polymars code.  

Line 655   m=m+k-1;

ought to be moved in front of the for loop in line 652 or else the levels array
will go out of bounds in the loop.

This does not seem to cause any errors in R, but caused crashes when I attempted
to link the file to PV-wave.  

Paul

==> 1044.audit <==
Sat Aug 11 09:56:56 2001	ripley	moved from incoming to Add-ons
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1116 *
Subject: get.hist.quote does not work
From: arto.luoma@uta.fi
Date: Thu, 4 Oct 2001 14:45:29 +0200 (MET DST)
--Seems specific to one locale on one system.
--The bug is unlikely to be in R.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1116 <==
From arto.luoma@uta.fi  Thu Oct  4 14:45:29 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id OAA18632
	for <R-bugs@biostat.ku.dk>; Thu, 4 Oct 2001 14:45:29 +0200 (MET DST)
Date: Thu, 4 Oct 2001 14:45:29 +0200 (MET DST)
From: arto.luoma@uta.fi
Message-Id: <200110041245.OAA18632@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: get.hist.quote does not work

Full_Name: Arto Luoma
Version: 1.3.1
OS: Windows 98
Submission from: (NULL) (153.1.53.119)


Hi!

The function get.hist.quote in the package tseries (Version 0.7-6) does not work
in 
my computer. 
I found that it uses the function strptime which did not "understand" English
month
names in my Finnish locale (see bug report 811). I changed the regional settings
to 
be English (UK) and strptime started to work as I liked. However, get.hist.quote
does 
not work yet, since the function julian does not work. Is this problem only in
my computer? The previous version of get.hist.quote (tseries 0.7-0) did work.

Sys.time and julian produce

> Sys.time()
[1] "2001-10-04 15:33:14 GTB Daylight Time"
> julian(Sys.time())
Error in fromchar(x) : character string is not in a standard unambiguous format
> 

get.hist.quote produces
 
 x <- get.hist.quote(instrument = "^spc", start = "1998-01-01",
+                     quote = "Close")
trying URL `http://chart.yahoo.com/table.csv?s=^spc&a=01&b=01&c=1998&d=10&e=03&f=2001&g=d&q=q&y=0&z=^spc&x=.csv'
Content type `application/octet-stream' length unknown
opened URL
downloaded 38Kb

time series starts 1998-01-02
Error in fromchar(x) : character string is not in a standard unambiguous format
 

==> 1116.reply.1 <==
From hornik@ci.tuwien.ac.at  Thu Oct  4 18:23:14 2001
Received: from isis.wu-wien.ac.at (isis.wu-wien.ac.at [137.208.3.42])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA21198
	for <R-bugs@biostat.ku.dk>; Thu, 4 Oct 2001 18:23:13 +0200 (MET DST)
Received: from mithrandir.hornik.net (wu057056.wu-wien.ac.at [137.208.57.56])
	by isis.wu-wien.ac.at (8.8.7/8.8.7) with ESMTP id SAA719600emf hornik@ci.tuwien.ac.at; Thu, 4 Oct 2001 18:23:08 +0200
Received: from hornik by mithrandir.hornik.net with local (Exim 3.12 #1 (Debian))
	id 15pBHQ-0008T1-00; Thu, 04 Oct 2001 18:23:24 +0200
From: Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15292.36092.160657.354210@mithrandir.hornik.net>
Date: Thu, 4 Oct 2001 18:23:24 +0200
To: arto.luoma@uta.fi
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] get.hist.quote does not work (PR#1116)
In-Reply-To: <200110041245.OAA18643@pubhealth.ku.dk>
References: <200110041245.OAA18643@pubhealth.ku.dk>
X-Mailer: VM 6.96 under Emacs 20.7.2
Reply-To: Kurt.Hornik@ci.tuwien.ac.at
Sender: Kurt Hornik <hornik@ci.tuwien.ac.at>

>>>>> arto luoma writes:

> Full_Name: Arto Luoma
> Version: 1.3.1
> OS: Windows 98
> Submission from: (NULL) (153.1.53.119)

> Hi!

> The function get.hist.quote in the package tseries (Version 0.7-6)
> does not work in my computer.  I found that it uses the function
> strptime which did not "understand" English month names in my Finnish
> locale (see bug report 811). I changed the regional settings to be
> English (UK) and strptime started to work as I liked. However,
> get.hist.quote does not work yet, since the function julian does not
> work. Is this problem only in my computer? The previous version of
> get.hist.quote (tseries 0.7-0) did work.

> Sys.time and julian produce

>> Sys.time()
> [1] "2001-10-04 15:33:14 GTB Daylight Time"
>> julian(Sys.time())
> Error in fromchar(x) : character string is not in a standard unambiguous format
>> 

> get.hist.quote produces
 
>  x <- get.hist.quote(instrument = "^spc", start = "1998-01-01",
> +                     quote = "Close")
> trying URL `http://chart.yahoo.com/table.csv?s=^spc&a=01&b=01&c=1998&d=10&e=03&f=2001&g=d&q=q&y=0&z=^spc&x=.csv'
> Content type `application/octet-stream' length unknown
> opened URL
> downloaded 38Kb

> time series starts 1998-01-02
> Error in fromchar(x) : character string is not in a standard unambiguous format

I am confused by the subject: above you indicate that get.hist.quote
does not work because julian does not work.

What precisely are your locale settings?

-k

==> 1116.followup.1 <==
From al18853@uta.fi  Fri Oct  5 15:04:46 2001
Received: from uta.fi (uta.fi [153.1.1.12])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA01166
	for <R-bugs@biostat.ku.dk>; Fri, 5 Oct 2001 15:04:45 +0200 (MET DST)
Received: from vuokko.uta.fi (vuokko [153.1.1.11])
	by uta.fi (8.11.6/8.11.6) with ESMTP id f95D4fB28446;
	Fri, 5 Oct 2001 16:04:41 +0300 (EEST)
Received: from localhost (al18853@localhost) by vuokko.uta.fi (8.8.5/8.8.2) with SMTP id QAA03268; Fri, 5 Oct 2001 16:04:41 +0300 (EET DST)
Date: Fri, 5 Oct 2001 16:04:40 +0300 (EET DST)
From: Arto Luoma <al18853@uta.fi>
X-Sender: al18853@vuokko
To: Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] get.hist.quote does not work (PR#1116)
In-Reply-To: <15292.36092.160657.354210@mithrandir.hornik.net>
Message-ID: <Pine.GSO.3.95.1011005155411.3064C-100000@vuokko>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Thu, 4 Oct 2001, Kurt Hornik wrote:

> >>>>> arto luoma writes:
> 
> > Full_Name: Arto Luoma
> > Version: 1.3.1
> > OS: Windows 98
> > Submission from: (NULL) (153.1.53.119)
> 
> > Hi!
> 
> > The function get.hist.quote in the package tseries (Version 0.7-6)
> > does not work in my computer.  I found that it uses the function
> > strptime which did not "understand" English month names in my Finnish
> > locale (see bug report 811). I changed the regional settings to be
> > English (UK) and strptime started to work as I liked. However,
> > get.hist.quote does not work yet, since the function julian does not
> > work. Is this problem only in my computer? The previous version of
> > get.hist.quote (tseries 0.7-0) did work.
> 
> > Sys.time and julian produce
> 
> >> Sys.time()
> > [1] "2001-10-04 15:33:14 GTB Daylight Time"
> >> julian(Sys.time())
> > Error in fromchar(x) : character string is not in a standard unambiguous format
> >> 
> 
> > get.hist.quote produces
>  
> >  x <- get.hist.quote(instrument = "^spc", start = "1998-01-01",
> > +                     quote = "Close")
> > trying URL `http://chart.yahoo.com/table.csv?s=^spc&a=01&b=01&c=1998&d=10&e=03&f=2001&g=d&q=q&y=0&z=^spc&x=.csv'
> > Content type `application/octet-stream' length unknown
> > opened URL
> > downloaded 38Kb
> 
> > time series starts 1998-01-02
> > Error in fromchar(x) : character string is not in a standard unambiguous format
> 
> I am confused by the subject: above you indicate that get.hist.quote
> does not work because julian does not work.
> 
> What precisely are your locale settings?
> 
> -k
> 
I think this is what you are interested in:

Sys.getlocale()
[1] "LC_COLLATE=English_United Kingdom.1252;LC_CTYPE=English_United
Kingdom.1252;LC_MONETARY=C;LC_NUMERIC=C;LC_TIME=English_United
Kingdom.1252"

Arto L. 


==> 1116.audit <==
Sun Oct  7 12:34:39 2001	ripley	changed notes
Sun Oct  7 12:34:39 2001	ripley	foobar
Sun Oct  7 12:34:39 2001	ripley	moved from incoming to Add-ons
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1178 *
Subject: segfault using svm from e1071
From: Jan Rychter <jan@rychter.com>
Date: Tue, 20 Nov 2001 23:38:17 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1178 <==
From postmaster@franz.stat.wisc.edu  Tue Nov 20 23:37:59 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA07060
	for <r-bugs@biostat.ku.dk>; Tue, 20 Nov 2001 23:37:58 +0100 (MET)
Received: from screech.rychter.com (really [212.87.11.114]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m166JWa-000IXPC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Tue, 20 Nov 2001 16:37:52 -0600 (CST) 
Received: from tnuctip.rychter.com (tnuctip-tun0.rychter.com [10.0.0.2])
	by screech.rychter.com (Postfix) with ESMTP id 0FBB94A600
	for <r-bugs@r-project.org>; Tue, 20 Nov 2001 23:09:04 +0100 (CET)
Received: by tnuctip.rychter.com (Postfix, from userid 501)
	id 75F7369F24; Tue, 20 Nov 2001 23:38:19 +0100 (CET)
Sender: jan@rychter.com
From: Jan Rychter <jan@rychter.com>
To: r-bugs@r-project.org
Subject: segfault using svm from e1071
X-Operating-System: Linux 2.4.12 #6 Mon Nov 12 12:22:25 CET 2001
X-No-Archive: yes
Date: Tue, 20 Nov 2001 23:38:17 +0100
Message-ID: <m27ksl83vq.fsf@tnuctip.rychter.com>
Lines: 29
User-Agent: Gnus/5.090004 (Oort Gnus v0.04) XEmacs/21.4 (Artificial
 Intelligence, i386-mandrake-linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

This could be a bug in the e1071 svm code, but maybe not -- I guess I'll
send it here anyway. It's reproducible.

> x <- seq (0.1,5,by=0.05)
> y <- log(x) + rnorm (x, sd=0.2)
> library(e1071)
> m <- svm (x,y)

Process R segmentation fault at Tue Nov 20 23:34:19 2001

> version
         _                
platform i686-pc-linux-gnu
arch     i686             
os       linux-gnu        
system   i686, linux-gnu  
status                    
major    1                
minor    3.1              
year     2001             
month    08               
day      31               
language R                

I used the Mandrake 8.0 RPM binaries from cran.r-project.org first, then
recompiled R myself and reinstalled e1071. Same results.

thanks,
--J.

==> 1178.reply.1 <==
From maechler@stat.math.ethz.ch  Wed Nov 21 10:25:03 2001
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id KAA09827
	for <R-bugs@biostat.ku.dk>; Wed, 21 Nov 2001 10:25:02 +0100 (MET)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id KAA19332;
	Wed, 21 Nov 2001 10:24:31 +0100 (MET)
Received: from lynne(129.132.58.30), claiming to be "lynne.ethz.ch"
 via SMTP by hypatia, id smtpdAAAa004i1; Wed Nov 21 10:24:28 2001
Received: (from maechler@localhost)
	by lynne.ethz.ch (8.11.6/8.11.2) id fAL9OVR32205;
	Wed, 21 Nov 2001 10:24:31 +0100
From: Martin Maechler <maechler@stat.math.ethz.ch>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15355.29391.627802.421311@gargle.gargle.HOWL>
Date: Wed, 21 Nov 2001 10:24:31 +0100
To: jan@rychter.com
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] segfault using svm from e1071 (PR#1178)
In-Reply-To: <200111202238.XAA07070@pubhealth.ku.dk>
References: <200111202238.XAA07070@pubhealth.ku.dk>
X-Mailer: VM 6.97 under Emacs 21.1.1
Reply-To: Martin Maechler <maechler@stat.math.ethz.ch>

>>>>> "jan" == jan  <jan@rychter.com> writes:

    jan> This could be a bug in the e1071 svm code, but maybe
    jan> not -- I guess I'll send it here anyway. It's
    jan> reproducible.

not really reproducible:

1) If you use random data (which is perfect),
  you need an explicit  set.seed(.) statement to make it reproducible

2) I can evaluate the code below (intel-Linux as you)
    more than 100 times without a problem.

Martin

    >> x <- seq (0.1,5,by=0.05)
    >> y <- log(x) + rnorm (x, sd=0.2)
    >> library(e1071)
    >> m <- svm (x,y)

    jan> Process R segmentation fault at Tue Nov 20 23:34:19 2001

    >> version
    jan> _                
    jan> platform i686-pc-linux-gnu
    jan> arch     i686             
    jan> os       linux-gnu        
    jan> system   i686, linux-gnu  
    jan> status                    
    jan> major    1                
    jan> minor    3.1              
    jan> year     2001             
    jan> month    08               
    jan> day      31               
    jan> language R                

    jan> I used the Mandrake 8.0 RPM binaries from
    jan> cran.r-project.org first, then recompiled R myself and
    jan> reinstalled e1071. Same results.



==> 1178.followup.1 <==
From david.meyer@ci.tuwien.ac.at  Wed Nov 21 11:36:27 2001
Received: from fangorn.ci.tuwien.ac.at (root@fangorn.ci.tuwien.ac.at [128.131.51.24])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA10869
	for <R-bugs@biostat.ku.dk>; Wed, 21 Nov 2001 11:36:26 +0100 (MET)
Received: from ci.tuwien.ac.at (meyer@boromir.ci.tuwien.ac.at [128.131.51.39])
	by fangorn.ci.tuwien.ac.at (8.9.3/8.8.5) with ESMTP id LAA25634;
	Wed, 21 Nov 2001 11:36:14 +0100
X-Authentication-Warning: fangorn.ci.tuwien.ac.at: Host meyer@boromir.ci.tuwien.ac.at [128.131.51.39] claimed to be ci.tuwien.ac.at
Sender: meyer@ci.tuwien.ac.at
Message-ID: <3BFB838A.E7E40F39@ci.tuwien.ac.at>
Date: Wed, 21 Nov 2001 11:35:55 +0100
From: David Meyer <david.meyer@ci.tuwien.ac.at>
Organization: Vienna University of Technology
X-Mailer: Mozilla 4.77 [en] (X11; U; Linux 2.4.13-k6 i686)
X-Accept-Language: en
MIME-Version: 1.0
To: jan@rychter.com
CC: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] segfault using svm from e1071 (PR#1178)
References: <200111202238.XAA07070@pubhealth.ku.dk>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

jan@rychter.com wrote:
> 
> This could be a bug in the e1071 svm code, but maybe not -- I guess I'll
> send it here anyway. It's reproducible.

Which version of e1071 are you using (Current: 1.2-1)? This package had
a bug fix release one month ago.

-d


> 
> > x <- seq (0.1,5,by=0.05)
> > y <- log(x) + rnorm (x, sd=0.2)
> > library(e1071)
> > m <- svm (x,y)
> 
> Process R segmentation fault at Tue Nov 20 23:34:19 2001
> 
> > version
>          _
> platform i686-pc-linux-gnu
> arch     i686
> os       linux-gnu
> system   i686, linux-gnu
> status
> major    1
> minor    3.1
> year     2001
> month    08
> day      31
> language R
> 
> I used the Mandrake 8.0 RPM binaries from cran.r-project.org first, then
> recompiled R myself and reinstalled e1071. Same results.
> 
> thanks,
> --J.
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-- 
	Mag. David Meyer		Wiedner Hauptstrasse 8-10
Vienna University of Technology		A-1040 Vienna/AUSTRIA
       Department for			Tel.: (+431) 58801/10772
Statistics and Probability Theory	mail: david.meyer@ci.tuwien.ac.at

==> 1178.followup.2 <==
From jan@rychter.com  Wed Nov 21 12:20:26 2001
Received: from screech.rychter.com (screech.rychter.com [212.87.11.114])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id MAA11623
	for <R-bugs@biostat.ku.dk>; Wed, 21 Nov 2001 12:20:26 +0100 (MET)
Received: from tnuctip.rychter.com (tnuctip-tun0.rychter.com [10.0.0.2])
	by screech.rychter.com (Postfix) with ESMTP
	id D04894A600; Wed, 21 Nov 2001 11:51:28 +0100 (CET)
Received: by tnuctip.rychter.com (Postfix, from userid 501)
	id 310F469F24; Wed, 21 Nov 2001 12:20:46 +0100 (CET)
Sender: jan@rychter.com
From: Jan Rychter <jan@rychter.com>
To: David Meyer <david.meyer@ci.tuwien.ac.at>
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] segfault using svm from e1071 (PR#1178)
References: <200111202238.XAA07070@pubhealth.ku.dk>
	<3BFB838A.E7E40F39@ci.tuwien.ac.at>
X-Operating-System: Linux 2.4.12 #6 Mon Nov 12 12:22:25 CET 2001
X-No-Archive: yes
Date: Wed, 21 Nov 2001 12:20:45 +0100
In-Reply-To: <3BFB838A.E7E40F39@ci.tuwien.ac.at> (David Meyer's message of
 "Wed, 21 Nov 2001 11:35:55 +0100")
Message-ID: <m21yis1ib6.fsf@tnuctip.rychter.com>
Lines: 30
User-Agent: Gnus/5.090004 (Oort Gnus v0.04) XEmacs/21.4 (Artificial
 Intelligence, i386-mandrake-linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

>>>>> "David" == David Meyer <david.meyer@ci.tuwien.ac.at> writes:
 David> jan@rychter.com wrote:
 >>
 >> This could be a bug in the e1071 svm code, but maybe not -- I guess
 >> I'll send it here anyway. It's reproducible.

 David> Which version of e1071 are you using (Current: 1.2-1)? This
 David> package had a bug fix release one month ago.

e1071_1.2-1.tar.gz

--J.

 > x <- seq (0.1,5,by=0.05) y <- log(x) + rnorm (x, sd=0.2)
 > library(e1071) m <- svm (x,y)
 >>
 >> Process R segmentation fault at Tue Nov 20 23:34:19 2001
 >>
 > version
 >> _ platform i686-pc-linux-gnu arch i686 os linux-gnu system i686,
 >> linux-gnu status major 1 minor 3.1 year 2001 month 08 day 31
 >> language R
 >>
 >> I used the Mandrake 8.0 RPM binaries from cran.r-project.org first,
 >> then recompiled R myself and reinstalled e1071. Same results.
 >>

[...]



==> 1178.audit <==
Fri Nov 23 19:15:14 2001	ripley	moved from incoming to Add-ons

==> 1178.followup.3 <==
From jan@rychter.com  Fri Nov 23 21:02:25 2001
Received: from screech.rychter.com (screech.rychter.com [212.87.11.114])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA11852
	for <R-bugs@biostat.ku.dk>; Fri, 23 Nov 2001 21:02:25 +0100 (MET)
Received: from tnuctip.rychter.com (tnuctip-tun0.rychter.com [10.0.0.2])
	by screech.rychter.com (Postfix) with ESMTP
	id 2CE564A600; Fri, 23 Nov 2001 20:32:56 +0100 (CET)
Received: by tnuctip.rychter.com (Postfix, from userid 501)
	id C7BD569F24; Fri, 23 Nov 2001 21:02:42 +0100 (CET)
Sender: jan@rychter.com
From: Jan Rychter <jan@rychter.com>
To: David Meyer <david.meyer@ci.tuwien.ac.at>
Cc: jan@rychter.com, r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] segfault using svm from e1071 (PR#1178)
References: <200111202238.XAA07070@pubhealth.ku.dk>
	<3BFB838A.E7E40F39@ci.tuwien.ac.at>
X-Operating-System: Linux 2.4.12 #6 Mon Nov 12 12:22:25 CET 2001
X-No-Archive: yes
Date: Fri, 23 Nov 2001 21:02:41 +0100
In-Reply-To: <3BFB838A.E7E40F39@ci.tuwien.ac.at> (David Meyer's message of
 "Wed, 21 Nov 2001 11:35:55 +0100")
Message-ID: <m2oflt1cim.fsf@tnuctip.rychter.com>
Lines: 72
User-Agent: Gnus/5.090004 (Oort Gnus v0.04) XEmacs/21.4 (Artificial
 Intelligence, i386-mandrake-linux)
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-2
Content-Transfer-Encoding: 8bit

>>>>> "David" == David Meyer <david.meyer@ci.tuwien.ac.at> writes:
 David> jan@rychter.com wrote:
 >>
 >> This could be a bug in the e1071 svm code, but maybe not -- I guess
 >> I'll send it here anyway. It's reproducible.

 David> Which version of e1071 are you using (Current: 1.2-1)? This
 David> package had a bug fix release one month ago.

To follow up on this (yes, I'm using 1.2-1), here is the backtrace. Hope
it helps.

> library(e1071)
>      x <- seq (0.1,5,by=0.05)
>      y <- log(x) + rnorm (x, sd=0.2)
>      m   <- svm (x,y)

Program received signal SIGSEGV, Segmentation fault.
0x4011ffe8 in realloc () from /lib/libc.so.6
(gdb) bt
#0  0x4011ffe8 in realloc () from /lib/libc.so.6
#1  0x403859ea in Cache::get_data (this=0x8b01d00, index=145759521, data=0xbfffd9b4, 
    len=99) at svm.cpp:126
#2  0x4038b239 in SVR_Q::get_Q (this=0xbfffdb00, i=100, len=198) at svm.cpp:1223
#3  0x4038658d in Solver::Solve (this=0xbfffdb50, l=198, Q=@0xbfffdb00, b_=0x8b01148, 
    y_=0x8b01780 '\001' <repeats 99 times>, 'ÿ' <repeats 99 times>, alpha_=0x8b00b10, 
    Cp=1, Cn=1, eps=0.001, si=0xbfffdc20, shrinking=1) at svm.cpp:534
#4  0x40388249 in solve_epsilon_svr (prob=0xbfffde40, param=0xbfffde50, alpha=0x8b007f0, 
    si=0xbfffdc20) at svm.cpp:1195
#5  0x40388aac in svm_train_one (prob=0xbfffde40, param=0xbfffde50, Cp=0, Cn=0)
    at svm.cpp:1505
#6  0x40388c54 in svm_train (prob=0xbfffde40, param=0xbfffde50) at svm.cpp:1584
#7  0x40384202 in svmtrain () from /local/lib/R/library/e1071/libs/e1071.so
#8  0x0808ccd9 in do_dotCode ()
#9  0x08093e23 in Rf_eval ()
#10 0x0809546a in do_set ()
#11 0x08093c6e in Rf_eval ()
#12 0x08094db9 in do_begin ()
#13 0x08093c6e in Rf_eval ()
#14 0x08094238 in Rf_applyClosure ()
#15 0x080b423b in applyMethod ()
#16 0x080b47ce in Rf_usemethod ()
#17 0x080b49dd in do_usemethod ()
#18 0x08093c6e in Rf_eval ()
#19 0x08094238 in Rf_applyClosure ()
#20 0x08093eaa in Rf_eval ()
#21 0x0809546a in do_set ()
#22 0x08093c6e in Rf_eval ()
#23 0x080a906b in R_ReplConsole ()
#24 0x080a980a in run_Rmainloop ()
#25 0x080ff8e8 in main ()
#26 0x400bb5b0 in __libc_start_main () from /lib/libc.so.6
(gdb) 


--Jan

 > x <- seq (0.1,5,by=0.05) y <- log(x) + rnorm (x, sd=0.2)
 > library(e1071) m <- svm (x,y)
 >>
 >> Process R segmentation fault at Tue Nov 20 23:34:19 2001
 >>
 > version
 >> _ platform i686-pc-linux-gnu arch i686 os linux-gnu system i686,
 >> linux-gnu status major 1 minor 3.1 year 2001 month 08 day 31
 >> language R
 >>
 >> I used the Mandrake 8.0 RPM binaries from cran.r-project.org first,
 >> then recompiled R myself and reinstalled e1071. Same results.
 >>
 >> thanks, --J.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1199 *
Subject: pixmap: infinite recursion with nonascii pnm-files
From: thomas.baumann@ch.tum.de
Date: Fri, 7 Dec 2001 11:07:52 +0100 (CET)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1199 <==
From postmaster@franz.stat.wisc.edu  Fri Dec  7 11:06:27 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA05422
	for <r-bugs@biostat.ku.dk>; Fri, 7 Dec 2001 11:06:27 +0100 (MET)
Received: from mafu.ws.chemie.tu-muenchen.de (really [129.187.76.2]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m16CHtb-000IinC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Fri, 7 Dec 2001 04:06:19 -0600 (CST) 
Received: from rc1021.ce.uiuc.edu (localhost [127.0.0.1])
	by mafu.ws.chemie.tu-muenchen.de (8.11.6/8.11.6/SuSE Linux 0.5) with ESMTP id fB7A7qT06891
	for <r-bugs@r-project.org>; Fri, 7 Dec 2001 11:07:52 +0100
Message-Id: <200112071007.fB7A7qT06891@mafu.ws.chemie.tu-muenchen.de>
Date: Fri, 7 Dec 2001 11:07:52 +0100 (CET)
From: thomas.baumann@ch.tum.de
Reply-To: thomas.baumann@ch.tum.de
Subject: pixmap: infinite recursion with nonascii pnm-files
To: r-bugs@r-project.org
MIME-Version: 1.0
Content-Type: TEXT/plain; charset=us-ascii

Problem:

read.pnm from pixmap_0.2-1.tar.gz stops with an infinite recursion if a
"#" occurs within the raw (binary) data of a pnm-file.


The reason for this behaviour seems to be the handling of comments in
read.pnmhead. The recursive call of strip.comments requires a newline to
complete sucessfully. A work-around would be

diff -r pixmap/R/pnm.R pixmap.orig/R/pnm.R
112c112
<       com1 <- as.integer(regexpr("#.*\n", inpstr))
---
>       com1 <- as.integer(regexpr("#", inpstr))

i.e. to check if the comment sign is actually followed by a newline.

However, if this sequence (#.*\n) would occur within the data and within
the first 350 bytes of the pnm-file the data would be stripped as well.

Furthermore, comments within the data of ascii files after byte 350 are
not handled correctly and lead to an error. Although this seems to be a
rare case, it might occur and it is allowed by the pnm-file
specification.

Thomas

--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = 
 major = 1
 minor = 3.1
 year = 2001
 month = 08
 day = 31
 language = R

Search Path:
 .GlobalEnv, package:pixmap, package:ctest, Autoloads, package:base



==> 1199.audit <==
Mon Dec 10 08:20:14 2001	ripley	moved from incoming to Add-ons
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1266 *
Subject: bug in survival package basehaz function
From: Nicholas Lewin-Koh <kohnicho@comp.nus.edu.sg>
Date: Wed, 16 Jan 2002 14:15:21 +0800 (GMT-8)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1266 <==
From postmaster@franz.stat.wisc.edu  Wed Jan 16 07:16:00 2002
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id HAA07135
	for <r-bugs@biostat.ku.dk>; Wed, 16 Jan 2002 07:15:59 +0100 (MET)
Received: from x86unx3.comp.nus.edu.sg (really [137.132.90.3]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m16QjM8-000Ib3C@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Wed, 16 Jan 2002 00:15:28 -0600 (CST) 
Received: from sf3.comp.nus.edu.sg (kohnicho@sf3.comp.nus.edu.sg [137.132.90.55])
	by x86unx3.comp.nus.edu.sg (8.9.1/8.9.1) with ESMTP id OAA02454
	for <r-bugs@r-project.org>; Wed, 16 Jan 2002 14:15:22 +0800 (GMT-8)
Received: from localhost (kohnicho@localhost)
	by sf3.comp.nus.edu.sg (8.8.5/8.8.5) with ESMTP id OAA29321
	for <r-bugs@r-project.org>; Wed, 16 Jan 2002 14:15:22 +0800 (GMT-8)
Date: Wed, 16 Jan 2002 14:15:21 +0800 (GMT-8)
From: Nicholas Lewin-Koh <kohnicho@comp.nus.edu.sg>
To: r-bugs@r-project.org
Subject: bug in survival package basehaz function
In-Reply-To: <200201022105.QAA20438@falmouth.bwh.harvard.edu>
Message-ID: <Pine.GSO.4.21.0201161351520.3690-100000@sf3.comp.nus.edu.sg>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

Hi,
In the survival analysis package the function basehaz has 2 errors in the
last line
   return(data.frame(hazard=H,time=surv$time,strata=strata))

1) no object surv is created or passed to the function, it should be sfit
2) If there are no strata data.frame barfs bucause strata is NULL

the following is a work around, there may be a better way.
   if(!is.null(strata))
   return(data.frame(hazard=H,time=sfit$time,strata=strata))
   else
   return(data.frame(hazard=H,time=sfit$time))

below is all the version info.

Nicholas

Title: Survival analysis, including penalised likelihood.
Maintainer: Thomas Lumley <tlumley@u.washington.edu>
Priority: recommended
Package: survival
Version: 2.8-2
Requires: R (>= 1.4.0)
Author: S original by Terry Therneau, ported by Thomas Lumley
Description: survival analysis: descriptive statistics, two-sample
  tests, parametric accelerated failure models, Cox model. Delayed entry
  (truncation) allowed for all models; interval censoring for parametric
  models.
License: GPL2



platform i686-pc-linux-gnu
arch     i686             
os       linux-gnu        
system   i686, linux-gnu  
status                    
major    1                
minor    4.0              
year     2001             
month    12               
day      19               
language R                



                 CH3
                  |
                  N             Nicholas Lewin-Koh
                 / \            Dept of Statistics
           N----C   C==O        Program in Ecology and Evolutionary Biology
          ||   ||   |           Iowa State University
          ||   ||   |           Ames, IA 50011
          CH    C   N--CH3      http://www.public.iastate.edu/~nlewin
            \  / \ /            nlewin@iastate.edu
             N    C
             |   ||             Currently
            CH3   O             Graphics Lab
                                School of Computing
                                National University of Singapore
     The Real Part of Coffee    kohnicho@comp.nus.edu.sg


==> 1266.audit <==
Sun Jan 20 15:03:42 2002	ripley	foobar
Sun Jan 20 15:03:42 2002	ripley	moved from incoming to Add-ons
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1295 *
Subject:  typo and user-proofing in odesolve() 
From: Ben Bolker <bolker@zoo.ufl.edu>
Date: Fri, 1 Feb 2002 12:42:25 -0500
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1295 <==
From postmaster@franz.stat.wisc.edu  Fri Feb  1 18:34:34 2002
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA21981
	for <r-bugs@biostat.ku.dk>; Fri, 1 Feb 2002 18:34:34 +0100 (MET)
Received: from triarch.zoo.ufl.edu (really [128.227.60.248]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m16WhZX-000Ic9C@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Fri, 1 Feb 2002 11:33:59 -0600 (CST) 
Received: from bolker.zoo.ufl.edu ([10.227.60.45]) by triarch.zoo.ufl.edu
          (Netscape Messaging Server 3.5)  with ESMTP id 394;
          Fri, 1 Feb 2002 12:33:54 -0500
Received: (from ben@localhost)
	by bolker.zoo.ufl.edu (8.11.0/8.11.0) id g11HgPO02553;
	Fri, 1 Feb 2002 12:42:25 -0500
Date: Fri, 1 Feb 2002 12:42:25 -0500
From: Ben Bolker <bolker@zoo.ufl.edu>
Message-Id: <200202011742.g11HgPO02553@bolker.zoo.ufl.edu>
To: r-bugs@r-project.org
Subject:  typo and user-proofing in odesolve() 
Cc: ben@bolker.zoo.ufl.edu


  A couple of minor points about the odesolve package
(which I am otherwise enjoying very much):

 1. "scalar" is misspelled as "scaler" in the definitions of
the rtol and atol parameters

 2. it is possible to crash R by doing something dumb, e.g
failing to read the documentation carefully enough and (a)
returning only a vector of derivatives and not a list of
(derivatives, global values) and (b) making the derivative
vector shorter than the vector of initial conditions (see example below).

  I know that this is my fault, but it might be possible/useful
to "user-proof" lsoda() some more (try func() once and see if
it returns a list of the appropriate form, check the derivative
vector for length matching the IC vector, etc ...

tderiv <- function(t,x,parms) {
#  return(list(c(x[1]*parms[1],x[2]*parms[2],parms[3]*(x[1]+x[2])),NULL))
   return(c(x[1]*parms[1],x[2]*parms[2],parms[3]*(x[1]+x[2])))
}

lsoda(rep(1,2),c(0:20),tderiv,c(0.01,-0.01,1.2))


--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = 
 major = 1
 minor = 3.1
 year = 2001
 month = 08
 day = 31
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base

==> 1295.audit <==
Fri Feb  1 21:55:34 2002	ripley	moved from incoming to Add-ons

==> 1295.followup.1 <==
From Setzer.Woodrow@epamail.epa.gov Mon Feb  4 14:56:19 2002
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id OAA08298
	for <R-bugs@biostat.ku.dk>; Mon, 4 Feb 2002 14:56:18 +0100 (MET)
From: Setzer.Woodrow@epamail.epa.gov
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id OAA06000
	for <r-bugs@lists.r-project.org>; Mon, 4 Feb 2002 14:55:42 +0100 (MET)
Received: from myrtle.rtpnc.epa.gov(134.67.208.33)
 via SMTP by hypatia, id smtpdAAAa001Th; Mon Feb  4 14:55:41 2002
Received: from epahub11.rtp.epa.gov (epahub11.rtp.epa.gov [134.67.213.52])
 by epamail.epa.gov (PMDF V5.2-32 #42055)
 with ESMTP id <0GR00080QHBVO8@epamail.epa.gov> for r-bugs@lists.r-project.org;
 Mon,  4 Feb 2002 08:55:09 -0500 (EST)
Date: Mon, 04 Feb 2002 08:55:15 -0500
Subject: Re: [Rd] typo and user-proofing in odesolve() (PR#1295)
To: r-bugs@hypatia.math.ethz.ch
Message-id: <OFDD76742E.7FE9E11E-ON85256B56.004C563F@rtp.epa.gov>
MIME-version: 1.0
X-Mailer: Lotus Notes Release 5.0.7  March 21, 2001
Content-type: text/plain; charset=us-ascii
X-MIMETrack: Serialize by Router on EPAHUB11/USEPA/US(Release 5.0.6a |January
 17, 2001) at 02/04/2002 08:55:17 AM
Content-Length: 4860
Status: RO

Forward to r-bugs to maintain a record.

R. Woodrow Setzer, Jr.                                            Phone:
(919) 541-0128
Experimental Toxicology Division                       Fax:  (919)
541-5394
Pharmacokinetics Branch
NHEERL MD-74; US EPA; RTP, NC 27711
----- Forwarded by Woodrow Setzer/RTP/USEPA/US on 02/04/02 08:53 AM
-----
                                                                                                                      
                    Woodrow Setzer                                                                                    
                                         To:     bolker@zoo.ufl.edu                                                   
                    02/01/02 03:23       cc:     owner-r-devel@stat.math.ethz.ch                                      
                    PM                   Subject:     Re: [Rd] typo and user-proofing in odesolve() (PR#1295)         
                                         (Document link: Woody Setzer)                                                
                                                                                                                      



Probably r-devel is not the right place for this discussion, since
odesolve is not an "official" part of R (not even a recommended
package).  I'll respond here to get it in the record, though.  I expect
to have a new release of odesolve ready in a couple of weeks.  lsoda
already calls func() once, to determine the number of "extra" values
returned; it was foolish of me not to test for the kind of value
returned at the same time.  That fix is already in the next release.
I'll see what other defensive checking can be done, as well.
Thanks for the spelling correction.

R. Woodrow Setzer, Jr.                                            Phone:
(919) 541-0128
Experimental Toxicology Division                       Fax:  (919)
541-5394
Pharmacokinetics Branch
NHEERL MD-74; US EPA; RTP, NC 27711


                                                                                                                              
                    bolker@zoo.ufl.edu                                                                                        
                    Sent by:                     To:     r-devel@stat.math.ethz.ch                                            
                    owner-r-devel@stat.ma        cc:                                                                          
                    th.ethz.ch                   Subject:     [Rd] typo and user-proofing in odesolve() (PR#1295)             
                                                                                                                              
                                                                                                                              
                    02/01/02 12:34 PM                                                                                         
                                                                                                                              
                                                                                                                              





  A couple of minor points about the odesolve package
(which I am otherwise enjoying very much):

 1. "scalar" is misspelled as "scaler" in the definitions of
the rtol and atol parameters

 2. it is possible to crash R by doing something dumb, e.g
failing to read the documentation carefully enough and (a)
returning only a vector of derivatives and not a list of
(derivatives, global values) and (b) making the derivative
vector shorter than the vector of initial conditions (see example
below).

  I know that this is my fault, but it might be possible/useful
to "user-proof" lsoda() some more (try func() once and see if
it returns a list of the appropriate form, check the derivative
vector for length matching the IC vector, etc ...

tderiv <- function(t,x,parms) {
#  return(list(c(x[1]*parms[1],x[2]*parms[2],parms[3]*(x[1]
+x[2])),NULL))
   return(c(x[1]*parms[1],x[2]*parms[2],parms[3]*(x[1]+x[2])))
}

lsoda(rep(1,2),c(0:20),tderiv,c(0.01,-0.01,1.2))


--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status =
 major = 1
 minor = 3.1
 year = 2001
 month = 08
 day = 31
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.
-.-.-.-
r-devel mailing list -- Read
http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To:
r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._.
_._._._






~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Analyses

none

Directory:  Documentation

* PR# 988 *
Subject: input for R-intro
From: "Paul E. Johnson" <pauljohn@ku.edu>
Date: Mon, 18 Jun 2001 13:57:10 -0500
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 988 <==
From pauljohn@ku.edu  Mon Jun 18 21:03:09 2001
Received: from lark.cc.ku.edu (root@lark.cc.ku.edu [129.237.34.2])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA14694
	for <r-bugs@biostat.ku.dk>; Mon, 18 Jun 2001 21:03:08 +0200 (MET DST)
Received: from ku.edu by lark.cc.ku.edu (8.8.8/1.1.8.2/12Jan95-0207PM)
	id OAA0000024737; Mon, 18 Jun 2001 14:02:11 -0500 (CDT)
Sender: pauljohn@lark.cc.ku.edu
Message-ID: <3B2E4F06.F3198537@ku.edu>
Date: Mon, 18 Jun 2001 13:57:10 -0500
From: "Paul E. Johnson" <pauljohn@ku.edu>
X-Mailer: Mozilla 4.77 [en] (X11; U; Linux 2.4.2-2 i686)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs@biostat.ku.dk
Subject: input for R-intro
Content-Type: multipart/mixed;
 boundary="------------1C95DB321C5D7CBC643B8CA3"

This is a multi-part message in MIME format.
--------------1C95DB321C5D7CBC643B8CA3
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

I asked Prof. Brian Ripley if I might submit some text/input for the
R-intro writers, he said this is the place to do it.

I was on a plane a couple of weeks ago reading R-intro as I plan for a
course and made these notes, some of which I think will help my students
if you incorporate them.  I've attached a raw text file I wrote in Emacs
to this message "Rintrochanges.txt".

I have written documents like R-intro before and understand it is
difficult to please everybody, and I thank you for your effort on the
project.

Paul Johnson
Assoc. Professor
Dept. of Political Science
University of Kansas

--------------1C95DB321C5D7CBC643B8CA3
Content-Type: text/plain; charset=us-ascii;
 name="Rintrochanges.txt"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="Rintrochanges.txt"

R-intro comments/enhancements  Part I.

I think something more verbose like this would help under
"Ordered and Unordered factors"

Texts on research design emphasize that variables have
different levels of measurement. Typically, there are three levels.
If a measurement is taken with a precise scale (one on which it is
meaningful to say new_value = b*old_value, as with readings of a
thermometer), it is considered an "interval" level variable.  Many
statistical models were originally designed for interval level
variables.  If a measurement is not so precise, but only provides an
ordered categorization of observations, such as "low" "medium" and
"high", it is called an ordinal variable.  If a measurement is
categorical and implies no sense of ordering, such as "European",
"Asian", or "South American", then it is typically called an ordinal
variable.  Assigning the values of "1", "2", and "3" to these
observations has no substantive significance, as we might as well
number them "3","2","1".

Many statistical models are designed for interval level data, but with
appropriate recoding of input, they can also be made to work with
nominal and ordinal data.  In the "old days" of statistical computing,
users were forced to create a lot of indicator (or "dummy") variables,
thereby converting information from nominal or ordinal measurements
into variables that have only values 0 and 1.  For example, to
represent the information about the home continents of survey
respondents, we might create two dummy variables, one for Asia (coded
1 if respondent is from Asia, 0 otherwise) and one for South America
(likewise 0 and 1).  A respondent for whom we find both of these dummy
variables equal to 0 is sure to be from Europe, so we don't usually
need to create three dummy variables.  Doing so would be redundant.

With a modern language like R, much of the drudgery of creating the
indicator variables is handled automatically if the user declares the
variables properly.  In R, and S before it, the term "factor" is used
to refer to a variable that is not measured at the interval level. An
"unordered factor" is a nominal (or categorical) variable, while an
"ordered factor" is the term for an ordinal measurement.  Many
statistical procedures in R have builtin procedures for handling
factors.

Beyond handling coding of noninterval variables, factors play a vital
role in many R procedures.  Procedures can be designed to do a chore
for each value of a factor.  Many procedures will in fact insist that
a variable be designated as a factor.

 ------------------


In this section "Named arguments and defaults", I am left in a
confusion about a few things.  This confusion has bothered me a while.
Can you do more to explain which arguments must be specified, which
are optional, and under what conditions is it necessary to include the
parameter= which calling a function.

1.  When I use a function, and I look in its help page, how do I know
which input variables must be declared and which can be ignored?  This
is quite mysterious.  When invocations leave out some arguments, how
does R "sift through" the ones that are provided to know which is
which?


For example, consider the page on "update.packages".  

Under Usage, I find:
update.packages(lib.loc = .lib.loc, CRAN = getOption("CRAN"),
                contriburl = contrib.url(CRAN),
                method = "auto", instlib = NULL,
                ask=TRUE, available=NULL, destdir=NULL)

I've been using computers a long time, and I use this function every two months or so.  Between times I forget, come back to this page, and still this one leaves me totally confused.  

After fiddling a while, I find this works on Linux:
>update.packages(lib="/usr/lib/R/library",CRAN="http://lib.stat.cmu.edu/R/CRAN")

but what bothered me thd most is the "getOption("CRAN") option for CRAN.  I tried many variations on that and never figured how to make it work.


Maybe any clarifications could be related to the section "Getting help with functions and features"

In this section, I think it would be nice to have a paragraph about
"how to read a help page."  Some things are not obvious to all new
users.  Some things in help pages are tough to describe... Maybe I'd
say

How to read a help page.

If you find a help page, notice that it is made up of different parts.

1. "Description". These are usually terse, so read every word
   carefully.

2. Look for the "Value" heading.  That tells you what this procedure is
   going to return when you call it. If this procedure doesn't return
   what you need, you should find out immediately.

3. Under "Usage", most help pages list a number of possible commands
   that can be used.  These are not commands to be typed
   literally. Many of them contain abstract references which provide
   information about the nature of the variables that might be
   entered.  

   Here is a simple case.  The coefficients help page has this:

Usage

coef(object, ...)
coefficients(object, ...)

   Clearly, coef and coefficients are going to do the same thing, and you must supply the appropriate object.

4. Under "Arguments," the help page indicates what inputs this
   procedure wants.  The inputs are described line-by-line, and often
   the comments indicate of parameters are optional or what their
   default value might be.

   Many help pages have the infamous "...", which is something like
   "fill in the appropriately, depending on whatever context you
   find."  In some situations this is easy to understand .  Many help
   pages will eplicitly say that "..." refers to any options that
   might be used with a particular kind of object, and in that case
   one must find the help page for that other object. For example, the
   dev.copy help page clearly indicates that "..." refers to any
   options that might be used with the particular device in question.

   Other help pages are not so informative.  Consider the output from ?coefficients:

Arguments

 object
       an object for which the extraction of model coefficients is meaningful.
 ...
       other arguments.

Here it is clear you need to give a statistical object to have
coefficients removed.  The "..." is a mystery, and most R users will
try to use the coefficients command without worrying about it, and
then backtrack if an error occurs.  And, if an error occurs, there may be no recourse but to read the source code for this command or ask  about it in the r-help email list.

--------------1C95DB321C5D7CBC643B8CA3--


==> 988.audit <==
Tue Jun 19 09:07:09 2001	ripley	moved from incoming to Documentation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1011 *
Subject: R-intro suggestions part II
From: "Paul E. Johnson" <pauljohn@ukans.edu>
Date: Tue, 03 Jul 2001 15:50:06 -0500
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1011 <==
From pauljohn@ukans.edu  Tue Jul  3 22:55:21 2001
Received: from lark.cc.ku.edu (root@lark.cc.ku.edu [129.237.34.2])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA25420
	for <r-bugs@biostat.ku.dk>; Tue, 3 Jul 2001 22:55:20 +0200 (MET DST)
Received: from ukans.edu by lark.cc.ku.edu (8.8.8/1.1.8.2/12Jan95-0207PM)
	id PAA0000007085; Tue, 3 Jul 2001 15:55:12 -0500 (CDT)
Sender: pauljohn@lark.cc.ku.edu
Message-ID: <3B422FFE.F4450D57@ukans.edu>
Date: Tue, 03 Jul 2001 15:50:06 -0500
From: "Paul E. Johnson" <pauljohn@ukans.edu>
X-Mailer: Mozilla 4.77 [en] (X11; U; Linux 2.4.2-2 i686)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs@biostat.ku.dk
Subject: R-intro suggestions part II
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Brian Ripley said that, if I sent these here, they might find their way
to the R-intro team.  So, here is another installment:


Concerning this section:

Data permanency and removing objects.

This is the first place R-intro discusses objects.  I was thinking a
better discussion of objects and syntax is needed, perhaps here, or in
the later section "Objects, their modes and attributes."  I suggest
this:


The fact that R is an object-oriented approach to programming for
statistical analysis has pervasive implications.  If one has studied a
programming language like Java or C++, the notions of object and
method are not new.  For readers who have not studied languages like
that, perhaps we can offer a brief explanation.  An object is a "self
contained data holder" that can follow instructions (do calculations,
provide values).  One intention of this design is to keep things
separate if they belong that way, to reduce the risk that one
calculation accidentally influences the result of another.
Object-orientation also has important implications for the way the
different parts of a program fit together.  Since an object is
supposed to be able to carry out a certain set of actions (which are
called methods, but in R one often says "functions" or "procedures"),
then both the user and the programmer understand what the object can
be expected to do.  There are numerous implications of object
orientation that come into play "under the hood" of the R statistical
engine, but it is not important to delve into them from a user's point
of view.


There is one wrinkle about the syntax of R that we hasten to
emphasize.  In object-oriented computer languages, syntax typically
puts the object first, followed by the instruction, followed any needed
parameters.  In Java, to tell the object "regression" to calculate
estimates for vectors y and x, one would write something like:

   regression.estimate(y,x);

Assuming that object's class has an "estimate" method which knows how
to handle the input, we would be in business.

In R, the syntax is totally different.  Instead of thinking of the
object itself as the primary thing, the syntax in R is designed to use
the method name--the instruction--as the leading concept, and then the
object that is being acted upon is given as a parameter.

When a model gives a result in R, the result is almost invariably an
object, which can then be "poked and prodded" with other methods.
If a linear regression is calculated, for example:

resultObject <- lm(y~x)

the return value is an object.  But, unlike other object-oriented
languages, in R one would write summary(resultObject), or
coefficients(resultObject), rather than the Java style
result_object.summary() or some such thing, in order to investigate the
result.


Paul E. Johnson
Political Science
University of Kansas


==> 1011.audit <==
Fri Aug  3 11:30:05 2001	ripley	moved from incoming to Documentation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1136 *
Subject: cex/col/etc. in title(): documentation?
From: Ben Bolker <ben@zoo.ufl.edu>
Date: Mon, 22 Oct 2001 11:55:14 -0400 (EDT)
--MM:actually the documentation still could elaborate a bit..
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1136 <==
From postmaster@franz.stat.wisc.edu  Mon Oct 22 17:51:05 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA09751
	for <r-bugs@biostat.ku.dk>; Mon, 22 Oct 2001 17:51:04 +0200 (MET DST)
Received: from smtp.ufl.edu (really [128.227.74.28]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15vhLx-000JL0C@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Mon, 22 Oct 2001 10:51:01 -0500 (CDT) 
Received: from bolker.zoo.ufl.edu (bolker.zoo.ufl.edu [10.227.60.45])
	by smtp.ufl.edu (8.12.1/8.12.1/2.2.3) with ESMTP id f9MFoxir117294
	for <r-bugs@r-project.org>; Mon, 22 Oct 2001 11:51:00 -0400
Date: Mon, 22 Oct 2001 11:55:14 -0400 (EDT)
From: Ben Bolker <ben@zoo.ufl.edu>
Reply-To: <bolker@zoo.ufl.edu>
To: <r-bugs@r-project.org>
Subject: cex/col/etc. in title(): documentation?
Message-ID: <Pine.LNX.4.30.0110221153480.5576-100000@bolker.zoo.ufl.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


  There appears to be a mismatch between the documentation and behavior of
title(), or at least a clarification is in order.  The documentation says
you can pass extra arguments from par() as "...".  However, cex at least
is ignored. Later on in the documentation it becomes clear that you can
specify these extra parameters as part of a list.

  I wouldn't say this is necessarily a bug (and there's certainly a way to
do what you want, if you read the rest of the documentation), but I will
say it didn't seem to follow the same conventions as most of the rest of
the graphical annotation in R.  I would have expected
title(main="foo",cex=2) to set the title larger ...

  I think it would be nicer if title() worked this way, but if it doesn't
it would be nice to have an additional note in the documentation for "..."
to the effect that parameters such as cex, col, etc., should be set using
the list mechanism described below.

## setting parameter with par(): works
par(mfrow=c(3,3),cex=1)
for (i in 1:9) {
  plot(0:5)
  par(cex=i)
  title(main="hello")
  par(cex=1)
}

## passing parameter as part of a list: works
par(mfrow=c(3,3),cex=1)
for (i in 1:9) {
  plot(0:5)
  title(main=list("hello",cex=i))
  par(cex=1)
}

## passing cex as an additional arg: doesn't work
par(mfrow=c(3,3))
for (i in 1:9) {
  plot(0:5)
  title(main="hello",cex=i)
}


--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status =
 major = 1
 minor = 3.1
 year = 2001
 month = 08
 day = 31
 language = R

Search Path:
 .GlobalEnv, package:bbfuns, package:cannib, package:ctest, Autoloads, package:base
-- 
318 Carr Hall                                bolker@zoo.ufl.edu
Zoology Department, University of Florida    http://www.zoo.ufl.edu/bolker
Box 118525                                   (ph)  352-392-5697
Gainesville, FL 32611-8525                   (fax) 352-392-3704


==> 1136.reply.1 <==
From maechler@stat.math.ethz.ch  Wed Oct 31 11:23:39 2001
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA12222
	for <R-bugs@biostat.ku.dk>; Wed, 31 Oct 2001 11:23:38 +0100 (MET)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id LAA03711;
	Wed, 31 Oct 2001 11:23:33 +0100 (MET)
Received: from lynne(129.132.58.30), claiming to be "lynne.ethz.ch"
 via SMTP by hypatia, id smtpdAAAa000tx; Wed Oct 31 11:23:32 2001
Received: (from maechler@localhost)
	by lynne.ethz.ch (8.11.6/8.11.2) id f9VANWH32397;
	Wed, 31 Oct 2001 11:23:32 +0100
X-Authentication-Warning: lynne.ethz.ch: maechler set sender to maechler@stat.math.ethz.ch using -f
From: Martin Maechler <maechler@stat.math.ethz.ch>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15327.53539.457975.641217@gargle.gargle.HOWL>
Date: Wed, 31 Oct 2001 11:23:31 +0100
To: Ben Bolker <bolker@zoo.ufl.edu>
Cc: R-bugs@biostat.ku.dk
Subject: Re: [Rd] cex/col/etc. in title(): documentation? (PR#1136)
In-Reply-To: <200110221551.RAA09762@pubhealth.ku.dk>
References: <200110221551.RAA09762@pubhealth.ku.dk>
X-Mailer: VM 6.95 under Emacs 20.7.1
Reply-To: Martin Maechler <maechler@stat.math.ethz.ch>

>>>>> "Ben" == Ben Bolker <bolker@zoo.ufl.edu> writes:

    Ben>   There appears to be a mismatch between the documentation and
    Ben> behavior of title(), or at least a clarification is in order.  The
    Ben> documentation says you can pass extra arguments from par() as
    Ben> "...".  However, cex at least is ignored. Later on in the
    Ben> documentation it becomes clear that you can specify these extra
    Ben> parameters as part of a list.

No bug.  Here's the clarification:

Contrary to the other implementations of S,
R differentiates different usages of "cex", "col" and "font" :

 > .Pars[grep("^cex",.Pars)]
 [1] "cex"      "cex.axis" "cex.lab"  "cex.main" "cex.sub" 
 > .Pars[grep("^col",.Pars)]
 [1] "col"      "col.axis" "col.lab"  "col.main" "col.sub" 
 > .Pars[grep("^font",.Pars)]
 [1] "font"      "font.axis" "font.lab"  "font.main" "font.sub" 

and ?par *does* document this.

Hence the "..." in axis() should really be ``filled'' with cex.axis, etc.

    Ben>   I wouldn't say this is necessarily a bug (and there's certainly
    Ben> a way to do what you want, if you read the rest of the
    Ben> documentation), but I will say it didn't seem to follow the same
    Ben> conventions as most of the rest of the graphical annotation in R.
    Ben> I would have expected title(main="foo",cex=2) to set the title
    Ben> larger ...

The following is an example demonstrating R's possibilities 
    (not as cleanly possible in S-plus AFAIK):

plot(1, col.axis = "sky blue", col.lab = "thistle")
title("Main Title", sub = "sub title", 
      cex.main = 2,   font.main= 4, col.main= "blue",
      cex.sub = 0.75, font.sub = 3, col.sub = "red")

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

==> 1136.audit <==
Wed Oct 31 11:32:57 2001	maechler	changed notes
Wed Oct 31 11:32:57 2001	maechler	foobar
Wed Oct 31 11:32:57 2001	maechler	moved from incoming to Documentation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1195 *
Subject: help(dbinom) recommended documentation improvement
From: Rich Heiberger <rmh@surfer.sbm.temple.edu>
Date: Tue, 4 Dec 2001 11:29:58 -0500 (EST)
--This isn't really a bug: the line in question is a plain-text equation, not a
--piece of R code.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1195 <==
From postmaster@franz.stat.wisc.edu  Tue Dec  4 17:34:50 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA27459
	for <r-bugs@biostat.ku.dk>; Tue, 4 Dec 2001 17:34:49 +0100 (MET)
Received: from surfer.sbm.temple.edu (really [155.247.185.2]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m16BISy-000IXXC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Tue, 4 Dec 2001 10:30:44 -0600 (CST) 
Received: (from rmh@localhost)
	by surfer.sbm.temple.edu (8.11.1/8.11.1) id fB4GTwW2323634
	for r-bugs@r-project.org; Tue, 4 Dec 2001 11:29:58 -0500 (EST)
Date: Tue, 4 Dec 2001 11:29:58 -0500 (EST)
From: Rich Heiberger <rmh@surfer.sbm.temple.edu>
Message-Id: <200112041629.fB4GTwW2323634@surfer.sbm.temple.edu>
To: r-bugs@r-project.org
Subject: help(dbinom) recommended documentation improvement

Version 1.3.1  (2001-08-31)

help(dbinom)

currently says
                  p(x) = Choose(n,x) p^x (1-p)^(n-x)

Better would be
                  p(x) = choose(n,x) p^x (1-p)^(n-x)
since "choose" with lower case is the function name.

Even better would be
                  p(x) = choose(n,x) * p^x * (1-p)^(n-x)
because the user could pick up the right-hand-side and execute it.


==> 1195.audit <==
Fri Dec  7 07:57:11 2001	ripley	foobar
Fri Dec  7 07:57:11 2001	ripley	moved from incoming to Documentation
Mon Dec 10 20:20:56 2001	thomas	changed notes
Mon Dec 10 20:20:56 2001	thomas	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1257 *
Subject: documentation of `las' on `par' help page
From: Achim Zeileis <zeileis@ci.tuwien.ac.at>
Date: Fri, 11 Jan 2002 12:30:20 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1257 <==
From postmaster@franz.stat.wisc.edu  Fri Jan 11 22:29:51 2002
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA28233
	for <r-bugs@biostat.ku.dk>; Fri, 11 Jan 2002 22:29:50 +0100 (MET)
Received: from fangorn.ci.tuwien.ac.at (really [128.131.51.24]) by franz.stat.wisc.edu
	via smail with esmtp (ident root using rfc1413)
	id <m16P9Eo-000IXpC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Fri, 11 Jan 2002 15:29:22 -0600 (CST) 
Received: from ci.tuwien.ac.at (zeileis@thorin.ci.tuwien.ac.at [128.131.51.33])
	by fangorn.ci.tuwien.ac.at (8.9.3/8.8.5) with ESMTP id MAA08601
	for <r-bugs@r-project.org>; Fri, 11 Jan 2002 12:30:20 +0100
X-Authentication-Warning: fangorn.ci.tuwien.ac.at: Host zeileis@thorin.ci.tuwien.ac.at [128.131.51.33] claimed to be ci.tuwien.ac.at
Sender: zeileis@ci.tuwien.ac.at
Message-ID: <3C3ECCCC.5A474D0B@ci.tuwien.ac.at>
Date: Fri, 11 Jan 2002 12:30:20 +0100
From: Achim Zeileis <zeileis@ci.tuwien.ac.at>
X-Mailer: Mozilla 4.77 [en] (X11; U; Linux 2.4.13 i686)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs@r-project.org
Subject: documentation of `las' on `par' help page
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Just a small documentation bug:
something went wrong for the description of the graphical parameter
`las' on the HTML version of the `par' help page: `las' is missing and
instead a line from the description is used.
Z


platform i686-pc-linux-gnu
arch     i686             
os       linux-gnu        
system   i686, linux-gnu  
status                    
major    1                
minor    4.0              
year     2001             
month    12               
day      19               
language R

==> 1257.audit <==
Mon Jan 14 20:03:58 2002	thomas	moved from incoming to Documentation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Graphics

* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--The persp algorithm does not apply the occlusion rules to the frame, 
--which is always plotted first. 
--A bug, but not very simple to fix.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 202 <==
From wsi@gcal.ac.uk  Wed Jun  2 15:02:10 1999
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA27126
	for <R-bugs@biostat.ku.dk>; Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
From: wsi@gcal.ac.uk
Message-Id: <199906021302.PAA27126@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: persp box occlusion bug

Full_Name: Bill Simpson
Version: 64.1
OS: linux
Submission from: (NULL) (193.62.250.209)


Bug in persp() bounding box:
If the surface being plotted extends below the lower z-axis boundary, the box
is
drawn with the wrong occlusion. The box is shown as being occluded by the
surface
even though it should be in front of the surface.

The box is correct for surface extending above the box. Problem is only for
surface extending below the box.

This exhibits the bug:

std<-rep(seq(-32,32,8),9)/1000 * 60
cf<-rep(seq(-32,32,8),rep(9,9))/1000 *60 
dp<-(cf-std)/.6
std<-unique(std)
cf<-unique(cf)
dp<-t(matrix(dp,length(cf),length(std)))
persp(std,cf,dp, xlim=c(-2,2), ylim=c(-2,2), zlim=c(0,5),theta=-40,    
phi=45,
box=TRUE,ltheta=-120, lphi=120,
d=1.5, shade=.7)


==> 202.audit <==
Wed Jun 30 19:31:18 1999	pd	moved from incoming to Graphics
Thu Jul 01 18:19:48 1999	pd	changed notes
Sun Feb 20 10:07:11 2000	ripley	changed notes
Mon Feb 28 17:17:51 2000	pd	changed notes
Mon Feb 28 17:18:28 2000	pd	changed notes
Mon Feb 28 17:19:35 2000	pd	changed notes
Mon Feb 28 17:20:17 2000	pd	changed notes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 660 *
Subject: identify.default ignores any setting of cex.
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Fri, 15 Sep 2000 10:23:39 +0100 (BST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 660 <==
From postmaster@franz.stat.wisc.edu  Fri Sep 15 11:23:32 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA13327
	for <R-bugs@biostat.ku.dk>; Fri, 15 Sep 2000 11:23:32 +0200 (MET DST)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id LAA17846
	for <r-bugs@hypatia.math.ethz.ch>; Fri, 15 Sep 2000 11:23:49 +0200 (MET DST)
Received: from franz.stat.wisc.edu(128.105.174.95)
 via SMTP by hypatia, id smtpdAAAa004Mn; Fri Sep 15 11:23:42 2000
Received: from toucan.stats.ox.ac.uk (really [163.1.20.20]) by franz.stat.wisc.edu
	via in.smtpd with esmtp
	id <m13Zrkl-000IW0C@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <R-bugs@r-project.org>; Fri, 15 Sep 2000 04:25:51 -0500 (CDT) 
Received: from localhost (ripley@localhost)
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id KAA14892
	for <R-bugs@r-project.org>; Fri, 15 Sep 2000 10:23:39 +0100 (BST)
X-Authentication-Warning: toucan.stats: ripley owned process doing -bs
Date: Fri, 15 Sep 2000 10:23:39 +0100 (BST)
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
X-Sender: ripley@toucan.stats
To: R-bugs@r-project.org
Subject: identify.default ignores any setting of cex.
Message-ID: <Pine.GSO.4.05.10009151011510.14885-100000@toucan.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

R 1.1.1 on Windows, but I think this is widespread.

Using either

par(cex=0.5)
plot(1:10)
identify(1:10)

or

plot(1:10)
identify(1:10, cex=0.5)

ignores the cex setting.  The root cause is that par(cex=0.5)
alters cexbase for the device but sets cex=1.0, and the internal
text plotting routines use cex and not cexbase.

The obvious fix is to set cex to cexbase in do_identify. However,
if this is fixed, there is another problem, The offset of the label
is related to the cex in use for the label, and not for the symbol.
So

plot(1:10, type="n")
points(1:10, cex=5)
identify(1:10)

is not sensible in placing the labels.  That may be hard to anticipate,
but 

plot(1:10)
identify(1:10, cex=0.5)

needs to use cex=1 not cex=0.5 for the adjustment.  Perhaps identify is
trying too hard, and should give the user more control over the precise
position of the label (as S-PLUS does).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 660.audit <==
Wed Oct 25 06:57:35 2000	ripley	moved from incoming to Graphics

==> 660.followup.1 <==
From ligges@statistik.uni-dortmund.de  Wed Apr 25 17:24:42 2001
Received: from nx5.HRZ.Uni-Dortmund.DE (nx5.HRZ.Uni-Dortmund.DE [129.217.131.21])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA02114
	for <R-bugs@biostat.ku.dk>; Wed, 25 Apr 2001 17:24:42 +0200 (MET DST)
Received: from amadeus.statistik.uni-dortmund.de by nx5.HRZ.Uni-Dortmund.DE
          via smtp-local with ESMTP; Wed, 25 Apr 2001 17:24:51 +0200
Received: from statistik.uni-dortmund.de ([129.217.207.201])
	by amadeus.statistik.uni-dortmund.de (8.9.3+Sun/8.9.3) with ESMTP id RAA01760;
	Wed, 25 Apr 2001 17:24:50 +0200 (MET DST)
Message-ID: <3AE6EC55.6C1D8C7A@statistik.uni-dortmund.de>
Date: Wed, 25 Apr 2001 17:25:09 +0200
From: Uwe Ligges <ligges@statistik.uni-dortmund.de>
Organization: Fachbereich Statistik, Universitaet Dortmund
X-Mailer: Mozilla 4.76 [en] (WinNT; U)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs <R-bugs@biostat.ku.dk>
CC: "Brian D. Ripley" <ripley@stats.ox.ac.uk>
Subject: Re: identify.default ignores any setting of cex (PR#660)
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

A follow-up to PR#660 (15 Sep 2000) from Brian Ripley:

> R 1.1.1 on Windows, but I think this is widespread.
>
> Using either
>
> par(cex=0.5)
> plot(1:10)
> identify(1:10)
>
> or
> 
> plot(1:10)
> identify(1:10, cex=0.5)
> 
> ignores the cex setting.  The root cause is that par(cex=0.5)
> alters cexbase for the device but sets cex=1.0, and the internal
> text plotting routines use cex and not cexbase.
> 
> The obvious fix is to set cex to cexbase in do_identify. However,
> if this is fixed, there is another problem, The offset of the label
> is related to the cex in use for the label, and not for the symbol.
> So
> 
> plot(1:10, type="n")
> points(1:10, cex=5)
> identify(1:10)
> 
> is not sensible in placing the labels.  That may be hard to anticipate,
> but 
> 
> plot(1:10)
> identify(1:10, cex=0.5)
> 
> needs to use cex=1 not cex=0.5 for the adjustment.  Perhaps identify is
> trying too hard, and should give the user more control over the precise
> position of the label (as S-PLUS does).


The same with 

 par(cex=1); plot(1:10); text(4, 5, "Hello World") # OK
 par(cex=2); plot(1:10); text(4, 5, "Hello World") # OK
 par(cex=2); plot(1:10); text(4, 5, "Hello World", cex = 1) # NOT OK
 par(cex=2); plot(1:10); text(4, 5, "Hello World", cex = 0.5)

So the scaling with cex in text() is relative to the par() settings,
which is not the expected behaviour.


[R-1.2.2 on WinNT 4.0]

Uwe Ligges

==> 660.followup.2 <==
From ripley@stats.ox.ac.uk  Wed Apr 25 20:00:09 2001
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA03187
	for <R-bugs@biostat.ku.dk>; Wed, 25 Apr 2001 20:00:09 +0200 (MET DST)
Received: from max166.public.ox.ac.uk (max166.public.ox.ac.uk [192.76.27.166])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id SAA06061;
	Wed, 25 Apr 2001 18:56:30 +0100 (BST)
Date: Wed, 25 Apr 2001 18:55:47 +0100 (GMT Daylight Time)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
To: <ligges@statistik.uni-dortmund.de>
cc: <r-devel@stat.math.ethz.ch>, <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] Re: identify.default ignores any setting of cex (PR#660)
In-Reply-To: <200104251524.RAA02124@pubhealth.ku.dk>
Message-ID: <Pine.WNT.4.31.0104251852500.300-100000@tern.stats>
Sender: ripley@stats.ox.ac.uk
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Wed, 25 Apr 2001 ligges@statistik.uni-dortmund.de wrote:

> A follow-up to PR#660 (15 Sep 2000) from Brian Ripley:

[...]

> The same with
>
>  par(cex=1); plot(1:10); text(4, 5, "Hello World") # OK
>  par(cex=2); plot(1:10); text(4, 5, "Hello World") # OK
>  par(cex=2); plot(1:10); text(4, 5, "Hello World", cex = 1) # NOT OK
>  par(cex=2); plot(1:10); text(4, 5, "Hello World", cex = 0.5)
>
> So the scaling with cex in text() is relative to the par() settings,
> which is not the expected behaviour.

It is the documented behaviour, though: see the description of cex in
?help.

     cex: numeric character expansion factor; multiplied by
          `par("cex")' yields the final character size.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 776 *
Subject: strwidth does not take font into account
From: Martyn Plummer <plummer@iarc.fr>
Date: Tue, 19 Dec 2000 14:56:01 +0100 (CET)
--This needs a substantial redesign.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 776 <==
From postmaster@franz.stat.wisc.edu  Tue Dec 19 14:53:40 2000
Received: from franz.stat.wisc.edu (franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id OAA05819
	for <r-bugs@biostat.ku.dk>; Tue, 19 Dec 2000 14:53:39 +0100 (MET)
Received: from smtp02.iarc.fr (really [212.157.236.234]) by franz.stat.wisc.edu
	via in.smtpd with esmtp
	id <m148NHG-000IYiC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <r-bugs@r-project.org>; Tue, 19 Dec 2000 07:58:02 -0600 (CST) 
Received: from xena.iarc.fr ([10.10.150.125])
	by smtp02.iarc.fr (8.9.3/8.9.3) with ESMTP id OAA21720
	for <r-bugs@r-project.org>; Tue, 19 Dec 2000 14:53:55 +0100
Message-ID: <XFMail.001219145601.plummer@iarc.fr>
X-Mailer: XFMail 1.3 [p0] on Linux
X-Priority: 3 (Normal)
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 8bit
MIME-Version: 1.0
Date: Tue, 19 Dec 2000 14:56:01 +0100 (CET)
Organization: International Agency for Research on Cancer
Sender: martyn@xena.iarc.fr
From: Martyn Plummer <plummer@iarc.fr>
To: r-bugs@r-project.org
Subject: strwidth does not take font into account

One for the wishlist.

The text() function permits the use of different fonts with the arguments
"font" or "vfont".  These create text strings of the same height as the
default font, but of different widths: bold face is slightly wider; vector
fonts are usually much wider.  I think the strwidth() function needs to
take the font into account by also having "font" and "vfont" arguments.
Currently it reports the string width using the default font, which can
be quite different.

Here is a little test function you can use to see how far off the
reported string width is.

test.strwidth <-
function(text, vfont=NULL, cex=NULL, ...)
{
 plot(0,0,xlim=c(-1,1),ylim=c(-1,1), type="n")
 text(0,0, text, adj=c(0,0), offset=0, cex=cex, vfont=vfont, ...)
 abline(h=c(0, strheight(text, cex=cex)), lty=2)
 abline(v=c(0, strwidth(text, cex=cex)), lty=2)
}

e.g.

test.strwidth("This is some text", cex=2)
test.strwidth("This is some text", cex=2, font=2)
test.strwidth("This is some text", vfont=c("sans serif", "plain"))

Martyn

Please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status =
 major = 1
 minor = 2.0
 year = 2000
 month = 12
 day = 15
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base




==> 776.audit <==
Tue Dec 26 10:31:10 2000	ripley	moved from incoming to Graphics
Sat Feb 24 08:55:28 2001	ripley	changed notes
Sat Feb 24 08:55:28 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 791 *
Subject:  par(lab= *) / axis(*) bug 
From: maechler@stat.math.ethz.ch
Date: Fri, 22 Dec 2000 10:59:26 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 791 <==
From postmaster@franz.stat.wisc.edu  Fri Dec 22 10:59:23 2000
Received: from franz.stat.wisc.edu (franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id KAA08619
	for <r-bugs@biostat.ku.dk>; Fri, 22 Dec 2000 10:59:23 +0100 (MET)
Received: from stat.math.ethz.ch (really [129.132.58.23]) by franz.stat.wisc.edu
	via in.smtpd with esmtp (ident daemon using rfc1413)
	id <m149OzA-000IXMC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <r-bugs@r-project.org>; Fri, 22 Dec 2000 03:59:36 -0600 (CST) 
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id KAA02617;
	Fri, 22 Dec 2000 10:59:34 +0100 (MET)
Received: from UNKNOWN(129.132.58.33), claiming to be "florence.ethz.ch"
 via SMTP by hypatia, id smtpdAAAa000cp; Fri Dec 22 10:59:26 2000
Received: (maechler@localhost) by florence.ethz.ch (8.9.3/D-MATH-client) id KAA23075; Fri, 22 Dec 2000 10:59:26 +0100
Date: Fri, 22 Dec 2000 10:59:26 +0100
From: maechler@stat.math.ethz.ch
Message-Id: <200012220959.KAA23075@florence.ethz.ch>
To: r-bugs@r-project.org
Subject:  par(lab= *) / axis(*) bug 
Cc: maechler@stat.math.ethz.ch

As the subject says,
here is example code (with comments) showing the problem:

p1 <- function(lab = c(8,12,7))
{
    ## This `fails' (on a virgin device)
    clab <- paste(lab,collapse=",")
    plot(1,1, xlim = c(0,15), ylim = c(-.8,1), type ="n", axes = FALSE,
         main=paste("plot(*,axes=F); par(lab= c(",clab,"));  axis(*) x 2",sep=""))
    box(col="gray80")
    op <- par(lab = lab) ; on.exit(par(op))
    axis(1, pos = 0)
    axis(2, pos = 0, las = 1)
    par(op)
    op
}

p2 <- function(lab = c(8,12,7))
{
    ## This works  [par()  *BEFORE*  plot() ]
    clab <- paste(lab,collapse=",")
    op <- par(lab = lab) ; on.exit(par(op))

    plot(1,1, xlim = c(0,15), ylim = c(-.8,1), type ="n", axes = FALSE,
         main=paste("par(lab= c(",clab,")); plot(*,axes=F); axis(*) x 2",sep=""))
    box(col="gray80")
    axis(1, pos = 0)
    axis(2, pos = 0, las = 1)
    op ## lab 5 5 7
}

dev.off()
par(mfrow=c(2,1), mar=c(2,2,3,1))
p1()
p2()




--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = Patched
 major = 1
 minor = 2.0
 year = 2000
 month = 12
 day = 19
 language = R

Search Path:
 .GlobalEnv, package:nls, package:splines, package:lqs, package:modreg, package:stepfun, package:mva, package:eda, package:ts, package:VLMC, package:ctest, package:SfS, Autoloads, package:base

==> 791.audit <==
Tue Dec 26 10:31:10 2000	ripley	moved from incoming to Graphics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 816 *
Subject: dotplot: character size of labels
From: RINNER Heinrich <H.RINNER@TIROL.GV.AT>
Date: Thu, 18 Jan 2001 14:54:32 +0100
--Suggested fix is incorporated in 1.2.2.
--
--There is a deeper problem:  mtext() ignores par(cex=.5) in general.  
--To see the problem try:  par(cex=.5); mtext("hi")
--Paul thinks the right fix is to change the argument list for mtext so that
--cex=par(cex) by default rather than cex=NA by default (plus corresponding
--internal changes to  do_mtext in plot.c).
--This needs to be done very carefully because (i) the change suggested above 
--mayhave side-effects in many other pieces of interpreted code 
--(ii) do_mtext ignores dd->gp.cexbase unlike, for example, do_plot_xy 
--and anything to do with cexbase needs extreme care.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 816 <==
From postmaster@franz.stat.wisc.edu  Thu Jan 18 16:57:16 2001
Received: from franz.stat.wisc.edu (franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA13627
	for <r-bugs@biostat.ku.dk>; Thu, 18 Jan 2001 16:57:15 +0100 (MET)
Received: from ingw1.tirol.gv.at (really [212.183.27.1]) by franz.stat.wisc.edu
	via in.smtpd with esmtp
	id <m14JHRE-000IWyC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <r-bugs@r-project.org>; Thu, 18 Jan 2001 09:57:24 -0600 (CST) 
Received: from xms.tirol.gv.at (xms.tirol.gv.at [10.11.128.200])
	by ingw1.tirol.gv.at (Mailer) with ESMTP id 22ADE2825
	for <r-bugs@r-project.org>; Thu, 18 Jan 2001 14:49:47 +0100 (NFT)
Received: from xms.tirol.gv.at (unverified) by xms.tirol.gv.at
 (Content Technologies SMTPRS 4.1.5) with ESMTP id <T0a0b80c8512ecf1400@xms.tirol.gv.at> for <r-bugs@r-project.org>;
 Thu, 18 Jan 2001 14:54:33 +0100
Received: by xms.tirol.gv.at with Internet Mail Service (5.5.2650.21)
	id <CLGLQ6B7>; Thu, 18 Jan 2001 14:54:33 +0100
Message-ID: <C4D44AB4CB62D311BA6500041202E8862640F8@xms1.tirol.gv.at>
From: RINNER Heinrich <H.RINNER@TIROL.GV.AT>
To: "'r-bugs@r-project.org'" <r-bugs@r-project.org>
Subject: dotplot: character size of labels
Date: Thu, 18 Jan 2001 14:54:32 +0100
Return-Receipt-To: RINNER Heinrich <H.RINNER@TIROL.GV.AT>
MIME-Version: 1.0
X-Mailer: Internet Mail Service (5.5.2650.21)
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: 8bit
X-MIME-Autoconverted: from quoted-printable to 8bit by pubhealth.ku.dk id QAA13627

There seems to be a bug in "dotplot" concerning the "cex" parameter. Setting
cex has no effect on the character size of the labels of the points.
This problem was posted to r-help today (Thu, 18 Jan 2001); the solution
given by Brian Ripley (and Uwe Ligges) seems to work for me.

Heinrich Rinner.
 
> version
         _              
platform i386-pc-mingw32
arch     x86            
os       Win32          
system   x86, Win32     
status                  
major    1              
minor    2.0            
year     2000           
month    12             
day      15             
language R              

> ----------
> Von: 	Prof Brian Ripley[SMTP:ripley@stats.ox.ac.uk]
> Gesendet: 	Donnerstag, 18. Jänner 2001 10:35
> An: 	RINNER Heinrich
> Cc: 	'r-help@stat.math.ethz.ch'
> Betreff: 	Re: [R] dotplot: character size of labels
> 
> On Thu, 18 Jan 2001, RINNER Heinrich wrote:
> 
> > Dear R users,
> >
> > using dotplot (R1.2.0, WinNT4.0), I am trying to change the character
> size
> > of the labels of the points:
> >
> > > # example
> > > data(VADeaths)
> > > dotplot(VADeaths, main = "Death Rates in Virginia - 1940")
> > > # I'd like to have smaller character size of the labels (for age and
> > population groups)
> > > ?dotplot
> > > # for argument "cex", this says: "Setting cex to a value smaller than
> one
> > can be a useful way of avoiding label overlap."
> > > dotplot(VADeaths, main = "Death Rates in Virginia - 1940", cex = 0.5)
> > > # the main title and the plotting characters are smaller now, but not
> the
> > labels
> > > # trying to set other graphics parameters seems to have no effect:
> > > dotplot(VADeaths, main = "Death Rates in Virginia - 1940", cex.axis =
> 0.5)
> > > dotplot(VADeaths, main = "Death Rates in Virginia - 1940", cex.lab =
> 0.5)
> >
> > I'd be grateful for any hint how to do this correctly;
> 
> Looks like a bug. Inside dotplot alter to
> 
>         for (i in 1:n) mtext(labs[i], side = 2, line = loffset,
>             at = y[i], adj = 0, col = color, las = 2, cex = cex, ...)
> 
>         for (i in 1:nlevels(groups)) mtext(glabels[i], side = 2,
>             line = goffset, at = gpos[i], adj = 0, col = gcolor,
>             las = 2, cex = cex, ...)
> 
> However, it really needs more than that to calculate the spaces for the
> labels correctly.
> 
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 

==> 816.audit <==
Sat Jan 20 10:24:14 2001	ripley	moved from incoming to Graphics
Tue Jan 23 03:38:23 2001	paul	changed notes
Tue Jan 23 03:38:23 2001	paul	foobar
Sun Feb 18 10:11:12 2001	ripley	changed notes
Sun Feb 18 10:11:12 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 820 *
Subject: interaction.plot
From: "Mark M. Span" <span@psy.uva.nl>
Date: Mon, 22 Jan 2001 10:47:39 +0100
--mtext is unscaled by default.  It is not clear if this should
--use the par("cex") setting or an inline cex setting such as cex.axis.
--It might make more sense to use axis rather than mtext, as boxplot does.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 820 <==
From postmaster@franz.stat.wisc.edu  Mon Jan 22 10:43:38 2001
Received: from franz.stat.wisc.edu (franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id KAA09043
	for <r-bugs@biostat.ku.dk>; Mon, 22 Jan 2001 10:43:37 +0100 (MET)
Received: from mail.psy.uva.nl (really [145.18.113.16]) by franz.stat.wisc.edu
	via in.smtpd with esmtp
	id <m14KdVr-000IWyC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <r-bugs@r-project.org>; Mon, 22 Jan 2001 03:43:47 -0600 (CST) 
Received: from rea2205 (rea2205.psy.uva.nl [145.18.152.205])
	by mail.psy.uva.nl (8.9.3/8.9.3) with SMTP id KAA21513
	for <r-bugs@r-project.org>; Mon, 22 Jan 2001 10:43:45 +0100 (MET)
Message-ID: <008501c08458$5bfc6530$cd981291@psy.uva.nl>
From: "Mark M. Span" <span@psy.uva.nl>
To: <r-bugs@r-project.org>
Subject: interaction.plot
Date: Mon, 22 Jan 2001 10:47:39 +0100
Organization: UvA
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 5.50.4133.2400
X-MimeOLE: Produced By Microsoft MimeOLE V5.50.4133.2400

I notices some indesireable behaviour in interaction.plot. The scaling of
the x-axis labels discards the overall settings for the 'cex' attribute,
leading to unscaled labels. The source for this behaviour is the line

mtext(xlabs, 1, at = xvals)

in interaction.plot.

to get this function to perform conform the manual, change this line to

mtext(xlabs, 1, at = xvals, cex=par("cex"))

and all is well.

because of the simplicity of this 'fix' I assume that it is a crossplatform
thingie, but for the record:

I use R-Win in winNT, 1.2.0, upgrading soon.

just my .02 euro..

I'll just end this mail with a standard declaration of love for R

greetz. Mark M. Span


==> 820.audit <==
Thu Jan 25 00:05:53 2001	ripley	moved from incoming to Graphics
Sat Feb 24 08:53:40 2001	ripley	changed notes
Sat Feb 24 08:53:40 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 828 *
Subject: termplot fails for composite non-factor terms
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Sat, 27 Jan 2001 11:57:37 +1100 (EST)
--Neither of the proposed changes actually works in sufficient generality.
--
--The easy and unimportant part of this, the labels, is fixed in 1.2.2. Getting
--the data right is a project for 1.3
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 828 <==
From postmaster@franz.stat.wisc.edu  Sat Jan 27 01:57:37 2001
Received: from franz.stat.wisc.edu (franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA07865
	for <r-bugs@biostat.ku.dk>; Sat, 27 Jan 2001 01:57:36 +0100 (MET)
Received: from leonard.anu.edu.au (really [150.203.2.15]) by franz.stat.wisc.edu
	via in.smtpd with esmtp
	id <m14MJgZ-000IWyC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <r-bugs@r-project.org>; Fri, 26 Jan 2001 18:57:47 -0600 (CST) 
Received: (from u9801539@localhost)
	by leonard.anu.edu.au (8.9.3/8.9.3) id LAA25063
	for r-bugs@r-project.org; Sat, 27 Jan 2001 11:57:37 +1100 (EST)
Date: Sat, 27 Jan 2001 11:57:37 +1100 (EST)
From: John Maindonald <john.maindonald@anu.edu.au>
Message-Id: <200101270057.LAA25063@leonard.anu.edu.au>
To: r-bugs@r-project.org
Subject: termplot fails for composite non-factor terms

I am running R 1.2.1 under Windows 98SE.

termplot() currently fails when there are composite terms, thus:
  > library(mass)
  > data(hills)
  > hills.lm <- lm(time ~ climb + poly(dist, 2), data = hills)
  > termplot(hills.lm)
  Hit <Return> to see next plot: 
  Error in eval(expr, envir, enclos) : Object "dist" not found

The call
  > termplot(hills.lm,data=hills)
does run without generating an error message, i.e. there is a 
problem with the default setting for the parameter 'data'. 
However the x-axis for the term poly(dist,2) is then incorrectly 
labelled as poly(dist,2), rather than dist
The label poly(dist,2) surely belongs as part of the y-axis label.

Here are suggested fixes

1. In the default parameters for the function call change
   data = model.frame(model)
to
   data = get(as.character(model$call$data))

[This does not work if the variable values are specified in the
function call.  It is not clear to me how to fix that.]

2. A few lines from the beginning, replace
    if (is.null(xlabs)) 
        xlabs <- nmt
    if (is.null(ylab)) 
        ylab <- substitute(link(foo), list(foo = formula(model)[[2]]))
with
   if (is.null(xlabs)) 
        xlabs <- unlist(lapply(cn,function(x)
        if(length(x)>1)as.character(x[[2]]) else as.character(x)))
   if (is.null(ylab)) 
        ylab <- paste("Partial for", nmt)

[The current y-label is "link(<yvar>)".  If it is thought necessary
to specify this, it should be additional to e.g., in my example,
"Partial for poly(dist,2)"]

Replace ylab = ylab with 
   ylab = ylab[i]
in the two places (arguments to plot()) where it appears.

John Maindonald               email : john.maindonald@anu.edu.au        
Statistical Consulting Unit,  phone : (6125)3998        
c/o CMA, SMS,                 fax   : (6125)5549  
John Dedman Mathematical Sciences Building
Australian National University
Canberra ACT 0200
Australia

==> 828.followup.1 <==
From tlumley@u.washington.edu  Sat Jan 27 02:08:54 2001
Received: from jason02.u.washington.edu (root@jason02.u.washington.edu [140.142.8.52])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id CAA07896
	for <R-bugs@biostat.ku.dk>; Sat, 27 Jan 2001 02:08:53 +0100 (MET)
Received: from homer06.u.washington.edu (tlumley@homer06.u.washington.edu [140.142.15.40])
	by jason02.u.washington.edu (8.9.3+UW00.05/8.9.3+UW00.12) with ESMTP id RAA28204;
	Fri, 26 Jan 2001 17:09:04 -0800
Received: from localhost (tlumley@localhost)
	by homer06.u.washington.edu (8.9.3+UW00.05/8.9.3+UW00.12) with ESMTP id RAA186066;
	Fri, 26 Jan 2001 17:09:03 -0800
Date: Fri, 26 Jan 2001 17:09:03 -0800 (PST)
From: Thomas Lumley <tlumley@u.washington.edu>
To: john.maindonald@anu.edu.au
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] termplot fails for composite non-factor terms (PR#828)
In-Reply-To: <200101270057.BAA07875@pubhealth.ku.dk>
Message-ID: <Pine.A41.4.21.0101261704120.21498-100000@homer06.u.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Sat, 27 Jan 2001 john.maindonald@anu.edu.au wrote:

> I am running R 1.2.1 under Windows 98SE.
> 
> termplot() currently fails when there are composite terms, thus:
>   > library(mass)
>   > data(hills)
>   > hills.lm <- lm(time ~ climb + poly(dist, 2), data = hills)
>   > termplot(hills.lm)
>   Hit <Return> to see next plot: 
>   Error in eval(expr, envir, enclos) : Object "dist" not found
> 
> The call
>   > termplot(hills.lm,data=hills)
> does run without generating an error message, i.e. there is a 
> problem with the default setting for the parameter 'data'. 
> However the x-axis for the term poly(dist,2) is then incorrectly 
> labelled as poly(dist,2), rather than dist
> The label poly(dist,2) surely belongs as part of the y-axis label.
> 
> Here are suggested fixes
> 
> 1. In the default parameters for the function call change
>    data = model.frame(model)
> to
>    data = get(as.character(model$call$data))
> 
> [This does not work if the variable values are specified in the
> function call.  It is not clear to me how to fix that.]

Also, it does not specify where to get() the data: what environment to
use. The reason that the data= argument is present in termplot() is that
we can't tell where to find the data in general.

The situation is better as of R1.2, since we can look up variables in the
environment of the model formula. This would fix not only termplot() but a
number of other prediction-related problems.


> 2. A few lines from the beginning, replace
>     if (is.null(xlabs)) 
>         xlabs <- nmt
>     if (is.null(ylab)) 
>         ylab <- substitute(link(foo), list(foo = formula(model)[[2]]))
> with
>    if (is.null(xlabs)) 
>         xlabs <- unlist(lapply(cn,function(x)
>         if(length(x)>1)as.character(x[[2]]) else as.character(x)))
>    if (is.null(ylab)) 
>         ylab <- paste("Partial for", nmt)
> 
> [The current y-label is "link(<yvar>)".  If it is thought necessary
> to specify this, it should be additional to e.g., in my example,
> "Partial for poly(dist,2)"]
> 
> Replace ylab = ylab with 
>    ylab = ylab[i]
> in the two places (arguments to plot()) where it appears.


This looks like a good idea. 

	-thomas


==> 828.audit <==
Mon Jan 29 08:36:10 2001	ripley	moved from incoming to Graphics
Fri Feb 16 22:43:59 2001	thomas	changed notes
Fri Feb 16 22:43:59 2001	thomas	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 831 *
Subject: screen can't go back to (split) screen with log="y" plot
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 30 Jan 2001 00:39:41 -0500
--Still there. Suggested fix included in followups, but we didn't get around to
--try it in time for 1.2.3.
--
--Fix doesn't work. One problem is that the opar<-par();par(opar) idiom updates
--xaxp before xlog, and the new value of xaxp may only be valid under the new
--value of xlog.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 831 <==
From postmaster@franz.stat.wisc.edu  Tue Jan 30 06:39:31 2001
Received: from franz.stat.wisc.edu (franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id GAA28455
	for <r-bugs@biostat.ku.dk>; Tue, 30 Jan 2001 06:39:30 +0100 (MET)
Received: from infiniti.ece.cmu.edu (really [128.2.216.84]) by franz.stat.wisc.edu
	via in.smtpd with esmtp
	id <m14NTW2-000IWyC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <r-bugs@r-project.org>; Mon, 29 Jan 2001 23:39:42 -0600 (CST) 
Received: (from tov@localhost) by infiniti.ece.cmu.edu (AIX4.3/UCB 8.8.8/8.8.8) id AAA26672; Tue, 30 Jan 2001 00:39:42 -0500
X-Authentication-Warning: infiniti.ece.cmu.edu: tov set sender to tov@ece.cmu.edu using -f
Sender: tov@infiniti.ece.cmu.edu
To: r-bugs@r-project.org
Cc: Thomas Vogels <tov@ece.cmu.edu>
Subject: screen can't go back to (split) screen with log="y" plot
Reply-To: Thomas Vogels <tov@ece.cmu.edu>
X-URI: http://www.ece.cmu.edu/~tov
From: Thomas Vogels <tov@ece.cmu.edu>
User-Agent: Gnus/5.0807 (Gnus v5.8.7) Emacs/20.7
Date: 30 Jan 2001 00:39:41 -0500
Message-ID: <pxsnm1egyq.fsf@infiniti.ece.cmu.edu>
Lines: 76
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii


Hi.  Let's try to explain the subject line with some code:

> split.screen (c(2,1))
[1] 1 2
> screen(1)
> plot (1:2, 1:2, log="y", main="1")
> screen (2)
> plot (1:2, 1:2, main="2")
> screen (1)
Error in par(.split.screens[[n]]) : invalid value specified for graphics parameter "yaxp".
> close.screen(all=TRUE)

Let's add comments:

> split.screen (c(2,1))
[1] 1 2

OK, plot in the top half screen:
> screen(1)
> plot (1:2, 1:2, log="y", main="1")
> par("yaxp")
[1]  1  2 -5

OK, switch to bottom half:
> screen (2)
> plot (1:2, 1:2, main="2")
> par("yaxp")
[1] 1 2 5

OK, looks fine, let's go back up:
> screen (1)
Error in par(.split.screens[[n]]) : invalid value specified for graphics parameter "yaxp".

Bummer.
> close.screen(all=TRUE)

Somehow I'm hoping you'll tell me I'm doing something wrong, because
I'd really would like to be able to do the following:
  repeat {
    #calculate
    screen(1)
    #fancy plot
    screen (2)
    #even fancier plot ;-)
    if (user.bored()) break
  }
Which is roughly what I was doing when the error messages started
popping up.

Thanks,
  -tom

--please do not edit the information below--

Version:
 platform = i386-pc-linux-gnu
 arch = i386
 os = linux-gnu
 system = i386, linux-gnu
 status = 
 major = 1
 minor = 2.1
 year = 2001
 month = 01
 day = 15
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base



-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


==> 831.followup.1 <==
From ripley@stats.ox.ac.uk  Tue Jan 30 08:40:46 2001
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id IAA28901
	for <R-bugs@biostat.ku.dk>; Tue, 30 Jan 2001 08:40:46 +0100 (MET)
Received: from max144.public.ox.ac.uk (max144.public.ox.ac.uk [192.76.27.144])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id HAA21509;
	Tue, 30 Jan 2001 07:40:54 GMT
Date: Tue, 30 Jan 2001 07:39:25 +0000 (GMT)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Sender: <ripley@auk.stats>
To: <tov@ece.cmu.edu>
cc: <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] screen can't go back to log="y" plot (PR#831)
In-Reply-To: <200101300539.GAA28465@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.31.0101300725290.17104-100000@auk.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

[I have abbreviated the subject as jitterbug has been having probems
with long subjects.]

The issue here is that one cannot mix log/non-log axes in the calls to
screen(), as the appropriate par() parameter is read-only, but the
meaning of yaxp depends on it.  But beyond that you can't set
x/yaxp for log axes.

You should be able to do this: you can in the S original.

A simpler version:

plot (1:2, 1:2, log="y", main="1")
zz <- par("yaxp")
zz
[1]  1  2 -5
par(yaxp=zz)
Error in par(yaxp = zz) : invalid value specified for graphics parameter
"yaxp".

So you can't reset the yaxp parameter to what it is reported as!


Additional bug: the meaning of x/yaxp for log axes is not defined
in help(par).


On Tue, 30 Jan 2001 tov@ece.cmu.edu wrote:

>
> Hi.  Let's try to explain the subject line with some code:
>
> > split.screen (c(2,1))
> [1] 1 2
> > screen(1)
> > plot (1:2, 1:2, log="y", main="1")
> > screen (2)
> > plot (1:2, 1:2, main="2")
> > screen (1)
> Error in par(.split.screens[[n]]) : invalid value specified for graphics parameter "yaxp".
> > close.screen(all=TRUE)
>
> Let's add comments:
>
> > split.screen (c(2,1))
> [1] 1 2
>
> OK, plot in the top half screen:
> > screen(1)
> > plot (1:2, 1:2, log="y", main="1")
> > par("yaxp")
> [1]  1  2 -5
>
> OK, switch to bottom half:
> > screen (2)
> > plot (1:2, 1:2, main="2")
> > par("yaxp")
> [1] 1 2 5
>
> OK, looks fine, let's go back up:
> > screen (1)
> Error in par(.split.screens[[n]]) : invalid value specified for graphics parameter "yaxp".
>
> Bummer.
> > close.screen(all=TRUE)
>
> Somehow I'm hoping you'll tell me I'm doing something wrong, because
> I'd really would like to be able to do the following:
>   repeat {
>     #calculate
>     screen(1)
>     #fancy plot
>     screen (2)
>     #even fancier plot ;-)
>     if (user.bored()) break
>   }
> Which is roughly what I was doing when the error messages started
> popping up.
>
> Thanks,
>   -tom
>
> --please do not edit the information below--
>
> Version:
>  platform = i386-pc-linux-gnu
>  arch = i386
>  os = linux-gnu
>  system = i386, linux-gnu
>  status =
>  major = 1
>  minor = 2.1
>  year = 2001
>  month = 01
>  day = 15
>  language = R
>
> Search Path:
>  .GlobalEnv, package:ctest, Autoloads, package:base
>
>
>
> --
> mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
>
>
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 831.followup.2 <==
From tov@ece.cmu.edu  Thu Feb  1 02:13:08 2001
Received: from infiniti.ece.cmu.edu (INFINITI.ECE.CMU.EDU [128.2.133.84])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id CAA25173
	for <R-bugs@biostat.ku.dk>; Thu, 1 Feb 2001 02:13:07 +0100 (MET)
Received: (from tov@localhost) by infiniti.ece.cmu.edu (AIX4.3/UCB 8.8.8/8.8.8) id UAA19026; Wed, 31 Jan 2001 20:12:41 -0500
X-Authentication-Warning: infiniti.ece.cmu.edu: tov set sender to tov@ece.cmu.edu using -f
Sender: tov@infiniti.ece.cmu.edu
To: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Cc: <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] screen can't go back to log="y" plot (PR#831)
References: <Pine.GSO.4.31.0101300725290.17104-100000@auk.stats>
Reply-To: Thomas Vogels <tov@ece.cmu.edu>
X-URI: http://www.ece.cmu.edu/~tov
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 31 Jan 2001 20:12:41 -0500
In-Reply-To: Prof Brian D Ripley's message of "Tue, 30 Jan 2001 07:39:25 +0000 (GMT)"
Message-ID: <px7l3bcik6.fsf@infiniti.ece.cmu.edu>
Lines: 81
User-Agent: Gnus/5.0807 (Gnus v5.8.7) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii


Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

> [I have abbreviated the subject as jitterbug has been having probems
> with long subjects.]
> 
> The issue here is that one cannot mix log/non-log axes in the calls to
> screen(), as the appropriate par() parameter is read-only, but the
> meaning of yaxp depends on it.  But beyond that you can't set
> x/yaxp for log axes.
> 
> You should be able to do this: you can in the S original.
> 
> A simpler version:
> 
> plot (1:2, 1:2, log="y", main="1")
> zz <- par("yaxp")
> zz
> [1]  1  2 -5
> par(yaxp=zz)
> Error in par(yaxp = zz) : invalid value specified for graphics parameter
> "yaxp".
> 
> So you can't reset the yaxp parameter to what it is reported as!
[snip]

The code in main/par.c ignores the value of xlog (or ylog) when
setting xaxp (or yaxp).  Right now you have in Specify (and Specify2):

... else if (streql(what, "xaxp")) {
	value = coerceVector(value, REALSXP);
	lengthCheck(what, value, 3);
	naRealCheck(REAL(value)[0], what);
	naRealCheck(REAL(value)[1], what);
        posIntCheck((int) (REAL(value)[2]), what);

Shouldn't that be something like:

... else if (streql(what, "xaxp")) {
	value = coerceVector(value, REALSXP);
	lengthCheck(what, value, 3);
	naRealCheck(REAL(value)[0], what);
	naRealCheck(REAL(value)[1], what);
        if (dd->gp.xlog)
            logAxpCheck((int) (REAL(value)[2]), what);
        else
            posIntCheck((int) (REAL(value)[2]), what);

Where logAxpCheck is suitably defined as:

static void logAxpCheck(int x, char *s)
{
    if (x == NA_INTEGER || x == 0 || x > 4)
	par_error(s);
}

since only values < 0 or the values 1, 2, 3 are allowed?


> Additional bug: the meaning of x/yaxp for log axes is not defined
> in help(par).

excerpt from help(par):

    xaxp: A vector of the form `c(x1, x2, n)' giving the coordinates
          of the extreme tick marks and the number of intervals
          between tick-marks.

Could you add:

          The value of n must be positive for linear scale axes.  For
          logarithmic scale axes n must be either negative (then there
          will be (1-n) ticks at a linear distance) or one of 1, 2, or
          3 where n then indicates the number of ticks per decade.

similar for yaxp?  What am I missing?
Regards,
  -tom

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204

==> 831.audit <==
Wed Feb  7 08:51:14 2001	ripley	moved from incoming to Graphics
Thu Apr 26 12:13:40 2001	pd	changed notes
Thu Apr 26 12:13:40 2001	pd	foobar
Thu Jun  7 19:13:15 2001	thomas	changed notes
Thu Jun  7 19:13:15 2001	thomas	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 837 *
Subject: screen doesn't handle redrawing properly
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 01 Feb 2001 14:20:52 -0500
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 837 <==
From tov@ece.cmu.edu  Thu Feb  1 20:20:40 2001
Received: from infiniti.ece.cmu.edu (INFINITI.ECE.CMU.EDU [128.2.133.84])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA08721
	for <r-bugs@biostat.ku.dk>; Thu, 1 Feb 2001 20:20:39 +0100 (MET)
Received: (from tov@localhost) by infiniti.ece.cmu.edu (AIX4.3/UCB 8.8.8/8.8.8) id OAA30464; Thu, 1 Feb 2001 14:20:52 -0500
X-Authentication-Warning: infiniti.ece.cmu.edu: tov set sender to tov@ece.cmu.edu using -f
Sender: tov@infiniti.ece.cmu.edu
To: r-bugs@biostat.ku.dk
Cc: Thomas Vogels <tov@ece.cmu.edu>
Subject: screen doesn't handle redrawing properly
Reply-To: Thomas Vogels <tov@ece.cmu.edu>
X-URI: http://www.ece.cmu.edu/~tov
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 01 Feb 2001 14:20:52 -0500
Message-ID: <pxitmub46j.fsf@infiniti.ece.cmu.edu>
Lines: 74
User-Agent: Gnus/5.0807 (Gnus v5.8.7) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii


Hi.  As far as I understand it, there is a list of graphic primitives
stored for a device.  So for example, when I iconify/deiconify an X11
window, the plot will be redrawn.  Now screen (split.screen and
friends) appear not to handle this list properly, the list is reset or
not reset at odd times.  The commands below will show clearly what I
mean.  There are two effects:

  - After splitting the device real estate into two screens, I can
    plot on these screens, alternating between them.  When I then
    touch the window to force a redraw, *all* the plots are redrawn,
    not just the last (and visible) ones.
    [This happens when the X server runs on AIX, R runs on AIX or Sun.]

  - Again, after splitting, plotting on one screen can affect the
    other screen.  I.e. plot(...); plot (...) on the left screen can
    erase the *right* screen.
    [This happens for all platforms I have access to, AIX, Linux, Sun.]

The first effect may be due to a bad interaction with the X server,
but the second effect is surely not desirable, is it?  Am I mis-using
'screen' here?

R> split.screen (c(1,2))
[1] 1 2
R> # Draw 10000 points to make the effect obvious
R> screen (1)
R> plot (1:10000, 1:10000, main="1")
R> screen (2)
R> plot (1:10000, 1:10000, main="2")
R> # Ok, go back to screen 1, draw plots 3 and 4
R> screen (1)
R> plot (1:10000, 10000:1, main="3")
R> screen (2)
R> plot (1:10000, 10000:1, main="4")
R> 
R> ########################################
R> # NOW lower/raise window, do something to force device to redraw itself.
R> # You'll see again plot 1 (!), 2 (!), 3, and 4.  Why 1 and 2?
R> ########################################
R> 
R> # Here's how to erase screen 2 from screen 1 (!)
R> screen (1)
R> plot (1:10, 1:10, main="3a")
R> ########################################
R> # The following plot will erase screen 2
R> ########################################
R> plot (1:10, 1:10, main="3b")
R> 
R> # The good news is that this resets the list of graphic ops:
R> screen (2)
R> plot (1:10, 1:10, main="4")
R> # Now if you touch the window, you'll see only plot 3b and 4.

Regards,
  -tom

R> R.version
         _                   
platform sparc-sun-solaris2.7
arch     sparc               
os       solaris2.7          
system   sparc, solaris2.7   
status   Patched             
major    1                   
minor    2.1                 
year     2001                
month    01                  
day      31                  
language R                   

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


==> 837.audit <==
Wed Feb  7 08:51:14 2001	ripley	moved from incoming to Graphics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 887 *
Subject: axis(adj=anything) has no effect
From: jhallman@frb.gov
Date: Wed, 28 Mar 2001 20:51:05 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 887 <==
From jhallman@frb.gov  Wed Mar 28 20:51:06 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA23265
	for <R-bugs@biostat.ku.dk>; Wed, 28 Mar 2001 20:51:05 +0200 (MET DST)
Date: Wed, 28 Mar 2001 20:51:05 +0200 (MET DST)
From: jhallman@frb.gov
Message-Id: <200103281851.UAA23265@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: axis(adj=anything) has no effect

Full_Name: Jeff Hallman
Version: 1.2.2
OS: SunOS5.6
Submission from: (NULL) (132.200.32.33)


Giving an adj argument to axis() seems to have no effect.  In Splus, adj = 0 
left-justifies the labels under the ticks, adj = 1 right justifies them, and 
numbers in between can also be used.  I like to use adj = 0.9 to get something
that looks like this:

-----------+-----------+-----------+------------+---------
        1980        1981        1982         1983

as an axis for a plot of monthly time series data.



==> 887.audit <==
Sat Apr  7 10:29:17 2001	ripley	moved from incoming to Graphics

==> 887.followup.1 <==
From paul@stat.auckland.ac.nz  Tue Jun 19 06:05:35 2001
Received: from mailhost.auckland.ac.nz (mailhost.auckland.ac.nz [130.216.191.4] (may be forged))
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id GAA16140
	for <R-bugs@biostat.ku.dk>; Tue, 19 Jun 2001 06:05:33 +0200 (MET DST)
Received: from stat1.stat.auckland.ac.nz (stat1.stat.auckland.ac.nz [130.216.93.1])
	by mailhost.auckland.ac.nz (8.9.2/8.9.2/8.9.2-ua) with ESMTP id QAA00412;
	Tue, 19 Jun 2001 16:05:26 +1200 (NZST)
Received: from murrell (murrell.stat.auckland.ac.nz [130.216.93.23])
	by stat1.stat.auckland.ac.nz (8.9.3+Sun/8.8.8) with SMTP id QAA24826;
	Tue, 19 Jun 2001 16:05:25 +1200 (NZST)
Message-ID: <020401c0f877$becbd540$175dd882@stat.auckland.ac.nz>
From: "Paul Murrell" <paul@stat.auckland.ac.nz>
To: <r-core@r-project.org>
Cc: <R-bugs@biostat.ku.dk>
Subject: Re: axis(adj=anything) has no effect (PR#887)
Date: Tue, 19 Jun 2001 16:24:35 +1200
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 5.50.4522.1200
X-MimeOLE: Produced By Microsoft MimeOLE V5.50.4522.1200

Hi

----Bug summary:----
Giving an adj argument to axis() seems to have no effect.  In Splus, adj = 0
left-justifies the labels under the ticks, adj = 1 right justifies them, and
numbers in between can also be used.  I like to use adj = 0.9 to get
something
that looks like this:

-----------+-----------+-----------+------------+---------
        1980        1981        1982         1983

as an axis for a plot of monthly time series data.
----Bug summary:----


Are missing features bugs or wish-list items ?

Paul


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 916 *
Subject:  par(mgp) bug 
From: paul@stat.auckland.ac.nz
Date: Fri, 20 Apr 2001 08:33:45 +1200 (NZST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 916 <==
From postmaster@franz.stat.wisc.edu  Thu Apr 19 22:33:54 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA02208
	for <r-bugs@biostat.ku.dk>; Thu, 19 Apr 2001 22:33:53 +0200 (MET DST)
Received: from mailhost.auckland.ac.nz (really [130.216.1.4]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m14qL7p-000J8eC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Thu, 19 Apr 2001 15:34:01 -0500 (CDT) 
Received: from stat1.stat.auckland.ac.nz (stat1.stat.auckland.ac.nz [130.216.93.1])
	by mailhost.auckland.ac.nz (8.9.2/8.9.2/8.9.2-ua) with ESMTP id IAA16455
	for <r-bugs@r-project.org>; Fri, 20 Apr 2001 08:33:45 +1200 (NZST)
Received: (from paul@localhost)
	by stat1.stat.auckland.ac.nz (8.9.3+Sun/8.8.8) id IAA18528;
	Fri, 20 Apr 2001 08:33:45 +1200 (NZST)
Date: Fri, 20 Apr 2001 08:33:45 +1200 (NZST)
Message-Id: <200104192033.IAA18528@stat1.stat.auckland.ac.nz>
From: paul@stat.auckland.ac.nz
To: r-bugs@r-project.org
Cc: paul@stat1.stat.auckland.ac.nz
Subject:  par(mgp) bug 

Hi

The behaviour of the third argument of par(mgp), which controls the
placement of the axis ticks, is not working.  

In the following example, the plots should NOT be
identical; the axis ticks plus the axis major line should be drawn one
line out from the edges of the plot region.

par(mfrow=c(2,1))
plot(1:10)
par(mgp=c(3,1,1))
plot(1:10)

Paul

<<insert bug report here>>



--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.7
 arch = sparc
 os = solaris2.7
 system = sparc, solaris2.7
 status = Under development (unstable)
 major = 1
 minor = 3.0
 year = 2001
 month = 02
 day = 18
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base

==> 916.audit <==
Sat Apr 21 12:59:42 2001	ripley	moved from incoming to Graphics

==> 916.followup.1 <==
From paul@stat.auckland.ac.nz  Tue Jun 19 03:36:11 2001
Received: from mailhost.auckland.ac.nz (mailhost.auckland.ac.nz [130.216.191.4] (may be forged))
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id DAA15904
	for <R-bugs@biostat.ku.dk>; Tue, 19 Jun 2001 03:36:08 +0200 (MET DST)
Received: from stat1.stat.auckland.ac.nz (stat1.stat.auckland.ac.nz [130.216.93.1])
	by mailhost.auckland.ac.nz (8.9.2/8.9.2/8.9.2-ua) with ESMTP id NAA25485;
	Tue, 19 Jun 2001 13:36:01 +1200 (NZST)
Received: from murrell (murrell.stat.auckland.ac.nz [130.216.93.23])
	by stat1.stat.auckland.ac.nz (8.9.3+Sun/8.8.8) with SMTP id NAA21072;
	Tue, 19 Jun 2001 13:36:00 +1200 (NZST)
Message-ID: <012601c0f862$df47ec10$175dd882@stat.auckland.ac.nz>
From: "Paul Murrell" <paul@stat.auckland.ac.nz>
To: <r-core@r-project.org>
Cc: <R-bugs@biostat.ku.dk>
References: <200104192033.WAA02218@pubhealth.ku.dk>
Subject: Re: [Rd] par(mgp) bug (PR#916)
Date: Tue, 19 Jun 2001 13:55:09 +1200
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 5.50.4522.1200
X-MimeOLE: Produced By Microsoft MimeOLE V5.50.4522.1200

Hi


> The behaviour of the third argument of par(mgp), which controls the
> placement of the axis ticks, is not working.
>
> In the following example, the plots should NOT be
> identical; the axis ticks plus the axis major line should be drawn one
> line out from the edges of the plot region.
>
> par(mfrow=c(2,1))
> plot(1:10)
> par(mgp=c(3,1,1))
> plot(1:10)


This is more of an incompatibility-with-S rather than a bug.  In R,
axis(pos=) overrides axis(line=) which overrides par(mgp=).  It is possible
to get axis to respond to par(mgp=), but this is NOT the default behaviour.
For example,

par(mgp=c(3, 1, 1))
plot(1:10, axes=F)
box()
axis(1, line=NA)
axis(2)

In S, par(mgp=) specifies locations RELATIVE TO axis(line=), which can be
overridden by axis(pos=).

So the options are:
(i) become compatible NOW (for 1.3)
(ii) become compatible later
(iii) remain incompatible

I think we should do (i), especially because the default behaviour, which I
think would cover 99.999% of user code, would NOT change.

This is your chance to disagree ...

Paul



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 943 *
Subject: legend() with xpd=T; omission of initial plot character
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Sun, 20 May 2001 10:35:16 +1000
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 943 <==
From postmaster@franz.stat.wisc.edu  Sun May 20 02:32:40 2001
Received: from franz.stat.wisc.edu (franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id CAA02494
	for <r-bugs@biostat.ku.dk>; Sun, 20 May 2001 02:32:39 +0200 (MET DST)
Received: from mail.anu.edu.au (really [150.203.2.7]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m151H95-000JH8C@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Sat, 19 May 2001 19:32:31 -0500 (CDT) 
Received: from anugpo.anu.edu.au (anugpo.anu.edu.au [150.203.2.6])
	by mail.anu.edu.au (8.9.3/8.9.3) with ESMTP id KAA18515
	for <r-bugs@r-project.org>; Sun, 20 May 2001 10:32:27 +1000 (EST)
Received: from soda.anu.edu.au (soda.anu.edu.au [150.203.33.17])
	by anugpo.anu.edu.au (8.9.3+Sun/8.9.3) with ESMTP id KAA22405
	for <r-bugs@r-project.org>; Sun, 20 May 2001 10:32:27 +1000 (EST)
Message-Id: <5.0.2.1.1.20010520103337.00ac8b10@pophost.anu.edu.au>
X-Sender: u9801539@pophost.anu.edu.au (Unverified)
X-Mailer: QUALCOMM Windows Eudora Version 5.0.2
Date: Sun, 20 May 2001 10:35:16 +1000
To: r-bugs@r-project.org
From: John Maindonald <john.maindonald@anu.edu.au>
Subject: legend() with xpd=T; omission of initial plot character
Mime-Version: 1.0
Content-Type: text/plain; charset="us-ascii"; format=flowed


In the following:

plot(0:1, 0:1)
legend(x=0, y=1.2, pch=c(1,2), legend=c("May","June"))

the first plot character is omitted when plotting to
the screen.

I obtained the same behaviour when placing a legend
in the margin following use of pairs()

-please do not edit the information below--

Version:
  platform = i386-pc-mingw32
  arch = x86
  os = Win32
  system = x86, Win32
  status =
  major = 1
  minor = 2.3
  year = 2001
  month = 04
  day = 26
  language = R

Windows 98 SE 4.10 (build 2222)  A

Search Path:
  .GlobalEnv, package:ctest, Autoloads, package:base
John Maindonald               email : john.maindonald@anu.edu.au
Statistical Consulting Unit,  phone : (6125)3998
c/o CMA, SMS,                 fax   : (6125)5549
John Dedman Mathematical Sciences Building
Australian National University
Canberra ACT 0200
Australia


==> 943.reply.1 <==
From: paul@stat.auckland.ac.nz
To: r-core@r-project.org
Subject: Re: legend() with xpd=T; omission of initial plot character (PR#943)
Date: Tue Jun 19 05:58:40 2001
CC: r-bugs@r-project.org; john.maindonald@anu.edu.au

Hi

Bug summary:----
par(xpd=T)
plot(0:1, 0:1)
legend(x=0, y=1.2, pch=c(1,2), legend=c("May","June"))

the first plot character is omitted when plotting to
the screen.
Bug summary:----

I cannot reproduce this bug, BUT it did show up a bug in rect() -- in the
example above, the border around the legend is not drawn.

This is because rect() ignores par(xpd).  The default is rect(xpd=FALSE).  This
is at odds with text(xpd=NULL) and polygon(xpd=NULL) which use par(xpd) by
default.  arrows(xpd=FALSE) has the same problem as rect().  

I propose modifying rect() and arrows() to use par(xpd) by default like text()
and polygon().  There will, as usual, be a small risk that someone's code will
produce different output after this change, but this risk should be pretty
small.

Any objections ... ?

Paul

==> 943.followup.1 <==
From postmaster@franz.stat.wisc.edu  Tue Jun 19 05:56:22 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id FAA16092
	for <r-bugs@biostat.ku.dk>; Tue, 19 Jun 2001 05:56:21 +0200 (MET DST)
Received: from pubhealth.ku.dk (really [130.225.108.10]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15CCch-000JGhC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Mon, 18 Jun 2001 22:56:15 -0500 (CDT) 
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id FAA16087;
	Tue, 19 Jun 2001 05:55:27 +0200 (MET DST)
From: paul@stat.auckland.ac.nz
Received: from blueberry.kubism.ku.dk (blueberry.kubism.ku.dk [130.225.108.193])
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) with ESMTP id FAA32381;
	Tue, 19 Jun 2001 05:58:35 +0200
Date: Tue, 19 Jun 2001 05:58:35 +0200
Message-Id: <200106190358.FAA32381@blueberry.kubism.ku.dk>
To: r-core@r-project.org
Subject: Re: legend() with xpd=T; omission of initial plot character (PR#943)
CC: r-bugs@r-project.org;john.maindonald@anu.edu.au;;;
X-Loop: R-bugs@biostat.ku.dk

Hi

Bug summary:----
par(xpd=T)
plot(0:1, 0:1)
legend(x=0, y=1.2, pch=c(1,2), legend=c("May","June"))

the first plot character is omitted when plotting to
the screen.
Bug summary:----

I cannot reproduce this bug, BUT it did show up a bug in rect() -- in the
example above, the border around the legend is not drawn.

This is because rect() ignores par(xpd).  The default is rect(xpd=FALSE).  This
is at odds with text(xpd=NULL) and polygon(xpd=NULL) which use par(xpd) by
default.  arrows(xpd=FALSE) has the same problem as rect().  

I propose modifying rect() and arrows() to use par(xpd) by default like text()
and polygon().  There will, as usual, be a small risk that someone's code will
produce different output after this change, but this risk should be pretty
small.

Any objections ... ?

Paul


==> 943.reply.2 <==
From postmaster@franz.stat.wisc.edu  Tue Jun 19 08:43:07 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id IAA16819
	for <r-bugs@biostat.ku.dk>; Tue, 19 Jun 2001 08:43:07 +0200 (MET DST)
Received: from stat.math.ethz.ch (really [129.132.58.23]) by franz.stat.wisc.edu
	via smail with esmtp (ident daemon using rfc1413)
	id <m15CFDy-000JJWC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Tue, 19 Jun 2001 01:42:54 -0500 (CDT) 
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id IAA02705;
	Tue, 19 Jun 2001 08:42:52 +0200 (MET DST)
Received: from lynne(129.132.58.30), claiming to be "lynne.ethz.ch"
 via SMTP by hypatia, id smtpdAAAa000eE; Tue Jun 19 08:42:50 2001
Received: (maechler@localhost) by lynne.ethz.ch (8.9.3/D-MATH-client) id IAA08111; Tue, 19 Jun 2001 08:42:50 +0200
X-Authentication-Warning: lynne.ethz.ch: maechler set sender to maechler@stat.math.ethz.ch using -f
From: Martin Maechler <maechler@stat.math.ethz.ch>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15150.62570.490993.741070@gargle.gargle.HOWL>
Date: Tue, 19 Jun 2001 08:42:50 +0200
To: paul@stat.auckland.ac.nz
Cc: r-bugs@r-project.org, john.maindonald@anu.edu.au
Subject: Re: legend() with xpd=T; omission of initial plot character (PR#943)
In-Reply-To: <200106190358.FAA32381@blueberry.kubism.ku.dk>
References: <200106190358.FAA32381@blueberry.kubism.ku.dk>
X-Mailer: VM 6.92 under Emacs 20.7.1
Reply-To: Martin Maechler <maechler@stat.math.ethz.ch>

>>>>> "Paul" == Paul Murrell <paul@stat.auckland.ac.nz> writes:

    Paul> Hi
    Paul> Bug summary:----
    Paul> par(xpd=T)
    Paul> plot(0:1, 0:1)
    Paul> legend(x=0, y=1.2, pch=c(1,2), legend=c("May","June"))

    Paul> the first plot character is omitted when plotting to
    Paul> the screen.
    Paul> Bug summary:----

    Paul> I cannot reproduce this bug, BUT it did show up a bug in rect()
    Paul> -- in the example above, the border around the legend is not
    Paul> drawn.

Coincidence, I *did* look at that bug only yesterday.
My experience:
   I *could* reproduce the bug {X11(), Linux-386}, but only a few times. 
   Then, it didn't show anymore. Even restarting R wouldn't show it again.
   My ``explanation'' was that it might be (a bug) inside X11 / Window manager
   handling of things... ??


    Paul> This is because rect() ignores par(xpd).  The default is
    Paul> rect(xpd=FALSE).  This is at odds with text(xpd=NULL) and
    Paul> polygon(xpd=NULL) which use par(xpd) by default.
    Paul> arrows(xpd=FALSE) has the same problem as rect().

    Paul> I propose modifying rect() and arrows() to use par(xpd) by
    Paul> default like text() and polygon().  There will, as usual, be a
    Paul> small risk that someone's code will produce different output
    Paul> after this change, but this risk should be pretty small.

    Paul> Any objections ... ?

not at all, but please fix  abline(*) at the same time.
It doesn't obey xpd either (PR#750).

Martin

==> 943.reply.3 <==
From: paul murrell <R-bugs@biostat.ku.dk>
To: paul@stat.auckland.ac.nz
Subject: Re: legend() with xpd=T; omission of initial plot character (PR#943)
Date: Tue Jul 17 04:28:44 2001
CC: John Maindonald <john.maindonald@anu.edu.au>

Hi


> Bug summary:----
> par(xpd=T)
> plot(0:1, 0:1)
> legend(x=0, y=1.2, pch=c(1,2), legend=c("May","June"))
> 
> the first plot character is omitted when plotting to
> the screen.
> Bug summary:----
> 
> I cannot reproduce this bug, BUT it did show up a bug in rect() -- in the
> example above, the border around the legend is not drawn.


Still can't reproduce original bug, so no progress there.


> This is because rect() ignores par(xpd).  The default is rect(xpd=FALSE). 
This
> is at odds with text(xpd=NULL) and polygon(xpd=NULL) which use par(xpd) by
> default.  arrows(xpd=FALSE) has the same problem as rect().  
> 
> I propose modifying rect() and arrows() to use par(xpd) by default like
text()
> and polygon().  There will, as usual, be a small risk that someone's code
will
> produce different output after this change, but this risk should be pretty
> small.


Both of these changes made now (for 1.3.1).  
The following code should demonstrate the bugs (in pre-1.3.1 R) and the fixes:

par(mfrow=c(2,1), xpd=FALSE)
plot(1:10)
plot(1:10)
# rect() and arrow() ignored par(xpd=)
rect(1, 9, 2, 20, col="red")
arrows(1.5, 20, 1.5, 10)
par(xpd=TRUE)
rect(3, 9, 4, 20, col="blue")
arrows(3.5, 20, 3.5, 10)
par(xpd=NA)
rect(5, 9, 6, 20, col="green")
arrows(5.5, 20, 5.5, 10)

Paul


==> 943.audit <==
Mon May 21 08:54:07 2001	ripley	moved from incoming to Graphics
Tue Jun 19 05:58:40 2001	paul	sent reply 1
Tue Jul 17 04:28:44 2001	paul	sent reply 3

==> 943.followup.2 <==
From MAILER-DAEMON  Tue Jul 17 04:21:22 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id EAA16216
	for <R-bugs@biostat.ku.dk>; Tue, 17 Jul 2001 04:21:21 +0200 (MET DST)
Received: from localhost (localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) with internal id EAA21901;
	Tue, 17 Jul 2001 04:28:45 +0200
Date: Tue, 17 Jul 2001 04:28:45 +0200
From: Mail Delivery Subsystem <MAILER-DAEMON@pubhealth.ku.dk>
Message-Id: <200107170228.EAA21901@blueberry.kubism.ku.dk>
To: <R-bugs@biostat.ku.dk>
MIME-Version: 1.0
Content-Type: multipart/report; report-type=delivery-status;
	boundary="EAA21901.995336925/blueberry.kubism.ku.dk"
Subject: Returned mail: User unknown
Auto-Submitted: auto-generated (failure)

This is a MIME-encapsulated message

--EAA21901.995336925/blueberry.kubism.ku.dk

The original message was received at Tue, 17 Jul 2001 04:28:44 +0200
from blueberry.kubism.ku.dk [130.225.108.193]

   ----- The following addresses had permanent fatal errors -----
<John>
    (expanded from: <John>)
<Maindonald>
    (expanded from: <Maindonald>)

   ----- Transcript of session follows -----
... while talking to mail.kubism.ku.dk.:
>>> RCPT To:<maindonald@mail.kubism.ku.dk>
<<< 550 <maindonald@mail.kubism.ku.dk>... User unknown
550 <Maindonald>... User unknown
>>> RCPT To:<john@mail.kubism.ku.dk>
<<< 550 <john@mail.kubism.ku.dk>... User unknown
550 <John>... User unknown

--EAA21901.995336925/blueberry.kubism.ku.dk
Content-Type: message/delivery-status

Reporting-MTA: dns; blueberry.kubism.ku.dk
Received-From-MTA: DNS; blueberry.kubism.ku.dk
Arrival-Date: Tue, 17 Jul 2001 04:28:44 +0200

Final-Recipient: RFC822; john@blueberry.kubism.ku.dk
X-Actual-Recipient: RFC822; john@mail.kubism.ku.dk
Action: failed
Status: 5.1.1
Remote-MTA: DNS; mail.kubism.ku.dk
Diagnostic-Code: SMTP; 550 <john@mail.kubism.ku.dk>... User unknown
Last-Attempt-Date: Tue, 17 Jul 2001 04:28:44 +0200

Final-Recipient: RFC822; maindonald@blueberry.kubism.ku.dk
X-Actual-Recipient: RFC822; maindonald@mail.kubism.ku.dk
Action: failed
Status: 5.1.1
Remote-MTA: DNS; mail.kubism.ku.dk
Diagnostic-Code: SMTP; 550 <maindonald@mail.kubism.ku.dk>... User unknown
Last-Attempt-Date: Tue, 17 Jul 2001 04:28:44 +0200

--EAA21901.995336925/blueberry.kubism.ku.dk
Content-Type: message/rfc822

Return-Path: <R-bugs@biostat.ku.dk>
Received: from blueberry.kubism.ku.dk (blueberry.kubism.ku.dk [130.225.108.193])
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) with ESMTP id EAA21899;
	Tue, 17 Jul 2001 04:28:44 +0200
Date: Tue, 17 Jul 2001 04:28:44 +0200
Message-Id: <200107170228.EAA21899@blueberry.kubism.ku.dk>
From: paul murrell <R-bugs@biostat.ku.dk>
To: paul@stat.auckland.ac.nz
Subject: Re: legend() with xpd=T; omission of initial plot character (PR#943)
CC: John Maindonald <john.maindonald@anu.edu.au>
X-Loop: R-bugs@biostat.ku.dk

Hi


> Bug summary:----
> par(xpd=T)
> plot(0:1, 0:1)
> legend(x=0, y=1.2, pch=c(1,2), legend=c("May","June"))
> 
> the first plot character is omitted when plotting to
> the screen.
> Bug summary:----
> 
> I cannot reproduce this bug, BUT it did show up a bug in rect() -- in the
> example above, the border around the legend is not drawn.


Still can't reproduce original bug, so no progress there.


> This is because rect() ignores par(xpd).  The default is rect(xpd=FALSE). 
This
> is at odds with text(xpd=NULL) and polygon(xpd=NULL) which use par(xpd) by
> default.  arrows(xpd=FALSE) has the same problem as rect().  
> 
> I propose modifying rect() and arrows() to use par(xpd) by default like
text()
> and polygon().  There will, as usual, be a small risk that someone's code
will
> produce different output after this change, but this risk should be pretty
> small.


Both of these changes made now (for 1.3.1).  
The following code should demonstrate the bugs (in pre-1.3.1 R) and the fixes:

par(mfrow=c(2,1), xpd=FALSE)
plot(1:10)
plot(1:10)
# rect() and arrow() ignored par(xpd=)
rect(1, 9, 2, 20, col="red")
arrows(1.5, 20, 1.5, 10)
par(xpd=TRUE)
rect(3, 9, 4, 20, col="blue")
arrows(3.5, 20, 3.5, 10)
par(xpd=NA)
rect(5, 9, 6, 20, col="green")
arrows(5.5, 20, 5.5, 10)

Paul



--EAA21901.995336925/blueberry.kubism.ku.dk--

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 997 *
Subject:  las=1 with log axis 
From: Peter Dalgaard BSA <pd@pubhealth.ku.dk>
Date: Wed, 27 Jun 2001 11:54:06 +0200
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 997 <==
From postmaster@franz.stat.wisc.edu  Wed Jun 27 11:50:00 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA01987
	for <r-bugs@biostat.ku.dk>; Wed, 27 Jun 2001 11:49:59 +0200 (MET DST)
Received: from pubhealth.ku.dk (really [130.225.108.10]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15FBxI-000JJjC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Wed, 27 Jun 2001 04:49:52 -0500 (CDT) 
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA01969;
	Wed, 27 Jun 2001 11:49:40 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id LAA25776;
	Wed, 27 Jun 2001 11:54:06 +0200
Date: Wed, 27 Jun 2001 11:54:06 +0200
From: Peter Dalgaard BSA <pd@pubhealth.ku.dk>
Message-Id: <200106270954.LAA25776@blueberry.kubism.ku.dk>
To: r-bugs@r-project.org
Subject:  las=1 with log axis 
Cc: pd@pubhealth.ku.dk

This just came in:

plot(c(0.1,100),log="y", las=1)

(Numbers and tick marks are unaligned)

Same thing with mtext(), try

mtext("x",2,at=0.1)
mtext("x",2,at=0.1,las=1)

--please do not edit the information below--

Version:
 platform = i586-pc-linux-gnu
 arch = i586
 os = linux-gnu
 system = i586, linux-gnu
 status = 
 major = 1
 minor = 3.0
 year = 2001
 month = 06
 day = 22
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base

==> 997.followup.1 <==
From paul@stat.auckland.ac.nz  Fri Jun 29 00:19:03 2001
Received: from mailhost.auckland.ac.nz (mailhost.auckland.ac.nz [130.216.1.4] (may be forged))
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id AAA21935;
	Fri, 29 Jun 2001 00:19:01 +0200 (MET DST)
Received: from stat1.stat.auckland.ac.nz (stat1.stat.auckland.ac.nz [130.216.93.1])
	by mailhost.auckland.ac.nz (8.9.2/8.9.2/8.9.2-ua) with ESMTP id KAA24932;
	Fri, 29 Jun 2001 10:18:52 +1200 (NZST)
Received: from murrell (murrell.stat.auckland.ac.nz [130.216.93.23])
	by stat1.stat.auckland.ac.nz (8.9.3+Sun/8.8.8) with SMTP id KAA25180;
	Fri, 29 Jun 2001 10:18:52 +1200 (NZST)
Message-ID: <00fc01c10023$19a40700$175dd882@stat.auckland.ac.nz>
From: "Paul Murrell" <paul@stat.auckland.ac.nz>
To: <pd@pubhealth.ku.dk>, <r-devel@stat.math.ethz.ch>
Cc: <R-bugs@biostat.ku.dk>
References: <200106270950.LAA01997@pubhealth.ku.dk>
Subject: Re: [Rd] las=1 with log axis (PR#997)
Date: Fri, 29 Jun 2001 10:38:49 +1200
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 5.50.4522.1200
X-MimeOLE: Produced By Microsoft MimeOLE V5.50.4522.1200

Hi


> This just came in:
>
> plot(c(0.1,100),log="y", las=1)
>
> (Numbers and tick marks are unaligned)
>
> Same thing with mtext(), try
>
> mtext("x",2,at=0.1)
> mtext("x",2,at=0.1,las=1)


This is related to bug #865, which I have discovered is a problem with some
of the very basic transformation code in R graphics (for transforming widths
or heights when there are log scales).  I have a fix for this particular
mtext() problem, but I'm still working on the more general transformation
bug.

Paul



==> 997.reply.1 <==
From: paul murrell <R-bugs@biostat.ku.dk>
To: pd@pubhealth.ku.dk
Subject: Re: las=1 with log axis (PR#997)
Date: Tue Jul 17 06:05:49 2001

Hi


> plot(c(0.1,100),log="y", las=1)
> 
> (Numbers and tick marks are unaligned)
> 
> Same thing with mtext(), try
> 
> mtext("x",2,at=0.1)
> mtext("x",2,at=0.1,las=1)


This is now fixed (which also fixes PR#865).
Also fixed for mtext() when side=1, log="x", and las=2 (and for corresponding
siutations on sides 3 and 4).
Also fixed for mtext() when text is an expression (i.e., mathematical
annotation).

Unfortunately, the problem goes pretty deep -- it is to do with transformation
of widths and heights to or from USER coordinates when the axis is logged. 
There are a couple of other places where this causes a problem:
(i) strwidth() and strheight() 
(ii) symbols()

I'm leaving this bug active until these other issues are resolved.

Paul


==> 997.audit <==
Sat Jun 30 08:57:44 2001	ripley	moved from incoming to Graphics
Tue Jul 17 06:05:49 2001	paul	sent reply 1
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1045 *
Subject: Palette changes on redraw
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 08 Aug 2001 19:08:01 +0200
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1045 <==
From postmaster@franz.stat.wisc.edu  Wed Aug  8 19:07:59 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA11349
	for <r-bugs@biostat.ku.dk>; Wed, 8 Aug 2001 19:07:58 +0200 (MET DST)
Received: from blueberry.kubism.ku.dk (really [130.225.108.193]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15UWoD-000JIvC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Wed, 8 Aug 2001 12:07:53 -0500 (CDT) 
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id f78H81o29218;
	Wed, 8 Aug 2001 19:08:01 +0200
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: r-bugs@r-project.org
Subject: Palette changes on redraw
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 08 Aug 2001 19:08:01 +0200
Message-ID: <x2snf2zdhq.fsf@blueberry.kubism.ku.dk>
Lines: 14
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Try this

example(palette)

then trigger a redraw e.g. by resizing the window. Shouldn't the
palette be stored as part of the display list?

(This only happens because the palette was reset at the end of the
example, but still...)
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1045.reply.1 <==
From ihaka@stat.auckland.ac.nz  Wed Aug  8 22:36:29 2001
Received: from mailhost.auckland.ac.nz (mailhost.auckland.ac.nz [130.216.1.4] (may be forged))
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA12009;
	Wed, 8 Aug 2001 22:36:26 +0200 (MET DST)
Received: from stat1.stat.auckland.ac.nz (stat1.stat.auckland.ac.nz [130.216.93.1])
	by mailhost.auckland.ac.nz (8.9.2/8.9.2/8.9.2-ua) with ESMTP id IAA21626;
	Thu, 9 Aug 2001 08:36:20 +1200 (NZST)
Received: from stat.auckland.ac.nz (g.ihaka.slip.auckland.ac.nz [130.216.9.243])
	by stat1.stat.auckland.ac.nz (8.10.2+Sun/8.8.8) with ESMTP id f78KaJ720404;
	Thu, 9 Aug 2001 08:36:19 +1200 (NZST)
Sender: ihaka@stat.auckland.ac.nz
Message-ID: <3B71A31A.8BB29F85@stat.auckland.ac.nz>
Date: Thu, 09 Aug 2001 08:37:46 +1200
From: Ross Ihaka <ihaka@stat.auckland.ac.nz>
Organization: University of Auckland
X-Mailer: Mozilla 4.76 [en] (X11; U; Linux 2.2.12 i386)
X-Accept-Language: en
MIME-Version: 1.0
To: p.dalgaard@biostat.ku.dk
CC: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Palette changes on redraw (PR#1045)
References: <200108081708.TAA11359@pubhealth.ku.dk>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

p.dalgaard@biostat.ku.dk wrote:
> 
> Try this
> 
> example(palette)
> 
> then trigger a redraw e.g. by resizing the window. Shouldn't the
> palette be stored as part of the display list?
> 
> (This only happens because the palette was reset at the end of the
> example, but still...)

I could argue either way on this.

I agree that its nasty to have plot colours change in mid-stream,
but I suspect that adding the palette to the display list may not
be the "right" solution.

A different approach would be to map the colour indices (and names)
to RGB values at a slightly higher level.  That way it would be the
RGB values which would be captured in the display list, not the
indices.

[ I'm afraid that I think that the whole display list mechanism is
  "wrong".  We need a much higher level way of describing plots. ]

	Ross

==> 1045.audit <==
Sat Aug 11 09:57:42 2001	ripley	moved from incoming to Graphics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1088 *
Subject:  barplot forces xpd=TRUE 
From: Peter Whiting <pwhiting@whitings.org>
Date: Sat, 8 Sep 2001 10:19:00 -0500
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1088 <==
From postmaster@franz.stat.wisc.edu  Sat Sep  8 17:19:16 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA14427
	for <r-bugs@biostat.ku.dk>; Sat, 8 Sep 2001 17:19:15 +0200 (MET DST)
Received: from whitings.org (really [65.169.182.99]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15fjt2-000J0iC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Sat, 8 Sep 2001 10:19:12 -0500 (CDT) 
Received: (from pwhiting@localhost)
	by whitings.org (8.11.2/8.11.2) id f88FJ0832396;
	Sat, 8 Sep 2001 10:19:00 -0500
Date: Sat, 8 Sep 2001 10:19:00 -0500
From: Peter Whiting <pwhiting@whitings.org>
Message-Id: <200109081519.f88FJ0832396@whitings.org>
To: r-bugs@r-project.org
Subject:  barplot forces xpd=TRUE 
Cc: pwhiting@whitings.org


<<insert bug report here>>

barplot hardcodes xpd as "TRUE" causing the bars to go outside of the
plot region.  True can be the default, but it shouldn't be the only
option.

*** barplot.R   Sat Sep  8 10:15:16 2001
--- barplot.R.orig      Sat Sep  8 10:03:39 2001
***************
*** 5,11 ****
           legend.text = NULL, beside = FALSE, horiz = FALSE,
           col = heat.colors(NR), border = par("fg"),
           main = NULL, sub = NULL, xlab = NULL, ylab = NULL,
!          xlim = NULL, ylim = NULL, xpd = TRUE,
           axes = TRUE, axisnames = TRUE, inside = TRUE, plot = TRUE, ...)
  {
      if (!missing(inside)) .NotYetUsed("inside", error = FALSE)
--- 5,11 ----
           legend.text = NULL, beside = FALSE, horiz = FALSE,
           col = heat.colors(NR), border = par("fg"),
           main = NULL, sub = NULL, xlab = NULL, ylab = NULL,
!          xlim = NULL, ylim = NULL,
           axes = TRUE, axisnames = TRUE, inside = TRUE, plot = TRUE, ...)
  {
      if (!missing(inside)) .NotYetUsed("inside", error = FALSE)
***************
*** 61,68 ****
        w.m <- matrix(w.m, nc = NC)
      if(plot) { ##-------- Plotting :
        opar <-
!           if (horiz)  par(xaxs = "i", xpd=xpd)
!           else        par(yaxs = "i", xpd=xpd)
        on.exit(par(opar))

        plot.new()
--- 61,68 ----
        w.m <- matrix(w.m, nc = NC)
      if(plot) { ##-------- Plotting :
        opar <-
!           if (horiz)  par(xaxs = "i", xpd = TRUE)
!           else        par(yaxs = "i", xpd = TRUE)
        on.exit(par(opar))

        plot.new()



--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = 
 major = 1
 minor = 3.1
 year = 2001
 month = 08
 day = 31
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base

==> 1088.audit <==
Sun Sep 16 11:01:03 2001	ripley	moved from incoming to Graphics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1147 *
Subject: postscript problem
From: kjetil halvorsen <kjetilh@umsanet.edu.bo>
Date: Fri, 26 Oct 2001 15:23:45 -0400
--This seems to be a problem with screen/layout rather than postscript.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1147 <==
From postmaster@franz.stat.wisc.edu  Fri Oct 26 21:23:17 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA03528
	for <r-bugs@biostat.ku.dk>; Fri, 26 Oct 2001 21:23:16 +0200 (MET DST)
Received: from jupiter.umsanet.edu.bo (really [166.114.17.11]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15xCZT-000JIvC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Fri, 26 Oct 2001 14:23:11 -0500 (CDT) 
Received: from umsanet.edu.bo (pc69.umsanet.edu.bo [166.114.17.69])
	by jupiter.umsanet.edu.bo (8.11.0/8.9.3) with ESMTP id f9QJZjK01812
	for <r-bugs@r-project.org>; Fri, 26 Oct 2001 15:35:47 -0400
Message-ID: <3BD9B841.215F6DB3@umsanet.edu.bo>
Date: Fri, 26 Oct 2001 15:23:45 -0400
From: kjetil halvorsen <kjetilh@umsanet.edu.bo>
Reply-To: kjetilh@umsanet.edu.bo
Organization: UMSA
X-Mailer: Mozilla 4.7 [en] (Win98; I)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs@r-project.org
Subject: postscript problem
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

I reported this earlier, and have got reports that others have the same
promlem on UNIX machines, so it is not only a windows problem
S I file a bug report.

The function (boot.stat) given at the end produces a postscript file, 
which cannot be included correctly in LaTeX. Specifically, 
the image in LaTeX (when translated by dvips to postscript)
becomes very small, not using the bounding box, and turned on its head!

Kjetil Halvorsen

boot.stat <-
function (x, B = 1000, norm = FALSE) 
{
    xname <- deparse(substitute(x))
    means <- meds <- numeric(B)
    for (i in 1:B) {
        s <- sample(x, replace = TRUE)
        means[i] <- mean(s)
        meds[i] <- median(s)
    }
    CImedian <- quantile(meds, c(0.025, 0.5, 0.975))
    CImean <- quantile(means, c(0.025, 0.5, 0.975))
    hmean <- hist(means, freq = FALSE, plot = FALSE)
    hmeds <- hist(meds, freq = FALSE, plot = FALSE)
    split.screen(c(1, 2))
    xlims <- range(c(hmean$breaks, hmeds$breaks))
    ymax <- max(c(hmean$density, hmeds$density))
    screen(1)
    plot(hmean, freq = FALSE, col = "red", xlim = xlims, ylim = c(0, 
        ymax), xlab = paste("Sampling dist. of mean of ", xname), 
        main = "")
    if (norm) {
        n <- length(x)
        mu <- mean(x)
        sd <- sqrt(var(x)/n)
        ps <- seq(xlims[1], xlims[2], len = 100)
        lines(ps, dnorm(ps, mu, sd), col = "darkgreen")
    }
    lines(CImean, rep(ymax/2, 3))
    points(CImean[2], ymax/2, cex = 2, col = "black")
    screen(2)
    plot(hmeds, freq = FALSE, col = "lightblue", xlim = xlims, 
        ylim = c(0, ymax), xlab = paste("Sampling dist. of median of ",
            xname), main = "")
    if (norm) {
        n <- length(x)
        p <- 1/2
        mu <- median(x)
        d <- density(x, n = 1, from = mu, to = mu)$y
        sd <- sqrt(p * (1 - p)/n)/d
        ps <- seq(xlims[1], xlims[2], len = 100)
        lines(ps, dnorm(ps, mu, sd), col = "darkgreen")
    }
    lines(CImedian, rep(ymax/2, 3))
    points(CImedian[2], ymax/2, cex = 2, col = "black")
    names(B) <- "Number of bootstrap replicactions"
    invisible(list(CImean = CImean, CImedian = CImedian, B, means =
means, 
        meds = meds))
}


call with for example

boot.stat( rnorm(100), norm=TRUE)

==> 1147.audit <==
Wed Oct 31 15:17:18 2001	ripley	changed notes
Wed Oct 31 15:17:18 2001	ripley	foobar
Wed Oct 31 15:17:18 2001	ripley	moved from incoming to Graphics

==> 1147.followup.1 <==
From postmaster@franz.stat.wisc.edu Thu Feb  7 16:39:12 2002
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA05430
	for <r-bugs@biostat.ku.dk>; Thu, 7 Feb 2002 16:39:09 +0100 (MET)
Received: from jupiter.umsanet.edu.bo (really [166.114.17.11]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m16YqdA-000IbFC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Thu, 7 Feb 2002 09:38:36 -0600 (CST) 
Received: from umsanet.edu.bo (antiguo31.umsanet.edu.bo [192.168.14.31])
	by jupiter.umsanet.edu.bo (8.11.0/8.9.3) with ESMTP id g17FqWW23666
	for <r-bugs@r-project.org>; Thu, 7 Feb 2002 11:52:33 -0400
Message-ID: <3C629F2F.71DBBE02@umsanet.edu.bo>
Date: Thu, 07 Feb 2002 11:37:19 -0400
From: kjetil halvorsen <kjetilh@umsanet.edu.bo>
Reply-To: kjetilh@umsanet.edu.bo
Organization: UMSA
X-Mailer: Mozilla 4.7 [en] (Win98; I)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs@r-project.org
Subject: PR# 1147
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Content-Length: 328
Status: RO

Apropops todays automatic bug report: The bug #1147 I reported
(postscript, problems with screen layout) which I treported some time
ago, does not anymore occur R1.4.0, windows 98, when I test with the
same code that caused the original problem. Fixed as a by-product of the
internal changes to graphics code?

Kjetil Halvorsen

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1157 *
Subject: identify(...plot=F)
From: Rolf Turner <rolf@maths.uwa.edu.au>
Date: Fri, 2 Nov 2001 09:43:49 +0800 (WST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1157 <==
From postmaster@franz.stat.wisc.edu  Fri Nov  2 02:44:03 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id CAA04480
	for <r-bugs@biostat.ku.dk>; Fri, 2 Nov 2001 02:44:02 +0100 (MET)
Received: from madvax.maths.uwa.edu.au (really [130.95.16.1]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15zTNG-000JR7C@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Thu, 1 Nov 2001 19:43:58 -0600 (CST) 
Received: from salvia.maths.uwa.edu.au (salvia.maths.uwa.edu.au [130.95.16.72])
	by madvax.maths.uwa.edu.au (8.12.0/8.12.0) with ESMTP id fA21hn47187084
	for <r-bugs@r-project.org>; Fri, 2 Nov 2001 09:43:50 +0800 (WST)
From: Rolf Turner <rolf@maths.uwa.edu.au>
Date: Fri, 2 Nov 2001 09:43:49 +0800 (WST)
Message-Id: <200111020143.JAA12083@salvia.maths.uwa.edu.au>
To: r-bugs@r-project.org
Subject: identify(...plot=F)


If I execute, e.g.

> x <- round(runif(20,0,1),2)
> y <- round(runif(20,0,1),2)
> plot(x,y,xlim=c(0,1),ylim=c(0,1))
> identify(x,y,n=1,plot=F)

then I get the index of the identified point printed in the command
window, and ***initially*** the index is NOT displayed in the
graphics window (which is the behaviour I had hoped and expected
to obtain by setting ``plot=F'').

BUT THEN if I lower and then raise the graphics window, poof!!!
the index appears, unwanted, in the plot.

I think a workaround is to issue the identify command as

> identify(x,y,n=1,col=0)

but still, shouldn't the function work as advertized?

Version information:

platform i686-pc-linux-gnu
arch     i686             
os       linux-gnu        
system   i686, linux-gnu  
status                    
major    1                
minor    3.1              
year     2001             
month    08               
day      31               
language R

                                cheers,

                                        Rolf Turner

Usual address:     rolf@math.unb.ca
Current address:   rolf@maths.uwa.edu.au

==> 1157.audit <==
Sun Nov  4 13:49:09 2001	ripley	moved from incoming to Graphics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1161 *
Subject: x-axis label in persp()
From: Rolf Turner <rolf@maths.uwa.edu.au>
Date: Wed, 7 Nov 2001 18:07:22 +0800 (WST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1161 <==
From postmaster@franz.stat.wisc.edu  Wed Nov  7 11:07:32 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA22526
	for <r-bugs@biostat.ku.dk>; Wed, 7 Nov 2001 11:07:32 +0100 (MET)
Received: from madvax.maths.uwa.edu.au (really [130.95.16.1]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m161PcE-000JLZC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Wed, 7 Nov 2001 04:07:26 -0600 (CST) 
Received: from salvia.maths.uwa.edu.au (salvia.maths.uwa.edu.au [130.95.16.72])
	by madvax.maths.uwa.edu.au (8.12.0/8.12.0) with ESMTP id fA7A7M7Z209411
	for <r-bugs@r-project.org>; Wed, 7 Nov 2001 18:07:23 +0800 (WST)
From: Rolf Turner <rolf@maths.uwa.edu.au>
Date: Wed, 7 Nov 2001 18:07:22 +0800 (WST)
Message-Id: <200111071007.SAA21120@salvia.maths.uwa.edu.au>
To: r-bugs@r-project.org
Subject: x-axis label in persp()


If the surface to be plotted by persp() is supplied as
a list, the x-axis label defaults to the name, in the call,
of this list --- which is usually silly.

I would suggest changing the first four lines of
persp.default() (where the x-axis label gets set) from

if (is.null(xlab))
        xlab <- if (!missing(x))
            deparse(substitute(x))
        else "X"

to

if (is.null(xlab))
        xlab <- if (!missing(x) && !is.list(x) && !is.matrix(x))
            deparse(substitute(x))
        else "X"

which makes the x-axis label default to "X" if the surface
is specified as a list.


					cheers,

						Rolf Turner

Current email address: rolf@maths.uwa.edu.au
Usual email address:   rolf@math.unb.ca

==> 1161.audit <==
Sun Nov 11 17:22:03 2001	ripley	moved from incoming to Graphics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1207 *
Subject: boxplot labels incorrect when horizontal = TRUE
From: Rashid Nassar <rnassar@duke.edu>
Date: Sun, 9 Dec 2001 21:46:32 -0500 (EST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1207 <==
From rnassar@duke.edu  Mon Dec 10 03:47:18 2001
Received: from gibson.acpub.duke.edu (gibson.acpub.duke.edu [152.3.233.8])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id DAA19748
	for <r-bugs@biostat.ku.dk>; Mon, 10 Dec 2001 03:47:17 +0100 (MET)
Received: from godzilla5.acpub.duke.edu (rnassar@godzilla5.acpub.duke.edu [152.3.233.46]) 
        by gibson.acpub.duke.edu (8.11.5/8.11.3/Duke-5.0.0) with ESMTP id fBA2kYR03236 for <r-bugs@biostat.ku.dk>;
        Sun, 9 Dec 2001 21:46:34 -0500 (EST)
Received: (from rnassar@localhost)
	by godzilla5.acpub.duke.edu (8.9.3/8.9.3) id VAA28884;
	Sun, 9 Dec 2001 21:46:33 -0500 (EST)
Date: Sun, 9 Dec 2001 21:46:32 -0500 (EST)
From: Rashid Nassar <rnassar@duke.edu>
X-Sender: rnassar@godzilla5.acpub.duke.edu
To: r-bugs <r-bugs@biostat.ku.dk>
Subject: boxplot labels incorrect when horizontal = TRUE
Message-ID: <Pine.SOL.3.91.1011209214428.28790B-100000@godzilla5.acpub.duke.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Scanned: by amavisd-milter, Duke University (http://amavis.org/)

#Example:

y <- rnorm(10)
group <- gl(2,5)

plot(y ~ group, horizontal = TRUE)  # BUG: default xlab & ylab interchanged
plot(y ~ group, horizontal = FALSE) # OK: supplies correct default xlab & ylab


# Using boxplot() instead of plot() omits default axis labels altogether
# (not sure if this is intentional):

boxplot(y ~ group, horizontal = FALSE) # no default axis labels supplied
boxplot(y ~ group, horizontal = TRUE)  # no default axis labels supplied

Thank you!

Rashid Nassar


--please do not edit the information below--

Version:
 platform = i586-pc-linux-gnu
 arch = i586
 os = linux-gnu
 system = i586, linux-gnu
 status = 
 major = 1
 minor = 3.1
 year = 2001
 month = 08
 day = 31
 language = R

Search Path:
 .GlobalEnv, Shoes, package:nls, package:nlme, package:ctest, Autoloads, 
package:base


==> 1207.audit <==
Mon Dec 10 08:21:15 2001	ripley	foobar
Mon Dec 10 08:21:15 2001	ripley	moved from incoming to Graphics

==> 1207.followup.1 <==
From ripley@stats.ox.ac.uk  Mon Dec 10 08:41:33 2001
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id IAA20814
	for <R-bugs@biostat.ku.dk>; Mon, 10 Dec 2001 08:41:32 +0100 (MET)
Received: from gannet.stats (IDENT:root@gannet.stats [163.1.20.127])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id HAA10031;
	Mon, 10 Dec 2001 07:41:26 GMT
Received: from localhost (ripley@localhost)
	by gannet.stats (8.11.3/8.11.3) with ESMTP id fBA7fQZ09146;
	Mon, 10 Dec 2001 07:41:26 GMT
X-Authentication-Warning: gannet.stats: ripley owned process doing -bs
Date: Mon, 10 Dec 2001 07:41:26 +0000 (GMT)
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
X-X-Sender:  <ripley@gannet.stats>
To: <rnassar@duke.edu>
cc: <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] boxplot labels incorrect when horizontal = TRUE (PR#1207)
In-Reply-To: <200112100247.DAA19758@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.31.0112100733010.9079-100000@gannet.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Mon, 10 Dec 2001 rnassar@duke.edu wrote:

> #Example:
>
> y <- rnorm(10)
> group <- gl(2,5)
>
> plot(y ~ group, horizontal = TRUE)  # BUG: default xlab & ylab interchanged
> plot(y ~ group, horizontal = FALSE) # OK: supplies correct default xlab & ylab

Um.  That's plot.formula, not boxplot.  horizontal = TRUE is *not* a
documented argument to plot.formula.  If you pass arguments to boxplot
through ... (rather than just par values), you may well get unexpected
results.

To fix this needs plot.formula to recognize horizontal, and that's
an API change which I don't advocate during feature freeze.
Generally, not doing something which is not documented to happen is not a
bug, so I'll put this on the wishlist.

> # Using boxplot() instead of plot() omits default axis labels altogether
> # (not sure if this is intentional):
>
> boxplot(y ~ group, horizontal = FALSE) # no default axis labels supplied
> boxplot(y ~ group, horizontal = TRUE)  # no default axis labels supplied

Yes, it's intentional.  You can always use title().


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1235 *
Subject: Axes labelling with logarithmic scales
From: tobias.hoevekamp@ilw.agrl.ethz.ch
Date: Thu, 3 Jan 2002 15:29:02 +0100 (MET)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1235 <==
From tobias.hoevekamp@ilw.agrl.ethz.ch  Thu Jan  3 15:29:03 2002
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA25589
	for <R-bugs@biostat.ku.dk>; Thu, 3 Jan 2002 15:29:02 +0100 (MET)
Date: Thu, 3 Jan 2002 15:29:02 +0100 (MET)
From: tobias.hoevekamp@ilw.agrl.ethz.ch
Message-Id: <200201031429.PAA25589@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: Axes labelling with logarithmic scales

Full_Name: Tobias Hoevekamp
Version: 1.4.0
OS: Debian GNU/Linux
Submission from: (NULL) (129.132.139.109)


There seems to be a problem with the labelling of axes when
logarithmic scales are used. More than half of 
both axes are not labeled in the following example:


x <-  c(0.12,  0.3,   0.53,  1.1,   1.8,  2.6, 4.5)
y <-  c(0.012, 0.021, 0.032, 0.055, 0.1,  0.2, 0.35)

plot(x, y,
     log="xy",
     main="Problem with axes labelling on logarithmic scales",
     xlab="x, why aren't 0.5, or even smaller tic-values displyed?",
     ylab="y, why isn't 0.05 diplayed?")


==> 1235.audit <==
Mon Jan  7 10:33:27 2002	ripley	foobar
Mon Jan  7 10:33:27 2002	ripley	moved from incoming to Graphics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1243 *
Subject: abline and log plots
From: stephen@cogsci.ed.ac.uk
Date: Sat, 5 Jan 2002 01:11:47 +0100 (MET)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1243 <==
From stephen@cogsci.ed.ac.uk  Sat Jan  5 01:11:47 2002
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA12564
	for <R-bugs@biostat.ku.dk>; Sat, 5 Jan 2002 01:11:47 +0100 (MET)
Date: Sat, 5 Jan 2002 01:11:47 +0100 (MET)
From: stephen@cogsci.ed.ac.uk
Message-Id: <200201050011.BAA12564@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: abline and log plots

Full_Name: Stephen Eglen
Version: 1.4
OS: Redhat Linux 7.1
Submission from: (NULL) (128.252.204.36)


abline() produces a spurious line in addition to the correct line, at least with

the X11 driver.  The postscript file generated also has nan values in it, which
causes an error under ghostscript.

xs <- c(0, 150, 300)
ys <- c(75, 40, 23)
par(mfrow=c(1,2))
plot(xs,ys, log="")
abline(70, -0.25, -.1, untf=F)
plot(xs,ys, log="y")
abline(70, -0.3, -.1, untf=T)
dev.copy2eps(file="abline.ps")


==> 1243.reply.1 <==
From p.dalgaard@biostat.ku.dk  Sat Jan  5 01:31:17 2002
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA12594;
	Sat, 5 Jan 2002 01:31:16 +0100 (MET)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id g050VDC18011;
	Sat, 5 Jan 2002 01:31:13 +0100
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: stephen@cogsci.ed.ac.uk
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] abline and log plots (PR#1243)
References: <200201050011.BAA12574@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 05 Jan 2002 01:31:13 +0100
In-Reply-To: <200201050011.BAA12574@pubhealth.ku.dk>
Message-ID: <x2bsg9d4fi.fsf@blueberry.kubism.ku.dk>
Lines: 37
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

stephen@cogsci.ed.ac.uk writes:

> Full_Name: Stephen Eglen
> Version: 1.4
> OS: Redhat Linux 7.1
> Submission from: (NULL) (128.252.204.36)
> 
> 
> abline() produces a spurious line in addition to the correct line, at least with
> 
> the X11 driver.  The postscript file generated also has nan values in it, which
> causes an error under ghostscript.
> 
> xs <- c(0, 150, 300)
> ys <- c(75, 40, 23)
> par(mfrow=c(1,2))
> plot(xs,ys, log="")
> abline(70, -0.25, -.1, untf=F)
> plot(xs,ys, log="y")
> abline(70, -0.3, -.1, untf=T)
> dev.copy2eps(file="abline.ps")

Still in the development version too. Notice that it is log="y" +
untf=T that is causing the trouble. Looks like the clipping algorithm
is getting confused.

A fairly straightforward workaround is 

plot(xs,ys, log="y")
curve(70-0.3*x,add=T)


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1243.audit <==
Mon Jan  7 10:32:50 2002	ripley	foobar
Mon Jan  7 10:32:50 2002	ripley	moved from incoming to Graphics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1248 *
Subject: piechart default colour
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 07 Jan 2002 18:54:02 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1248 <==
From postmaster@franz.stat.wisc.edu  Mon Jan  7 18:54:40 2002
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA01829
	for <r-bugs@biostat.ku.dk>; Mon, 7 Jan 2002 18:54:39 +0100 (MET)
Received: from pubhealth.ku.dk (really [130.225.108.10]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m16NdyN-000IY9C@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Mon, 7 Jan 2002 11:54:11 -0600 (CST) 
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA01825
	for <r-bugs@r-project.org>; Mon, 7 Jan 2002 18:54:20 +0100 (MET)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id g07Hs3e32039;
	Mon, 7 Jan 2002 18:54:03 +0100
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: r-bugs@r-project.org
Subject: piechart default colour
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 07 Jan 2002 18:54:02 +0100
Message-ID: <x2666ef3np.fsf@blueberry.kubism.ku.dk>
Lines: 12
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

As of 1.4.0, the default colour of pieslices is black. Try
piechart(1:3) for instance. The workaround is to use an explicit
col="white" argument.

(Of course, everything in example(piechart) uses fancy colour schemes,
so nobody noticed that the default got changed.)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1248.audit <==
Fri Jan 11 09:02:18 2002	pd	moved from incoming to Graphics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  In-Out

none

Directory:  Installation

* PR# 1222 *
Subject: configure: sed: Function s%@PDFLATEX@%/usr/local/bin/pdflatex%g
From: Peter Kleiweg <kleiweg@let.rug.nl>
Date: Thu, 20 Dec 2001 14:09:42 +0100 (CET)
--problem is on hppa2.0-hp-hpux10.20: may be HP-UX specific
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1222 <==
From postmaster@franz.stat.wisc.edu  Thu Dec 20 14:10:13 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id OAA13749
	for <r-bugs@biostat.ku.dk>; Thu, 20 Dec 2001 14:10:12 +0100 (MET)
Received: from kleigh.nl (really [213.84.55.218]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m16H2xF-000IXfC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Thu, 20 Dec 2001 07:09:45 -0600 (CST) 
Received: from kleigh.nl (kleigh [127.0.0.1])
	by kleigh.nl (8.12.0/8.12.0) with ESMTP id fBKD9goQ007981
	for <r-bugs@r-project.org>; Thu, 20 Dec 2001 14:09:43 +0100
Received: from localhost (peter@localhost)
	by kleigh.nl (8.12.0/8.12.0/Submit) with ESMTP id fBKD9gPQ007978
	for <r-bugs@r-project.org>; Thu, 20 Dec 2001 14:09:42 +0100
X-Authentication-Warning: kleigh.nl: peter owned process doing -bs
Date: Thu, 20 Dec 2001 14:09:42 +0100 (CET)
From: Peter Kleiweg <kleiweg@let.rug.nl>
X-X-Sender:  <kleiweg@kleigh.nl>
To: <r-bugs@r-project.org>
Subject: configure: sed: Function s%@PDFLATEX@%/usr/local/bin/pdflatex%g
 cannot be parsed.
Message-ID: <Pine.LNX.4.33.0112201304160.476-100000@kleigh.nl>
Organization: Alfa-Informatica, Rijksuniversiteit Groningen
X-Accept-Language: nl,en,ia,af,de,da,no,sv,fr,it
X-Alert: http://www.opensource.org/halloween/
X-Face: "K~X:~!ydgSdjNy;]_+BCb\OM^pqyg_q*Le84$l46M\-mL=.^,L4B}bDK>`o#r4_>O*
X-Mailer: Pine 4.33, Linux 2.0.36, i586
X-Reason: http://www.interlingua.com/
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


Sometimes, configure isn't able to create the makefiles. It
produces errors like:

sed: Function s%@PDFLATEX@%/usr/local/bin/pdflatex%g cannot be parsed.

This happens when I use a combination of arguments to configure like:

    --prefix=$HOME/R-tst
    --with-tcl-config=/opt_local/opt/tcl/lib/tclConfig.sh
    --with-tk-config=/opt_local/opt/tk/lib/tkConfig.sh

If I leave out the last two arguments, the problem does not
occur.

If I change the first argument to --prefix=$HOME/Rtst, the
problem does not occur.

--please do not edit the information below--

Version:
 platform = hppa2.0-hp-hpux10.20
 arch = hppa2.0
 os = hpux10.20
 system = hppa2.0, hpux10.20
 status =
 major = 1
 minor = 4.0
 year = 2001
 month = 12
 day = 19
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base


==> 1222.audit <==
Fri Dec 21 06:19:29 2001	ripley	changed notes
Fri Dec 21 06:19:29 2001	ripley	foobar
Fri Dec 21 06:19:29 2001	ripley	moved from incoming to Installation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Language

* PR# 408 *
Subject: convolution bug
From: wsimpson@gcal.ac.uk
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 408 <==
From wsimpson@gcal.ac.uk  Fri Jan 28 11:17:36 2000
Received: from localhost (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA11325
	for <R-bugs@biostat.ku.dk>; Fri, 28 Jan 2000 11:17:36 +0100 (MET)
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)
From: wsimpson@gcal.ac.uk
Message-Id: <200001281017.LAA11325@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: convolution bug

Full_Name: Bill Simpson
Version: 65.1 , 0.90.1
OS: Linux
Submission from: (NULL) (193.62.250.209)


I reported this on r-help, but here is official bug report.

The present convolve() does not do convolution by default. Its default behaviour
is
correlation. This is a bug.

The default argument conj should be set to FALSE.

The zero-padding should be on the right for linear convolution (don't ask me
why you call this type="open"; I suggest type="linear").

Here is what I expect linear convolution to do:
myconvolve<-function (x,h) 
{
    nx <- length(x)
    nh <- length(h)
    #zero pad
    if(nx>nh)
       {
       x <- c(x,rep(0, nh-1))
       h<-c(h,rep(0,nx-1))
       }
    else
       {
       h <- c(h,rep(0, nx-1))
       x<-c(x,rep(0,nh-1))
       }
    x <- fft(fft(x) * fft(h), inv = TRUE)
    Re(x)/length(x)
#I am not sure about this, the R IFFT is weird
}

What "circular" convolution should do is just
eliminate the zero-padding:

myconvolve2<-function (x,h)
{
#no padding, circular convolution
    nx <- length(x)
    nh <- length(h)
    x <- fft(fft(x) * fft(h), inv = TRUE)
    Re(x)/(nx)
}


I suggest that you create two functions, convolve() and correlate(), and get
rid
of the conj argument in convolve().

==> 408.audit <==
Wed Feb 16 19:28:42 2000	ripley	moved from incoming to Language
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 412 *
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 412 <==
From postmaster@franz.stat.wisc.edu  Sun Feb  6 01:16:33 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA26868
	for <R-bugs@biostat.ku.dk>; Sun, 6 Feb 2000 01:16:31 +0100 (MET)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id BAA18080
	for <r-bugs@hypatia.math.ethz.ch>; Sun, 6 Feb 2000 01:16:38 +0100 (MET)
Received: from franz.stat.wisc.edu(128.105.174.95)
 via SMTP by hypatia, id smtpdAAAa004QS; Sun Feb  6 01:16:33 2000
Received: from pubhealth.ku.dk (really [130.225.108.10]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m12HFNP-000ZSxC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <r-bugs@r-project.org>; Sat, 5 Feb 2000 18:16:31 -0600 (CST) 
Received: from biostat.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA26864
	for <r-bugs@r-project.org>; Sun, 6 Feb 2000 01:16:18 +0100 (MET)
Received: (from pd@localhost)
	by biostat.ku.dk (8.9.3/8.9.3) id BAA12311;
	Sun, 6 Feb 2000 01:18:51 +0100
Sender: pd@blueberry.kubism.ku.dk
To: r-bugs@r-project.org
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
Message-ID: <x2900zyyhh.fsf@blueberry.kubism.ku.dk>
Lines: 51
X-Mailer: Gnus v5.7/Emacs 20.4
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit


Call objects don't always behave as you'd expect. They're mostly
list-like, but with exceptions:

> f<-function(x,y,...)match.call(expand.dots=FALSE)
> xx <- f(y=1,2,z=3,4)
> dd <- xx$...
> xx$... <- NULL
> c(xx,dd)
[[1]]
f(x = 2, y = 1)

$z
[1] 3

[[3]]
[1] 4

> as.call(c(as.list(xx),dd))
f(x = 2, y = 1, z = 3, 4)

(Splus has this rather differently, since dd becomes a call to list()
rather than a list of promises:

S> c(xx,dd)
f(x = 2, y = 1, list, z = 3, 4)
S> as.call(c(as.list(xx),dd))
f(x = 2, y = 1, list, z = 3, 4)

...but at least gives the same in both cases)

Also, the names of arguments added with [[<- is getting dropped if a
new element is required:

> xx[["abc"]]<-123
> xx
f(x = 2, y = 1, 123)

S has what I'd expect there:

S> xx[["abc"]]<-123
S> xx
f(x = 2, y = 1, abc = 123)

[R-0.99.0 prerelease on RedHat6.1, but this is likely not a new thing.]

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 412.audit <==
Wed Feb 16 19:26:57 2000	ripley	moved from incoming to Language
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 669 *
Subject: Bug(s) w/ rbind.data.frame(); fix also read.table(*, as.is = TRUE) ?
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 25 Sep 2000 10:17:15 +0200
--status of AsIs columns
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 669 <==
From maechler@stat.math.ethz.ch  Mon Sep 25 10:17:01 2000
Received: from stat.math.ethz.ch (daemon@hypatia.ethz.ch [129.132.58.23])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id KAA01907
	for <R-bugs@biostat.ku.dk>; Mon, 25 Sep 2000 10:17:01 +0200 (MET DST)
Received: (from daemon@localhost)
	by stat.math.ethz.ch (8.9.1/8.9.1) id KAA07627
	for <R-bugs@stat.math.ethz.ch>; Mon, 25 Sep 2000 10:17:19 +0200 (MET DST)
Received: from lynne(129.132.58.30), claiming to be "lynne.ethz.ch"
 via SMTP by hypatia, id smtpdAAAa001r9; Mon Sep 25 10:17:15 2000
Received: (maechler@localhost) by lynne.ethz.ch (8.9.3/D-MATH-client) id KAA01475; Mon, 25 Sep 2000 10:17:15 +0200
X-Authentication-Warning: lynne.ethz.ch: maechler set sender to maechler@stat.math.ethz.ch using -f
From: Martin Maechler <maechler@stat.math.ethz.ch>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <14799.2571.494467.836722@gargle.gargle.HOWL>
Date: Mon, 25 Sep 2000 10:17:15 +0200
To: R-bugs@stat.math.ethz.ch
Subject: Bug(s) w/ rbind.data.frame(); fix also read.table(*, as.is = TRUE) ?
X-Mailer: VM 6.76 under Emacs 20.7.1
Reply-To: Martin Maechler <maechler@stat.math.ethz.ch>

This is not only bug report, but also a RFC (request for comments):

The basic problem is that there are (at least) two ways of easily getting
non-factor character columns in data.frames.
The first is  
    read.table(*, as.is = TRUE) 
and the second is
    data.frame(.., I(...), ..)	      

which differ in their result. Whereas the first produces `pure' character
columns in the data.frame, the second approach gives `AsIs' classed
columns (character, or, e.g. logical).

Now, as the following shows,  rbind.data.frame()  *is* buggy anyway,
I wonder if we shouldn't change read.table(*, as.is = TRUE)
such that the non-numeric columns of its result become "AsIs" classed as
well:

-----------

str(d1 <- data.frame(a=1:3, b = I(letters[1:3])))
## d1 is `alright'
## d0: The same but a `character' *not* protected by AsIs:
d0 <- d1
d0$b <- unclass(d0$b)
str(d0)
## Note that this is *really* the same as a what you get from
##  read.table(*, as.is = TRUE)
##  ----------
##  R's read.table() is S+ compatible; however I wonder if
##  we shouldn't add  "AsIs" classes to all non-numeric components...
##  the classes, shouldn't harm, but ensure consistency of treatment..

str(d11 <- rbind(d1, new = c(7, "N"))) ## alright
str(d01 <- rbind(d0, new = c(7, "N"))) ## all wrong :
## Both columns were coerced to factors !!
##-- S-PLUS 5 coerces both to "character" -- which is better,
##  since the new row *is* all character

## R makes nonsense with 'b' [factor w/ 1 level "N": NA NA NA 1]
## S+ 5.1 does exactly the right thing [both a & b still look like in d0,d1 :
str(d12 <- rbind(d1, new = data.frame(a= 7, b="N")))##
str(d02 <- rbind(d0, new = data.frame(a= 7, b="N")))##

---------

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

==> 669.audit <==
Wed Oct 25 20:31:21 2000	ripley	changed notes
Wed Oct 25 20:31:21 2000	ripley	foobar
Wed Oct 25 20:31:21 2000	ripley	moved from incoming to Language
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 921 *
Subject:  Managed to confuse match.arg 
From: J.C.Rougier@durham.ac.uk
Date: Wed, 25 Apr 2001 12:22:54 +0100 (BST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 921 <==
From postmaster@franz.stat.wisc.edu  Wed Apr 25 13:23:07 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id NAA14338
	for <r-bugs@biostat.ku.dk>; Wed, 25 Apr 2001 13:23:06 +0200 (MET DST)
Received: from hermes.dur.ac.uk (really [129.234.4.9]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m14sNO6-000JH1C@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Wed, 25 Apr 2001 06:23:14 -0500 (CDT) 
Received: from euclid (euclid.dur.ac.uk [129.234.21.53])
	by hermes.dur.ac.uk (8.11.1/8.11.1) with ESMTP id f3PBMtl04590
	for <r-bugs@r-project.org>; Wed, 25 Apr 2001 12:22:55 +0100 (BST)
Received: from laplace by euclid id <MAA23210@euclid>; Wed, 25 Apr 2001 12:22:49 +0100 (BST)
From: J.C.Rougier@durham.ac.uk
Date: Wed, 25 Apr 2001 12:22:54 +0100 (BST)
Message-Id: <8522.200104251122@laplace>
To: r-bugs@r-project.org
Cc: dma0jcr@laplace.dur.ac.uk
Subject:  Managed to confuse match.arg 

This one may not strictly be a bug, and it was certainly my
fault, but it took me a while to track it down and it is rather
strange:

funOne <- function(x)
{
  funTwo <- 1:10
  funTwo(x)
}

funTwo <- function(v) 2*v

funOne(5) # answer is 10 as expected

# now a different definition for funTwo with a match.arg

funTwo <- function(v, foo=c("small", "large"))
{
  foo <- match.arg(foo)
  print(foo)
  2*v
}

funOne(5) # answer is 10, but foo is NULL

What happens is that in funOne I mask funTwo with a vector, but
that doesn't matter as the call to funTwo specifies
mode="function" (or something similar).  But what happens when
funTwo includes a match.arg?  In this case match.arg fails, and
the reason it fails is that sys.function(sys.parent()) in
match.arg evaluates to 1:10.  If there is a bug here it is the
failure of sys.function to grab a function, with the result that
formal.args in match.fun is NULL.

Cheers, Jonathan.

--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.7
 arch = sparc
 os = solaris2.7
 system = sparc, solaris2.7
 status = 
 major = 1
 minor = 2.1
 year = 2001
 month = 01
 day = 15
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

==> 921.reply.1 <==
From postmaster@franz.stat.wisc.edu  Thu Apr 26 01:01:48 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA04470
	for <r-bugs@biostat.ku.dk>; Thu, 26 Apr 2001 01:01:47 +0200 (MET DST)
Received: from pubhealth.ku.dk (really [130.225.108.10]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m14sYIG-000JdlC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Wed, 25 Apr 2001 18:01:56 -0500 (CDT) 
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA04466
	for <r-bugs@r-project.org>; Thu, 26 Apr 2001 01:01:27 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id BAA30388;
	Thu, 26 Apr 2001 01:10:27 +0200
Sender: pd@pubhealth.ku.dk
To: r-bugs@r-project.org
Subject: match.arg confusion (PR#921)
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 26 Apr 2001 01:10:27 +0200
Message-ID: <x2zod4r2xo.fsf@blueberry.kubism.ku.dk>
Lines: 22
X-Mailer: Gnus v5.7/Emacs 20.7
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit


[sys.function fails sometimes (sorry, our mail system decide to throw
away the original mail)]

Yes, I bumped into something similar recently. The problem is that we
only actually store the call in the context structure, not the
function, so sys.function has to grab the call, take the 1st element,
and reevaluate it in the parent frame. It is quite easy to think up
examples where a second evaluation does not give the same value as
the first. 

Your particular case is of a slightly different natur and should be
easily fixable by replacing findVar in R_sysfunction by findVar1 and
looking specifically for objects of mode "function", but the basic
problem persists. I don't think I want to risk fixing this (and maybe
unfixing something else) for 1.2.3 tomorrow though.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 921.audit <==
Thu Apr 26 12:30:31 2001	pd	moved from incoming to Language
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1073 *
Subject: Wierd problem comparing numeric values and list using ==
From: "Warnes, Gregory R" <gregory_r_warnes@groton.pfizer.com>
Date: Fri, 24 Aug 2001 22:07:41 -0400
--see also PR#1075
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1073 <==
From postmaster@franz.stat.wisc.edu  Sat Aug 25 04:08:02 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id EAA03646
	for <r-bugs@biostat.ku.dk>; Sat, 25 Aug 2001 04:08:01 +0200 (MET DST)
Received: from mailrelay1.pfizer.com (really [192.77.198.2]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15aSrf-000JIlC@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Fri, 24 Aug 2001 21:07:59 -0500 (CDT) 
Received: from gsun56.pfizer.com (localhost [127.0.0.1])
	by mailrelay1.pfizer.com (8.9.3/Pro-8.9.3) with ESMTP id WAA09177
	for <r-bugs@r-project.org>; Fri, 24 Aug 2001 22:07:43 -0400 (EDT)
Received: from groexms01.pfizer.com (localhost [127.0.0.1])
	by gsun56.pfizer.com (Pro-8.9.3/Pro-8.9.3) with ESMTP id WAA24921
	for <r-bugs@r-project.org>; Fri, 24 Aug 2001 22:08:07 -0400 (EDT)
Received: from groexcncr05.pfizer.com (unverified) by groexms01.pfizer.com
 (Content Technologies SMTPRS 4.2.1) with ESMTP id <T559305f66fac1e08e203f@groexms01.pfizer.com> for <r-bugs@r-project.org>;
 Fri, 24 Aug 2001 22:07:41 -0400
Received: by groexcncr05.pfizer.com with Internet Mail Service (5.5.2650.21)
	id <R3ZPXZDF>; Fri, 24 Aug 2001 22:07:41 -0400
Message-ID: <5429125E11E4D411AF7300805FE603A8014CED55@groexmbcr02.pfizer.com>
From: "Warnes, Gregory R" <gregory_r_warnes@groton.pfizer.com>
To: "'r-bugs@r-project.org'" <r-bugs@r-project.org>
Subject: Wierd problem comparing numeric values and list using ==
Date: Fri, 24 Aug 2001 22:07:41 -0400
MIME-Version: 1.0
X-Mailer: Internet Mail Service (5.5.2650.21)
Content-Type: text/plain; charset="ISO-8859-1"


Under R 1.3.0 on Solaris and Windows NT  there seems to be a bug in == when
applied to elements of a list, particularly when one of the elements is of
mode integer:

	> list(1) == list(1)
	[1] FALSE
	> 1 == list(1)
	[1] TRUE
	> as.integer(1)==list(as.integer(1))
	[1] FALSE
	> as.integer(1)==list(as.double(1))
	[1] FALSE
	> list(as.integer(1))==list(as.integer(1))
	[1] FALSE
	> list(as.integer(1))==as.integer(1)
	[1] FALSE
	> list(as.double(1))==list(as.double(1))
	[1] FALSE

However, these cases work:

	> as.double(1)==list(as.integer(1))
	[1] TRUE
	> list(as.integer(1))==as.double(1)
	[1] TRUE

Replacing the bare integer/double with a vector constructed with c() doesn't
change the results, and comparing between vectors created with c() appears
correct.

-Greg

--please do not edit the information below--

Version:
 platform = i386-pc-mingw32
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 major = 1
 minor = 3.0
 year = 2001
 month = 06
 day = 22
 language = R

Windows NT 4.0 (build 1381) Service Pack 5

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base


LEGAL NOTICE
Unless expressly stated otherwise, this message is confidential and may be privileged. It is intended for the addressee(s) only. Access to this E-mail by anyone else is unauthorized. If you are not an addressee, any disclosure or copying of the contents of this E-mail or any action taken (or not taken) in reliance on it is unauthorized and may be unlawful. If you are not an addressee, please inform the sender immediately.

==> 1073.reply.1 <==
From p.dalgaard@biostat.ku.dk  Sat Aug 25 15:58:26 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA04833;
	Sat, 25 Aug 2001 15:58:25 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id f7PDv9r21975;
	Sat, 25 Aug 2001 15:57:09 +0200
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: gregory_r_warnes@groton.pfizer.com
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Wierd problem comparing numeric values and list using == (PR#1073)
References: <200108250208.EAA03656@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 25 Aug 2001 15:57:09 +0200
In-Reply-To: <200108250208.EAA03656@pubhealth.ku.dk>
Message-ID: <x23d6gmedm.fsf@blueberry.kubism.ku.dk>
Lines: 57
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

gregory_r_warnes@groton.pfizer.com writes:

> Under R 1.3.0 on Solaris and Windows NT  there seems to be a bug in == when
> applied to elements of a list, particularly when one of the elements is of
> mode integer:
> 
> 	> list(1) == list(1)
> 	[1] FALSE
> 	> 1 == list(1)
> 	[1] TRUE
> 	> as.integer(1)==list(as.integer(1))
> 	[1] FALSE
> 	> as.integer(1)==list(as.double(1))
> 	[1] FALSE
> 	> list(as.integer(1))==list(as.integer(1))
> 	[1] FALSE
> 	> list(as.integer(1))==as.integer(1)
> 	[1] FALSE
> 	> list(as.double(1))==list(as.double(1))
> 	[1] FALSE
> 
> However, these cases work:
> 
> 	> as.double(1)==list(as.integer(1))
> 	[1] TRUE
> 	> list(as.integer(1))==as.double(1)
> 	[1] TRUE
> 
> Replacing the bare integer/double with a vector constructed with c() doesn't
> change the results, and comparing between vectors created with c() appears
> correct.

It is not entirely clear what we *should* be doing here. S (-PLUS 3.4)
is at least consistent:

> list(1) == list(1)
Error in list(1) == list(1): == operation on mode "list" undefined
Dumped
>  1 == list(1)
Error in 1 == list(1): == operation on mode "list" undefined
Dumped
> as.integer(1)==list(as.integer(1))
Error in as.integer(1) == list(as.integer(1)): == operation on mode "list"
        undefined
Dumped
...

so one might argue that you shouldn't do that in the first place...
(or that the bug is that we do not expressly forbid doing this.)

        -p

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1073.audit <==
Tue Aug 28 10:14:14 2001	ripley	moved from incoming to Language
Tue Aug 28 10:16:19 2001	ripley	changed notes
Tue Aug 28 10:16:19 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1076 *
Subject: Re: [Rd] Wierd problem comparing numeric values and list using == 
From: John Chambers <jmc@research.bell-labs.com>
Date: Mon, 27 Aug 2001 08:44:22 -0400
--part of PR#1073
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1076 <==
From jmc@research.bell-labs.com  Mon Aug 27 14:45:38 2001
Received: from crufty.research.bell-labs.com (crufty.research.bell-labs.com [204.178.16.49])
	by pubhealth.ku.dk (8.9.3/8.9.1) with SMTP id OAA16860;
	Mon, 27 Aug 2001 14:45:37 +0200 (MET DST)
Received: from scummy.research.bell-labs.com ([135.104.2.10]) by crufty; Mon Aug 27 08:40:52 EDT 2001
Received: from jessie.research.bell-labs.com (jessie.research.bell-labs.com [135.104.13.5])
	by scummy.research.bell-labs.com (8.11.4/8.11.4) with ESMTP id f7RCiOl07715;
	Mon, 27 Aug 2001 08:44:24 -0400 (EDT)
Received: from research.bell-labs.com (IDENT:jmc@newton.research.bell-labs.com [135.104.13.158])
	by jessie.research.bell-labs.com (8.9.1/8.9.1) with ESMTP id IAA18247;
	Mon, 27 Aug 2001 08:44:23 -0400 (EDT)
Sender: jmc@research.bell-labs.com
Message-ID: <3B8A40A6.15AF96C2@research.bell-labs.com>
Date: Mon, 27 Aug 2001 08:44:22 -0400
From: John Chambers <jmc@research.bell-labs.com>
Organization: Bell Labs, Lucent Technologies
X-Mailer: Mozilla 4.72 [en] (X11; U; Linux 2.2.14-5.0 i686)
X-Accept-Language: en
MIME-Version: 1.0
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
CC: gregory_r_warnes@groton.pfizer.com, r-devel@stat.math.ethz.ch,
        R-bugs@biostat.ku.dk
Subject: Re: [Rd] Wierd problem comparing numeric values and list using == 
 (PR#1073)
References: <200108250208.EAA03656@pubhealth.ku.dk> <x23d6gmedm.fsf@blueberry.kubism.ku.dk>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Peter Dalgaard BSA wrote:
> 
> gregory_r_warnes@groton.pfizer.com writes:
> 
> > Under R 1.3.0 on Solaris and Windows NT  there seems to be a bug in == when
> > applied to elements of a list, particularly when one of the elements is of
> > mode integer:
> >
> >       > list(1) == list(1)
> >       [1] FALSE
> >       > 1 == list(1)
> >       [1] TRUE
> >       > as.integer(1)==list(as.integer(1))
> >       [1] FALSE
> >       > as.integer(1)==list(as.double(1))
> >       [1] FALSE
> >       > list(as.integer(1))==list(as.integer(1))
> >       [1] FALSE
> >       > list(as.integer(1))==as.integer(1)
> >       [1] FALSE
> >       > list(as.double(1))==list(as.double(1))
> >       [1] FALSE
> >
> > However, these cases work:
> >
> >       > as.double(1)==list(as.integer(1))
> >       [1] TRUE
> >       > list(as.integer(1))==as.double(1)
> >       [1] TRUE
> >
> > Replacing the bare integer/double with a vector constructed with c() doesn't
> > change the results, and comparing between vectors created with c() appears
> > correct.
> 
> It is not entirely clear what we *should* be doing here. S (-PLUS 3.4)
> is at least consistent:
> 
> > list(1) == list(1)
> Error in list(1) == list(1): == operation on mode "list" undefined
> Dumped
> >  1 == list(1)
> Error in 1 == list(1): == operation on mode "list" undefined
> Dumped
> > as.integer(1)==list(as.integer(1))
> Error in as.integer(1) == list(as.integer(1)): == operation on mode "list"
>         undefined
> Dumped
> ...
> 
> so one might argue that you shouldn't do that in the first place...
> (or that the bug is that we do not expressly forbid doing this.)
> 
>         -p
> 
> --
>    O__  ---- Peter Dalgaard             Blegdamsvej 3
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

As of 1.4, we will have the `identical' function, which is the right way
to do such comparisons in any case.

So I'd vote for making a use of the comparison operators an error unless
the type is correct (or there is a method defined).  There is even code
in relop.c (commented out) that looks like the right test.  Any
objections?

John

-- 
John M. Chambers                  jmc@bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-2681
700 Mountain Avenue, Room 2C-282  fax:    (908)582-3340
Murray Hill, NJ  07974            web: http://www.cs.bell-labs.com/~jmc

==> 1076.reply.1 <==
From p.dalgaard@biostat.ku.dk  Mon Aug 27 15:36:50 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA17663;
	Mon, 27 Aug 2001 15:36:49 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id f7RDZHZ03790;
	Mon, 27 Aug 2001 15:35:17 +0200
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: jmc@research.bell-labs.com
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Wierd problem comparing numeric values and list using == (PR#1076)
References: <200108271245.OAA16874@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 27 Aug 2001 15:35:17 +0200
In-Reply-To: <200108271245.OAA16874@pubhealth.ku.dk>
Message-ID: <x27kvpwrqi.fsf@blueberry.kubism.ku.dk>
Lines: 56
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

jmc@research.bell-labs.com writes:

> > >       > list(1) == list(1)
> > >       [1] FALSE
> > >       > 1 == list(1)
> > >       [1] TRUE
> > >       > as.integer(1)==list(as.integer(1))
> > >       [1] FALSE
> > >       > as.integer(1)==list(as.double(1))
> > >       [1] FALSE
> > >       > list(as.integer(1))==list(as.integer(1))
> > >       [1] FALSE
> > >       > list(as.integer(1))==as.integer(1)
> > >       [1] FALSE
> > >       > list(as.double(1))==list(as.double(1))
> > >       [1] FALSE
> > >
> > > However, these cases work:
> > >
> > >       > as.double(1)==list(as.integer(1))
> > >       [1] TRUE
> > >       > list(as.integer(1))==as.double(1)
> > >       [1] TRUE
....
> As of 1.4, we will have the `identical' function, which is the right way
> to do such comparisons in any case.
> 
> So I'd vote for making a use of the comparison operators an error unless
> the type is correct (or there is a method defined).  There is even code
> in relop.c (commented out) that looks like the right test.  Any
> objections?

Not really, except that I get the usual nagging suspicion that someone
(who?) meant something by doing it this way...

The current logic seems to be that if either side of the == is a
vector of atomic type, try to coerce the list on the other side to a
similar object and then test. However this has a clear bug in that the
coercion is to double even when the atomic vector is integer. If there
are lists on both sides, a pointer comparison is done:

> x<-2
> list(x)==list(x)
[1] FALSE
> list(.Alias(x))==list(.Alias(x))
[1] TRUE

The latter seems highly dubious to me. I'd rather have a recursive
pairwise application of "==" there. However, none of this is what
identical does, is it?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1076.audit <==
Tue Aug 28 10:14:14 2001	ripley	moved from incoming to Language
Tue Aug 28 10:15:49 2001	ripley	changed notes
Tue Aug 28 10:15:49 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1186 *
Subject: a patch to tapply
From: Vadim Ogranovich <vograno@arbitrade.com>
Date: Thu, 29 Nov 2001 14:48:35 -0600
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1186 <==
From postmaster@franz.stat.wisc.edu  Thu Nov 29 21:48:55 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA14928
	for <r-bugs@biostat.ku.dk>; Thu, 29 Nov 2001 21:48:54 +0100 (MET)
Received: from syn.arbitrade.com (really [208.47.220.70]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m169Y6y-000IWoC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Thu, 29 Nov 2001 14:48:48 -0600 (CST) 
Received: from urg.arbitrade.com (urg.arbitrade.com [10.0.9.25])
	by syn.arbitrade.com (8.11.1/8.11.1) with ESMTP id fATKlSE29652
	for <r-bugs@r-project.org>; Thu, 29 Nov 2001 14:47:28 -0600 (CST)
Received: from mnmail.arbitrade.com (mnmail.arbitrade.com [38.156.36.157])
	by urg.arbitrade.com (8.11.1/8.11.1) with ESMTP id fATKmf519971
	for <r-bugs@r-project.org>; Thu, 29 Nov 2001 14:48:41 -0600 (CST)
Received: by mnmail.arbitrade.com with Internet Mail Service (5.5.2653.19)
	id <XXDQF55J>; Thu, 29 Nov 2001 14:48:41 -0600
Message-ID: <AFD78192EC49D311BFAE00902798AB8F23D65A@jupiter.sc.arbitrade.com>
From: Vadim Ogranovich <vograno@arbitrade.com>
To: "'r-bugs@r-project.org'" <r-bugs@r-project.org>
Subject: a patch to tapply
Date: Thu, 29 Nov 2001 14:48:35 -0600
MIME-Version: 1.0
X-Mailer: Internet Mail Service (5.5.2653.19)
Content-Type: text/plain;
	charset="iso-8859-1"

Though tapply(x, factor, fun, simplify =TRUE) should be equivalent to
sapply(split(x, factor), fun, simplify=TRUE), note simplify=TRUE, it is not
so if fun() returns a vector rather than a scalar, e.g.

> tapply(1:6, c(0,0,0,1,1,1), function(x) c(min=min(x), max=max(x)),
simplify=TRUE)
$"0"
min max 
  1   3 

$"1"
min max 
  4   6 

> sapply(split(1:6, c(0,0,0,1,1,1)), function(x) c(min=min(x), max=max(x)),
simplify=TRUE)
    0 1
min 1 4
max 3 6

The patch submitted below fixes this problem
> tapply.new(1:6, c(0,0,0,1,1,1), function(x) c(min=min(x), max=max(x)),
simplify=TRUE)
    0 1
min 1 4
max 3 6

Another potential problem, which I am not able to verify at the moment, is
that whenever simplification is possible S-Plus returns a TRANSPOSE of that
of R, i.e.
  min max
0   1   3
1   4   6

Fixing this would require small changes to both tapply and sapply and I'll
be happy to provide the patches if requested.


R Version
> sapply(R.Version(), I)
           platform                arch                  os
system 
"i686-pc-linux-gnu"              "i686"         "linux-gnu"   "i686,
linux-gnu" 
             status               major               minor
year 
                 ""                 "1"               "3.1"
"2001" 
              month                 day            language 
               "08"                "31"                 "R"

 **************
The patch:
"tapply.new" <-
  function (X, INDEX, FUN = NULL, ..., simplify = TRUE) 
{
  FUN <- if (!is.null(FUN)) 
    match.fun(FUN)
  if (!is.list(INDEX)) 
    INDEX <- list(INDEX)
  nI <- length(INDEX)
  namelist <- vector("list", nI)
  names(namelist) <- names(INDEX)
  extent <- integer(nI)
  nx <- length(X)
  one <- as.integer(1)
  group <- rep(one, nx)
  ngroup <- one
  for (i in seq(INDEX)) {
    index <- as.factor(INDEX[[i]])
    if (length(index) != nx) 
      stop("arguments must have same length")
    namelist[[i]] <- levels(index)
    extent[i] <- nlevels(index)
    group <- group + ngroup * (as.integer(index) - one)
    ngroup <- ngroup * nlevels(index)
  }
  if (is.null(FUN)) 
    return(group)
  ans <- lapply(split(X, group), FUN, ...)
  if (simplify && length(common.len <- unique(unlist(lapply(ans, length))))
== 1) {
    if (common.len > 1) {
      extent <- c(common.len, extent)
      namelist <- c(list(names(ans[[1]])), namelist)
    }
    ansmat <- array(unlist(ans, recursive = FALSE), dim = extent, dimnames =
namelist)
    return(ansmat)
  }
  index <- as.numeric(names(ans))
  ansmat <- array(vector("list", prod(extent)), dim = extent, 
                  dimnames = namelist)
  names(ans) <- NULL
  ansmat[index] <- ans
  ansmat
}

-------------------------------------------------- 
DISCLAIMER 
This e-mail, and any attachments thereto, is intended only for use by the
addressee(s) named herein and may contain legally privileged and/or
confidential information.  If you are not the intended recipient of this
e-mail, you are hereby notified that any dissemination, distribution or
copying of this e-mail, and any attachments thereto, is strictly prohibited.
If you have received this e-mail in error, please immediately notify me and
permanently delete the original and any copy of any e-mail and any printout
thereof. 

E-mail transmission cannot be guaranteed to be secure or error-free.  The
sender therefore does not accept liability for any errors or omissions in
the contents of this message which arise as a result of e-mail transmission.

NOTICE REGARDING PRIVACY AND CONFIDENTIALITY 

Knight Trading Group may, at its discretion, monitor and review the content
of all e-mail communications. 


==> 1186.audit <==
Fri Dec 28 20:08:08 2001	thomas	moved from incoming to Language
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1193 *
Subject: Re: [R] appending similar data frames?
From: Thomas Lumley <tlumley@u.washington.edu>
Date: Mon, 3 Dec 2001 13:46:35 -0800 (PST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1193 <==
From postmaster@franz.stat.wisc.edu  Mon Dec  3 22:46:44 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA15057
	for <r-bugs@biostat.ku.dk>; Mon, 3 Dec 2001 22:46:43 +0100 (MET)
Received: from jason04.u.washington.edu (really [140.142.8.53]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m16B0v7-000IXdC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Mon, 3 Dec 2001 15:46:37 -0600 (CST) 
Received: from homer01.u.washington.edu (homer01.u.washington.edu [140.142.15.35])
	by jason04.u.washington.edu (8.11.6+UW01.08/8.11.6+UW01.10) with ESMTP id fB3LkZP24524
	for <r-bugs@r-project.org>; Mon, 3 Dec 2001 13:46:35 -0800
Received: from localhost (tlumley@localhost)
	by homer01.u.washington.edu (8.11.6+UW01.08/8.11.6+UW01.10) with ESMTP id fB3LkZo127810
	for <r-bugs@r-project.org>; Mon, 3 Dec 2001 13:46:35 -0800
Date: Mon, 3 Dec 2001 13:46:35 -0800 (PST)
From: Thomas Lumley <tlumley@u.washington.edu>
To: <r-bugs@r-project.org>
Subject: Re: [R] appending similar data frames?
In-Reply-To: <b0qn0uoourcor9a0hbmdqvcgknfbsedieh@4ax.com>
Message-ID: <Pine.A41.4.33.0112031342240.70328-100000@homer01.u.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Mon, 3 Dec 2001, Duncan Murdoch wrote:

> As long as the names match exactly in the two original frames, you
> should be able to do it using "rbind" and "cbind":
>
> Specifically:
>
>  rbind( cbind(x, 'x'), cbind(y, 'y') )
>


I would have thought that the recycling rules allowed this, but it doesn't
work and you need cbind(x, rep('x', NROW(x))) instead.

The documentation only specifically addresses vectors and matrices but
says
     When the arguments consist of a mix of matrices and vectors the
     number of columns (rows) of the result is determined by the number
     of columns (rows) of the matrix arguments.  Any vectors have their
     values recycled or subsetted to achieve this length.

I think it's a bug, but it might just be a documentation bug.


	-thomas


==> 1193.audit <==
Mon Dec 10 20:04:50 2001	thomas	moved from incoming to Language
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1214 *
Subject: syntax questtion, maybe a bug
From: Rich Heiberger <rmh@surfer.sbm.temple.edu>
Date: Thu, 13 Dec 2001 13:46:54 -0500 (EST)
--Is .2logl meant to be a valid name in R? It is S
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1214 <==
From rmh@surfer.sbm.temple.edu  Thu Dec 13 19:44:55 2001
Received: from surfer.sbm.temple.edu (surfer.sbm.temple.edu [155.247.185.2])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA09950
	for <R-bugs@biostat.ku.dk>; Thu, 13 Dec 2001 19:44:55 +0100 (MET)
Received: (from rmh@localhost)
	by surfer.sbm.temple.edu (8.11.1/8.11.1) id fBDIksf2527242
	for R-bugs@biostat.ku.dk; Thu, 13 Dec 2001 13:46:54 -0500 (EST)
Date: Thu, 13 Dec 2001 13:46:54 -0500 (EST)
From: Rich Heiberger <rmh@surfer.sbm.temple.edu>
Message-Id: <200112131846.fBDIksf2527242@surfer.sbm.temple.edu>
To: R-bugs@biostat.ku.dk
Subject: syntax questtion, maybe a bug


S-Plus takes names of the form ".2logl" since it sees a single set of
letters beginning with "." and continuing with alphanumerics.
> .2logl <- function(x) 2*log(x)
> .2logl(3)
[1] 2.197225
>

The same name is rejected by R, my guess is that the ".2" is recognized as
a number and then there is no operator symbol between the "2" and the
following alphabet symbols.
> .2logl <- function(x) 2*log(x)
Error: syntax error

Is this an intentional syntax difference between R and S?  Or is it a bug?


(continue)
I am using rw1031 Version 1.3.1  (2001-08-31) on windows.

Rich

==> 1214.audit <==
Sat Dec 15 10:55:43 2001	ripley	changed notes
Sat Dec 15 10:55:43 2001	ripley	foobar
Sat Dec 15 10:55:43 2001	ripley	moved from incoming to Language
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1241 *
Subject:  Problem with "missing" in "local" 
From: J.C.Rougier@durham.ac.uk
Date: Fri, 4 Jan 2002 13:34:34 GMT
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1241 <==
From postmaster@franz.stat.wisc.edu  Fri Jan  4 14:41:56 2002
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id OAA07662
	for <r-bugs@biostat.ku.dk>; Fri, 4 Jan 2002 14:41:55 +0100 (MET)
Received: from hermes.dur.ac.uk (really [129.234.4.9]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m16MUb9-000IZ3C@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Fri, 4 Jan 2002 07:41:27 -0600 (CST) 
Received: from euclid (euclid.dur.ac.uk [129.234.21.53])
	by hermes.dur.ac.uk (8.11.1/8.11.1) with ESMTP id g04DYZr02195
	for <r-bugs@r-project.org>; Fri, 4 Jan 2002 13:34:35 GMT
Received: from arrow.dur.ac.uk by euclid id <g04DYYG10013@euclid>; Fri, 4 Jan 2002 13:34:34 GMT
From: J.C.Rougier@durham.ac.uk
Date: Fri, 4 Jan 2002 13:34:34 GMT
Message-Id: <28125.200201041334@arrow.dur.ac.uk>
To: r-bugs@r-project.org
Subject:  Problem with "missing" in "local" 
Cc: dma0jcr@arrow.dur.ac.uk
X-ECS-MailScanner: Found to be clean

Hi everyone,

I encountered unexpected behaviour when calling "missing" within a
"local" environment, namely

fred <- function(x, y)
{
  x <- as.vector(x)
  local({
    dontwantme <- 1:100
    if (missing(y)) print("No \"y\" today")
  })
  x
}

whereupon I get

> fred(1:10)
Error in eval(expr, envir, enclos) : "missing" illegal use of missing

I think it is reasonable to expect missing to work in this context (I
suspect the problem relates to lazy evaluation): if not, it might be
helpful to amend the help file.

Cheers, Jonathan.

--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = 
 major = 1
 minor = 4.0
 year = 2001
 month = 12
 day = 19
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

==> 1241.followup.1 <==
From ripley@stats.ox.ac.uk  Fri Jan  4 14:51:24 2002
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id OAA07830
	for <R-bugs@biostat.ku.dk>; Fri, 4 Jan 2002 14:51:23 +0100 (MET)
Received: from gannet.stats (IDENT:root@gannet.stats [163.1.20.127])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id NAA03055;
	Fri, 4 Jan 2002 13:50:56 GMT
Received: from localhost (ripley@localhost)
	by gannet.stats (8.11.3/8.11.3) with ESMTP id g04Doui08194;
	Fri, 4 Jan 2002 13:50:56 GMT
X-Authentication-Warning: gannet.stats: ripley owned process doing -bs
Date: Fri, 4 Jan 2002 13:50:56 +0000 (GMT)
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
X-X-Sender:  <ripley@gannet.stats>
To: <J.C.Rougier@durham.ac.uk>
cc: <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] Problem with "missing" in "local" (PR#1241)
In-Reply-To: <200201041341.OAA07672@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.31.0201041347390.8133-100000@gannet.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Fri, 4 Jan 2002 J.C.Rougier@durham.ac.uk wrote:

> Hi everyone,
>
> I encountered unexpected behaviour when calling "missing" within a
> "local" environment, namely
>
> fred <- function(x, y)
> {
>   x <- as.vector(x)
>   local({
>     dontwantme <- 1:100
>     if (missing(y)) print("No \"y\" today")
>   })
>   x
> }
>
> whereupon I get
>
> > fred(1:10)
> Error in eval(expr, envir, enclos) : "missing" illegal use of missing
>
> I think it is reasonable to expect missing to work in this context (I
> suspect the problem relates to lazy evaluation): if not, it might be
> helpful to amend the help file.

Why do you think it reasonable?  You've take a function from

     Evaluate an R expression in a specified environment.

and evaluated it somewhere where missing() is not defined.  If you had
used eval() explicitly, would you think it reasonable?  I doubt it.

Which help file did you have in mind?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 1241.followup.2 <==
From J.C.Rougier@durham.ac.uk  Fri Jan  4 15:48:01 2002
Received: from hermes.dur.ac.uk (hermes.dur.ac.uk [129.234.4.9])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA09042
	for <R-bugs@biostat.ku.dk>; Fri, 4 Jan 2002 15:48:01 +0100 (MET)
Received: from euclid (euclid.dur.ac.uk [129.234.21.53])
	by hermes.dur.ac.uk (8.11.1/8.11.1) with ESMTP id g04EbSr02994;
	Fri, 4 Jan 2002 14:37:29 GMT
Received: from durham.ac.uk by euclid id <g04EbSG15752@euclid>; Fri, 4 Jan 2002 14:37:28 GMT
Sender: dma0jcr@durham.ac.uk
Message-ID: <3C35BE28.DFA1C500@durham.ac.uk>
Date: Fri, 04 Jan 2002 14:37:28 +0000
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk>
Organization: Maths Dept., Univ. of Durham
X-Mailer: Mozilla 4.77 [en] (X11; U; Linux 2.4.9-12 i686)
X-Accept-Language: en
MIME-Version: 1.0
To: Prof Brian Ripley <ripley@stats.ox.ac.uk>
CC: R-bugs@biostat.ku.dk
Subject: Re: [Rd] Problem with "missing" in "local" (PR#1241)
References: <Pine.LNX.4.31.0201041347390.8133-100000@gannet.stats>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-ECS-MailScanner: Found to be clean

Hi Brian,

Prof Brian Ripley wrote:
> 
> On Fri, 4 Jan 2002 J.C.Rougier@durham.ac.uk wrote:
> 
> > Hi everyone,
> >
> > I encountered unexpected behaviour when calling "missing" within a
> > "local" environment, namely
> >
> > fred <- function(x, y)
> > {
> >   x <- as.vector(x)
> >   local({
> >     dontwantme <- 1:100
> >     if (missing(y)) print("No \"y\" today")
> >   })
> >   x
> > }
> >
> > whereupon I get
> >
> > > fred(1:10)
> > Error in eval(expr, envir, enclos) : "missing" illegal use of missing
> >
> > I think it is reasonable to expect missing to work in this context (I
> > suspect the problem relates to lazy evaluation): if not, it might be
> > helpful to amend the help file.
> 
> Why do you think it reasonable?  You've take a function from
> 
>      Evaluate an R expression in a specified environment.
> 
> and evaluated it somewhere where missing() is not defined.  If you had
> used eval() explicitly, would you think it reasonable?  I doubt it.

By "reasonable" in this context I mean that the operation would appear
to be well-defined and useful.  I can access x within the local()
environment, ie it is found in the enclosing environment, and I do not
think that y should be treated any differently.  If I modify my function
to read

fred <- function(x, y)
{
  x <- as.vector(x)
  local({
    print(x)
    print(y)
    if (missing(y)) print("No \"y\" today")
  })
  x
}

then I get the error message

> fred(1:10)
 [1]  1  2  3  4  5  6  7  8  9 10
Error in print(y) : Argument "y" is missing, with no default

This error message suggests to me that "missing(y)" would evaluate
correctly.

> 
> Which help file did you have in mind?
> 

The help file for "missing".  This points out that "missing" is not
always reliable, eg after "x <- match.arg(x)".  Perhaps this could be
another example of "unreliability".

Cheers, Jonathan.

-- 
Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE
tel: +44 (0)191 374 2361, fax: +44 (0)191 374 7388
http://www.maths.dur.ac.uk/stats/people/jcr/jcr.html

==> 1241.audit <==
Mon Jan  7 10:33:01 2002	ripley	moved from incoming to Language
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Low-level

* PR# 989 *
Subject: "[.data.frame" allows un-named 3rd subscript
From: "Charles C. Berry" <cberry@tajo.ucsd.edu>
Date: Mon, 18 Jun 2001 13:13:46 -0700 (PDT)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 989 <==
From cberry@tajo.ucsd.edu  Mon Jun 18 22:10:28 2001
Received: from mailbox4.ucsd.edu (mailbox4.ucsd.edu [132.239.1.56])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA14900
	for <r-bugs@biostat.ku.dk>; Mon, 18 Jun 2001 22:10:27 +0200 (MET DST)
Received: from smtp.ucsd.edu (smtp.ucsd.edu [132.239.1.49])
	by mailbox4.ucsd.edu (8.11.3/8.11.0) with ESMTP id f5IKAKq28590
	for <r-bugs@biostat.ku.dk>; Mon, 18 Jun 2001 13:10:20 -0700 (PDT)
Received: from tajo.ucsd.edu (tajo.ucsd.edu [132.239.99.2])
	by smtp.ucsd.edu (8.9.3/8.9.3) with ESMTP id NAA24075
	for <r-bugs@biostat.ku.dk>; Mon, 18 Jun 2001 13:10:20 -0700 (PDT)
Received: by tajo.ucsd.edu (8.9.3+Sun/SMI-SVR4-UCSD.1)
	id NAA15110; Mon, 18 Jun 2001 13:13:46 -0700 (PDT)
Date: Mon, 18 Jun 2001 13:13:46 -0700 (PDT)
Message-Id: <200106182013.NAA15110@tajo.ucsd.edu>
From: "Charles C. Berry" <cberry@tajo.ucsd.edu>
To: r-bugs@biostat.ku.dk
Subject: "[.data.frame" allows un-named 3rd subscript


Since the Extract page has usage as:

     x[i, j, ... , drop=TRUE]

I would expect that 'drop=' would need to be given to the third 'subscript'

> diag(4)[ , 4 , 4 ] # Forgot 'drop=' or added extra ','
Error in diag(4)[, 4, 4] : incorrect number of dimensions
> 
> as.data.frame( diag(4) )[ , 4 , 4 ] # should return error, right?
[1] 0 0 0 1


Also note:

> diag(4)[ ,  , drop=TRUE ]
     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    1    0    0
[3,]    0    0    1    0
[4,]    0    0    0    1
> 
> as.data.frame( diag(4) )[ ,  , drop=TRUE ]
Error in [.data.frame(as.data.frame(diag(4)), , , drop = 4) : 
	Argument "j" is missing, with no default
> 

--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.7
 arch = sparc
 os = solaris2.7
 system = sparc, solaris2.7
 status = 
 major = 1
 minor = 2.3
 year = 2001
 month = 04
 day = 26
 language = R

Search Path:
 .GlobalEnv, package:nls, package:nlme, package:ctest, Autoloads, package:base



Chuck

-- 
Charles C. Berry                        (858) 534-2098 
                                         Dept of Family/Preventive Medicine
E mailto:cberry@tajo.ucsd.edu	         UC San Diego
http://hacuna.ucsd.edu/members/ccb.html  La Jolla, San Diego 92093-0645

 

==> 989.reply.1 <==
From pd@blueberry.kubism.ku.dk  Mon Jun 18 22:35:29 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA15008;
	Mon, 18 Jun 2001 22:35:28 +0200 (MET DST)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.9.3/8.9.3) id WAA31163;
	Mon, 18 Jun 2001 22:38:38 +0200
Sender: pd@pubhealth.ku.dk
To: cberry@tajo.ucsd.edu
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] "[.data.frame" allows un-named 3rd subscript (PR#989)
References: <200106182010.WAA14911@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 18 Jun 2001 22:38:38 +0200
In-Reply-To: cberry@tajo.ucsd.edu's message of "Mon, 18 Jun 2001 22:10:29 +0200 (MET DST)"
Message-ID: <x27ky9o75d.fsf@blueberry.kubism.ku.dk>
Lines: 34
X-Mailer: Gnus v5.7/Emacs 20.7
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

cberry@tajo.ucsd.edu writes:

> Since the Extract page has usage as:
> 
>      x[i, j, ... , drop=TRUE]
> 
> I would expect that 'drop=' would need to be given to the third 'subscript'
> 
> > diag(4)[ , 4 , 4 ] # Forgot 'drop=' or added extra ','
> Error in diag(4)[, 4, 4] : incorrect number of dimensions
> > 
> > as.data.frame( diag(4) )[ , 4 , 4 ] # should return error, right?
> [1] 0 0 0 1
> 

And the bug is?

The generic indexing should really be x[...,drop=T].  Methods for
specific classes can specialize to a particular number of indices if
they want to, which is what is happening here

> get ("[.data.frame")
function (x, i, j, drop = if (missing(i)) TRUE else length(cols) == 
    1) 

one could fairly easily slip in a "..." argument after "j", and then
inside the function give an error if "..." is not empty, but what
would the point be?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 989.followup.1 <==
From cberry@tajo.ucsd.edu  Mon Jun 18 23:06:32 2001
Received: from mailbox3.ucsd.edu (mailbox3.ucsd.edu [132.239.1.55])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA15201;
	Mon, 18 Jun 2001 23:06:31 +0200 (MET DST)
Received: from smtp.ucsd.edu (smtp.ucsd.edu [132.239.1.49])
	by mailbox3.ucsd.edu (8.10.1/8.11.0) with ESMTP id f5IL6PR16820;
	Mon, 18 Jun 2001 14:06:25 -0700 (PDT)
Received: from tajo.ucsd.edu (tajo.ucsd.edu [132.239.99.2])
	by smtp.ucsd.edu (8.9.3/8.9.3) with ESMTP id OAA06469;
	Mon, 18 Jun 2001 14:06:24 -0700 (PDT)
Received: from localhost by tajo.ucsd.edu (8.9.3+Sun/SMI-SVR4-UCSD.1)
	id OAA15733; Mon, 18 Jun 2001 14:09:49 -0700 (PDT)
Date: Mon, 18 Jun 2001 14:09:49 -0700 (PDT)
From: "Charles C. Berry" <cberry@tajo.ucsd.edu>
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] "[.data.frame" allows un-named 3rd subscript (PR#989)
In-Reply-To: <x27ky9o75d.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.05.10106181348090.12737-100000@tajo.ucsd.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


See below.

On 18 Jun 2001, Peter Dalgaard BSA wrote:

> cberry@tajo.ucsd.edu writes:
> 
> > Since the Extract page has usage as:
> > 
> >      x[i, j, ... , drop=TRUE]
> > 
> > I would expect that 'drop=' would need to be given to the third 'subscript'
> > 
> > > diag(4)[ , 4 , 4 ] # Forgot 'drop=' or added extra ','
> > Error in diag(4)[, 4, 4] : incorrect number of dimensions
> > > 
> > > as.data.frame( diag(4) )[ , 4 , 4 ] # should return error, right?
> > [1] 0 0 0 1
> > 
> 
> And the bug is?
> 
> The generic indexing should really be x[...,drop=T].  Methods for
> specific classes can specialize to a particular number of indices if
> they want to, which is what is happening here
> 
> > get ("[.data.frame")
> function (x, i, j, drop = if (missing(i)) TRUE else length(cols) == 
>     1) 
> 
> one could fairly easily slip in a "..." argument after "j", and then
> inside the function give an error if "..." is not empty, but what
> would the point be?
> 

The point would be to catch errors like this

for ( i in 1:2 ) foo[i,2] <- my.fun( bar[,i,2] , another.arg )

that might otherwise pass unnoticed when 'bar' is a data.frame.


Charles C. Berry                        (858) 534-2098 
                                         Dept of Family/Preventive Medicine
E mailto:cberry@tajo.ucsd.edu	         UC San Diego
http://hacuna.ucsd.edu/members/ccb.html  La Jolla, San Diego 92093-0645

 


==> 989.audit <==
Tue Jun 19 09:07:09 2001	ripley	moved from incoming to Low-level
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1063 *
Subject: interrupting Sys.sleep
From: Thomas Lumley <tlumley@u.washington.edu>
Date: Mon, 20 Aug 2001 13:55:29 -0700 (PDT)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1063 <==
From postmaster@franz.stat.wisc.edu  Mon Aug 20 22:55:35 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA16433
	for <r-bugs@biostat.ku.dk>; Mon, 20 Aug 2001 22:55:35 +0200 (MET DST)
Received: from jason03.u.washington.edu (really [140.142.8.11]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15Yw56-000JH0C@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <R-bugs@r-project.org>; Mon, 20 Aug 2001 15:55:32 -0500 (CDT) 
Received: from homer28.u.washington.edu (tlumley@homer28.u.washington.edu [140.142.8.38])
	by jason03.u.washington.edu (8.11.2+UW01.01/8.11.2+UW01.04) with ESMTP id f7KKtUu37756
	for <R-bugs@r-project.org>; Mon, 20 Aug 2001 13:55:30 -0700
Received: from localhost (tlumley@localhost)
	by homer28.u.washington.edu (8.11.2+UW01.01/8.11.2+UW01.04) with ESMTP id f7KKtTY130770
	for <R-bugs@r-project.org>; Mon, 20 Aug 2001 13:55:29 -0700
Date: Mon, 20 Aug 2001 13:55:29 -0700 (PDT)
From: Thomas Lumley <tlumley@u.washington.edu>
To: <R-bugs@r-project.org>
Subject: interrupting Sys.sleep
Message-ID: <Pine.A41.4.33.0108201130100.142352-100000@homer28.u.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


On Linux R1.3.0 (and current pre1.3.1 and pre1.4.0)
 Sys.sleep(30)
interrupt with CTRL-C
 Sys.sleep(30)
causes a segmentation fault. It doesn't happen under Windows (2000).


	-thomas





==> 1063.followup.1 <==
From tlumley@u.washington.edu  Tue Aug 21 20:24:10 2001
Received: from jason03.u.washington.edu (jason03.u.washington.edu [140.142.8.11])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA27594
	for <R-bugs@biostat.ku.dk>; Tue, 21 Aug 2001 20:24:09 +0200 (MET DST)
Received: from homer06.u.washington.edu (tlumley@homer06.u.washington.edu [140.142.15.40])
	by jason03.u.washington.edu (8.11.2+UW01.01/8.11.2+UW01.04) with ESMTP id f7LINQu46490;
	Tue, 21 Aug 2001 11:23:27 -0700
Received: from localhost (tlumley@localhost)
	by homer06.u.washington.edu (8.11.2+UW01.01/8.11.2+UW01.04) with ESMTP id f7LINQV169084;
	Tue, 21 Aug 2001 11:23:26 -0700
Date: Tue, 21 Aug 2001 11:23:26 -0700 (PDT)
From: Thomas Lumley <tlumley@u.washington.edu>
To: <r-devel@stat.math.ethz.ch>
cc: <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] interrupting Sys.sleep (PR#1063)
In-Reply-To: <200108202055.WAA16443@pubhealth.ku.dk>
Message-ID: <Pine.A41.4.33.0108211114160.88898-100000@homer06.u.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Mon, 20 Aug 2001 tlumley@u.washington.edu wrote:

>
> On Linux R1.3.0 (and current pre1.3.1 and pre1.4.0)
>  Sys.sleep(30)
> interrupt with CTRL-C
>  Sys.sleep(30)
> causes a segmentation fault. It doesn't happen under Windows (2000).
>

The problem is that SleepHandler is not removed if the sleep is
interrupted. The segfault occurs if Sys.sleep() called again, or as soon
as the timer runs out.

It looks as though either do_syssleep needs to handle SIGINT itself or
jump_to_toplevel needs to know about event handlers.

	-thomas


==> 1063.audit <==
Tue Aug 21 20:25:22 2001	thomas	moved from incoming to Low-level
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1068 *
Subject: Interrupts (was Re: [Rd] X11 protocol errors ...)
From: Luke Tierney <luke@nokomis.stat.umn.edu>
Date: Wed, 22 Aug 2001 19:32:51 -0500
--see also followup in PR#1069
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1068 <==
From luke@nokomis.stat.umn.edu  Thu Aug 23 02:32:58 2001
Received: from nokomis.stat.umn.edu (root@nokomis.stat.umn.edu [134.84.86.39])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id CAA09952
	for <R-bugs@biostat.ku.dk>; Thu, 23 Aug 2001 02:32:57 +0200 (MET DST)
Received: (from luke@localhost)
	by nokomis.stat.umn.edu (8.11.3/8.10.2/SuSE Linux 8.10.0-0.3) id f7N0Wpq10715;
	Wed, 22 Aug 2001 19:32:51 -0500
Date: Wed, 22 Aug 2001 19:32:51 -0500
From: Luke Tierney <luke@nokomis.stat.umn.edu>
To: maechler@stat.math.ethz.ch
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Interrupts (was Re: [Rd] X11 protocol errors ...)
Message-ID: <20010822193251.A10682@nokomis.stat.umn.edu>
References: <200108221235.OAA05855@pubhealth.ku.dk>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5i
In-Reply-To: <200108221235.OAA05855@pubhealth.ku.dk>; from maechler@stat.math.ethz.ch on Wed, Aug 22, 2001 at 02:35:24PM +0200

Martin wrote:

> Just this morning,
> I found (again!, we had something close to this before) 
> the following related bugous behavior :
> After interrupting a plot (which would have taken a few minutes and was
> "wrong" anyway), starting another plot, interrupting again [with C-c],
> and maybe the same once more,
> R started just giving a ">" prompt
> but did not react any further at all.
> (C-c would return the prompt, but no other reaction was possible)
> Only killing the R process helped.
> 
> I may try to reproduce more exactly later today.

I'm surprised we don't get more of these sorts of things on UNIX.  Our
current UNIX interrupt handling approach takes an immediate LONGJMP
out of the signal handler no matter where the signal occurs (except
for two places where signals are suspended).  Any place where an
invariant is temporarily broken, any place where an assignment is not
yet complete, is a potential trouble spot.

I've been meaning to raise this issue at some point: I think we will
need to eventually spend some time re-examining how we want to handle
interrupts.  Right now on Windows/Mac interrupts are only processed at
special points in the evaluation process, which is a bit restrictive
(but perhaps unavoidable due to OS limitations).  On UNIX on the other
hand we LONGJUMP out of the signal handler except for the very few
places where the signal gets masked temporarily (GC and one place in
graphics I believe).  The UNIX approach is much too loose even now,
and it becomes even more untenable if we add any kind of threading
support.

We will I think have to come up with a cleaner model for very
selectively enabling interrupt processing, perhaps with some
integration with the external function registration mechanism Duncan
added recently (e.g. marking a function as one where LONGJMP's are
safe).  We will also need some means of controlling interrupt
behaviour from R, such as having some sort of without.interrupts and
with.interrupts functions to be able to program reliable interaction
with interrupts at the R level. (Another sort of thing we might
consider is suspending interrupts during on.exit processing.)

It's a farily big can of worms, and probably not urgent for now, but
we will need to look at it eventually.

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
313 Ford Hall, 224 Church St. S.E.           email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu

==> 1068.audit <==
Tue Aug 28 10:16:46 2001	ripley	moved from incoming to Low-level
Tue Aug 28 10:23:54 2001	ripley	changed notes
Tue Aug 28 10:23:54 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1069 *
Subject: Interrupts (was Re: [Rd] X11 protocol errors ...)
From: "John W. Eaton" <jwe@bevo.che.wisc.edu>
Date: Wed, 22 Aug 2001 21:56:33 -0500
--part of PR#1068
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1069 <==
From jwe@ricotta.che.wisc.edu  Thu Aug 23 04:57:11 2001
Received: from ricotta.che.wisc.edu (ricotta.che.wisc.edu [128.104.179.160])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id EAA10175
	for <R-bugs@biostat.ku.dk>; Thu, 23 Aug 2001 04:57:10 +0200 (MET DST)
Received: from ricotta.che.wisc.edu (jwe@localhost [127.0.0.1])
        by localhost (8.12.0.Beta7/8.12.0.Beta7/Debian 8.12.0.Beta7-1) with ESMTP id f7N2uZqU003270;
	Wed, 22 Aug 2001 21:56:35 -0500
Received: (from jwe@localhost)
        by ricotta.che.wisc.edu (8.12.0.Beta7/8.12.0.Beta7/Debian 8.12.0.Beta7-1) id f7N2uXNS003266;
	Wed, 22 Aug 2001 21:56:33 -0500
From: "John W. Eaton" <jwe@bevo.che.wisc.edu>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15236.28897.468790.842201@ricotta.che.wisc.edu>
Date: Wed, 22 Aug 2001 21:56:33 -0500
To: Luke Tierney <luke@nokomis.stat.umn.edu>
Cc: maechler@stat.math.ethz.ch, r-devel@stat.math.ethz.ch,
        R-bugs@biostat.ku.dk
Subject: Interrupts (was Re: [Rd] X11 protocol errors ...)
In-Reply-To: <20010822193251.A10682@nokomis.stat.umn.edu>
References: <200108221235.OAA05855@pubhealth.ku.dk>
	<20010822193251.A10682@nokomis.stat.umn.edu>
X-Mailer: VM 6.95 under Emacs 20.7.2

On 22-Aug-2001, Luke Tierney <luke@nokomis.stat.umn.edu> wrote:

| We will I think have to come up with a cleaner model for very
| selectively enabling interrupt processing, perhaps with some
| integration with the external function registration mechanism Duncan
| added recently (e.g. marking a function as one where LONGJMP's are
| safe).

FWIW, Octave doesn't do this correctly either, it just does a longjmp,
same as R, which can result in leaking memory, and possibly other bad
things.

The way Bash handles this is to only set a flag in the handler for
SIGINT, then at safe places in the code, there are

  QUIT;

statements.  These are macros that expand to some code that may
longjump somewhere depending on the interrupt state.  This method
avoids the problems of jumping out of the signal handler, which may
result in memory leaks or inconsistencies in global state.  The hard
part is inserting the (many!) QUIT statements, though it is probably
somewhat easier if this type of choice is made early on in the life of
the program instead of late.

I only mention Bash because it is a program that is expected to
handle a lot of interrupts without leaking memory or crashing, and
seems to do so reasonably well.

Packages like R and Octave also have to be able to handle interrupts
in calls Fortran or C code that may run for a long time, and which
cannot be modified (at least not easily) to add the equivalent QUIT
calls.  I'm not sure what the right solution is for cases like that.

jwe

-- 
www.octave.org        | Unfortunately we were hoplessly optimistic in 1954
www.che.wisc.edu/~jwe | about the problems of debugging FORTRAN programs.
                      |                                       -- J. Backus

==> 1069.audit <==
Tue Aug 28 10:16:46 2001	ripley	moved from incoming to Low-level
Tue Aug 28 10:23:24 2001	ripley	changed notes
Tue Aug 28 10:23:24 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1120 *
Subject: bug in write.table?
From: Ott Toomet <siim@obs.ee>
Date: Sun, 7 Oct 2001 18:24:34 +0200 (CEST)
--Traced down to an effect of read.dta in foreign interacting with do_paste. Fixed
--in foreign, but do_paste may need to use strlen() rather than LENGTH().
--
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1120 <==
From siim@obs.ee  Sun Oct  7 18:24:20 2001
Received: from ecopc15.eco.au.dk (ecopc15.eco.au.dk [192.38.42.15])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA11074
	for <r-bugs@biostat.ku.dk>; Sun, 7 Oct 2001 18:24:19 +0200 (MET DST)
Received: from localhost (siim@localhost)
	by ecopc15.eco.au.dk (8.11.2/8.11.2) with ESMTP id f97GOZm08466
	for <r-bugs@biostat.ku.dk>; Sun, 7 Oct 2001 18:24:35 +0200
X-Authentication-Warning: ecopc15.eco.au.dk: siim owned process doing -bs
Date: Sun, 7 Oct 2001 18:24:34 +0200 (CEST)
From: Ott Toomet <siim@obs.ee>
X-X-Sender:  <siim@ecopc15.eco.au.dk>
To: <r-bugs@biostat.ku.dk>
Subject: bug in write.table?
Message-ID: <Pine.LNX.4.33.0110071821220.8457-102000@ecopc15.eco.au.dk>
MIME-Version: 1.0
Content-Type: MULTIPART/MIXED; BOUNDARY="650121002-237711743-1002471874=:8457"

  This message is in MIME format.  The first part should be readable text,
  while the remaining parts are likely unreadable without MIME-aware tools.
  Send mail to mime@docserver.cac.washington.edu for more info.

--650121002-237711743-1002471874=:8457
Content-Type: TEXT/PLAIN; charset=US-ASCII

r-bugs@biostat.ku.dk

Hi,

I have found something I guess is a bug in write.table.  When saving
the object "e2" (see the session transcription below, I have attached
the Rdata file in gzipped form), the resulting table (also attached)
contains a spurious space in the front of columns from starting the
column "c05ak01" (column 234).

This would not be a problem, but if the object is large (the original
database contained not 10 but 7000 observations), some of the colums
are missing at all.  The problem is similar when you use quote=FALSE
option.

Best wishes

Ott Toomet
otoomet@econ.au.dk

Attachments:
table - ETU2000.and
R-datafile - e2.rd

--------------------------

Now the session sample: start R without previous .RData

> load( "/home/siim/a/e2.rd")
> ls()
[1] "e2"
> write.table( e2, quote=TRUE, sep="\t", file="ETU2000.and", na="", row.names=FALSE)
> dim(e2)
[1]   10 1197
> version
         _
platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status
major    1
minor    3.1
year     2001
month    08
day      31
language R


--650121002-237711743-1002471874=:8457
Content-Type: APPLICATION/x-gzip; name="ETU2000.and.gz"
Content-Transfer-Encoding: BASE64
Content-ID: <Pine.LNX.4.33.0110071824340.8457@ecopc15.eco.au.dk>
Content-Description: 
Content-Disposition: attachment; filename="ETU2000.and.gz"

H4sICFx1wDsAA0VUVTIwMDAuYW5kAO2b2XLbypJFn3G/Ql+gYGXWADx2REd3
9EN/BClRA0kd35BlX9+/76q9iqMoeTjWsY/bMFUJgkCuwiYqswb6w4fH+z9u
P/wx/HO+/DisP3zQzn3bux/m8/dP82H9cf74NN8Mm+X9Yv3uj+th/e/390+b
5dMwn4X6Z4v55rbZebeL1dNa77Hej3s/z7fHdd7i07Cop1ZP1SxknHfe313J
xG6uZZLKvJYpmJHLRi6bWhlmKgPea5WAGBADYkAMiAExQQyIATEgBsQEMUFM
EAPiQByIA3EgDsSBuCAOxIE4EAfigrggLogDiUAikAgkAolAIpAoSAQSgUQg
EUgUJAoSBYlAEpAEJAFJQBKQBCQJkoAkIAlIApIESYIkQRKQDCQDyUAykAwk
A8mCZCAZSAaSgWRBsiBZkAykAClACpACpAApQIogBUgBUoAUIEWQIkgRpAAZ
gYxARiAjkBHICGQUZAQyAhmBjEBGQUZBRkFGIBOQCcgEZAIyAZmATIJMQCYg
E5AJyCTIJMgkiLzPw0wQGeed93dXMrGba5mkMq9lCmbkspHLplbWVtjKgPd5
oMUHWjymv7sKtHjMtUwKtPhAiw+0eAyXTUEtXmXA+zzQ4gMtHtPfXQVaPOZa
JgVafKDFB1o8hsumoBavMuB9HmjxgRaP6e+uAi0ecy2TAi0+0OIDLR7DZVNQ
i1cZ8D4PtPhAi8f0d1eBFo+5lkmBFh9o8YEWj+GyKajFqwy1rPF13orF0IJg
i1FXn6pJLao2s8YuuuFtVlk4p/DZuOGz8aHbR+zEWZPOUmS+UmSu34BKVxn5
WHG+miXmRiapzJyROSPzUVGpFFANZ4xXGE4EH8Cb8Ca8KftUwyd2hbnGLDE3
mFvMHeYes5JR9S2qRDRDLMtdQcnahDSEtC6kSUhDSENI60JaF9K6kIaQhpAm
IU1CmoQ0CWkIaQhpCGkIaRLSENIQ0hDSJKQhpCGkIaQhpCGkIaRJSJOQhpCG
kIaQhpCGkIaQhpCGkIaQhpAmIU1CGkIaQpqERMH2bEpIR0jvQrqEdIR0hPQu
pHchvQvpCOkI6RLSJaRLSJeQjpCOkI6QjpAuIR0hHSEdIV1COkI6QjpCOkI6
QjpCuoR0CekI6QjpCOkI6QjpCOkI6QjpCOkI6RLSJaQjpCOkS0gUnMUuZETI
2IWMEjIiZETI2IWMXcjYhYwIGREySsgoIaOEjBIyImREyIiQESGjhIwIGREy
ImSUkBEhI0JGhIwIGREyImSUkFFCRoSMCBkRMiJkRMiIkBEhI0JGhIwIGSVk
lJARISNCRgkZh+tPQ40VtY1f04+9ph9bv62PW2MYx0RMwmRMwYyYSaZmSpnm
JcpXUplVFmAF2PhxawzjmIhJmIwpmBEzyQg2AqsGLwEvAS8BLwEvAS+heWm9
7WvF9CaFIYUhBTcfukGDgAYBDQIaBDQIaBDQwNDAUNJMUpikMElhSGFI0avN
LRm3ZNyS8ZlxS8YtGbdk3JJxS4YwhhfHi+PF8eJ4cbw4XjxLCpMUJikcKRwp
uHnrBg0MDQwNDA0MDQwNHA0cDRwlVYMol0llVlmAlUV/AJxbcm7JuaXILUVu
KXJLkQsitxS5pYgwES8RLxEvCS8JLwkvCS8pSgqXFD4sPw1LtZElbWRJG6mh
TGVUmfgk8Un+uDWGcUzEJEzGFMyImWTqAy2Dl4CXgJeAl4CXgJeAl4CX0LwU
1WFUGVQRPddLnutWfVP1jeob1Qdl8A2+9YPwDb7BN/gG3+Abd+F4cbw4Xhwv
jhfHi+PF8eKjqm+qvqn6TvWd6ruq76q+U32n+t05/Ag/wo/wI6dE+BF+hB/h
R+4i4iXhJeEl4SXhJeEl4SXhJRVV31V9H25a5/SmdU5rcdWK61YsW3HTitta
WDvF2ilWT/lUrWYSbphJuNFTdqMQekPwbGaNXXTD21FlC2o3YaaP1FO9CXp4
q+GYq5TbgFvNKtwwq3Az04Nxo0h1Q4yCaBCtE01EE9EgmogG0SCaiCaiiWgQ
HaLrFl1AB+gd6AC9A11AF9ABuoAO0AG6gC6gC+gAI8AoYBQwAowdGAHGDowC
RgEjwChgBBgBRgGjgFHACDABTAImARPA1IEJYOrAJGASMAFMAiaACWASMAmY
BEwAM8AsYBYwA8wdmAHmDswCZgEzwCxgBpgBZgGzgFnAPLQxResO335qNupd
Wr+TzRpLVfvQ7SNWj+8tj+2tHtdbPa63YTbH8El7UvBm3Zt1b9a9Gd4MbyZv
Jm+GN8ObyZt3b969effm3ZvjzfHm8uby5nhzvDXT7rg5d+5V7ehW7YhjpmOm
Y9vzXMdcx7wfizoWdSz2Y0nHko6lfizrWNax3I8VHSs61so8b8WiFqXtlbY3
1r+pvZvqO5u1tCRjGMdETMJkTMGMmEmmpqVbC3gJeAl4CXhpR3xoQ8z616ZM
2yDp7lM1Cmd3hLM7PSl3Cmd3xJ074s6dvvU7hZ06Qt2sW/mg8rGV9einauTs
Hme1t6sHrdqHbh+xSWXm1Lk8CsIV1q+wfoXpCtMVxhXOFd6v8H6F9ytcV7iu
8KGNpNsgcKX9OKw+VZP1fKyUi1d61ld61lfqb65CmGMWmCvMNWaJucHcYu5k
TKWrjCqTyowjcFkP4kqZdKWmsVLTWKmHJ7gBN+AG3IAbcANuwE1wE9wEN8EN
uAluHe6Cu+AuuAvuwB24A3fgDtyBO3AH7oK74C64C+7AXXDv8Ch4FDwKHgWP
wCPwCDwCj8Aj8Ag8Ao+CR8Gj4FHwCDwKHjs8CZ4ET4InwRPwBDwBT8AT8AQ8
AU/Ak+BJ8CR4EjwBT4KnDs+CZ8Gz4FnwDDwDz8Az8Aw8A8/AM/AseBY8C54F
z8Cz4LnDi+BF8CJ4EbwAL8AL8AK8AC/AC/ACvAheBC+CF8EL8CJ4LWuPdVW7
q6saglY1BK1qL3VVu6gry/P1g4zKRS3a2WP9m4ZV7aGuavd0Vfumq9oxXdVe
6ap2SVe1I9piSIsKtZ3PW7EYWl+gpeeWMdc1VahYt3Khou2O63fvroc2Wb2u
KaMV9bPajW/zsW26tM1mrmvXfV377evaaV/XEL2u3fU1wXlNcF4TnNcE5zXB
eU1wXhOc1wTnNcF5TXCWwUvAS8BLwEsDW/u8fdg+aYeT1riqXXQ73+idyqt+
7LrbKx29Vrnsx266XeroTStbNUv3W7rfIr9Ffkv3W7rfIr9Ffkv3W7rfIr9F
fsf54v6x2fdP9/9s9und8qnaqkD9Kteu3CRjGMdETMJkTMGMmOaiXdS+ba/f
9qa62NTrN/XiTb1yw6huw6huw6huw6huw6huw6huw6huw6huw6huw6huw6hu
Mys4Kzhrp00129WyZruHNk54aOOEh5lt2nvTUXtspeuI64jrSKx/ad720qKV
9f7qUxiGp/n7ZdC+ad+079p37UftR+0n7ad6/Vj/puGhVrfGyfqt1XKhsq9+
xr5KmuqfRJkjyhxR5ogyR5Q5orSm31aI2gJOW19pyx99iWOu1QGtDWhlQOsC
WhXQmsCw6ItzWg3QWoBWAoYFyz+DllA+TdPwr9un2ayVdf/u7rLuDO+f5k8f
3g+bm3ePV8th8+6P26fl48Mwv122vzD8693jur15mD/et4Xi5fWHq/nTcP/+
anld31xulh/r4/f+6cP1v2vJ23/URlWDiA8XNsTBZpUZhtCSamg79VhtZ8NQ
W7fsRR6Czq2vaWyvMOUyXAQdC+01bG3/25029etOTqs33c/RaaXszznyZjqN
z8I0ibg/qZw9KW4rwUn57En53Ek/agvTmIaLrVRh+A/VLbV61oOqtaP3NAw1
TGyVylxuqX6B3r7F3U1c6Pvabz/y7s5uoT1a3F/Svcz0Cgfl4YvvivPLuROO
Tz7rpDayKsv3vg2qVR9ia3e0q2R8+V5mrx7/s/W0o3+05zfc7Pg5e2lTw/Vk
PNX1aZ+ytSe7ijU7PTdyhjVjQ3vGZ6/8qw2C9nxQDTWXMLxUMQlC+1G7iDM1
soMXx3S9p8N29VdurQ17b8nt5cPUHi3VvEXtHoD1t6vuue01+aR+2LXEbQvb
1eHljwbIZx32+BSPovpRgwinraFIZ765ll1Cb1vbL1PPcT3Ub7pvvKmJKibu
46Ae9cL2CLTPvSewg+wVCLWhX1a/6DFd5hxzxfllLrXD6T67zLF2M3UCd9Pq
k+R4NryWRu0ojap2rQ6/3Fbb6KiQfJS6xjOpSy8lrzjsUtdBZvo7pKz4C6Ws
WUtZfEMnKesrK/mLpqxXskfgsf/RqennSEuhpaWRj+xnTUjnNo1O2hOXpi9M
M6PGLc/STOhpZhflDkY/9izNzOzSZ6XmkDK7nKXsL6aZ+AVpxg/STK/dL5lm
rI9utmnmf1q4qX8Hx/dpxpoQYdfziN1HSH+rEdKLz+3bbj2SB3U41cTa7mez
wktjmdmvlxj0VMVsPXOOZ04pfUzYTPqCPBGGb8kRcZ8jyvErHQTgkH/8ACZs
dy5acKKNxu84gPnc1/b8ohdhmow6mxUOr6DWNeT6uYSwG3eoARzPczEBdZgQ
rIb/1MYdIV+OpQ4VThLC7opRI4+aEHqEq19tq+I+IcTQ6xpG3YkeBFXUu9bb
ilg8nb4bz03f+Xg6fTf+fIHyC7cwtWcs9xv6QdH1O2w/Li8onJEXelr9qlxw
9MpfFmvPbz9xXtAcV24PWz5zivGB8TB+2fghz74iN9i2vX67uG++7ebgt5GF
6NRmDv6rHSjUPhx20N4qA1xsA+PpRNXJpNXBq3bgfTdRVeOoZoTK+RHEvuvT
E8bU5u2GXboIJyOIZxNV8r8bQYwqLy7qwKEFfY/xMuc6vtwlDO9Oehbq44dX
0oUdpQv7haepUtlPU/0O/l+5HQT/9Dv4nz/t/BYI+sl/R/s+YCHa/6c6/uNf
GOrPberh2l7mZwG87pdpH8d3UbwvN5yP4s/mgQQ5ieI25suUa8y2cbyskOk0
imvkPNs95i2Ou5bkB40MDuJ42nb7XaOKqbUx1o9PV+3rmOak23921T496/af
XY4fw1HafGlBfjxZkP+KVfufZKv34Nuhz3buSUscpU/X7eeefL/EwThdj85+
1umksf5EN8n2gxLM22CtN8ptG2pNi0ey6OcW3ua2/vdiNyXBw9ibw3ftBX3N
ECKXWa/luSpMfBB2swm2D0SH/8I+9tWhRkstZfzqSaZ9BPjsQsROO99rt59j
ffvnvC9IHJa1ozz0Od/2Sj98vmk/FfYlo41dzNVI43A66nyiSppiO8hXfdVi
6usDL6xaPBtziHS6alHqUCPkMnieXYZYA9/JJFXerlpMQxriZ7KVHWWr8AuP
OlremHre2Aaag6M9b3hb4DhYseDxilW0bVEO5t2Ol6Z+55C3xb6YQ6ZzOSQc
55BzawPfvPUfFMSh/TZlFy+00MDT9ErKIrFw3RcllvDmiaXrZFl9qKxX5Ich
th0gbh/8nahjH3pqTW87fKh9Zf8r+ov75LJb1bho9b3QgJhf/7WXfsjZJlN+
lhWN9OIgR0mjDXKo+cGQh9jfE0h8vsoRXh7upKPhznaVo1yWsS1u1B0r/myV
4ySBtAf9tRTiRykk/rIL3/zk7/ek1TdsPSC2lnpuuuoLftbUX9OfiS2n01Ut
f7zh1hcMSUd0L/i1+7TPF1P/RX82O8oj0wt55DO/hKrXfecV7r/LvJYdvtv+
dKdvf22EH+lUXzz/wewuwk+7CM/Xu5vLSq+NDnbzRweTPgdL2IXgHsZLi9WV
h9mleTqdy+pP2BD6b5raJOBrwT0eBff0y44Pfgf3b97+3wb3PoVxENzL57v/
r0Rwx8XvCP6jI3h8aX7nuI9+ML9DeG7/EeRwNYIR2msRPHa/wy5+z8JltHE6
WFo+E79nw+7nRdXXPyrUtdt+z3AQv3PoY4PQl3bSSz9CytO++3G0zHC8GlGO
V+f3iwR/w233P/30Dfy3+mlGDy0cTgJmzVAe3rS2/RzQ71+v/oXY0zBvn236
fxL35YsFU5n1tah49pShr71+Pr4bP1b9ht+h9ic0kU1HNfRChy39+P+rEA5m
bNovUG03Y2NHKwKnTepoe6tccLFdNTxdEZgd7x/0Z3YrAnmim/ziisB269M4
kd/3HK9ax5fXAeR/19Pv0zi7/yQ3+eWU4uzz/3vh/wCjPeTF5VwAAA==
--650121002-237711743-1002471874=:8457
Content-Type: APPLICATION/x-gzip; name="e2.rd.gz"
Content-Transfer-Encoding: BASE64
Content-ID: <Pine.LNX.4.33.0110071824341.8457@ecopc15.eco.au.dk>
Content-Description: 
Content-Disposition: attachment; filename="e2.rd.gz"

H4sICAd8wDsAA2UyLnJkAO1dS4wkyVnOfszUzOzO7tpeCdkIey8r78WjjozM
yiq4jIVlhAQXuCBOW1lZWV1Z1TtLd83srMRhhHxC4mL5AgdeEjbCWJZlZGEk
v8AYZK8fJyQkywIZISTEjTMmH5EZ//9VZj27uqt6/pCiK7+M+OJ/RGRmvDL7
Nz7xW+qe4zh3nCLcymJ/0ru4KPDdLJ4/eufBW72zgTmX5b/3pHf+YNILB5Pi
ZCuL8aPzs970oioHOdPR2eDBxbR39rYtO+pNe3k5Rb7DLA7c6rgMB+T4zs/S
kP5+wKYdfyH9vU/y3DO4jIcmHkG8ZcpC7s+TeM/E90H8SAOXln/QFBu4hyS+
YuLPQbzdwD0msUnuYT239aNlYoPcRhsX2nvwhX8k8V9N/CnE/5kjt6zT8pie
O57j5/V13sjPzsskvt/Ej0B8sY77LP2zTLxsrmPbe6brBxri/Tn2fswcZ/eE
D5q07PwbaQyyuGP23i7T03Bofm9RntNcv/eXiU3XPin/gMqn55fgHjZwm3QO
SZ6Q/tLzl89tfdHmaX3K/H6Oc1tfarp+SfkH9Jee38BXjfeNDeSuzaV55sUt
XAtU5zv7YO8+ynWu7xr8ks3T+rT5/Szntv5mC/ccuQaX5Dr7eQ3O8B2o3ybu
hnJDzFd3bgXuUjo3cA+W47a+OsttfW1JuTP6raDzjH7L63w9XMzTFLd5DRKd
W7tsr7NB29hQ7ibX4DW159Y/zXJb39xA56uo3+ftGpy53urO7ZK9jlyDTt25
hmvwu7Pc2XM7Vr/P2zV4G/PVndsle52atrssd0O5M9fbVejs1Ph0eW7rveuQ
uwxvO/Zej84b2jtzvd1ke4UrXOEKV7jCFa5whStc4QpXuMIVrnCFK1zhCle4
whWucIUrXOHuF9dxWt9K47fNe0afSeNfpPEbRfzoy0Vsfauem79Hlr1/lr13
c9scZ++z3S1lZscN3MOamL/DQ7jLvKuVR8KpcAOXvitUhhlsuK/UcT9OOPT4
V53aQNPy41+fk+9XFut9RGw9Qtyg96WGy2+D+ftJWbuhtmSYtoWm9+d+aOKP
bN7W97P2S/B7DXLv1Mg5dnj7fWFRG6Q6Osu139fLSPIiXvj+HM27pNy7DVzq
99p3HEleam/FK2OD3A+beI9wM/wqwW/Ma1dpeJHKQTzHV8fObP0u46vGPftL
cG+beEzzOvCe2S49By6b6yzZNprkpLew00XctDl/e33uC39b5L31Y+B+ZTF3
/WuwyV6Mwt34mVK9C17mc2bvz0cN3Ln9ihLvkr3CvdlcR+4587i73t/ddf2E
K1zhCle4whWucIUr3Jvc3911/YQrXOEKV7jCFa5whSvcm9zf3XX9hCtc4QpX
uMIVrnCFK9xL4zqz+89rQwM3+38OL60nt9g7vabO+f+Z2cTeNbl5uAbudem8
j77aR+7afl7E2ZbcDa/f/P9GXb3ORRCucGu4co+92dwXsrgml+3lX4W7iCNc
4QpXuMIVrnCFK1zhCle4whWucIUrXOE6fJ1u7jekFnCPnNn39qu5rXpu6wdp
/E6Rt/XPWVxB5xcd860cI6d2za6Bm60t3jFlsLm7xToX37sx+Y4d/i2cCjfY
+8Nl1jYa5B6b+OIa3Jl1WKJzhRu4M2EF7sza7xXJvSwutud90Bm5lQ0LuFVd
rSB3XrtaVm4dd5Fcpu8a3E3kCnc57gsmVt8NI9zse21353CPSMTvE81tV2W+
RVG4whWucIUrXOEKV7jCFa5wbzrXqf8+/Uy8Im45f3DVcnedWzcfOxNX4B5B
XEXuUtxnzmz7cxw+f5bF5bmtf8i+d78e184vrMGd2Y+5Areakwbuuu+B0/+r
MO9/LOThEmzc+/fVnY3aHP+O9hrcwzW5a+tcF3fdzxvKzdrunauWu4PcXb9W
d10/4QpXuPtxre66fsIVrnD341rddf2EK1zh7se1uuv6CVe4wt2Pa3XX9ROu
cJfiOs3rXXRdaaV1MyqzidukYynPWWPfaBpecsy61+rcw+9SvIbOa+11Nbzq
/y5fndz8fY73ynW7FeXedRbsC96OztV7K43vfDRxjc3Vuxyrc+2e6DW499fn
Hr61gdyD/eNuVEd3N+BuYu/RulwahSvcm851yPO94TjHTf2NZ8Vx9fxwYG27
mXvwZpF+8AN7fPjHaYwt9+i7DXJvmbIz3W43yL1Tz219q0jPn7d/ZI6/kUXL
bTXIPfr7Ms+82KDznfW5xXue63CX4QlXuMLdHtcp3j3O7k/Z91XL+2vZZ1+w
J3Hx/WqO3Np7OYlHc+R+PY3fTuP30viZNP5ZGr9qYvYe9vezd84b5N6uiaXs
6tyyfnZqxrFbqKO6MPOO7grcmSBc4ZpwY9vVM+dyr980vJHFRVzH7rGu23e9
YN4sn3d5r5DX+ksT/y6LVo/W9+bcY9faq15nb10U7vPHdTZ7B+L1ZeKc8eC6
70/ItSBc4QpXuFviOrAO6KwwX0fLLvPW4V3iUnvnlNH0PCrHmsc075LcOrlL
zW1Se+fFLbSNNxzoLxv8IYLdBu4dE1skb4aPCb67Ivc2xRtw72+gc+uy5ZL0
uf/rasfqd2Y/QB3epfa8CTeFf13YdPshzes4r3xlMfdyr33n+Xu/caP3DB1y
/a4q9zrs3UTnTeVeB9fZoH6dK5jL3TVu2jTq3mu/kde+cIUrXOEKV7jCFa5w
hStc4QpXuMIVrnCFK1zhCne3uA7ZL1nmq8MrcJddo99EbrXfAeSuwl3X3gNn
1t6DxdyPvpzGl7LzJG8W6Lrzh5at31Tk/+K5Bp2r97OInCXf1XKOSxuBe0zw
cQP3VZNO16xvpfFlgj/YpLMz69dldW5a72ZtZZXryFniu8hz5G51nd1p3hvw
QYIXXQvXtjdgnvwluI37gxZzV/vfiTU6H6/JnVnbW4Gbpd1fk7tI7rLfUsnL
+Tg5/sSczBiW1JOtE2+i5ydX0G0FHWv1e7YcN3sXrPad0G1eK/Pilq9v1mad
Bf/vc9/tFe58rrNkEK5whbsd7jNnL+8bM//3pi7Wcxf//+g5crMxy9z9vs3c
jeRm/YTWOtxFHOHuN9eZ05dfzJVrQbjCvU6uU7MX+orkLhWE+/xxnzlFu3H2
6B1uB+bd6S853/ieH81Df5fgHpM85bfQUG7jnGsNd6lvtW6o8z5yWZ4G7jJt
Yxtyt20v+6Xn94C7Th01cRt89Qu/ZvO80Niv3MI1+DrJ8zr9pecb+sBfTOOX
zLe0PpXGT6fxc2n8bBq/lsZvZulz+vz0ve/DmnPz3mme933ped96zNJ/ycSu
w78lUn0zed44ZVGc10daFJvqaJm4BZ2vhfvM2ewZ6vD2tLLOzwpM8/8hiXPr
13CPnA3sTcOXjazPm+PPN9lbw8VvRa30PWwjr+R+eUUu+27VKtxSNsUrcnf2
/UKnfq5vqW9dOKRdEVtXWtOmcuvKaJD7vjS+38QP1MRX0/hSA/dj5vfDJl+G
X3aKdfzAKeZdavdKUDvnxS3W0ab3ujLMnNul8RFkQd2r82vKPVhSbmNY8RlK
r6Om/Tv03nRlz+5nzkZt8rrk3jf+oMflbym36Vsmm3DLugwdXq/lubDJXpJe
F0u54Rrcsm00cK+tD1zX9qtzz4p8N6ZftwkXdCu/l1Pilon7bO9LlPvw6Yf+
PDt4eP4f//2n2e/03rsPSYaHv/NfP8vww3dGP8nx9Hf/ICvr4cVPf/JvOe9f
fpz/mnJqZbzz21/Pue+89p/fzLnf/7/Xst/Hv/+VoozDf8/Tn/zeID8/nb75
Zp6v/503qS5P/+SXG+2Y/tUn87Iu6XeJ+sW+c4WX4K7Ur8tsXiY2yD028dCk
ZefKb4SV8pueg3iPOKrTfYN+zlr3qwVybxl77xB9y++OHy+wt6zDW4R7i+C8
nhfoXPIOHO77eTo3BeavFcc4L5m8tN9+CGWXofxe2Ct16Qu4txu42ZjgfW73
td8cvP2ae3KiXlPuL/pqcXm3Zss7/oJj7sWPH5+P3ho+fssxvn27N3jimHob
P36c87OYnR8ZchbTtFGZ1utdTHvG7iyOn/TOp72JU8qYDEbh+NFbUYnH716M
ppPBtJTTO1EVt3fihr3JkOIe4DCZjlk6xxryayhPY/6yvLy9hU+LOshimJZd
qFbhkGMN6RrT+xx7iCODcz+GJ76BZXp7zPMHgDsgvxPy8rpleQVWJ4AVyEvt
dcFehjWka0zvc+whjgyu7HXRXpY/ANwB+Z2Ql9cty6vs5ViBvNReDfYyrCFd
Y3qfYw9xZHBlr0Z7Wf4AcAfkd0JeXrcsr7KXYwXyUns9sJdhDeka0/sce4gj
gyt7PbSX5Q8Ad0B+J+TldcvyKns5ViAvtdcHexnWkK4xvc+xhzgyuLLXR3tZ
/gBwB+R3Ql5etyyvspdjBfJSe9tgL8Ma0jWm9zn2EEcGV/a20V6WPwDcAfmd
kJfXLcur7OVYgbzU3gDsZVhDusb0Psce4sjgyt4A7WX5A8AdkN8JeXndsrzK
Xo4VyEvt7YC9DGtI15je59hDHBlc2dtBe1n+AHAH5HdCXl63LK+yl2MF8lJ7
u2AvwxrSNab3OfYQRwZX9nbRXpY/ANwB+Z2Ql9cty6vs5ViBPLenTri9HGtI
15je59hDHBlc2mugtZfnDwB3QH4n5OV1y/JKewErkJfaC/0rBf0rwJjeV9C/
Ahwp3r9S2L9S0L9S0L8CHPLyugr6V4CVwv6Vgv6Vgv4VYEzvK+hfAY4U718p
7F8p6F8p6F8BDnl5XQX9K8BKYf9KQf9KQf8KMKb3FfSvAEeK968U9q8U9K8U
9K8Ah7y8roL+FWClsH+loH+loH8FGNP7CvpXgCPF+1cK+1cK+lcK+leAQ15e
V0H/CrAqcT4GTAczPXKczdfm4znT6TfHuYfysVWfjK3SjlQ5dsnHYRk2g5sy
PYT00KTnuqQdEzZ2SR/cbCyUYuB3JmMyzkzxGeBzLr8L5XXZ2KoPY6m+HUsZ
7ALWXF/lsbFiiiPAA8Axl+9DeW0orw3ltYEfAJ+PJVMM5XX6gKF88JcCf7ng
L5ePPfsuH2unOATcBxwBHgCOAQ8BnwIeAU64/hr090B/H/T3wX5sr345liXt
36XpIaSHJr1q/y4rL2Bj47z9M37W/l2KzwCfc/ldKK/Lxtp9GFv37di6av8c
a65v1v5dhiPAA8Axl+9DeW0orw3ltYEfAJ/PLeTtn+M+YCgf/KXAXy74y+Vz
EXn7dxkOAfcBR4AHgGPAQ8CngEeAE66/Bv090N8H/X2wH9urX85tkPavaXoI
6aFJr9q/ZuUFbK4kb/+Mn7V/TfEZ4HMuvwvlddncSx/mWvp2rqVq/xxrrm/W
/jXDEeAB4JjL96G8NpTXhvLawA+Az+ea8vbPcR8wlA/+UuAvF/zl8rmpvP1r
hkPAfcAR4AHgGPAQ8CngEeCE669Bfw/090F/H+zH9uqXc12k/Xs0PYT00KRX
7d9j5QVs7ixv/4yftX+P4jPA51x+F8rrsrm4Psy99e3cW9X+OdZc36z9ewxH
gAeAYy7fh/LaUF4bymsDPwA+n3vM2z/HfcBQPvhLgb9c8JfL5yrz9u8xHALu
A44ADwDHgIeATwGPACdcfw36e6C/D/r7YH/VXvOxQPTUpqUdOdY3imDdJYJ1
l/TCfzKDXcAasAfYB9wGHADuAO5yTOdFckz6fmlFsb5jZNd5DG6D/QHYH4D9
nScz2AWsAXuAfcBtwAHgDuAux9z+zhMF+inQT4F+CvRToJ8C/RTop8g8YwTr
XhGM1bL2RvsiEax7RbDuldcnYmhfCtqXgvaloH0paF8K2peC9uVC+3Kh/buk
r5W1N9pXi+w6W9XeuP0B2B+E2J4U1LcL9e1CfbvAd6G+XahvF+rbhfp2ob5d
aI8u6KdBPw36adBPg34a9NOgnybrFhGsO0YwNsraG332R7DuGMG6Y16fiKF9
udC+XGhfLrQvF9qXC+1LQ/vS0L40tH9N+jZZe6N9o8iuc1btjdsfgP1BiPcr
DfWtob411LcH9e1BfXtQ3x7I86C+PahvD9qjB/p5oJ8H+vmgnw/6+aCfD/r5
5FkawbpvZMci+bN1QJ6tA3i2DuDZOrDPVpOfz3MMTjzg+8D3Q47bT2awC1gD
9gD7gNuAA8AdwF2O6bMpx6CfAv0U6KdAPwX6KdBPgX4K9FNkjWhwEoC/O4D5
s2oAz6qBfVZV9ecyvgd8H/h+iPXjgr9c8JeL+cFfLvjLBX+54C8X/OWCv1yo
Tw36adBPg34a9NOgnwb9NOinQT9N+hpZ/XF/dwDze/8A7v0De++v6k8zvgd8
H/h+iNeTBn954C8P/OWBvzwozwN/eeAvD/zlgb88qE8P9PNBPx/080E/H/Tz
QT8f9PNBP5+swWf1x/3dKXG+rhGTNY64WOMoj/vkOCLHA3Ick+OhPXZJmS4p
083KzO/hMVkriWGfWWz3meU6xzC+iGEfWWzHE/lYP8N0rSOGtZIM07WWGO5J
se1fF3x1wvWBfWWx4s+cFEN+/syJFdij0B6+Dy2GfWjxSXXTq/zhMn7A5t4L
f7g0PYR0NvcewzUe2/6f9QeVD/vOcn+4DEN+fg/P/MEx2sP3qcV2n1rVPmgb
j2EfWmz7Y8QfmqaHkM7mYmN7zVT+YOVn/qD6wL603B+aYcjP74mZPzhGe/g+
ttjuY6v8QecyYtinFtu5NOIPj6aHkM7m5jJ/8PK7vPzMH1Qf2LeW+8NjGPLz
uZjMHxyjPXyfW2z3uVX+oPvKYtjHlvvDR3/43B88PTTplT94+V1efuYPqg/s
a8v94TMM+TUvX4E9Cu3h++Biuw+u8gfddxbDPrfcH230R5v7g6eHJr3yBy+/
y8vP/EH1gX1vuT/aDEN+zctXYI+q7MnX6M3CqDm2a/fDp/YZMLTPmNym4Yk/
fkTWz4cnbba+nuIzwGx9fQhzXEP7DDLy+DNnCM+coTrhfHgGDW2/l+jrEtxm
66GFvgyz9dAhzJEM7TOi0pfeo4fwTMj1dRkGfnVPI/pqgtts/arQl2G2fjWE
MfbQ3sMrfek9dAj37FxfzXDJL9qGou2E+E3psl0U5cKzfGif5SS/y/K7kN+d
ya9Zfg359Ux+j+X3IL83k99n+X3I78/kb7P8bcjfnskfsPwB5Dc47xMOVbtH
jkN7HJDzQbX3ZlgMNs35LsnTDau6dE/YGD3HLmAN2APsA24DDgB3AHc5pmP0
oatAPwX6KdBPlfoVPnBJ2ywGp/nxKbn/pMfmtZAyLefkfe9T0vc+hb73KfS9
T6HvfQp971Poq57avmrFd4FP8ehETcYcnwE+Nzi3Y0TsGBE7RmDHyNqRt8vR
icfu3yk+A3xOxwQjWMMYwRrGCOweWbuJPBfkuSDPZfJckOeiPA3yNMrTIE+D
PM3kaZCniZ8T8sxMyDPTLBqbY6+qi+Sp1SU5abN7ZAJzQAk8+xJYz0jsekZu
a6IUq9sUh4D7gCPAA8Ax4CHgU3oNJLDXLYHxXALPgATGc4ndu2bSK38Qf9m2
kMCcSwLP3gTm4xM7H2/95TIcAu4DjgAPAMeAh4BP6TWfwN6oBMZ7CTwDExjv
JXavU+Uv+ows/GXbcgJzHAk8+xOYT07sfLL1l2Y4BNwHHAEeAI4BDwGf0r5K
AntpEhgPJtAHSGA8mNi9MZW/aB+h8JftI2T+on2EBMZzCbyHlNi9ENZfHsMh
4D7gCPAAcAx4CPiUjg8T2HuRwHgxgT5QAuPFxO6lqPxF+0iFv2wfKfMX7SMl
MN5L4D2mxL7HZP3lMxwC7gOOAA8Ax4CHgE/p+DHzF9dPA/YA+6B/O+TlBayP
WPjL9hEzf9E+YgLjwQTeg0rse1DWX22GQ8B9wBHgAeAY8BDwKR1fZv7i+mnA
HmAf9G+HvLyA9ZELf9k+cuYv2kfO/MUxf48qse9RWX8FDIeA+4AjwAPAMeAh
4FP6nlfmL66fBuwB9kH/dsjLq/xR9DOKBRtzTPolpB+ckH5wUizQmGM7j5O4
7d74jMhJcQGLMUSKQ8sLSBkdcty1x5ropYlemuiliV6a6FUsyphjK2tM+l2m
f1i8j572/8hxaPN4JL9PjtuEm4+lcpuz4zGxOcUhSQtNWvGe+0ln/OhRRMrs
Wl46fibHVh9F9CdjaPNiijkmOiuic7HQaI6JT1SHHHer+hzDOG8M47wxjPPG
MM4bwzhvDOO8MYzzxjDOG8M4bwzjvByDfgr0U6CfAv3MWmxhO2n7Y9L2x6Tt
j12753Hs+uxbASkuvxVQ1HeaPinqu8ThhNa/6/eBHwG/D/wI+APgx8AfAD82
2NjSJtwAbAnAlgBsCcCWAGwJwJYAbAnAlgBsCcCWAGwJYs7v9MLROcUX09Hb
FE8f5Z+MKG2395lxcZ8p2oTmcwc5dgFrwB5gH3AbcAC4A7hL6kiTe5Qm9yht
71ETMn6ckPHjhNy7JmS+fQJ7LCawx2ICeywmsMdiAnssJrDHYgJ7LCawx2IC
eywmsMdiAnssJicB6BuU+hrb8sLzdjE56bL5jhSf0fvxGVl3PSvWXfN8Zycu
46X4DPA5xxrya8iv2bzKGRkfnGV7tVleP+R5bV8ve0DQse+0dzGgOEt3Id2F
dA3pGtI9SPcg3Yd0n+naIcf2mjorKjTnpIMZdu9IMbt3ZOn8mype+U0V830X
23Z70HZ70HZ70HZ70HZ70HZ7tu0aWQE57pBja5t5idkcK3Jsr9WQrNGHZI0+
JP2MsOhnlMd9e+zR46gs3wwSzPn22B4H5LhDyu+Elmv1D4n+5oXkIv/Tbres
o3eG0xP67nWKu/Rd89PTB+kpiy+mvenjC4sn8aPz/iDHxTd8Hr01nA7Ozypf
DQeV3PRYlXX/zqPzsUnL8VnvfGS+BZSXO4ge93tTq9fooj+IHCtnED2YDJ7k
j4o8/WL6OHqXpF9Mi/QF3zw6bvjmUV7m696DkyHxzca4syC9e8ny9h0v8td1
lyf27pZ+Yu9uYbF3t8oTe2+2fmKv2Cv2ir1i727og/jyxnf52Pp1dbFq2n76
7bLbAaZjvSzCm8rbNfuvurz1+dLut4nRH5vW+763++vWd5V235V2fw31sht4
39r9qv2c+ra9ersXLPgm4f29rsX+fcTPu7+fd/vF34KfJ3x18xqCpf4Ei/8F
XyVev31d7jz0dV8X2/TDNudnxA+75teb5Yf1scxbih8u/3511fx903ff8arr
OJL/atMFb9efN+1+sWv7H/ZdnuDt4st+/+ymt4+bbp/4S/y1T1j8Jfgm41XH
Q/t+fVyevtudr983vwq+3Prd9fRd0+ey0ze9L+46vmn2bBuvOo7dd//u2vV4
3f4QfLX1te363/T9zD3BC75VddTwrSoJEiRIkCBBggQJEiRIkCBBggQJEiRI
kCBBggQJEiRIkCBBggQJEiRIkDAnLNibdTi7N8u5Z/IcKJv/wCXHmhx75Ngn
x21yHJDjDjk2/68x0+0w+5ePC3Q9qNH1wOh7L+pNew/i897ZoChn2fD/O2eO
NU3YAQA=
--650121002-237711743-1002471874=:8457--

==> 1120.audit <==
Thu Oct 11 17:59:27 2001	thomas	changed notes
Thu Oct 11 17:59:27 2001	thomas	foobar
Thu Oct 11 18:00:09 2001	thomas	moved from incoming to Low-level
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1211 *
Subject: crash bug in get("function.name")()
From: Rich Heiberger <rmh@surfer.sbm.temple.edu>
Date: Tue, 11 Dec 2001 17:34:07 -0500 (EST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1211 <==
From rmh@surfer.sbm.temple.edu  Tue Dec 11 23:32:16 2001
Received: from surfer.sbm.temple.edu (surfer.sbm.temple.edu [155.247.185.2])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA15680
	for <R-bugs@biostat.ku.dk>; Tue, 11 Dec 2001 23:32:15 +0100 (MET)
Received: (from rmh@localhost)
	by surfer.sbm.temple.edu (8.11.1/8.11.1) id fBBMY7J2511117
	for R-bugs@biostat.ku.dk; Tue, 11 Dec 2001 17:34:07 -0500 (EST)
Date: Tue, 11 Dec 2001 17:34:07 -0500 (EST)
From: Rich Heiberger <rmh@surfer.sbm.temple.edu>
Message-Id: <200112112234.fBBMY7J2511117@surfer.sbm.temple.edu>
To: R-bugs@biostat.ku.dk
Subject: crash bug in get("function.name")()

R : Copyright 2001, The R Development Core Team
Version 1.3.1  (2001-08-31)

> tmp <- factor(1:3)
> get("print.factor")(tmp)
[1] 1 2 3
Levels:  1 2 3 
> print.a <- function(x,...) {
+   print("this is a")
+   NextMethod("print", x, quote = FALSE, right = TRUE, ...)
+ }
> 
> get("print.a")
function(x,...) {
  print("this is a")
  NextMethod("print", x, quote = FALSE, right = TRUE, ...)
}
> print.a(tmp)
[1] "this is a"
[1] 1 2 3
Levels:  1 2 3 
> get("print.a")(tmp)
[1] "this is a"

Process R exited abnormally with code 5 at Tue Dec 11 16:18:17 2001

----

I am using the windows version rw1031

I also tried on rw1030.   rw1030 gives a different code
Process R exited abnormally with code 255 at Tue Dec 11 17:31:06 2001

Rich

==> 1211.followup.1 <==
From ligges@amadeus.statistik.uni-dortmund.de  Wed Dec 12 00:04:56 2001
Received: from nx5.HRZ.Uni-Dortmund.DE (nx5.HRZ.Uni-Dortmund.DE [129.217.131.21])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id AAA15864
	for <R-bugs@biostat.ku.dk>; Wed, 12 Dec 2001 00:04:56 +0100 (MET)
Received: from amadeus.statistik.uni-dortmund.de by nx5.HRZ.Uni-Dortmund.DE
          via smtp-local with ESMTP; Wed, 12 Dec 2001 00:04:45 +0100
Received: from statistik.uni-dortmund.de (dial-142228.HRZ.Uni-Dortmund.DE [129.217.142.228])
	by amadeus.statistik.uni-dortmund.de (8.10.2+Sun/8.10.2) with ESMTP id fBBN4ib07175;
	Wed, 12 Dec 2001 00:04:44 +0100 (MET)
Message-ID: <3C16912C.75907CDA@statistik.uni-dortmund.de>
Date: Wed, 12 Dec 2001 00:05:16 +0100
From: Uwe Ligges <ligges@statistik.uni-dortmund.de>
X-Mailer: Mozilla 4.79 [en] (Windows NT 5.0; U)
X-Accept-Language: en
MIME-Version: 1.0
To: rmh@surfer.sbm.temple.edu
CC: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] crash bug in get("function.name")() (PR#1211)
References: <200112112232.XAA15690@pubhealth.ku.dk>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

rmh@surfer.sbm.temple.edu wrote:
> 
> R : Copyright 2001, The R Development Core Team
> Version 1.3.1  (2001-08-31)
> 
> > tmp <- factor(1:3)
> > get("print.factor")(tmp)
> [1] 1 2 3
> Levels:  1 2 3
> > print.a <- function(x,...) {
> +   print("this is a")
> +   NextMethod("print", x, quote = FALSE, right = TRUE, ...)
> + }
> >
> > get("print.a")
> function(x,...) {
>   print("this is a")
>   NextMethod("print", x, quote = FALSE, right = TRUE, ...)
> }
> > print.a(tmp)
> [1] "this is a"
> [1] 1 2 3
> Levels:  1 2 3
> > get("print.a")(tmp)
> [1] "this is a"
> 
> Process R exited abnormally with code 5 at Tue Dec 11 16:18:17 2001
> 
> ----
> 
> I am using the windows version rw1031
> 
> I also tried on rw1030.   rw1030 gives a different code
> Process R exited abnormally with code 255 at Tue Dec 11 17:31:06 2001


With an existing workspace the same happens with R-1.4.0 (unstable) on
WinNT4.

Also in R-1.4.0 (unstable) the last lines of your example, if started
without an existing workspace, results in:

>  print.a(tmp)
[1] "this is a"
[1] 1 2 3
Levels:  1 2 3 
>  get("print.a")(tmp)
[1] "this is a"
Error in get("print.a")(tmp) : function is not a closure
>  get("print.a")
Error: attempt to apply non-function
>  get 
#### Now a crash!


Uwe

==> 1211.reply.1 <==
From p.dalgaard@biostat.ku.dk  Wed Dec 12 00:37:20 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id AAA16017;
	Wed, 12 Dec 2001 00:37:19 +0100 (MET)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id fBBNX1I07101;
	Wed, 12 Dec 2001 00:33:01 +0100
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: Uwe Ligges <ligges@statistik.uni-dortmund.de>
Cc: rmh@surfer.sbm.temple.edu, r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] crash bug in get("function.name")() (PR#1211)
References: <200112112232.XAA15690@pubhealth.ku.dk>
	<3C16912C.75907CDA@statistik.uni-dortmund.de>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 12 Dec 2001 00:33:01 +0100
In-Reply-To: <3C16912C.75907CDA@statistik.uni-dortmund.de>
Message-ID: <x2adwps576.fsf@blueberry.kubism.ku.dk>
Lines: 83
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Uwe Ligges <ligges@statistik.uni-dortmund.de> writes:

> rmh@surfer.sbm.temple.edu wrote:
> > 
> > R : Copyright 2001, The R Development Core Team
> > Version 1.3.1  (2001-08-31)
> > 
> > > tmp <- factor(1:3)
> > > get("print.factor")(tmp)
> > [1] 1 2 3
> > Levels:  1 2 3
> > > print.a <- function(x,...) {
> > +   print("this is a")
> > +   NextMethod("print", x, quote = FALSE, right = TRUE, ...)
> > + }
> > >
> > > get("print.a")
> > function(x,...) {
> >   print("this is a")
> >   NextMethod("print", x, quote = FALSE, right = TRUE, ...)
> > }
> > > print.a(tmp)
> > [1] "this is a"
> > [1] 1 2 3
> > Levels:  1 2 3
> > > get("print.a")(tmp)
> > [1] "this is a"
> > 
> > Process R exited abnormally with code 5 at Tue Dec 11 16:18:17 2001
> > 
> > ----
> > 
> > I am using the windows version rw1031
> > 
> > I also tried on rw1030.   rw1030 gives a different code
> > Process R exited abnormally with code 255 at Tue Dec 11 17:31:06 2001
> 
> 
> With an existing workspace the same happens with R-1.4.0 (unstable) on
> WinNT4.
> 
> Also in R-1.4.0 (unstable) the last lines of your example, if started
> without an existing workspace, results in:
> 
> >  print.a(tmp)
> [1] "this is a"
> [1] 1 2 3
> Levels:  1 2 3 
> >  get("print.a")(tmp)
> [1] "this is a"
> Error in get("print.a")(tmp) : function is not a closure
> >  get("print.a")
> Error: attempt to apply non-function
> >  get 
> #### Now a crash!

This comes from this spot:

(gdb) 
#3  0x080cc4cc in do_nextmethod (call=0x873cc68, op=0x8214ee8,args=0x873cd2c, 
    env=0x8b2f394) at ../../../R/src/main/objects.c:488
488         s = findFun(CAR(cptr->call), cptr->sysparent);

CAR(cptr->call) grabs the first element of the call. In a construction
like get("print.a")(tmp) that will be  get("print.a"). However, findFun
assumes that it is being passed a symbol, and pokes a HASHVALUE into
what it thinks is the PRINTNAME of the object, and all hell breaks
loose. 

However, given the way that method dispatch works (by "dotting on" the
class name to the function name), I don't think this kind of
construction makes sense at all.  

There probably needs to be a check in findFun that its symbol argument
really is one. It is however of the "Doctor, it hurts when I do this"
variety, and it might be better to keep our hands off it this close to
release time.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1211.followup.2 <==
From rmh@surfer.sbm.temple.edu  Wed Dec 12 01:18:19 2001
Received: from surfer.sbm.temple.edu (surfer.sbm.temple.edu [155.247.185.2])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA16136;
	Wed, 12 Dec 2001 01:18:18 +0100 (MET)
Received: (from rmh@localhost)
	by surfer.sbm.temple.edu (8.11.1/8.11.1) id fBC0KKL2512179;
	Tue, 11 Dec 2001 19:20:20 -0500 (EST)
Date: Tue, 11 Dec 2001 19:20:20 -0500 (EST)
From: Rich Heiberger <rmh@surfer.sbm.temple.edu>
Message-Id: <200112120020.fBC0KKL2512179@surfer.sbm.temple.edu>
To: Uwe Ligges <ligges@statistik.uni-dortmund.de>,
        Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Subject: Re: [Rd] crash bug in get("function.name")() (PR#1211)
Cc: R-bugs@biostat.ku.dk, r-devel@stat.math.ethz.ch, rmh@surfer.sbm.temple.edu
References: <200112112232.XAA15690@pubhealth.ku.dk>
    <3C16912C.75907CDA@statistik.uni-dortmund.de>

Peter, your explanation looks right to me, and is certainly consistent
with the crash behavior of
get("print.a")
The R-1.4.0 error message is a good check.

I would think the explanation should prevent the other example from
working as well.  But this one works
get("print.factor")(tmp)
exactly as expected.

Both of these examples work correctly in S-Plus 4.5

Rich

==> 1211.reply.2 <==
From p.dalgaard@biostat.ku.dk  Wed Dec 12 14:15:29 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id OAA23218;
	Wed, 12 Dec 2001 14:15:28 +0100 (MET)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id fBCDB8M08832;
	Wed, 12 Dec 2001 14:11:08 +0100
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: Rich Heiberger <rmh@surfer.sbm.temple.edu>
Cc: Uwe Ligges <ligges@statistik.uni-dortmund.de>,
        Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>, R-bugs@biostat.ku.dk,
        r-devel@stat.math.ethz.ch
Subject: Re: [Rd] crash bug in get("function.name")() (PR#1211)
References: <200112112232.XAA15690@pubhealth.ku.dk>
	<3C16912C.75907CDA@statistik.uni-dortmund.de>
	<200112120020.fBC0KKL2512179@surfer.sbm.temple.edu>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 12 Dec 2001 14:11:07 +0100
In-Reply-To: <200112120020.fBC0KKL2512179@surfer.sbm.temple.edu>
Message-ID: <x23d2g37o4.fsf@blueberry.kubism.ku.dk>
Lines: 29
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Rich Heiberger <rmh@surfer.sbm.temple.edu> writes:

> Peter, your explanation looks right to me, and is certainly consistent
> with the crash behavior of
> get("print.a")
> The R-1.4.0 error message is a good check.
> 
> I would think the explanation should prevent the other example from
> working as well.  But this one works
> get("print.factor")(tmp)
> exactly as expected.
> 
> Both of these examples work correctly in S-Plus 4.5

(S-PLUS 3.4 too)

There's no NextMethod in print.factor, but I was wrong on the other
example: It has NextMethod("print",....) with an explicit generic, so
I don't think it should go near the CAR(call) bit at all.

I'll take a closer look, but there's also a few other nasty bugs
nagging us at the moment, and this looks like it could require surgery
to do_nextmethod with some risk of complications.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1211.followup.3 <==
From luke@nokomis.stat.umn.edu  Wed Dec 12 16:51:57 2001
Received: from nokomis.stat.umn.edu (root@nokomis.stat.umn.edu [134.84.86.39])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA25616;
	Wed, 12 Dec 2001 16:51:55 +0100 (MET)
Received: (from luke@localhost)
	by nokomis.stat.umn.edu (8.11.3/8.10.2/SuSE Linux 8.10.0-0.3) id fBCFpk712188;
	Wed, 12 Dec 2001 09:51:46 -0600
Date: Wed, 12 Dec 2001 09:51:46 -0600
From: Luke Tierney <luke@nokomis.stat.umn.edu>
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Cc: Rich Heiberger <rmh@surfer.sbm.temple.edu>,
        Uwe Ligges <ligges@statistik.uni-dortmund.de>, R-bugs@biostat.ku.dk,
        r-devel@stat.math.ethz.ch
Subject: Re: [Rd] crash bug in get("function.name")() (PR#1211)
Message-ID: <20011212095146.A12155@nokomis.stat.umn.edu>
References: <200112112232.XAA15690@pubhealth.ku.dk> <3C16912C.75907CDA@statistik.uni-dortmund.de> <200112120020.fBC0KKL2512179@surfer.sbm.temple.edu> <x23d2g37o4.fsf@blueberry.kubism.ku.dk>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5i
In-Reply-To: <x23d2g37o4.fsf@blueberry.kubism.ku.dk>; from p.dalgaard@biostat.ku.dk on Wed, Dec 12, 2001 at 02:11:07PM +0100

I don't think I'll get to look at this cerefully today, but here is
just a thought: My recollection is that NextMethod needs to be called
only from within a usemethod dispatch because the dispatch needs to
set up stuff in the environment that NextMethod needs.  If you do

print.a <- function(...) NextMethod()

and then call print.a directly then the stuff NextMethod needs isn't
set up, so NextMethod can't do anything useful.  I think the
do_nextmethod tries to detect this and raise an error, but for some
reason it isn't detecting the problem here.

luke

On Wed, Dec 12, 2001 at 02:11:07PM +0100, Peter Dalgaard BSA wrote:
> Rich Heiberger <rmh@surfer.sbm.temple.edu> writes:
> 
> > Peter, your explanation looks right to me, and is certainly consistent
> > with the crash behavior of
> > get("print.a")
> > The R-1.4.0 error message is a good check.
> > 
> > I would think the explanation should prevent the other example from
> > working as well.  But this one works
> > get("print.factor")(tmp)
> > exactly as expected.
> > 
> > Both of these examples work correctly in S-Plus 4.5
> 
> (S-PLUS 3.4 too)
> 
> There's no NextMethod in print.factor, but I was wrong on the other
> example: It has NextMethod("print",....) with an explicit generic, so
> I don't think it should go near the CAR(call) bit at all.
> 
> I'll take a closer look, but there's also a few other nasty bugs
> nagging us at the moment, and this looks like it could require surgery
> to do_nextmethod with some risk of complications.
> 
> -- 
>    O__  ---- Peter Dalgaard             Blegdamsvej 3  
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
313 Ford Hall, 224 Church St. S.E.           email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu

==> 1211.audit <==
Fri Dec 14 00:21:28 2001	thomas	moved from incoming to Low-level

==> 1211.followup.4 <==
From rmh@surfer.sbm.temple.edu  Fri Dec 14 05:38:10 2001
Received: from surfer.sbm.temple.edu (surfer.sbm.temple.edu [155.247.185.2])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id FAA11752;
	Fri, 14 Dec 2001 05:38:09 +0100 (MET)
Received: (from rmh@localhost)
	by surfer.sbm.temple.edu (8.11.1/8.11.1) id fBE4e7R2530944;
	Thu, 13 Dec 2001 23:40:07 -0500 (EST)
Date: Thu, 13 Dec 2001 23:40:07 -0500 (EST)
From: Rich Heiberger <rmh@surfer.sbm.temple.edu>
Message-Id: <200112140440.fBE4e7R2530944@surfer.sbm.temple.edu>
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>,
        Luke Tierney
    <luke@nokomis.stat.umn.edu>
Subject: Re: [Rd] crash bug in get("function.name")() (PR#1211)
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk,
        Uwe Ligges
    <ligges@statistik.uni-dortmund.de>,
        Rich Heiberger
    <rmh@surfer.sbm.temple.edu>
References: <200112112232.XAA15690@pubhealth.ku.dk>
    <3C16912C.75907CDA@statistik.uni-dortmund.de>
    <200112120020.fBC0KKL2512179@surfer.sbm.temple.edu>
    <x23d2g37o4.fsf@blueberry.kubism.ku.dk>

I tried the same exercise in S-Plus 6.  S-Plus 6 rejects any direct use
of a method.  It requires use of the generic.  It provides an error message
that might make sense to us, but probably not to a user.  The message
is consistent with Luke's intuition of coming into the middle of a sequence
that was not properly initiated with UseMethod.

Professional Edition Version 6.0.3 Release 2 for Microsoft Windows : 2001 

> tmp <- factor(1:3)
> tmp
[1] 1 2 3
> print.factor(tmp)
Warning messages:
  the "..." object should be a list but has mode "missing"
Problem in NextMethod("print", quote = quote): argument "..1" is missing with no default 
Use traceback() to see the call stack
> get("print.factor")(tmp)
Warning messages:
  the "..." object should be a list but has mode "missing"
Problem in NextMethod("print", quote = quote): argument "..1" is missing with no default 
Use traceback() to see the call stack
> 
> get("print")(tmp)
[1] 1 2 3
>

Rich
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1247 *
Subject: Mishandling missing "..."
From: David Brahm  <brahm@alum.mit.edu>
Date: Mon, 7 Jan 2002 10:52:09 -0500
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1247 <==
From postmaster@franz.stat.wisc.edu  Mon Jan  7 16:52:56 2002
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA00365
	for <r-bugs@biostat.ku.dk>; Mon, 7 Jan 2002 16:52:55 +0100 (MET)
Received: from mailmro2.fmr.com (really [192.223.198.254]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m16Nc4Z-000IY9C@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@R-project.org>; Mon, 7 Jan 2002 09:52:27 -0600 (CST) 
Received: from virmro110nts.fmr.com (virmro110nts.fmr.com [172.26.5.98])
	by mailmro2.fmr.com (Switch-2.2.0/Switch-2.2.0) with SMTP id g07FqA407241
	for <r-bugs@R-project.org>; Mon, 7 Jan 2002 10:52:10 -0500 (EST)
Received: from arbres1a.fmr.com ([155.1.103.77]) by msgmmk102nts.fmr.com with SMTP (Microsoft Exchange Internet Mail Service Version 5.5.2654.89)
	id VX34N36G; Mon, 7 Jan 2002 10:52:09 -0500
Received: (from a215020@localhost)
	by arbres1a.FMR.Com (8.11.1/8.11.1) id g07Fq9A10051;
	Mon, 7 Jan 2002 10:52:09 -0500 (EST)
X-Authentication-Warning: arbres1a.FMR.Com: a215020 set sender to brahm@alum.mit.edu using -f
From: David Brahm  <brahm@alum.mit.edu>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15417.50217.18954.874805@gargle.gargle.HOWL>
Date: Mon, 7 Jan 2002 10:52:09 -0500
To: r-bugs@R-project.org
Subject: Mishandling missing "..."
X-Mailer: VM 6.92 under Emacs 20.7.1
Reply-To: brahm@alum.mit.edu

R> myfun <- function(x, ...) {x[...] <- 0; x}
R> myfun(3)
   Error in myfun(3) : SubAssignArgs: invalid number of arguments

It fails because no ... was passed.  The workaround (and desired behavior) is:
R> myfun <- function(x, ...) {if (missing(...)) x[] <- 0 else x[...] <- 0; x}
R> myfun(3)
   [1] 0

Deja vu?  This is the one piece of my PR#1110 (Oct 3, 2001) that I think may be
a genuine bug (though even that is debatable), and I would like to override
PR#1110 with this report.  This behavior still occurs in 1.4.0.

-- 
                              -- David Brahm (brahm@alum.mit.edu)

==> 1247.followup.1 <==
From tlumley@u.washington.edu  Mon Jan  7 20:15:04 2002
Received: from jason03.u.washington.edu (jason03.u.washington.edu [140.142.8.11])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA02248
	for <R-bugs@biostat.ku.dk>; Mon, 7 Jan 2002 20:15:03 +0100 (MET)
Received: from homer04.u.washington.edu (homer04.u.washington.edu [140.142.15.38])
	by jason03.u.washington.edu (8.11.6+UW01.08/8.11.6+UW01.10) with ESMTP id g07JEY661488;
	Mon, 7 Jan 2002 11:14:34 -0800
Received: from localhost (tlumley@localhost)
	by homer04.u.washington.edu (8.11.6+UW01.08/8.11.6+UW01.10) with ESMTP id g07JEXb159676;
	Mon, 7 Jan 2002 11:14:33 -0800
Date: Mon, 7 Jan 2002 11:14:33 -0800 (PST)
From: Thomas Lumley <tlumley@u.washington.edu>
To: brahm@alum.mit.edu
cc: r-devel@stat.math.ethz.ch, <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] Mishandling missing "..." (PR#1247)
In-Reply-To: <200201071552.QAA00375@pubhealth.ku.dk>
Message-ID: <Pine.A41.4.43.0201071110230.157118-100000@homer04.u.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Mon, 7 Jan 2002 brahm@alum.mit.edu wrote:

> R> myfun <- function(x, ...) {x[...] <- 0; x}
> R> myfun(3)
>    Error in myfun(3) : SubAssignArgs: invalid number of arguments
>
> It fails because no ... was passed.  The workaround (and desired behavior) is:
> R> myfun <- function(x, ...) {if (missing(...)) x[] <- 0 else x[...] <- 0; x}
> R> myfun(3)
>    [1] 0
>

This is interesting.  Another workaround is

> myfun
function(x, ...) {x[...] <- 0; x}
> myfun(3,)
[1] 0

and the problem goes down to eval.c:evalListKeepMissing, which says
	/* If we have a ... symbol, we look to see what it is bound to.
	 * If its binding is Null (i.e. zero length)
	 *	we just ignore it and return the cdr with all its
               expressions evaluated;

The difference between  myfun(3) and myfun(3,) is that in the former case
there are no ... arguments, in the latter there is a ... argument but it's
missing.

In one way this would be fairly easy to fix by writing yet another variant
of evalList that replaced an empty ... with R_MissingArg, but I'm scared.


	-thomas


==> 1247.audit <==
Fri Jan 11 09:02:53 2002	pd	foobar
Fri Jan 11 09:02:53 2002	pd	moved from incoming to Low-level
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1267 *
Subject: hashing NaN
From: Thomas Lumley <tlumley@u.washington.edu>
Date: Wed, 16 Jan 2002 16:29:35 -0800 (PST)
--Patch put in R-devel for further testing.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1267 <==
From postmaster@franz.stat.wisc.edu  Thu Jan 17 01:30:07 2002
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA20692
	for <r-bugs@biostat.ku.dk>; Thu, 17 Jan 2002 01:30:07 +0100 (MET)
Received: from jason04.u.washington.edu (really [140.142.8.53]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m16R0Qz-000IbWC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Wed, 16 Jan 2002 18:29:37 -0600 (CST) 
Received: from homer05.u.washington.edu (homer05.u.washington.edu [140.142.15.39])
	by jason04.u.washington.edu (8.11.6+UW01.08/8.11.6+UW01.10) with ESMTP id g0H0TZC24106
	for <r-bugs@r-project.org>; Wed, 16 Jan 2002 16:29:36 -0800
Received: from localhost (tlumley@localhost)
	by homer05.u.washington.edu (8.11.6+UW01.08/8.11.6+UW01.10) with ESMTP id g0H0TZN43686
	for <r-bugs@r-project.org>; Wed, 16 Jan 2002 16:29:35 -0800
Date: Wed, 16 Jan 2002 16:29:35 -0800 (PST)
From: Thomas Lumley <tlumley@u.washington.edu>
To: r-bugs@r-project.org
Subject: hashing NaN
Message-ID: <Pine.A41.4.44.0201161618110.75106-100000@homer05.u.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


Different NaNs can hash to different values and so be treated differently
by duplicated(), unique(), match(). Any IEEE double value with exponent
bits all 1 is NaN (except the one that is NA).

AFAICT all arithmetic and mathematical operations in R produce the same
NaN, but this is not guaranteed by any standard. read.spss() will produce
different NaNs when reading missing values in at least some circumstances.


	-thomas

Thomas Lumley			Asst. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle


==> 1267.audit <==
Fri Jan 18 09:12:14 2002	ripley	changed notes
Fri Jan 18 09:12:14 2002	ripley	foobar
Fri Jan 18 09:12:14 2002	ripley	moved from incoming to Low-level
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Macintosh

none

Directory:  Misc

* PR# 1126 *
Subject: R-bug report www page whishlist
From: jens.lund@nordea.com
Date: Wed, 10 Oct 2001 18:24:29 +0200 (MET DST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1126 <==
From jens.lund@nordea.com  Wed Oct 10 18:24:29 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA01798
	for <R-bugs@biostat.ku.dk>; Wed, 10 Oct 2001 18:24:29 +0200 (MET DST)
Date: Wed, 10 Oct 2001 18:24:29 +0200 (MET DST)
From: jens.lund@nordea.com
Message-Id: <200110101624.SAA01798@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: R-bug report www page whishlist

Full_Name: Jens Lund
Version: --
OS: --
Submission from: (NULL) (194.239.194.210)


On http://r-bugs.biostat.ku.dk/cgi-bin/R pressing "new bug report" returns a new
form. It would, IMHO, be natural to place the "submit bug report" button on this
form *below* the input area for the actual bug report :-)

Cheers, Jens

==> 1126.audit <==
Wed Oct 10 19:08:54 2001	ripley	moved from incoming to Misc
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1158 *
Subject: bug.report()sends empty message
From: Paul Gilbert <pgilbert@bank-banque-canada.ca>
Date: Mon, 05 Nov 2001 10:05:27 -0500
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1158 <==
From pgilbert@bank-banque-canada.ca  Mon Nov  5 16:07:41 2001
Received: from mail1.bank-banque-canada.ca (mail1.bank-banque-canada.ca [140.80.193.130])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA03956
	for <r-bugs@biostat.ku.dk>; Mon, 5 Nov 2001 16:07:39 +0100 (MET)
Received: from fwx-t1 ([140.80.193.132])
	by mail1.bank-banque-canada.ca (8.9.3/8.9.3) with SMTP id KAA05318;
	Mon, 5 Nov 2001 10:01:04 -0500 (EST)
Message-ID: <3BE6AAB6.E0962CD5@bank-banque-canada.ca>
Date: Mon, 05 Nov 2001 10:05:27 -0500
From: Paul Gilbert <pgilbert@bank-banque-canada.ca>
X-Mailer: Mozilla 4.7 [en] (Win95; U)
X-Accept-Language: en
MIME-Version: 1.0
To: R-bugs <r-bugs@biostat.ku.dk>
CC: brahm@alum.mit.edu
Subject: bug.report()sends empty message
Content-Type: multipart/mixed;
 boundary="------------FAC78F7B6BFECAD9BD873458"

This is a multi-part message in MIME format.
--------------FAC78F7B6BFECAD9BD873458
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

On Mon, 22 Oct 2001, David Brahm wrote:
>    I swear, bug.report() ate my message!  Apologies to all, esp. Peter
who
> will once again have to clean up after my mess...

With some editors on Unix bug.report() does this. The problem is that
some editors (like Nedit) fork a separate process and return. The Unix
version of bug.report sends an empty message in this case. The fix is to
make the Unix version the same as the Windows version, with an optional
argument "wait".

Attached are four small files bug.report.R, bug.report.Rd, Sys.mail.R,
and Sys.mail.Rd, which attempt to fix the problem and the documentation.
They also separate out the mail mechanism as a utility that can be used
elsewhere. Unfortunately, I have only been able to test these on a
limited number of platforms.

Paul Gilbert

--------------FAC78F7B6BFECAD9BD873458
Content-Type: text/plain; charset=us-ascii;
 name="bug.report.R"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="bug.report.R"

bug.report <- function(subject = "", ccaddress = Sys.getenv("USER"),
                       method = getOption("mailer"),
                       address = "gilp",  #"r-bugs@r-project.org",
                       file = "R.bug.report",
		       wait=TRUE)
{
    methods <- c("mailx", "gnudoit", "none", "ess")

    method <-
	if(is.null(method)) "none"
	else methods[pmatch(method, methods)]

    body <- paste("\\n<<insert bug report here>>\\n\\n\\n\\n",
		  "--please do not edit the information below--\\n\\n",
		  "Version:\\n ",
		  paste(names(R.version),R.version, sep=" = ",collapse="\\n "),
		  "\\n\\n",
		  "Search Path:\\n ",
		  paste(search(), collapse=", "),
		  "\\n", sep="", collapse="")

    if(method == "gnudoit") {
	cmd <- paste("gnudoit -q '",
		     "(mail nil \"", address, "\")",
		     "(insert \"", body, "\")",
		     "(search-backward \"Subject:\")",
		     "(end-of-line)'",
		     sep="")
	system(cmd)
        if (wait) {
	  cat("Hit Return to continue in R. ")
	  answer <- readline()
        }
    }
    else if(method=="none"){

        disclaimer <-
            paste("# Your mailer is set to \"none\" (default on Windows),\n",
                  "# hence we cannot send the bug report directly from R.\n",
                  "# Please copy the bug report (after finishing it) to\n",
                  "# your favorite email program and send it to\n#\n",
                  "#       ", address, "\n#\n",
                  "######################################################\n",
                  "\n\n", sep = "")

        cat(disclaimer, file=file)
	body <- gsub("\\\\n", "\n", body)
	cat(body, file=file, append=TRUE)
	system(paste(getOption("editor"), file))
        cat("The unsent bug report can be found in file", file, "\n")
        if (wait) {
	  cat("Hit Return to continue in R. ")
	  answer <- readline()
        }
    }
    else if(method == "mailx"){

        if(missing(subject)) stop("Subject missing")

	body <- gsub("\\\\n", "\n", body)
	cat(body, file=file, append=FALSE)
	system(paste(getOption("editor"), file))
	
	if (wait) {
	  cat("Submit the bug report? (finish editing and save the file before responding) ")
	  answer <- readline()
	  answer <- grep("y", answer, ignore.case=TRUE)
	  if(length(answer)>0){
 	     body <- scan(file, what="char", sep="\n")
             cat("Sending email ...\n")
             status <- Sys.mail(address=address, ccaddress=ccaddress,
	                       subject=subject, body=body, method="mailx")
             if(!status) status <- Sys.mail(address=address, ccaddress=ccaddress,
	                       subject=subject, body=body, method="mail")
             if(!status) status <- Sys.mail(address=address, ccaddress=ccaddress,
	                       subject=subject, body=body, method="Mail")
             if(!status) {
                cat("Sending email failed!\n")
                cat("The unsent bug report can be found in file", file, "\n")
            }
	  }
        }
        else cat("The unsent bug report can be found in file", file, "\n")
    }
    else if(method=="ess"){
	body <- gsub("\\\\n", "\n", body)
	cat(body)
        if (wait) {
	  cat("Hit Return to continue in R. ")
	  answer <- readline()
        }
    }
}

--------------FAC78F7B6BFECAD9BD873458
Content-Type: text/plain; charset=us-ascii;
 name="bug.report.Rd"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="bug.report.Rd"

\name{bug.report}
\alias{bug.report}
\title{Send a Bug Report}
\usage{
bug.report(subject = "", ccaddress = Sys.getenv("USER"),
           method = getOption("mailer"), 
	   address = "r-bugs@r-project.org",
           file = "R.bug.report",
	   wait = TRUE)

}
\arguments{
  \item{subject}{Subject of the email. Please do not use single quotes
    (\code{'}) in the subject!}
  \item{ccaddress}{Optional email address for copies (default is current
    user).  Use \code{ccaddress = NULL} for no copies.}
  \item{method}{Submission method, one of \code{"mailx"},
    \code{"gnuclient"}, \code{"none"}, or \code{"ess"}.}
  \item{address}{Recipient's email address.}
  \item{file}{File to use for setting up the email (or storing it when
    method is \code{"none"} or sending mail fails).}
  \item{wait}{logical. Should \R wait for the editor to return?}
}
\description{
  Invokes an editor to write a bug report and optionally mail it to the
  r-bugs list at \email{r-bugs@r-project.org}.  Some standard
  information on the current version and configuration of \R are 
  included automatically.
}
\details{
  Currently direct submission of bug reports works only on Unix systems.
  If the submission method is \code{"mailx"}, then the default editor is
  used to write the bug report. Which editor is used can be controlled
  using \code{\link{options}}, type \code{getOption("editor")} to see what
  editor is currently defined. Please use the help pages of the
  respective editor for details of usage. After saving the bug report
  (in the temporary file opened) and exiting the editor
  the report is mailed using a Unix command line mail utility such as
  \code{mailx}.  A copy of the mail is sent to the current user.

  If method is \code{"gnuclient"}, then an emacs mail buffer is opened
  and used for sending the email.

  If method is \code{"none"} or \code{NULL} (which is the default on
  Windows systems), then only an editor is opened to help writing the
  bug report.  The report can then be copied to your favorite email
  program and be sent to the r-bugs list.

  If method is \code{"ess"} the body of the mail is simply sent to
  stdout.
  
  If wait is \code{"TRUE"} then \R issues a prompt after the editor is started
  and waits for input. If \R is sending the mail (e.g. with method
  code{"mailx"}) then wait should be \code{"TRUE"}. In this case the edited file
  must be saved before responding to the question.
}
\value{Nothing useful.}
\section{When is there a bug?}{
  If \R executes an illegal instruction, or dies with an operating
  system error message that indicates a problem in the program (as
  opposed to something like ``disk full''), then it is certainly a bug.

  Taking forever to complete a command can be a bug, but you must make
  certain that it was really \R's fault.  Some commands simply take a
  long time.  If the input was such that you KNOW it should have been
  processed quickly, report a bug.  If you don't know whether the
  command should take a long time, find out by looking in the manual or
  by asking for assistance.

  If a command you are familiar with causes an \R error message in a
  case where its usual definition ought to be reasonable, it is probably
  a bug.  If a command does the wrong thing, that is a bug.  But be sure
  you know for certain what it ought to have done.  If you aren't
  familiar with the command, or don't know for certain how the command
  is supposed to work, then it might actually be working right.  Rather
  than jumping to conclusions, show the problem to someone who knows for
  certain.

   Finally, a command's intended definition may not be best for
   statistical analysis.  This is a very important sort of problem, but
   it is also a matter of judgment.  Also, it is easy to come to such a
   conclusion out of ignorance of some of the existing features.  It is
   probably best not to complain about such a problem until you have
   checked the documentation in the usual ways, feel confident that you
   understand it, and know for certain that what you want is not
   available.  If you are not sure what the command is supposed to do
   after a careful reading of the manual this indicates a bug in the
   manual.  The manual's job is to make everything clear.  It is just as
   important to report documentation bugs as program bugs.

   If the online argument list of a function disagrees with the manual,
   one of them must be wrong, so report the bug.
}
\section{How to report a bug}{
  When you decide that there is a bug, it is important to report it and
  to report it in a way which is useful.  What is most useful is an
  exact description of what commands you type, from when you start \R
  until the problem happens.  Always include the version of \R, machine,
  and operating system that you are using; type `version' in \R to print
  this. 

  The most important principle in reporting a bug is to report FACTS,
  not hypotheses or categorizations.  It is always easier to report the
  facts, but people seem to prefer to strain to posit explanations and
  report them instead.  If the explanations are based on guesses about
  how \R is implemented, they will be useless; we will have to try to 
  figure out what the facts must have been to lead to such
  speculations.  Sometimes this is impossible.  But in any case, it is
  unnecessary work for us.

  For example, suppose that on a data set which you know to be quite
  large the command \code{data.frame(x, y, z, monday, tuesday)} never
  returns.  Do not report that \code{data.frame()} fails for large data
  sets.  Perhaps it fails when a variable name is a day of the week.  If
  this is so then when we got your report we would try out the
  \code{data.frame()} command on a large data set, probably with no day
  of the week variable name, and not see any problem. There is no way in
  the world that we could guess that we should try a day of the week
  variable name.

  Or perhaps the command fails because the last command you used was a
  \code{[} method that had a bug causing \R's internal data structures
  to be corrupted and making the \code{data.frame()} command fail from
  then on.  This is why we need to know what other commands you have
  typed (or read from your startup file).

  It is very useful to try and find simple examples that produce
  apparently the same bug, and somewhat useful to find simple examples
  that might be expected to produce the bug but actually do not.  If you
  want to debug the problem and find exactly what caused it, that is
  wonderful.  You should still report the facts as well as any
  explanations or solutions.

  Invoking \R with the \code{--vanilla} option may help in isolating a
  bug.  This ensures that the site profile and saved data files are not
  read.

  On some systems a bug report can be generated using the
  \code{bug.report()} function.  This automatically includes the version
  information and sends the bug to the correct address.  Alternatively
  the bug report can be emailed to \email{r-bugs@r-project.org} or
  submitted to the Web page at \url{http://bugs.r-project.org}.
}
\seealso{R FAQ, \code{link{Sys.mail}} }
\author{This help page is adapted from the Emacs manual}
\keyword{utilities}
\keyword{error}

--------------FAC78F7B6BFECAD9BD873458
Content-Type: text/plain; charset=us-ascii;
 name="Sys.mail.R"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="Sys.mail.R"

Sys.mail <- function(address = Sys.info()$user,
                     ccaddress  = NULL,
                     bccaddress = NULL,
		     subject    = NULL,
		     body= "no body",
                     method = getOption("mailer")) {
   if(!(is.character(address) && nchar(address)>0))
      stop("A character string address must be specified.")

   # The arguments to mail, mailx, and Mail are all the same, but a different
   # mailer will require that this first part be re-organized under the
   # specific method.
   file <- tempfile()
   on.exit(unlink(file))
   cat(body, file=file, append=FALSE, sep="\n")
   cmdargs <- paste(address, "<", file, "2>/dev/null")
	
   if(is.character(ccaddress) && nchar(ccaddress)>0) 
            cmdargs <- paste(" -c '", ccaddress, "' ",  cmdargs)

   if(is.character(bccaddress) && nchar(bccaddress)>0) 
            cmdargs <- paste(" -b '", bccaddress, "' ",  cmdargs)

   if(is.character(subject) && nchar(subject)>0) 
            cmdargs <- paste(" -s '", subject, "' ",  cmdargs)

   status <- 1
   if(method == "mailx") status <- system(paste("mailx", cmdargs)) else
   if(method == "mail")  status <- system(paste("mail", cmdargs))  else 
   if(method == "Mail")  status <- system(paste("Mail", cmdargs))  else {
	warning(paste("mail method ", method, " not supported.\n"))
	return(F)
	}
   if(status > 0) {
	warning(paste("sending email with ", method, " failed.\n"))
	return(F)
	}
   T
   }

--------------FAC78F7B6BFECAD9BD873458
Content-Type: text/plain; charset=us-ascii;
 name="Sys.mail.Rd"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="Sys.mail.Rd"

\name{Sys.mail}
\alias{Sys.mail}
\title{Send Mail}
\usage{
Sys.mail(address= Sys.info()$user, ccaddress = NULL, bccaddress = NULL,
           subject = NULL, body= "no body", method = getOption("mailer"))
}
\arguments{
  \item{address}{Recipient's email address. The default is the user name as
     indicated by \code{Sys.info()$user}, which will correspond to your 
     own email address on many systems.}
  \item{ccaddress}{Optional email address for copies. 
    Use \code{ccaddress = NULL} for no copies.}
  \item{bccaddress}{Optional email address for blind copies.
    Use \code{bccaddress = NULL} for no copies.}
  \item{subject}{Subject of the email. Please do not use single quotes
     in the subject!}
  \item{method}{Submission method, one of \code{"mailx"},
    \code{"mail"}, or \code{"Mail"}.}
  \item{body}{A vector of character, one line per element to place in the body
     of the email.}
}
\description{
  Use a system mail tool to send a message. Multiple recipients can be
  specified in any of the addresses by enclosing them in double (\code{"}) 
  quotes. Please do not use single (\code{'}) quotes.
  
  The body is a vector of character. Each element of body is written 
  as a line of the message body.
}
\details{
  Currently works only on Unix systems using "mailx", "mail" or "Mail". The mail
  tool needs to be found on your Unix search path.
}
\value{TRUE or FALSE indicating success or failure as returned by the operating
    system. (This does not indicate that the message was received at the 
    address.)}

\examples{
    \dontrun{Sys.mail(address="friends", subject="R", body="R is great")}
}
\seealso{\code{link{options}} }
\author{Paul Gilbert}
\keyword{utilities}


--------------FAC78F7B6BFECAD9BD873458--


==> 1158.audit <==
Sat Nov 17 11:59:57 2001	ripley	foobar
Sat Nov 17 11:59:57 2001	ripley	moved from incoming to Misc

==> 1158.followup.1 <==
From postmaster@franz.stat.wisc.edu  Mon Dec 10 19:37:36 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA01758
	for <r-bugs@biostat.ku.dk>; Mon, 10 Dec 2001 19:37:35 +0100 (MET)
Received: from mailmro2.fmr.com (really [192.223.198.254]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m16DVIu-000IheC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Mon, 10 Dec 2001 12:37:28 -0600 (CST) 
Received: from virmro110nts.fmr.com (virmro110nts.fmr.com [172.26.5.98])
	by mailmro2.fmr.com (Switch-2.2.0/Switch-2.2.0) with SMTP id fBAIaqX07055
	for <r-bugs@r-project.org>; Mon, 10 Dec 2001 13:36:52 -0500 (EST)
Received: from arbprod.fmr.com (arbproda.fmr.com [155.1.103.75]) by msgbos102nts.fmr.com with SMTP (Microsoft Exchange Internet Mail Service Version 5.5.2654.89)
	id W0GPQMRB; Mon, 10 Dec 2001 13:36:51 -0500
Received: (from a215020@localhost)
	by arbprod.fmr.com (8.11.1/8.11.1) id fBAIapl09851;
	Mon, 10 Dec 2001 13:36:51 -0500 (EST)
Date: Mon, 10 Dec 2001 13:36:51 -0500 (EST)
From: David Brahm  <a215020@onyx.fmr.com>
Message-Id: <200112101836.fBAIapl09851@arbprod.fmr.com>
Reply-to: brahm@alum.mit.edu
To: r-bugs@r-project.org
Cc: a215020@arbprod.fmr.com
Subject:  Re: bug.report() sends empty message (PR#1158) 

   On Oct 22, I sent an empty bug report (#1138) because bug.report() "ate my
message".  Paul Gilbert opened a new bug report (#1158) for this problem.

   I'm now convinced it's because I had an apostrophe in the subject line
("round() doesn't").  The bug.report documentation specifically warns against
this, but the bug.report() function could also check for it!  I suggest adding
this line to the bug.report code:

  if (regexpr("'", subject) > 0) stop("Please, no apostrophe in the subject.")

                              -- David Brahm (brahm@alum.mit.edu)

R> getOption("mailer")
   [1] "mailx"
Version:
 platform = sparc-sun-solaris2.6
 arch = sparc
 os = solaris2.6
 system = sparc, solaris2.6
 status = 
 major = 1
 minor = 3.1
 year = 2001
 month = 08
 day = 31
 language = R

Search Path:
 .GlobalEnv, package:misc, package:io, package:arrays, package:ls1, package:g.data, package:db, package:ts, package:ctest, Autoloads, package:base

==> 1158.followup.2 <==
From pgilbert@bank-banque-canada.ca  Mon Dec 10 20:09:31 2001
Received: from mail1.bank-banque-canada.ca (mail1.bank-banque-canada.ca [140.80.193.130])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA01969
	for <R-bugs@biostat.ku.dk>; Mon, 10 Dec 2001 20:09:29 +0100 (MET)
Received: from fwx-int (fwx-int.bank-banque-canada.ca [140.80.193.129])
	by mail1.bank-banque-canada.ca (8.9.3/8.9.3) with SMTP id OAA00487;
	Mon, 10 Dec 2001 14:04:01 -0500 (EST)
Received: from mfa99599.boc by mailhost.bank-banque-canada.ca (8.8.8+Sun/SMI-SVR4)
	id NAA05366; Mon, 10 Dec 2001 13:53:57 -0500 (EST)
Received: from mfa01506.boc (mfa01506 [140.80.3.112])
	by mfa99599.boc (8.9.1b+Sun/8.9.1) with ESMTP id NAA29819;
	Mon, 10 Dec 2001 13:53:56 -0500 (EST)
Received: from bank-banque-canada.ca (localhost [127.0.0.1])
	by mfa01506.boc (8.9.3+Sun/8.9.3) with ESMTP id NAA09467;
	Mon, 10 Dec 2001 13:53:53 -0500 (EST)
Sender: pgilbert@bank-banque-canada.ca
Message-ID: <3C1504C0.1ADC7F0D@bank-banque-canada.ca>
Date: Mon, 10 Dec 2001 13:53:52 -0500
From: Paul Gilbert <pgilbert@bank-banque-canada.ca>
X-Mailer: Mozilla 4.75 [en] (X11; U; SunOS 5.8 sun4u)
X-Accept-Language: en
MIME-Version: 1.0
To: brahm@alum.mit.edu
CC: R-bugs@biostat.ku.dk
Subject: Re: [Rd] Re: bug.report() sends empty message (PR#1158)
References: <200112101837.TAA01768@pubhealth.ku.dk>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

brahm@alum.mit.edu wrote:
>   On Oct 22, I sent an empty bug report (#1138) because bug.report()
>"ate my
>message".  Paul Gilbert opened a new bug report (#1158) for this
>problem.

>   I'm now convinced it's because I had an apostrophe in the subject
>line

Your problem may have been due to the apostrophe, but it reminded me of another
outstanding problem which I had neglected to report previously: wait=TRUE as in
the windows version seems to be necessary with some Unix editors too (e.g.
Nedit).

Paul Gilbert
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  Models

none

Directory:  Startup

none

Directory:  System-specific

* PR# 848 *
Subject: X11 device doesn't handle destroy events correcly
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 13 Feb 2001 17:40:46 -0500
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 848 <==
From postmaster@franz.stat.wisc.edu  Tue Feb 13 23:40:36 2001
Received: from franz.stat.wisc.edu (franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id XAA10552
	for <r-bugs@biostat.ku.dk>; Tue, 13 Feb 2001 23:40:36 +0100 (MET)
Received: from infiniti.ece.cmu.edu (really [128.2.133.84]) by franz.stat.wisc.edu
	via in.smtpd with esmtp
	id <m14So7r-000J2mC@franz.stat.wisc.edu> (Debian Smail3.2.0.102)
	for <r-bugs@r-project.org>; Tue, 13 Feb 2001 16:40:47 -0600 (CST) 
Received: (from tov@localhost) by infiniti.ece.cmu.edu (AIX4.3/UCB 8.8.8/8.8.8) id RAA70658; Tue, 13 Feb 2001 17:40:46 -0500
X-Authentication-Warning: infiniti.ece.cmu.edu: tov set sender to tov@ece.cmu.edu using -f
Sender: tov@infiniti.ece.cmu.edu
To: r-bugs@r-project.org
Cc: Thomas Vogels <tov@ece.cmu.edu>
Subject: X11 device doesn't handle destroy events correcly
Reply-To: Thomas Vogels <tov@ece.cmu.edu>
X-URI: http://www.ece.cmu.edu/~tov
From: Thomas Vogels <tov@ece.cmu.edu>
Date: 13 Feb 2001 17:40:46 -0500
Message-ID: <px3ddi6wb5.fsf@infiniti.ece.cmu.edu>
Lines: 258
User-Agent: Gnus/5.0807 (Gnus v5.8.7) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii


Hi, there are two problems in devX11.c.  The one is an undocumented
nuisance and the other isn't a bug until you try to embed an X11
device in another window (think tktoplevel() in tcltk package...).

Let's take a look at locator() first: Assuming you call locator() with
a current X11 device, this call is handled in X11_Locator
(src/unix/X11/devX11.c).  When you have one window open and call
locator, you have three options to quit the locator: click Button 1
(to locate), click Button 2 (to abort), or destroy the window.  The
later results in the error message: "Error in locator(1) : No graphics
device is active". That's OK, sort of.

This gets problematic when you open two windows:
> x11()  # assume that's device 2
> x11()  # assume that's device 3
> plot(1)
> locator(1)  # with device 3 == dev.cur()!

When you now destroy device 3 (where locator expects the click), you have
*no alternative but to close _all_ windows* to abort the locator.  The
locator continues to wait for mouse clicks in device 3 where of course
no further clicks can come from.  That's the nuisance part.

The second problem is that the device may try to plot() into a
non-existant window.  Assume that the window was destroyed by some
other part of the program.  The device (at some point in the future)
will receive a DestroyNotify event that handleEvent ignores.
Blissfully!  *No KillDevice is called* when the window is destroyed by
something other than the WM_DELETE_WINDOW mechanism!  This happens
when you embed the X11 device into another window/application.  For
starters, the device no longer receives WM_DELETE_WINDOW client
messages.  But it does receive a DestroyNotify event when the parent
(the container window) is destroyed.  HandleEvent should, well
_handle_ this _event_.

The patch below is a _suggestion_ how to solve both problems.  It is
against the current r-devel, 1.3, as of 2/13.  I believe this behavior
exists in version 1.2 as well and can be solved there the same way.
The patch is just meant as a convenient and concise way to describe
my suggestion.  I'd greatly appreciate feedback or other ideas!

Implementation:

-- the variable inclose is now in the device specific structure (why
   was it global?)  After the window is mapped, inclose is TRUE until
   the window is destroyed explicitly or a DestroyNotify event has been
   received.
-- the deviceSpecific pointer is set to NULL after the memory has been
   freed. This (side?) effect is used in X11_Locator to detect the
   closing of the current device  which _must_ lead to an error.
-- the if statement to handle events of type DestroyEvent is added to 
   handleEvent
-- when the user closes the device (dev.off()), the window is
   destroyed in X11_Close
-- when the user pushes the close button in the window frame, the
   window is destroyed in handleEvent and X11_Close is initiated
   (the WM_DELETE_WINDOW mechanism already in place.)
-- when the window is destroyed for another reason (e.g. the parent
   being destroyed), it is not destroyed again but X11_Close is still
   initiated.

Regards,
  -tom


--------------------------------------------------
*** devX11.c_orig	Tue Feb 13 15:32:24 2001
--- devX11.c	Tue Feb 13 17:24:04 2001
***************
*** 116,121 ****
--- 116,122 ----
      FILE *fp;				/* file for a bitmap device */
      int quality;			/* JPEG quality */
  
+     Rboolean inclose;                   /* TRUE if window is being closed */
  } x11Desc;
  
  
***************
*** 145,151 ****
  static Atom _XA_WM_PROTOCOLS, protocol;
  
  static Rboolean displayOpen = FALSE;
- static Rboolean inclose = FALSE;
  static int numX11Devices = 0;
  
  	/********************************************************/
--- 146,151 ----
***************
*** 619,632 ****
  	xd->windowHeight = event.xconfigure.height;
  	xd->resize = 1;
      }
      else if ((event.type == ClientMessage) &&
! 	     (event.xclient.message_type == _XA_WM_PROTOCOLS))
! 	if (!inclose && event.xclient.data.l[0] == protocol) {
! 	    XFindContext(display, event.xclient.window,
  			 devPtrContext, &temp);
  	    dd = (DevDesc *) temp;
! 	    KillDevice(dd);
  	}
  }
  
  static void R_ProcessEvents(void *data)
--- 619,652 ----
  	xd->windowHeight = event.xconfigure.height;
  	xd->resize = 1;
      }
+     else if (event.type == DestroyNotify) {
+         /* The window is being destroyed, kill the device, too. */
+         XFindContext(display, event.xdestroywindow.window,
+                      devPtrContext, &temp);
+         dd = (DevDesc *) temp;
+         xd = (x11Desc *) dd->deviceSpecific;
+         if (!xd->inclose) {
+             xd->inclose = TRUE;
+             KillDevice(dd);
+         }
+     }
      else if ((event.type == ClientMessage) &&
! 	     (event.xclient.message_type == _XA_WM_PROTOCOLS)) {
! 	if (event.xclient.data.l[0] == protocol) {
!             XFindContext(display, event.xclient.window,
  			 devPtrContext, &temp);
  	    dd = (DevDesc *) temp;
! 	    xd = (x11Desc *) dd->deviceSpecific;
! 	    if (!xd->inclose) {
! 		/* Dispatch destroy only once */
! 		xd->inclose = TRUE;
! 		XDestroyWindow(display, xd->window);
! 		XSync (display, 0);
! 		KillDevice(dd);
! 	    }
  	}
+     }
+ 
  }
  
  static void R_ProcessEvents(void *data)
***************
*** 1208,1213 ****
--- 1228,1234 ----
  		     ExposureMask | ButtonPressMask | StructureNotifyMask);
  	XMapWindow(display, xd->window);
  	XSync(display, 0);
+         xd->inclose = FALSE;
  
  	/* Gobble expose events */
  
***************
*** 1464,1476 ****
      x11Desc *xd = (x11Desc *) dd->deviceSpecific;
  
      if (xd->type == WINDOW) {
! 	/* process pending events */
! 	/* set block on destroy events */
! 	inclose = TRUE;
  	R_ProcessEvents((void*) NULL);
  
  	XFreeCursor(display, xd->gcursor);
- 	XDestroyWindow(display, xd->window);
  	XSync(display, 0);
      } else {
  	if (xd->npages && xd->type != XIMAGE) {
--- 1485,1506 ----
      x11Desc *xd = (x11Desc *) dd->deviceSpecific;
  
      if (xd->type == WINDOW) {
! 	/* There are three reasons to be here: */
! 	/* 1) The user clicked on a button in the window frame */
! 	/*    and we received a DELETE_WINDOW from the wm, */
! 	/* 2) Somebody destroyed our window directly, or if */
! 	/*    embedded, the parent is being destroyed, and so */
! 	/*    we got a DestroyNotify event, too, */
! 	/* 3) The user used dev.off() to get rid of us. Bye. */
! 
! 	if (!xd->inclose) {
! 	    xd->inclose = TRUE;
! 	    XDestroyWindow(display, xd->window);
! 	}
! 	/* process pending events (esp. reap events for this window) */
  	R_ProcessEvents((void*) NULL);
  
  	XFreeCursor(display, xd->gcursor);
  	XSync(display, 0);
      } else {
  	if (xd->npages && xd->type != XIMAGE) {
***************
*** 1517,1523 ****
      }
  
      free(xd);
!     inclose = FALSE;
  }
  
  	/********************************************************/
--- 1547,1553 ----
      }
  
      free(xd);
!     dd->deviceSpecific = NULL;
  }
  
  	/********************************************************/
***************
*** 1858,1866 ****
  		else
  		    done = 2;
  	    }
! 	}
! 	else
  	    handleEvent(event);
      }
      /* if it was a Button1 succeed, otherwise fail */
      return (done == 1);
--- 1888,1901 ----
  		else
  		    done = 2;
  	    }
! 	} else {
  	    handleEvent(event);
+ 	    if (!dd->deviceSpecific) {
+ 		/* Allow new active window to redraw */
+ 		R_ProcessEvents((void*)NULL);
+ 		error ("Device closed while waiting for input.\n");
+ 	    }
+         }
      }
      /* if it was a Button1 succeed, otherwise fail */
      return (done == 1);
--------------------------------------------------




--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = Under development (unstable)
 major = 1
 minor = 3.0
 year = 2001
 month = 02
 day = 12
 language = R

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base


-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


==> 848.followup.1 <==
From pd@biostat.ku.dk  Wed Feb 14 01:10:35 2001
Received: from biostat.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id BAA10968;
	Wed, 14 Feb 2001 01:10:34 +0100 (MET)
Received: (from pd@localhost)
	by biostat.ku.dk (8.9.3/8.9.3) id BAA02066;
	Wed, 14 Feb 2001 01:11:56 +0100
Sender: pd@blueberry.kubism.ku.dk
To: tov@ece.cmu.edu
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] X11 device doesn't handle destroy events correcly (PR#848)
References: <200102132240.XAA10562@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@pubhealth.ku.dk>
Date: 14 Feb 2001 01:11:56 +0100
In-Reply-To: tov@ece.cmu.edu's message of "Tue, 13 Feb 2001 23:40:37 +0100 (MET)"
Message-ID: <x2elx2yvg3.fsf@blueberry.kubism.ku.dk>
Lines: 25
X-Mailer: Gnus v5.7/Emacs 20.7
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

tov@ece.cmu.edu writes:


> Blissfully!  *No KillDevice is called* when the window is destroyed by
> something other than the WM_DELETE_WINDOW mechanism!  This happens
> when you embed the X11 device into another window/application.  For
> starters, the device no longer receives WM_DELETE_WINDOW client
> messages.  But it does receive a DestroyNotify event when the parent
> (the container window) is destroyed.  HandleEvent should, well
> _handle_ this _event_.

Heh. Quite probably, this is also the source of the FVWM trouble
reported earlier although that triggered an infinite loop which should
probably be guarded against by other means as well. 

Thanks for filing this (good to have as bug report so that we don't
forget - it's the sort of thing that often has to wait until someone
has a clear enough mind and sufficient stamina to try and get it
right.)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 848.audit <==
Sat Feb 17 11:44:41 2001	ripley	moved from incoming to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1020 *
Subject: .Call and Mandrake 8.0
From: lcottret@yahoo.fr
Date: Wed, 11 Jul 2001 15:34:23 +0200 (MET DST)
--problem with symbol names only on Mandrake 8.0, not 7.2
--needs reply to follow-up
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1020 <==
From lcottret@yahoo.fr  Wed Jul 11 15:34:24 2001
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id PAA16374
	for <R-bugs@biostat.ku.dk>; Wed, 11 Jul 2001 15:34:23 +0200 (MET DST)
Date: Wed, 11 Jul 2001 15:34:23 +0200 (MET DST)
From: lcottret@yahoo.fr
Message-Id: <200107111334.PAA16374@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: .Call and Mandrake 8.0

Full_Name: Ludovic Cottret
Version: R 1.3.0
OS: Linux
Submission from: (NULL) (157.136.20.138)


I have a R function which call a C function by the instruction ".Call".
The first time I call the R function in a R session, it perfectly runs. But the
next 
times, R returns this error message :

Error in .Call("", bankpath, accn, indexpath, key, beg, end) :
        .Call function name not in load table

The function name has disappeared !!
This function well runs on Mandrake 7.2 but not in Mandrake 8.0. Why ?!?

Thanks for your answers...
PS : Excuse my poor english...




==> 1020.followup.1 <==
From duncan@jessie.research.bell-labs.com  Wed Jul 11 16:15:16 2001
Received: from crufty.research.bell-labs.com (crufty.research.bell-labs.com [204.178.16.49])
	by pubhealth.ku.dk (8.9.3/8.9.1) with SMTP id QAA16686
	for <R-bugs@biostat.ku.dk>; Wed, 11 Jul 2001 16:15:15 +0200 (MET DST)
Received: from scummy.research.bell-labs.com ([135.104.2.10]) by crufty; Wed Jul 11 10:10:04 EDT 2001
Received: from jessie.research.bell-labs.com ([135.104.13.5]) by scummy; Wed Jul 11 10:13:33 EDT 2001
Received: (from duncan@localhost)
	by jessie.research.bell-labs.com (8.9.1/8.9.1) id KAA02731;
	Wed, 11 Jul 2001 10:13:07 -0400 (EDT)
Date: Wed, 11 Jul 2001 10:13:07 -0400
From: Duncan Temple Lang <duncan@research.bell-labs.com>
To: lcottret@yahoo.fr
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] .Call and Mandrake 8.0 (PR#1020)
Message-ID: <20010711101307.E24919@jessie.research.bell-labs.com>
Mail-Followup-To: lcottret@yahoo.fr, r-devel@stat.math.ethz.ch,
	R-bugs@biostat.ku.dk
References: <200107111334.PAA16384@pubhealth.ku.dk>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Mailer: Mutt 1.0us
In-Reply-To: <200107111334.PAA16384@pubhealth.ku.dk>; from lcottret@yahoo.fr on Wed, Jul 11, 2001 at 03:34:25PM +0200

Hi Ludovic.

 There are at least two possible explanations for this behaviour.

  1)  There is a bug in the recently changed code in R to find 
     routines in C and Fortran libraries.

  2)  The routine that you are .Call()'ing is doing something
  that has confused the R internals and makes the next R commands
  not work, and potentially this is not reproducible.

If this is not proprietary or confidential code, you can send the C
code and instructions as to how to call it from R (that is, provide
simple values for the bankpath, accn, indexpath, key, beg and end
arguments), then I can see if the computations are potentially
writing over other values in memory.

Also, you can try a invoking a very simple .Call() routine 
many times to see if that displays the same failure. For example,
put the following C code in a file named simpleCall.c

#include "Rinternals.h"

SEXP
simpleCall() 
{
  static int count = 0;
  SEXP ans;

  PROTECT(ans = allocVector(INTSXP, 1));
  INTEGER(ans)[0] = count++;

  UNPROTECT(1);
  return(ans);
}

Then, compile this with 
  R CMD SHLIB simpleCall.c

and call it from R in the following way

 > dyn.load("simpleCall.so")
 > for(i in 1:10) { print(.Call("simpleCall")) }

If this works, it won't determine whether it is 1) or 2) (or any other
possible reason), but if it doesn't work, we will have a lot more
information.

 Thanks,
   Duncan


lcottret@yahoo.fr wrote:
> Full_Name: Ludovic Cottret
> Version: R 1.3.0
> OS: Linux
> Submission from: (NULL) (157.136.20.138)
> 
> 
> I have a R function which call a C function by the instruction ".Call".
> The first time I call the R function in a R session, it perfectly runs. But the
> next 
> times, R returns this error message :
> 
> Error in .Call("", bankpath, accn, indexpath, key, beg, end) :
>         .Call function name not in load table
> 
> The function name has disappeared !!
> This function well runs on Mandrake 7.2 but not in Mandrake 8.0. Why ?!?
> 
> Thanks for your answers...
> PS : Excuse my poor english...
> 
> 
> 
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-- 
_______________________________________________________________

Duncan Temple Lang                duncan@research.bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-3217
700 Mountain Avenue, Room 2C-259  fax:    (908)582-3340
Murray Hill, NJ  07974-2070       
         http://cm.bell-labs.com/stat/duncan

==> 1020.audit <==
Fri Aug  3 11:33:04 2001	ripley	changed notes
Fri Aug  3 11:33:04 2001	ripley	foobar
Fri Aug  3 11:33:04 2001	ripley	moved from incoming to System-specific
Tue Aug  7 08:37:20 2001	ripley	changed notes
Tue Aug  7 08:37:20 2001	ripley	foobar

==> 1020.followup.2 <==
From mikalzet@libero.it  Fri Dec  7 12:44:05 2001
Received: from smtp3.libero.it (smtp3.libero.it [193.70.192.53])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id MAA07110
	for <r-bugs@biostat.ku.dk>; Fri, 7 Dec 2001 12:44:04 +0100 (MET)
From: mikalzet@libero.it
Received: from localhost.localdomain (151.25.109.136) by smtp3.libero.it (6.0.032)
        id 3BD43E2500FA2042 for r-bugs@biostat.ku.dk; Fri, 7 Dec 2001 12:43:26 +0100
Received: from localhost.localdomain (localhost.localdomain [127.0.0.1])
	by localhost.localdomain (Postfix) with ESMTP id 477AB1D9C
	for <r-bugs@biostat.ku.dk>; Fri,  7 Dec 2001 12:43:25 +0100 (CET)
Date: Fri, 7 Dec 2001 12:43:25 +0100 (CET)
X-X-Sender:  <mike@localhost.localdomain>
To: <r-bugs@biostat.ku.dk>
Subject: bug PR#1020
Message-ID: <Pine.LNX.4.33L2.0112071238100.3318-100000@localhost.localdomain>
Return-Receipt-To: mikalzet@libero.it
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


Found it on the site.
I tried duncan's suggestion.

#include "Rinternals.h"

SEXP
simpleCall()
{
  static int count = 0;
  SEXP ans;

  PROTECT(ans = allocVector(INTSXP, 1));
  INTEGER(ans)[0] = count++;

  UNPROTECT(1);
  return(ans);
}


If I had read this before I could have checked on mandrake 8.0

Here is my output on mandrake 8.1:

> dyn.load("simpleCall.so")
> for(i in 1:10) { print(.Call("simpleCall")) }

[1] 0
[1] 1
[1] 2
[1] 3
[1] 4
[1] 5
[1] 6
[1] 7
[1] 8
[1] 9

for(i in 1:10) { print(.Call("simpleCall")) }

[1] 10
[1] 11
[1] 12
[1] 13
[1] 14
[1] 15
[1] 16
[1] 17
[1] 18
[1] 19

> for(i in 1:10) { print(.Call("simpleCall")) }

[1] 20
[1] 21
[1] 22
[1] 23
[1] 24
[1] 25
[1] 26
[1] 27
[1] 28
[1] 29

Seems ok ?

-- 
Michele Alzetta

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1097 *
Subject: R 1.3.1 fails 'make check' on arm in the Bessel example
From: Dirk Eddelbuettel <edd@debian.org>
Date: Thu, 20 Sep 2001 23:54:19 -0500
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1097 <==
From postmaster@franz.stat.wisc.edu  Fri Sep 21 06:54:31 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id GAA13162
	for <r-bugs@biostat.ku.dk>; Fri, 21 Sep 2001 06:54:30 +0200 (MET DST)
Received: from sonny.eddelbuettel.com (really [64.195.36.229]) by franz.stat.wisc.edu
	via smail with esmtp (ident mail using rfc1413)
	id <m15kIKZ-000JJ6C@franz.stat.wisc.edu> (Debian Smail3.2.0.111)
	for <r-bugs@r-project.org>; Thu, 20 Sep 2001 23:54:27 -0500 (CDT) 
Received: from edd by sonny.eddelbuettel.com with local (Exim 3.32 #1 (Debian))
	id 15kIKS-0005EK-00
	for <r-bugs@r-project.org>; Thu, 20 Sep 2001 23:54:20 -0500
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-ID: <15274.51195.688109.743960@sonny.eddelbuettel.com>
Date: Thu, 20 Sep 2001 23:54:19 -0500
To: r-bugs@r-project.org
Subject: R 1.3.1 fails 'make check' on arm in the Bessel example
X-Mailer: VM 6.92 under 21.4 (patch 1) "Copyleft" XEmacs Lucid
From: Dirk Eddelbuettel <edd@debian.org>


Debian tries to build its packages on a variety of platforms.  The arm
platform compiled 0.90.1 (the last Debian release before the Debian package
required an Atlas library, something we no longer require) failed in 'make
check'. The log snippet follows; I traced this to the example(Bessel) code.
 
> matplot(nu, t(outer(xx,nu, besselI)), type = 'l', ylim = c(-50,200),
+         main = expression(paste("Bessel ",I[nu](x)," for fixed ", x,
+                                 ",  as ",f(nu))),
+         xlab = expression(nu))
Error in title(main = main, sub = sub, xlab = xlab, ylab = ylab, ...) :
        Metric information not yet available for this device
        In addition: Warning messages:
        1: Nonfinite axis limits [GScale(nan,nan,1, .); log=0]
        2: relative range of values = 9.0072e+15 * EPS, is small (axis 1).
        3: Nonfinite axis limits [GScale(-inf,inf,2, .); log=0]
        4: relative range of values = 9.0072e+15 * EPS, is small (axis 2).
        Execution halted

Casual inspection suggests that GScale(nan,nan,1, .) is probably
incorrect. Now, src/nmath/bessel* provide the Bessel functions but does this
reflect a potential libc bug in IEEE handling?

I have also asked on the debian-arm mailing list, but no result so far. I
have some access to an arm box and could compile small test cases if that
helped. 

Dirk 
 
--please do not edit the information below--
 
Version:
 platform = i386-pc-linux-gnu
 arch = i386
 os = linux-gnu
 system = i386, linux-gnu
 status =
 major = 1
 minor = 3.1
 year = 2001
 month = 08
 day = 31
 language = R
 
Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base


-- 
Better to have an approximate answer to the right question 
than a precise answer to the wrong question. -- John Tukey

==> 1097.audit <==
Fri Sep 21 07:46:37 2001	ripley	moved from incoming to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1140 *
Subject: Possible bug, Rprof() and scan(pipe())
From: Don MacQueen <macq@llnl.gov>
Date: Tue, 23 Oct 2001 13:50:26 -0700
--Doesn't happen on Solaris or Linux
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1140 <==
From macq@llnl.gov  Tue Oct 23 22:51:03 2001
Received: from smtp-2.llnl.gov (smtp-2.llnl.gov [128.115.250.82])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA27064
	for <r-bugs@biostat.ku.dk>; Tue, 23 Oct 2001 22:51:02 +0200 (MET DST)
Received: from [128.115.153.6] (localhost [127.0.0.1])
	by smtp-2.llnl.gov (8.9.3/8.9.3/LLNL-gateway-1.0) with ESMTP id NAA16321
	for <r-bugs@biostat.ku.dk>; Tue, 23 Oct 2001 13:50:23 -0700 (PDT)
Mime-Version: 1.0
X-Sender: e556558@popgun.llnl.gov
Message-Id: <p05101015b7fb820c1d22@[128.115.153.6]>
Date: Tue, 23 Oct 2001 13:50:26 -0700
To: r-bugs@biostat.ku.dk
From: Don MacQueen <macq@llnl.gov>
Subject: Possible bug, Rprof() and scan(pipe())
Content-Type: text/plain; charset="us-ascii" ; format="flowed"

This looks like a bug?
Unable to use scan(pipe()) while profiling.
I have no idea whether this version of R violates the
    "do not use `Rprof' in an executable built for profiling"
warning in ?Rprof.

Thanks
-Don

>  version
          _
platform powerpc-apple-darwin1.4
arch     powerpc
os       darwin1.4
system   powerpc, darwin1.4
status   Patched
major    1
minor    3.1
year     2001
month    10
day      15
language R
>
>  foo <- scan(pipe('ls -1 | head -3'),what='')
Read 3 items
>  foo
[1] "README"      "RMfiles.dat" "RMfiles.tmp"
>  Rprof()
>  foo <- scan(pipe('ls -1 | head -3'),what='')
Read 0 items
>  foo
character(0)
>  Rprof(NULL)
>  foo <- scan(pipe('ls -1 | head -3'),what='')
Read 3 items
>

note, profiling does appear to be functional:
>  Rprof() ; hist(rnorm(10000)) ; Rprof(NULL)
>  system('R CMD Rprof Rprof.out')

Each sample represents 0.02 seconds.
Total run time: 0.1 seconds.

Total seconds: time spent in function and callees.
Self seconds: time spent in function alone.

    %       total       %       self
  total    seconds     self    seconds    name
100.00      0.10      0.00      0.00     "hist"
  60.00      0.06      0.00      0.00     "hist.default"
  40.00      0.04     40.00      0.04     "rnorm"
  40.00      0.04      0.00      0.00     "plot"
  40.00      0.04      0.00      0.00     "plot.histogram"
  20.00      0.02      0.00      0.00     "storage.mode<-"
  20.00      0.02     20.00      0.02     "X11"
  20.00      0.02      0.00      0.00     "paste"
  20.00      0.02      0.00      0.00     "rect"
  20.00      0.02      0.00      0.00     "plot.new"
  20.00      0.02     20.00      0.02     "seq.default"
  20.00      0.02      0.00      0.00     "seq"
  20.00      0.02     20.00      0.02     "par"

    %       self        %       total
  self     seconds    total    seconds    name
  40.00      0.04     40.00      0.04     "rnorm"
  20.00      0.02     20.00      0.02     "X11"
  20.00      0.02     20.00      0.02     "seq.default"
  20.00      0.02     20.00      0.02     "par"

-- 
--------------------------------------
Don MacQueen
Environmental Protection Department
Lawrence Livermore National Laboratory
Livermore, CA, USA
--------------------------------------

==> 1140.audit <==
Sun Nov  4 13:54:41 2001	ripley	changed notes
Sun Nov  4 13:54:41 2001	ripley	foobar
Sun Nov  4 13:54:41 2001	ripley	moved from incoming to System-specific

==> 1140.followup.1 <==
From ripley@stats.ox.ac.uk  Sun Nov  4 14:01:05 2001
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id OAA21765
	for <R-bugs@biostat.ku.dk>; Sun, 4 Nov 2001 14:01:05 +0100 (MET)
Received: from gannet.stats (IDENT:root@gannet.stats [163.1.20.127])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id NAA06732;
	Sun, 4 Nov 2001 13:01:00 GMT
Received: from localhost (ripley@localhost)
	by gannet.stats (8.11.3/8.11.3) with ESMTP id fA4D0xv19084;
	Sun, 4 Nov 2001 13:00:59 GMT
X-Authentication-Warning: gannet.stats: ripley owned process doing -bs
Date: Sun, 4 Nov 2001 13:00:59 +0000 (GMT)
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
X-X-Sender:  <ripley@gannet.stats>
To: <macq@llnl.gov>
cc: <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] Possible bug, Rprof() and scan(pipe()) (PR#1140)
In-Reply-To: <200110232051.WAA27074@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.31.0111041258370.19068-100000@gannet.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

This does not happen on Solaris or Linux, so must be related to the use of
signals on darwin.

It probably means Rprof should be avoided on that platform, but the
porter (Jan de Leeuw) needs to investigate.


On Tue, 23 Oct 2001 macq@llnl.gov wrote:

> This looks like a bug?
> Unable to use scan(pipe()) while profiling.
> I have no idea whether this version of R violates the
>     "do not use `Rprof' in an executable built for profiling"
> warning in ?Rprof.
>
> Thanks
> -Don
>
> >  version
>           _
> platform powerpc-apple-darwin1.4
> arch     powerpc
> os       darwin1.4
> system   powerpc, darwin1.4
> status   Patched
> major    1
> minor    3.1
> year     2001
> month    10
> day      15
> language R
> >
> >  foo <- scan(pipe('ls -1 | head -3'),what='')
> Read 3 items
> >  foo
> [1] "README"      "RMfiles.dat" "RMfiles.tmp"
> >  Rprof()
> >  foo <- scan(pipe('ls -1 | head -3'),what='')
> Read 0 items
> >  foo
> character(0)
> >  Rprof(NULL)
> >  foo <- scan(pipe('ls -1 | head -3'),what='')
> Read 3 items
> >
>
> note, profiling does appear to be functional:
> >  Rprof() ; hist(rnorm(10000)) ; Rprof(NULL)
> >  system('R CMD Rprof Rprof.out')
>
> Each sample represents 0.02 seconds.
> Total run time: 0.1 seconds.
>
> Total seconds: time spent in function and callees.
> Self seconds: time spent in function alone.
>
>     %       total       %       self
>   total    seconds     self    seconds    name
> 100.00      0.10      0.00      0.00     "hist"
>   60.00      0.06      0.00      0.00     "hist.default"
>   40.00      0.04     40.00      0.04     "rnorm"
>   40.00      0.04      0.00      0.00     "plot"
>   40.00      0.04      0.00      0.00     "plot.histogram"
>   20.00      0.02      0.00      0.00     "storage.mode<-"
>   20.00      0.02     20.00      0.02     "X11"
>   20.00      0.02      0.00      0.00     "paste"
>   20.00      0.02      0.00      0.00     "rect"
>   20.00      0.02      0.00      0.00     "plot.new"
>   20.00      0.02     20.00      0.02     "seq.default"
>   20.00      0.02      0.00      0.00     "seq"
>   20.00      0.02     20.00      0.02     "par"
>
>     %       self        %       total
>   self     seconds    total    seconds    name
>   40.00      0.04     40.00      0.04     "rnorm"
>   20.00      0.02     20.00      0.02     "X11"
>   20.00      0.02     20.00      0.02     "seq.default"
>   20.00      0.02     20.00      0.02     "par"
>
> --
> --------------------------------------
> Don MacQueen
> Environmental Protection Department
> Lawrence Livermore National Laboratory
> Livermore, CA, USA
> --------------------------------------
>
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 1140.followup.2 <==
From luke@nokomis.stat.umn.edu  Sun Nov  4 14:18:34 2001
Received: from nokomis.stat.umn.edu (root@nokomis.stat.umn.edu [134.84.86.39])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id OAA21858
	for <R-bugs@biostat.ku.dk>; Sun, 4 Nov 2001 14:18:33 +0100 (MET)
Received: (from luke@localhost)
	by nokomis.stat.umn.edu (8.11.3/8.10.2/SuSE Linux 8.10.0-0.3) id fA4DIOU10120;
	Sun, 4 Nov 2001 07:18:24 -0600
Date: Sun, 4 Nov 2001 07:18:24 -0600
From: Luke Tierney <luke@nokomis.stat.umn.edu>
To: ripley@stats.ox.ac.uk
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Possible bug, Rprof() and scan(pipe()) (PR#1140)
Message-ID: <20011104071824.A10053@nokomis.stat.umn.edu>
References: <200111041301.OAA21775@pubhealth.ku.dk>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5i
In-Reply-To: <200111041301.OAA21775@pubhealth.ku.dk>; from ripley@stats.ox.ac.uk on Sun, Nov 04, 2001 at 02:01:10PM +0100

This feels like a system call restarting issue.  Some OS's restart
system calls after signals, others do not. For those that don't, low
level reads need to check for EINTR and such.  Connections use high
level reads, which should be insulated by the stdio library.  Possibly
dawrin's gets this wrong.  If strace is available you might be able to
tell that way.

luke

On Sun, Nov 04, 2001 at 02:01:10PM +0100, ripley@stats.ox.ac.uk wrote:
> This does not happen on Solaris or Linux, so must be related to the use of
> signals on darwin.
> 
> It probably means Rprof should be avoided on that platform, but the
> porter (Jan de Leeuw) needs to investigate.
> 
> 
> On Tue, 23 Oct 2001 macq@llnl.gov wrote:
> 
> > This looks like a bug?
> > Unable to use scan(pipe()) while profiling.
> > I have no idea whether this version of R violates the
> >     "do not use `Rprof' in an executable built for profiling"
> > warning in ?Rprof.
> >
> > Thanks
> > -Don
> >
> > >  version
> >           _
> > platform powerpc-apple-darwin1.4
> > arch     powerpc
> > os       darwin1.4
> > system   powerpc, darwin1.4
> > status   Patched
> > major    1
> > minor    3.1
> > year     2001
> > month    10
> > day      15
> > language R
> > >
> > >  foo <- scan(pipe('ls -1 | head -3'),what='')
> > Read 3 items
> > >  foo
> > [1] "README"      "RMfiles.dat" "RMfiles.tmp"
> > >  Rprof()
> > >  foo <- scan(pipe('ls -1 | head -3'),what='')
> > Read 0 items
> > >  foo
> > character(0)
> > >  Rprof(NULL)
> > >  foo <- scan(pipe('ls -1 | head -3'),what='')
> > Read 3 items
> > >
> >
> > note, profiling does appear to be functional:
> > >  Rprof() ; hist(rnorm(10000)) ; Rprof(NULL)
> > >  system('R CMD Rprof Rprof.out')
> >
> > Each sample represents 0.02 seconds.
> > Total run time: 0.1 seconds.
> >
> > Total seconds: time spent in function and callees.
> > Self seconds: time spent in function alone.
> >
> >     %       total       %       self
> >   total    seconds     self    seconds    name
> > 100.00      0.10      0.00      0.00     "hist"
> >   60.00      0.06      0.00      0.00     "hist.default"
> >   40.00      0.04     40.00      0.04     "rnorm"
> >   40.00      0.04      0.00      0.00     "plot"
> >   40.00      0.04      0.00      0.00     "plot.histogram"
> >   20.00      0.02      0.00      0.00     "storage.mode<-"
> >   20.00      0.02     20.00      0.02     "X11"
> >   20.00      0.02      0.00      0.00     "paste"
> >   20.00      0.02      0.00      0.00     "rect"
> >   20.00      0.02      0.00      0.00     "plot.new"
> >   20.00      0.02     20.00      0.02     "seq.default"
> >   20.00      0.02      0.00      0.00     "seq"
> >   20.00      0.02     20.00      0.02     "par"
> >
> >     %       self        %       total
> >   self     seconds    total    seconds    name
> >   40.00      0.04     40.00      0.04     "rnorm"
> >   20.00      0.02     20.00      0.02     "X11"
> >   20.00      0.02     20.00      0.02     "seq.default"
> >   20.00      0.02     20.00      0.02     "par"
> >
> > --
> > --------------------------------------
> > Don MacQueen
> > Environmental Protection Department
> > Lawrence Livermore National Laboratory
> > Livermore, CA, USA
> > --------------------------------------
> >
> > -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> > r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> > Send "info", "help", or "[un]subscribe"
> > (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> > _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
> >
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
313 Ford Hall, 224 Church St. S.E.           email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu

==> 1140.followup.3 <==
From macq@llnl.gov  Mon Nov  5 18:47:53 2001
Received: from smtp-1.llnl.gov (smtp-1.llnl.gov [128.115.250.81])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA05624
	for <R-bugs@biostat.ku.dk>; Mon, 5 Nov 2001 18:47:52 +0100 (MET)
Received: from [128.115.153.6] (localhost [127.0.0.1])
	by smtp-1.llnl.gov (8.9.3/8.9.3/LLNL-gateway-1.0) with ESMTP id JAA05930;
	Mon, 5 Nov 2001 09:46:15 -0800 (PST)
Mime-Version: 1.0
X-Sender: e556558@popgun.llnl.gov
Message-Id: <p0510100bb80c7eff076c@[128.115.153.6]>
In-Reply-To: <Pine.LNX.4.31.0111041258370.19068-100000@gannet.stats>
References: <Pine.LNX.4.31.0111041258370.19068-100000@gannet.stats>
Date: Mon, 5 Nov 2001 09:46:10 -0800
To: Jan de Leeuw <deleeuw@stat.ucla.edu>
From: Don MacQueen <macq@llnl.gov>
Subject: Re: [Rd] Possible bug, Rprof() and scan(pipe()) (PR#1140)
Cc: Prof Brian Ripley <ripley@stats.ox.ac.uk>, <R-bugs@biostat.ku.dk>
Content-Type: text/plain; charset="us-ascii" ; format="flowed"

Jan,
Here is information on the problem with Rprof() that I encountered, 
including Brian Ripley's assessment.
This is OS X 10.1 with the 10.1 developer tools installed.
-Don

At 1:00 PM +0000 11/4/01, Prof Brian Ripley wrote:
>This does not happen on Solaris or Linux, so must be related to the use of
>signals on darwin.
>
>It probably means Rprof should be avoided on that platform, but the
>porter (Jan de Leeuw) needs to investigate.
>
>
>On Tue, 23 Oct 2001 macq@llnl.gov wrote:
>
>>  This looks like a bug?
>>  Unable to use scan(pipe()) while profiling.
>>  I have no idea whether this version of R violates the
>>      "do not use `Rprof' in an executable built for profiling"
>>  warning in ?Rprof.
>>
>>  Thanks
>>  -Don
>>
>>  >  version
>>            _
>>  platform powerpc-apple-darwin1.4
>>  arch     powerpc
>>  os       darwin1.4
>>  system   powerpc, darwin1.4
>>  status   Patched
>>  major    1
>>  minor    3.1
>>  year     2001
>>  month    10
>>  day      15
>>  language R
>>  >
>  > >  foo <- scan(pipe('ls -1 | head -3'),what='')
>>  Read 3 items
>>  >  foo
>>  [1] "README"      "RMfiles.dat" "RMfiles.tmp"
>>  >  Rprof()
>>  >  foo <- scan(pipe('ls -1 | head -3'),what='')
>>  Read 0 items
>>  >  foo
>>  character(0)
>>  >  Rprof(NULL)
>  > >  foo <- scan(pipe('ls -1 | head -3'),what='')
>>  Read 3 items
>>  >
>>
>>  note, profiling does appear to be functional:
>>  >  Rprof() ; hist(rnorm(10000)) ; Rprof(NULL)
>>  >  system('R CMD Rprof Rprof.out')
>  >
>>  Each sample represents 0.02 seconds.
>>  Total run time: 0.1 seconds.
>>
>>  Total seconds: time spent in function and callees.
>>  Self seconds: time spent in function alone.
>>
>>      %       total       %       self
>>    total    seconds     self    seconds    name
>>  100.00      0.10      0.00      0.00     "hist"
>>    60.00      0.06      0.00      0.00     "hist.default"
>>    40.00      0.04     40.00      0.04     "rnorm"
>>    40.00      0.04      0.00      0.00     "plot"
>>    40.00      0.04      0.00      0.00     "plot.histogram"
>>    20.00      0.02      0.00      0.00     "storage.mode<-"
>>    20.00      0.02     20.00      0.02     "X11"
>>    20.00      0.02      0.00      0.00     "paste"
>>    20.00      0.02      0.00      0.00     "rect"
>>    20.00      0.02      0.00      0.00     "plot.new"
>>    20.00      0.02     20.00      0.02     "seq.default"
>>    20.00      0.02      0.00      0.00     "seq"
>>    20.00      0.02     20.00      0.02     "par"
>>
>>      %       self        %       total
>>    self     seconds    total    seconds    name
>>    40.00      0.04     40.00      0.04     "rnorm"
>>    20.00      0.02     20.00      0.02     "X11"
>>    20.00      0.02     20.00      0.02     "seq.default"
>>    20.00      0.02     20.00      0.02     "par"
>>
>>  --
>>  --------------------------------------
>>  Don MacQueen
>>  Environmental Protection Department
>>  Lawrence Livermore National Laboratory
>>  Livermore, CA, USA
>>  --------------------------------------
>>
>> 
>>-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
>>  r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
>>  Send "info", "help", or "[un]subscribe"
>>  (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
>> 
>>_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
>>
>
>--
>Brian D. Ripley,                  ripley@stats.ox.ac.uk
>Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>University of Oxford,             Tel:  +44 1865 272861 (self)
>1 South Parks Road,                     +44 1865 272860 (secr)
>Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-- 
--------------------------------------
Don MacQueen
Environmental Protection Department
Lawrence Livermore National Laboratory
Livermore, CA, USA
--------------------------------------
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1145 *
Subject: Problem testing R version 1.3.1 on SGI Irix
From: Gordon Lack <gml4410@ggr.co.uk>
Date: Fri, 26 Oct 2001 19:04:04 +0100
--error from using SGI libblas (not reported on other systems?)
--use --without-blas
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1145 <==
From postmaster@franz.stat.wisc.edu  Fri Oct 26 20:05:08 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA03262
	for <r-bugs@biostat.ku.dk>; Fri, 26 Oct 2001 20:05:07 +0200 (MET DST)
Received: from gate.ggr.co.uk (really [193.128.25.10]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15xBLs-000JIvC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Fri, 26 Oct 2001 13:05:04 -0500 (CDT) 
Received: (uucp@localhost) by gate.ggr.co.uk; Fri, 26 Oct 2001 19:06:07 +0100 (BST)
Received: from uk-stv-mhub1.ggr.co.uk(147.184.212.132) by gb-stv-fw2.ggr.co.uk via smap (V5.5)
	id xma019101; Fri, 26 Oct 01 19:05:11 +0100
Received: from ukwit01.ggr.co.uk (root@ukwit01.ggr.co.uk [147.184.219.175]) by mailhub.ggr.co.uk; Fri, 26 Oct 2001 19:04:07 +0100 (BST)
Received: from ggr.co.uk by ukwit01.ggr.co.uk (8.8.8/imd160294)
        id SAA126689; Fri, 26 Oct 2001 18:04:05 GMT
Sender: gml4410@ggr.co.uk
Message-ID: <3BD9A594.82824E30@ggr.co.uk>
Date: Fri, 26 Oct 2001 19:04:04 +0100
From: Gordon Lack <gml4410@ggr.co.uk>
Organization: Glaxo Wellcome
X-Mailer: Mozilla 4.78 [en] (X11; U; IRIX 6.5 IP32)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs@r-project.org
Subject: Problem testing R version 1.3.1 on SGI Irix
References: <3BD9845D.6010512F@ggr.co.uk>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

   I've compiled R verison 1.3.1 on SGI Irix 6.5

   It fails its check when running the ts-Ex.Rout test with:

=====
> 
> data(BJsales)
> ar(ts.union(BJsales, BJsales.lead))
Error in ar.yw.mts(x, aic = aic, order.max = order.max, na.action =
na.action,  : 
        On entry to DGEMM  parameter number 1 had an illegal value
Execution halted
=====

   It was compiled with gcc 2.95.2 (and the g77 which came with that,
which is 0.5.25).

==> 1145.followup.1 <==
From postmaster@franz.stat.wisc.edu  Thu Nov  1 18:30:36 2001
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA02302
	for <r-bugs@biostat.ku.dk>; Thu, 1 Nov 2001 18:30:36 +0100 (MET)
Received: from gate.ggr.co.uk (really [193.128.25.10]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m15zLfj-000JLMC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Thu, 1 Nov 2001 11:30:31 -0600 (CST) 
Received: (uucp@localhost) by gate.ggr.co.uk; Thu, 1 Nov 2001 17:31:24 GMT
Received: from uk-stv-mhub1.ggr.co.uk(147.184.212.132) by gb-stv-fw2.ggr.co.uk via smap (V5.5)
	id xma019221; Thu, 1 Nov 01 17:30:51 GMT
Received: from ukwit01.ggr.co.uk (root@ukwit01.ggr.co.uk [147.184.219.175]) by mailhub.ggr.co.uk; Thu, 1 Nov 2001 17:29:46 GMT
Received: from ggr.co.uk by ukwit01.ggr.co.uk (8.8.8/imd160294)
        id RAA163227; Thu, 1 Nov 2001 17:29:45 GMT
Sender: gml4410@ggr.co.uk
Message-ID: <3BE18689.D81206DA@ggr.co.uk>
Date: Thu, 01 Nov 2001 17:29:45 +0000
From: Gordon Lack <gml4410@ggr.co.uk>
Organization: Glaxo Wellcome
X-Mailer: Mozilla 4.78 [en] (X11; U; IRIX 6.5 IP32)
X-Accept-Language: en
MIME-Version: 1.0
To: r-bugs@r-project.org
Subject: Update on report PR#1145 (with a cross-reference to PR#1026).
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

   The original report was that compiling with gcc2.95.2 gcc and the
related g77 on Irix 6.,5.13 produced an R which wailed its tests with:

>> On entry to DGEMM  parameter number 1 had an illegal value

   To some extend this confused me, as the source only seems to mention
DGEMM in lowercase.  Eventually, after the debug code I added did
nothing, I realized that the R which was build was not using the
src/appl/blas.f source file: it was using the SGI libblas.

   My suspicion is that this is the cause.  The man page for this
mentions there is a C interface for dgemm but that it uses an enumerated
variable for the first 2 parameters in place of character strings.  I
thing things got mixed up somewhere along the line (perhaps with the
number of "_" appended to external symbils?).

   So, I tried configuring while adding "--without-blas" to the config  
options. This resulted in a SIGSEGV in the modreg test.  (See bug report
PR#1026, which also mentions this).

   So, a further try, this time using the compilers, cc anf f77 while  
still specifying "--without-blas" (so that the SGI libblas is ignored).

   This ran through the tests without crashing.  There were a few minor
differences in the print-tests output, but all at the "0 vs.  10**-300"
level, ie: floating point inaccuracies (which I presume are Ok and any
good statistician will ignore?).

==========
comparing `print-tests.Rout' to `./print-tests.Rout.save'
...259c259
< [1]  0.000000e+00 2.225074e-308 2.225074e-308 2.227299e-308
2.447581e-308
---
> [1] 2.002566e-308 2.222849e-308 2.225074e-308 2.225074e-308 2.225074e-308 2.2$
==========

   and 16 occurrences of:

==========
^H: syntax error
========== 
at the end.

==> 1145.audit <==
Wed Oct 31 11:35:29 2001	maechler	foobar
Wed Oct 31 11:35:29 2001	maechler	moved from incoming to System-specific
Tue Dec 11 13:22:24 2001	ripley	changed notes
Tue Dec 11 13:22:24 2001	ripley	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1261 *
Subject: R_140 AND RHL_72 AND Packages
From: Patrick Gonin <gonin@genethon.fr>
Date: Wed, 15 Jan 2003 13:25:17 +0100
--Seems to relate to RH7.2 rpms
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1261 <==
From gonin@genethon.fr  Tue Jan 15 13:25:52 2002
Received: from sansgene.genethon.fr (root@sansgene.genethon.fr [193.50.68.15])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id NAA28694
	for <r-bugs@biostat.ku.dk>; Tue, 15 Jan 2002 13:25:51 +0100 (MET)
Received: from [192.168.100.154] (nat0-154.genethon.fr [192.168.100.154])
	by sansgene.genethon.fr (8.11.5/8.11.5) with ESMTP id g0FCPKT28309
	for <r-bugs@biostat.ku.dk>; Tue, 15 Jan 2002 13:25:20 +0100 (MET)
Mime-Version: 1.0
X-Sender: gonin@sansgene.genethon.fr
Message-Id: <a05100300ba4b0138cb3c@[192.168.100.154]>
Date: Wed, 15 Jan 2003 13:25:17 +0100
To: r-bugs@biostat.ku.dk
From: Patrick Gonin <gonin@genethon.fr>
Subject: R_140 AND RHL_72 AND Packages
Content-Type: text/plain; charset="us-ascii" ; format="flowed"

Dear colleagues,

>I use R under RH Linux 7.2 on a i686 PIII 733 machine.

I have a problem to install packages since R 1.4.0 has been installed.

>I have determined that whenever I install whichever package, the 
>installation (CMD INSTALL command) fail at finding R files, and at 
>finding all html,and other help files.
>However, it ends up with DONE INSTALL, and when you type 
>library(XXX) under R, there is no error. But it is like loading an 
>empty nutshell: no R function available, no help page available 
>(apart from the 00Index.html file).The only functional call is 
>always library(help=search) which displays all functions and 
>datasets of the package (the INDEX file, in fact). When looking at 
>the directories of the package, you find that only one file remains, 
>all other have disappeared (while they were there after tar).

I have also tried R CMD check which runs correctly and finds all files.

>The next test I did was desinstalling R 1.4.0, and reinstalling R 
>1.3.1, which led to no correction whatsoever (while before 
>installing R 1.4.0, there were no problem at all with R 1.3.1).
>Back with R 1.4.0, I am baffled, since it is like if the first 
>installation of R 1.4.0 had changed something to my Linux box.
>Last important element: some while ago, when I installed 15 packages 
>under RH 7.2 with R 1.3.1, everything worked OK. Moreover, for 
>upgrading to RH 7.2, I realised a new installation from scratch 
>after backup of all important data.

>Maybe I should also say that I install and desinstall R-base and 
>R-recommended using rpm files with gno-rpm.
Couldn't it be a general problem with the new binaries of R 1.4.0 and RH 7.2?
Any hint welcome, of course, because I have spend many many hours to 
try to fix that.

Best regards,
-- 
----------------------------
Patrick Gonin, DVM, PhD
Head of in vivo Evaluation Dept
GENETHON III
1 bis, rue de l'Internationale
BP 60
91002 EVRY CEDEX
FRANCE
Tel: 33-1-69-47-10-21
Fax: 33-1-60-77-86-98
gonin@genethon.fr
----------------------------

==> 1261.audit <==
Fri Jan 18 09:14:36 2002	ripley	changed notes
Fri Jan 18 09:14:36 2002	ripley	foobar
Fri Jan 18 09:14:36 2002	ripley	moved from incoming to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1268 *
Subject: Solaris 2.6 Compile
From: gm81640@development.nssmb.com
Date: Thu, 17 Jan 2002 06:28:26 +0100 (MET)
--Most likely a compiler installation problem
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1268 <==
From gm81640@development.nssmb.com  Thu Jan 17 06:28:36 2002
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id GAA21618
	for <R-bugs@biostat.ku.dk>; Thu, 17 Jan 2002 06:28:26 +0100 (MET)
Date: Thu, 17 Jan 2002 06:28:26 +0100 (MET)
From: gm81640@development.nssmb.com
Message-Id: <200201170528.GAA21618@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: Solaris 2.6 Compile

Full_Name: Geordon Marchak
Version: R-1.3.1
OS: Solaris 2.6
Submission from: (NULL) (199.67.239.91)


Got the following error when compiling on Solaris 2.6 with the standard GNU
gcc package (from the Sun site).   BTW - linux compiles no problem (and fast
too :-)

# make
`Makedeps' is up to date.
gcc -I. -I../../src/include -I../../src/include -I/usr/local/include
-DHAVE_CONFIG_H   -g -O2 -c lbfgsb.c -o lbfgsb.o
/usr/ccs/bin/as: "/var/tmp/cccbNfee.s", line 12959: error: unknown opcode
".subsection"
/usr/ccs/bin/as: "/var/tmp/cccbNfee.s", line 12959: error: statement syntax
/usr/ccs/bin/as: "/var/tmp/cccbNfee.s", line 12971: error: unknown opcode
".previous"
/usr/ccs/bin/as: "/var/tmp/cccbNfee.s", line 12971: error: statement syntax
*** Error code 1
make: Fatal error: Command failed for target `lbfgsb.o'
Current working directory /home/gm81640/R-1.3.1/src/appl
*** Error code 1
make: Fatal error: Command failed for target `R'
Current working directory /home/gm81640/R-1.3.1/src/appl
*** Error code 1
make: Fatal error: Command failed for target `R'
Current working directory /home/gm81640/R-1.3.1/src
*** Error code 1
make: Fatal error: Command failed for target `R'


==> 1268.followup.1 <==
From ripley@stats.ox.ac.uk  Thu Jan 17 09:37:45 2002
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id JAA23207
	for <R-bugs@biostat.ku.dk>; Thu, 17 Jan 2002 09:37:45 +0100 (MET)
Received: from gannet.stats (IDENT:root@gannet.stats [163.1.20.127])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id IAA21901;
	Thu, 17 Jan 2002 08:37:15 GMT
Received: from localhost (ripley@localhost)
	by gannet.stats (8.11.3/8.11.3) with ESMTP id g0H8bFj02561;
	Thu, 17 Jan 2002 08:37:15 GMT
X-Authentication-Warning: gannet.stats: ripley owned process doing -bs
Date: Thu, 17 Jan 2002 08:37:15 +0000 (GMT)
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
X-X-Sender:  <ripley@gannet.stats>
To: <gm81640@development.nssmb.com>
cc: <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] Solaris 2.6 Compile (PR#1268)
In-Reply-To: <200201170528.GAA21628@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.31.0201170827260.2465-100000@gannet.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Thu, 17 Jan 2002 gm81640@development.nssmb.com wrote:

> Full_Name: Geordon Marchak
> Version: R-1.3.1
> OS: Solaris 2.6
> Submission from: (NULL) (199.67.239.91)
>
>
> Got the following error when compiling on Solaris 2.6 with the standard GNU
> gcc package (from the Sun site).   BTW - linux compiles no problem (and fast
> too :-)

You sent this twice, for some reason.

It's hard to tell what `the standard GNU gcc package (from the Sun site)'
actually is.  However, R 1.3.1 did compile under Solaris 2.6 with gcc
2.95.3 compiled under Solaris 2.6.  The error appears to be a mismatch
between your compiler and your assembler.  I don't think that qualifies as
a bug in R, and definitely is one we can do nothing about.  lbfgsb.c does
seem to be valid C that is accepted by a wide range of compilers on
Solaris and elsewhere.


> # make
> `Makedeps' is up to date.
> gcc -I. -I../../src/include -I../../src/include -I/usr/local/include
> -DHAVE_CONFIG_H   -g -O2 -c lbfgsb.c -o lbfgsb.o
> /usr/ccs/bin/as: "/var/tmp/cccbNfee.s", line 12959: error: unknown opcode
> ".subsection"
> /usr/ccs/bin/as: "/var/tmp/cccbNfee.s", line 12959: error: statement syntax
> /usr/ccs/bin/as: "/var/tmp/cccbNfee.s", line 12971: error: unknown opcode
> ".previous"
> /usr/ccs/bin/as: "/var/tmp/cccbNfee.s", line 12971: error: statement syntax
> *** Error code 1
> make: Fatal error: Command failed for target `lbfgsb.o'
> Current working directory /home/gm81640/R-1.3.1/src/appl
> *** Error code 1
> make: Fatal error: Command failed for target `R'
> Current working directory /home/gm81640/R-1.3.1/src/appl
> *** Error code 1
> make: Fatal error: Command failed for target `R'
> Current working directory /home/gm81640/R-1.3.1/src
> *** Error code 1
> make: Fatal error: Command failed for target `R'
>
>
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 1268.reply.1 <==
From p.dalgaard@biostat.ku.dk  Thu Jan 17 11:46:44 2002
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id LAA25668;
	Thu, 17 Jan 2002 11:46:44 +0100 (MET)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id g0HAjXh15735;
	Thu, 17 Jan 2002 11:45:33 +0100
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: ripley@stats.ox.ac.uk
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] Solaris 2.6 Compile (PR#1268)
References: <200201170837.JAA23228@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 17 Jan 2002 11:45:33 +0100
In-Reply-To: <200201170837.JAA23228@pubhealth.ku.dk>
Message-ID: <x2g055cl2q.fsf@blueberry.kubism.ku.dk>
Lines: 24
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

ripley@stats.ox.ac.uk writes:

> > Got the following error when compiling on Solaris 2.6 with the standard GNU
> > gcc package (from the Sun site).   BTW - linux compiles no problem (and fast
> > too :-)
> 
> You sent this twice, for some reason.
> 
> It's hard to tell what `the standard GNU gcc package (from the Sun site)'
> actually is.  However, R 1.3.1 did compile under Solaris 2.6 with gcc
> 2.95.3 compiled under Solaris 2.6.  The error appears to be a mismatch
> between your compiler and your assembler.  I don't think that qualifies as
> a bug in R, and definitely is one we can do nothing about.  lbfgsb.c does
> seem to be valid C that is accepted by a wide range of compilers on
> Solaris and elsewhere.

Assuming that the "Sun site" means www.sunfreeware.com, I seem to
recall that you get in trouble if you use gcc3 without GNU binutils.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1268.audit <==
Fri Jan 18 09:06:39 2002	ripley	changed notes
Fri Jan 18 09:06:39 2002	ripley	foobar
Fri Jan 18 09:06:39 2002	ripley	moved from incoming to System-specific

==> 1268.followup.2 <==
From geordon.marchak@nssmb.com  Mon Jan 21 09:27:58 2002
Received: from issaspam-ny01.ssmb.com (mail1.ssmb.COM [199.67.139.25])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id JAA26346
	for <R-bugs@biostat.ku.dk>; Mon, 21 Jan 2002 09:27:56 +0100 (MET)
Received: from issny6.ny.ssmb.com (issny6.ny.ssmb.com [162.124.150.21])
	by issaspam-ny01.ssmb.com (8.12.0/8.12.0/SSMB_EXT/1.4) with ESMTP id g0L8QXbE027462;
	Mon, 21 Jan 2002 03:26:50 -0500 (EST)
Received: from mailhub.nssmb.com (mailhubb.nssmb.com [169.180.188.120])
	by issny6.ny.ssmb.com (8.11.0/8.11.0/SSMB_QQQ_IN/1.1) with ESMTP id g0L8PFT01212;
	Mon, 21 Jan 2002 03:25:15 -0500 (EST)
Received: from lx22z001.nssmb.com (lx22z001.nssmb.com [169.180.162.41])
	by mailhub.nssmb.com (8.9.3/8.9.3/SSMB-HUB) with ESMTP id RAA08319;
	Mon, 21 Jan 2002 17:25:14 +0900 (JST)
Received: by lx22z001.nssmb.com (Postfix, from userid 81640)
	id 3B1E9BFE83; Mon, 21 Jan 2002 17:25:14 +0900 (JST)
Received: from localhost (localhost [127.0.0.1])
	by lx22z001.nssmb.com (Postfix) with ESMTP
	id 0A901BFE82; Mon, 21 Jan 2002 17:25:14 +0900 (JST)
Date: Mon, 21 Jan 2002 17:25:13 +0900 (JST)
From: Joe Marchak <geordon.marchak@nssmb.com>
X-X-Sender:  <gm81640@lx22z001.nssmb.com>
To: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Cc: <geordon.marchak@nssmb.com>, <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] Solaris 2.6 Compile (PR#1268)
In-Reply-To: <Pine.LNX.4.31.0201170827260.2465-100000@gannet.stats>
Message-ID: <Pine.LNX.4.33.0201211721260.8617-100000@lx22z001.nssmb.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


As you mentioned below, R 1.3.1 does compile on Solaris with gcc 2.95.  I've tried 
both Solaris 2.5.1 and Solaris 2.6 with this, and they are fine.  Moving to gcc 
3.03 however causes the problem.  

Thanks for you help earlier.

-Joe.



> Date: Thu, 17 Jan 2002 08:37:15 +0000 (GMT)
> From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
> To: geordon.marchak@nssmb.com
> Subject: Re: [Rd] Solaris 2.6 Compile (PR#1268)
> 
> On Thu, 17 Jan 2002 gm81640@development.nssmb.com wrote:
> 
> > Full_Name: Geordon Marchak
> > Version: R-1.3.1
> > OS: Solaris 2.6
> > Submission from: (NULL) (199.67.239.91)
> >
> >
> > Got the following error when compiling on Solaris 2.6 with the standard GNU
> > gcc package (from the Sun site).   BTW - linux compiles no problem (and fast
> > too :-)
> 
> You sent this twice, for some reason.
> 
> It's hard to tell what `the standard GNU gcc package (from the Sun site)'
> actually is.  However, R 1.3.1 did compile under Solaris 2.6 with gcc
> 2.95.3 compiled under Solaris 2.6.  The error appears to be a mismatch
> between your compiler and your assembler.  I don't think that qualifies as
> a bug in R, and definitely is one we can do nothing about.  lbfgsb.c does
> seem to be valid C that is accepted by a wide range of compilers on
> Solaris and elsewhere.
> 
> 
> > # make
> > `Makedeps' is up to date.
> > gcc -I. -I../../src/include -I../../src/include -I/usr/local/include
> > -DHAVE_CONFIG_H   -g -O2 -c lbfgsb.c -o lbfgsb.o
> > /usr/ccs/bin/as: "/var/tmp/cccbNfee.s", line 12959: error: unknown opcode
> > ".subsection"
> > /usr/ccs/bin/as: "/var/tmp/cccbNfee.s", line 12959: error: statement syntax
> > /usr/ccs/bin/as: "/var/tmp/cccbNfee.s", line 12971: error: unknown opcode
> > ".previous"
> > /usr/ccs/bin/as: "/var/tmp/cccbNfee.s", line 12971: error: statement syntax
> > *** Error code 1
> > make: Fatal error: Command failed for target `lbfgsb.o'
> > Current working directory /home/gm81640/R-1.3.1/src/appl
> > *** Error code 1
> > make: Fatal error: Command failed for target `R'
> > Current working directory /home/gm81640/R-1.3.1/src/appl
> > *** Error code 1
> > make: Fatal error: Command failed for target `R'
> > Current working directory /home/gm81640/R-1.3.1/src
> > *** Error code 1
> > make: Fatal error: Command failed for target `R'
> >
> >
> > -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> > r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> > Send "info", "help", or "[un]subscribe"
> > (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> > _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
> >
> 
> 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1272 *
Subject: eigen segfault with GCC 3 on Solaris
From: Paul Gilbert <pgilbert@bank-banque-canada.ca>
Date: Thu, 17 Jan 2002 15:14:33 -0500
--Seems to be a problem with g77 in gcc 3.0.2 on Solaris only.
--Probably a compiler bug
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1272 <==
From pgilbert@bank-banque-canada.ca  Thu Jan 17 21:26:12 2002
Received: from mail1.bank-banque-canada.ca (mail1.bank-banque-canada.ca [140.80.193.130])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA03042
	for <R-bugs@biostat.ku.dk>; Thu, 17 Jan 2002 21:26:11 +0100 (MET)
Received: from fwx-int (fwx-int.bank-banque-canada.ca [140.80.193.129])
	by mail1.bank-banque-canada.ca (8.9.3/8.9.3) with SMTP id PAA12351
	for <R-bugs@biostat.ku.dk>; Thu, 17 Jan 2002 15:14:51 -0500 (EST)
Received: from mfa99599.boc by mailhost.bank-banque-canada.ca (8.8.8+Sun/SMI-SVR4)
	id PAA12589; Thu, 17 Jan 2002 15:14:36 -0500 (EST)
Received: from mfa01506.boc (mfa01506 [140.80.3.112])
	by mfa99599.boc (8.9.1b+Sun/8.9.1) with ESMTP id PAA22347
	for <R-bugs@biostat.ku.dk>; Thu, 17 Jan 2002 15:14:35 -0500 (EST)
Received: from bank-banque-canada.ca (localhost [127.0.0.1])
	by mfa01506.boc (8.9.3+Sun/8.9.3) with ESMTP id PAA21692
	for <R-bugs@biostat.ku.dk>; Thu, 17 Jan 2002 15:14:33 -0500 (EST)
Sender: pgilbert@bank-banque-canada.ca
Message-ID: <3C4730A9.2F4818FA@bank-banque-canada.ca>
Date: Thu, 17 Jan 2002 15:14:33 -0500
From: Paul Gilbert <pgilbert@bank-banque-canada.ca>
X-Mailer: Mozilla 4.75 [en] (X11; U; SunOS 5.8 sun4u)
X-Accept-Language: en
MIME-Version: 1.0
To: R-bugs <R-bugs@biostat.ku.dk>
Subject: eigen segfault with GCC 3 on Solaris
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

A message this morning reminded me of a previous problem I had which should be
noted in R bugs, but is really a problem with gcc 3 I believe. It may be only a
problem on Solaris, but AFAIK has not been checked on other platforms. I
resolved it by going back to a gcc 2.9x.x (which a few people suggested). Below
is the relevant part of my original post, an example which provokes the
segfault, and some gdb information from Peter Dalgaard.

PG>I have now tested R 1.3.1 compiled with GCC 3.0.2 on Solaris and the example
I
PG>previously posted (repeated below) still gives a segmentation fault, as it
does
PG>with GCC 3.0.1 but not with 2.95.2. The eigen calculation sometimes needs to
be
PG> repeated several times before the segmentation fault occurs. La.eigen does
not
PG> cause a problem. (The problem occurred with R-devel too, but I have not
tested
PG> that with GCC 3.0.2.)

PD>I don't know if it helps, but I see it too... 3.0.1 on Solaris 2.7.
PD>
PD>gdb says that it is happening at l.2144 of eigen.f:
PD>
PD>2142    C
PD>2143                DO 760 J = M, EN
PD>2144                   RA = RA + H(I,J) * H(J,NA)
PD>2145                   SA = SA + H(I,J) * H(J,EN)
PD>2146      760       CONTINUE
PD>2147    C
PD>
PD>J prints as 7289784 for me, which looks a bit weird since M and EN are
PD>17 and 18 respectively. However, optimizers sometimes cause this sort
PD>of thing.

----- example -----


zz <- t(matrix(c(
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  0.082008166, -0.066322053,
-0.115616348,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  0.038919428,  0.009703382,
0.115944209,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.007823026, -0.068859673,
0.025264756,
1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  0.067027108,  0.087934957,
-0.316974768,
0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  0.024890008,  0.052195412,
-0.015138322,
0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  0.028192857, -0.004832597,
0.207879665,
0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  0.078706928, -0.012801413,
0.425960682,
0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  0.102169750,  0.163238356,
-0.150373125,
0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.002685166,  0.014355904,
0.197912183,
0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,  0.042937314,  0.115719388,
0.679370293,
0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,  0.032306141,  0.263227910,
0.009171148,
0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,  0.008238734, -0.031480706,
0.051976566,
0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,  0.015219148,  0.221345314,
0.020146770,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,  0.039741608,  0.092955553,
-0.262550823,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,  0.012624418,  0.047810873,
0.201673308,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, -0.114163303,  0.417786916,
0.253110874,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,  0.049894329, -0.155696562,
-0.049735728,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,  0.006112607,  0.074242237,
0.034046467
), 18,18))

eigen(zz)$values
eigen(zz)$values
eigen(zz)$values
eigen(zz)$values
eigen(zz)$values
eigen(zz)$values
eigen(zz)$values
eigen(zz)$values
Segmentation Fault - core dumped

==> 1272.audit <==
Fri Jan 18 09:10:34 2002	ripley	changed notes
Fri Jan 18 09:10:34 2002	ripley	foobar
Fri Jan 18 09:10:34 2002	ripley	moved from incoming to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1275 *
Subject: compile problem with bessel_i.c on IRIX64 flexor 6.5 10100655 IP35 (uname -a)
From: Walter Tautz <wtautz@math.uwaterloo.ca>
Date: Tue, 22 Jan 2002 10:05:20 -0500 (EST)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1275 <==
From wtautz@math.uwaterloo.ca  Tue Jan 22 16:05:53 2002
Received: from mfcf.math.uwaterloo.ca (wtautz@mfcf.math.uwaterloo.ca [129.97.216.156])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA20264
	for <r-bugs@biostat.ku.dk>; Tue, 22 Jan 2002 16:05:52 +0100 (MET)
Received: from localhost (wtautz@localhost)
	by mfcf.math.uwaterloo.ca (8.9.3/8.9.3) with SMTP id KAA12752;
	Tue, 22 Jan 2002 10:05:20 -0500 (EST)
X-Authentication-Warning: mfcf.math: wtautz owned process doing -bs
Date: Tue, 22 Jan 2002 10:05:20 -0500 (EST)
From: Walter Tautz <wtautz@math.uwaterloo.ca>
Reply-To: Walter Tautz <wtautz@math.uwaterloo.ca>
To: r-bugs@biostat.ku.dk
cc: Walter Tautz <wtautz@math.uwaterloo.ca>
Subject: compile problem with bessel_i.c on IRIX64 flexor 6.5 10100655 IP35 (uname -a)
Message-ID: <Pine.SOL.3.96.1020122095845.3015H-100000@mfcf.math.uwaterloo.ca>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

I have included the full configure/make output:
(the particular error regarding bessel_i.c is at
the END of the report). 


-walter tautz 




	cd build/R-1.4.0 \
	    && unset noclobber \
	&& CPPFLAGS=" " \
	    LDFLAGS="" \
	       ./configure --prefix=/software/r-1 \
	           --datadir=/software/r-1/data \
	           --libdir=/software/r-1/lib \
	           --includedir=/software/r-1/include \
		   --with-x \
			   \
			 \
	           | tee configure.XHIER.log 2>&1 \
	&& touch XHIER_CONFIGURED
creating cache ./config.cache
checking for a BSD compatible install... tools/install-sh -c
checking whether build environment is sane... yes
checking whether make sets ${MAKE}... yes
checking for working aclocal... found
checking for working autoconf... found
checking for working automake... found
checking for working autoheader... found
checking for working makeinfo... found
checking host system type... mips-sgi-irix6.5
loading site script ./config.site
loading build specific script ./config.site
checking for pwd... /sbin/pwd
checking whether builddir is srcdir... yes
checking for gcc... gcc
checking whether the C compiler (gcc  ) works... yes
checking whether the C compiler (gcc  ) is a cross-compiler... no
checking whether we are using GNU C... yes
checking whether gcc accepts -g... yes
checking how to run the C preprocessor... gcc -E
checking whether gcc needs -traditional... no
checking whether gcc accepts -M for generating dependencies... yes
checking whether gcc supports -c -o FILE.lo... yes
checking for mawk... no
checking for gawk... no
checking for nawk... nawk
checking whether ln -s works... yes
checking for ranlib... :
checking for bison... bison -y
checking for ar... ar
checking whether echo can suppress newlines... yes
configure: warning: redefining INSTALL to be /scratch/usr/source/r-1/build/R-1.4.0/tools/install-sh -c
checking for javac... no
checking for less... /.software/local/.admin/bins/bin/less
checking for perl... /.software/local/.admin/bins/bin/perl
checking whether perl version is at least 5.004... yes
checking for dvips... no
checking for tex... configure: warning: you cannot build DVI versions of the R manuals
configure: warning: you cannot build PDF versions of the R manuals
no
checking for latex... no
checking for makeindex... no
checking for pdftex... no
checking for pdflatex... no
checking for makeinfo... /.software/local/.admin/bins/bin/makeinfo
checking for unzip... no
checking for zip... no
checking for Cygwin environment... no
checking for mingw32 environment... no
checking build system type... mips-sgi-irix6.5
checking for ld used by GCC... /usr/bin/ld
checking if the linker (/usr/bin/ld) is GNU ld... no
checking for /usr/bin/ld option to reload object files... -r
checking for BSD-compatible nm... /usr/bin/nm -B
checking how to recognise dependant libraries... pass_all
checking for object suffix... o
checking for executable suffix... no
checking command to parse /usr/bin/nm -B output... ok
checking for dlfcn.h... yes
checking for ranlib... (cached) :
checking for strip... strip
checking for objdir... .libs
checking for gcc option to produce PIC... none
checking if gcc static flag -static works... no
checking if gcc supports -c -o file.o... yes
checking if gcc supports -c -o file.lo... 
checking if gcc supports -fno-rtti -fno-exceptions... yes
checking whether the linker (/usr/bin/ld -64) supports shared libraries... yes
checking how to hardcode library paths into programs... immediate
checking whether stripping libraries is possible... no
checking dynamic linker characteristics... irix6.5 ld.so
checking if libtool supports shared libraries... yes
checking whether -lc should be explicitly linked in... yes
creating libtool
checking whether makeinfo version is at least 4... yes
checking for main in -lm... yes
defining F77 to be g77
checking whether the Fortran 77 compiler (g77  ) works... yes
checking whether the Fortran 77 compiler (g77  ) is a cross-compiler... no
checking whether we are using GNU Fortran 77... yes
checking whether g77 accepts -g... yes
checking for Fortran 77 libraries...  -lg2c -lm -L/.software/arch/gcc-2.95.3/distribution/lib/gcc-lib/mips-sgi-irix6.5/2.95.3/mabi=64 -L/.software/arch/gcc-2.95.3/distribution/lib/gcc-lib/mips-sgi-irix6.5/2.95.3 -L/usr/bin -L/.software/arch/gcc-2.95.3/dis

tribution/lib/mabi=64 -L/.software/arch/gcc-2.95.3/distribution/lib -lm -L/usr/lib64/mips3 -L/usr/lib64
checking whether g77 appends underscores... yes
checking whether g77 and gcc agree on int and double... yes
checking whether g77 and gcc agree on double complex... yes
checking whether g77 supports -c -o FILE.lo... yes
checking for c++... g++
checking whether the C++ compiler (g++  ) works... yes
checking whether the C++ compiler (g++  ) is a cross-compiler... no
checking whether we are using GNU C++... yes
checking whether g++ accepts -g... yes
checking how to run the C++ preprocessor... g++ -E
checking whether g++ accepts -M for generating dependencies... yes
checking whether g++ supports -c -o FILE.lo... yes
checking for sin in -lm... yes
checking for sin in -lmoto... no
checking for main in -lncurses... no
checking for main in -ltermcap... yes
checking for dlopen in -ldl... no
checking for ATL_xerbla in -latlas... no
checking for zherk in -lblas... no
checking for dgemm_ in -lblas... yes
checking for rl_callback_read_char in -lreadline... no
checking for working alloca.h... yes
checking for alloca... yes
checking for ANSI C header files... yes
checking for pid_t... yes
checking for vfork.h... no
checking for working vfork... no
checking for vprintf... yes
checking for access... yes
checking for acosh... yes
checking for asinh... yes
checking for atanh... yes
checking for bcopy... yes
checking for bzero... yes
checking for finite... yes
checking for ftruncate... yes
checking for getcwd... yes
checking for getgrgid... yes
checking for getpwuid... yes
checking for getuid... yes
checking for hypot... yes
checking for isascii... yes
checking for isnan... yes
checking for matherr... no
checking for memcpy... yes
checking for memmove... yes
checking for mempcpy... no
checking for mkfifo... yes
checking for popen... yes
checking for putenv... yes
checking for rint... yes
checking for setenv... no
checking for snprintf... yes
checking for strcoll... yes
checking for stat... yes
checking for strptime... yes
checking for system... yes
checking for times... yes
checking for unsetenv... no
checking for vsnprintf... yes
checking for strdup... yes
checking for library containing connect... none required
checking for library containing gethostbyname... none required
checking for library containing xdr_string... none required
checking for __setfpucw... no
checking for working calloc... yes
checking for working finite... yes
checking for working log... yes
checking for working strptime... no
checking for ANSI C header files... (cached) yes
checking whether time.h and sys/time.h may both be included... yes
checking for dirent.h that defines DIR... yes
checking for opendir in -ldir... no
checking for sys/wait.h that is POSIX.1 compatible... yes
checking for arpa/inet.h... yes
checking for dl.h... no
checking for dlfcn.h... (cached) yes
checking for elf.h... yes
checking for errno.h... yes
checking for fcntl.h... yes
checking for floatingpoint.h... no
checking for fpu_control.h... no
checking for grp.h... yes
checking for ieee754.h... no
checking for ieeefp.h... yes
checking for locale.h... yes
checking for netdb.h... yes
checking for netinet/in.h... yes
checking for pwd.h... yes
checking for readline/history.h... yes
checking for readline/readline.h... yes
checking for rpc/xdr.h... yes
checking for string.h... yes
checking for strings.h... yes
checking for sys/param.h... yes
checking for sys/select.h... yes
checking for sys/socket.h... yes
checking for sys/stat.h... yes
checking for sys/time.h... yes
checking for sys/times.h... yes
checking for sys/utsname.h... yes
checking for unistd.h... yes
checking whether setjmp.h is POSIX.1 compatible... yes
checking for GNU C library with version >= 2... no
checking whether math.h defines isfinite... no
checking whether math.h defines isnan... no
checking return type of signal handlers... void
checking for pid_t... (cached) yes
checking for size_t... yes
checking for blkcnt_t... yes
checking for sys/socket.h... (cached) yes
checking for type of socket length... size_t *
checking whether byte ordering is bigendian... yes
checking for working const... yes
checking size of int... 4
checking size of long... 8
checking size of long long... 8
checking size of long double... 8
checking whether C compiler needs -OPT:IEEE_NaN_inf=ON... no
checking for xmkmf... /usr/bin/X11/xmkmf
checking for X... libraries , headers 
checking for dnet_ntoa in -ldnet... no
checking for dnet_ntoa in -ldnet_stub... no
checking for gethostbyname... yes
checking for connect... yes
checking for remove... yes
checking for shmat... yes
checking for IceConnectionNumber in -lICE... yes
checking for tclConfig.sh... no
checking for tkConfig.sh... no
checking for tcl.h... no
checking for finite... (cached) yes
checking for isnan... (cached) yes
checking whether you have IEEE 754 floating-point arithmetic... yes
checking for BSD networking... yes
checking for jpeglib.h... yes
checking if jpeglib version >= 6b... no
checking for main in -lz... yes
checking for png.h... yes
checking if libpng version >= 1.0.5... no
checking for XDR support... yes
checking for gzopen in -lz... yes
checking for zlib.h... yes
checking if zlib version >= 1.1.3... no
checking whether leap seconds are treated according to POSIX... yes
checking for setitimer... yes
checking for lpr... lpr
checking for paperconf... false
updating cache ./config.cache
creating ./config.status
creating Makeconf
creating Makefile
creating afm/Makefile
creating doc/Makefile
creating doc/html/Makefile
creating doc/html/search/Makefile
creating doc/manual/Makefile
creating etc/Makefile
creating etc/Makeconf
creating etc/Renviron
creating m4/Makefile
creating share/Makefile
creating src/Makefile
creating src/appl/Makefile
creating src/include/Makefile
creating src/include/R_ext/Makefile
creating src/library/Makefile
creating src/library/base/DESCRIPTION
creating src/library/base/Makefile
creating src/library/profile/Makefile
creating src/library/ctest/DESCRIPTION
creating src/library/ctest/Makefile
creating src/library/ctest/src/Makefile
creating src/library/eda/DESCRIPTION
creating src/library/eda/Makefile
creating src/library/eda/src/Makefile
creating src/library/lqs/DESCRIPTION
creating src/library/lqs/Makefile
creating src/library/lqs/src/Makefile
creating src/library/methods/DESCRIPTION
creating src/library/methods/Makefile
creating src/library/methods/src/Makefile
creating src/library/modreg/DESCRIPTION
creating src/library/modreg/Makefile
creating src/library/modreg/src/Makefile
creating src/library/mva/DESCRIPTION
creating src/library/mva/Makefile
creating src/library/mva/src/Makefile
creating src/library/nls/DESCRIPTION
creating src/library/nls/Makefile
creating src/library/nls/src/Makefile
creating src/library/stepfun/DESCRIPTION
creating src/library/stepfun/Makefile
creating src/library/splines/DESCRIPTION
creating src/library/splines/Makefile
creating src/library/splines/src/Makefile
creating src/library/tcltk/DESCRIPTION
creating src/library/tcltk/Makefile
creating src/library/tcltk/src/Makefile
creating src/library/tools/DESCRIPTION
creating src/library/tools/Makefile
creating src/library/ts/DESCRIPTION
creating src/library/ts/Makefile
creating src/library/ts/src/Makefile
creating src/main/Makefile
creating src/modules/Makefile
creating src/modules/X11/Makefile
creating src/modules/gnome/Makefile
creating src/modules/internet/Makefile
creating src/modules/lapack/Makefile
creating src/modules/vfonts/Makefile
creating src/nmath/Makefile
creating src/nmath/standalone/Makefile
creating src/scripts/Makefile
creating src/scripts/COMPILE
creating src/scripts/INSTALL
creating src/scripts/REMOVE
creating src/scripts/R.sh
creating src/scripts/Rdconv
creating src/scripts/Rdindex
creating src/scripts/Rprof
creating src/scripts/SHLIB
creating src/scripts/Sd2Rd
creating src/scripts/build
creating src/scripts/check
creating src/unix/Makefile
creating tests/Makefile
creating tests/Embedding/Makefile
creating tests/Examples/Makefile
creating tools/Makefile
creating src/include/config.h
configure: warning: you cannot build DVI versions of the R manuals
configure: warning: you cannot build PDF versions of the R manuals


R is now configured for mips-sgi-irix6.5

  Source directory:          .
  Installation directory:    /software/r-1
  C compiler:                gcc  -g -O2
  C++ compiler:              g++  -g -O2
  FORTRAN compiler:          g77  -g -O2

  X11 support:               yes
  Gnome support:             no
  Tcl/Tk support:            no

  R profiling support:       yes
  R as a shared library:     no

	cd build/R-1.4.0 \
	&&  make  all \
	&& touch XHIER_BUILT
creating src/scripts/R.fe
mkdir ../../bin
mkdir ../../include
mkdir ../../../include/R_ext
making approx.d from approx.c
making bakslv.d from bakslv.c
making bandwidths.d from bandwidths.c
making binning.d from binning.c
making chull.d from chull.c
making cpoly.d from cpoly.c
making cumsum.d from cumsum.c
making fft.d from fft.c
making fmin.d from fmin.c
making integrate.d from integrate.c
making lbfgsb.d from lbfgsb.c
making loglin.d from loglin.c
making lowess.d from lowess.c
making machar.d from machar.c
making maxcol.d from maxcol.c
making massdist.d from massdist.c
making pretty.d from pretty.c
making rowsum.d from rowsum.c
making splines.d from splines.c
making stem.d from stem.c
making strsignif.d from strsignif.c
making tabulate.d from tabulate.c
making uncmin.d from uncmin.c
making zeroin.d from zeroin.c
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c approx.c -o approx.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c bakslv.c -o bakslv.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c bandwidths.c -o bandwidths.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c binning.c -o binning.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c chull.c -o chull.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c cpoly.c -o cpoly.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c cumsum.c -o cumsum.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c fft.c -o fft.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c fmin.c -o fmin.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c integrate.c -o integrate.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c lbfgsb.c -o lbfgsb.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c loglin.c -o loglin.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c lowess.c -o lowess.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c machar.c -o machar.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c maxcol.c -o maxcol.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c massdist.c -o massdist.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c pretty.c -o pretty.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c rowsum.c -o rowsum.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c splines.c -o splines.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c stem.c -o stem.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c strsignif.c -o strsignif.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c tabulate.c -o tabulate.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c uncmin.c -o uncmin.o
	gcc -I. -I../../src/include -I../../src/include  -DHAVE_CONFIG_H   -g -O2 -c zeroin.c -o zeroin.o
	g77   -g -O2 -c ch2inv.f -o ch2inv.o
	g77   -g -O2 -c chol.f -o chol.o
	g77   -g -O2 -c dpbfa.f -o dpbfa.o
	g77   -g -O2 -c dpbsl.f -o dpbsl.o
	g77   -g -O2 -c dpoco.f -o dpoco.o
	g77   -g -O2 -c dpodi.f -o dpodi.o
	g77   -g -O2 -c dpofa.f -o dpofa.o
	g77   -g -O2 -c dposl.f -o dposl.o
	g77   -g -O2 -c dqrdc.f -o dqrdc.o
	g77   -g -O2 -c dqrdc2.f -o dqrdc2.o
	g77   -g -O2 -c dqrls.f -o dqrls.o
	g77   -g -O2 -c dqrsl.f -o dqrsl.o
	g77   -g -O2 -c dqrutl.f -o dqrutl.o
	g77   -g -O2 -c dsvdc.f -o dsvdc.o
	g77   -g -O2 -c dtrco.f -o dtrco.o
	g77   -g -O2 -c dtrsl.f -o dtrsl.o
	g77   -g -O2 -c eigen.f -o eigen.o
	g77   -g -O2 -c lminfl.f -o lminfl.o
	ar cr libappl.a approx.o  bakslv.o bandwidths.o binning.o  chull.o cpoly.o cumsum.o  fft.o fmin.o integrate.o lbfgsb.o loglin.o lowess.o  machar.o maxcol.o massdist.o  pretty.o  rowsum.o  splines.o stem.o strsignif.o  tabulate.o  uncmin.o  zeroin.o ch2in

v.o chol.o  dpbfa.o dpbsl.o dpoco.o dpodi.o dpofa.o dposl.o dqrdc.o  dqrdc2.o dqrls.o dqrsl.o dqrutl.o dsvdc.o dtrco.o dtrsl.o  eigen.o  lminfl.o 
	: libappl.a
making mlutils.d from mlutils.c
making d1mach.d from d1mach.c
making i1mach.d from i1mach.c
making fmax2.d from fmax2.c
making fmin2.d from fmin2.c
making fprec.d from fprec.c
making fround.d from fround.c
making ftrunc.d from ftrunc.c
making sign.d from sign.c
making fsign.d from fsign.c
making imax2.d from imax2.c
making imin2.d from imin2.c
making chebyshev.d from chebyshev.c
making log1p.d from log1p.c
making lgammacor.d from lgammacor.c
making gammalims.d from gammalims.c
making stirlerr.d from stirlerr.c
making bd0.d from bd0.c
making gamma.d from gamma.c
making lgamma.d from lgamma.c
making gamma_cody.d from gamma_cody.c
making beta.d from beta.c
making lbeta.d from lbeta.c
making polygamma.d from polygamma.c
making bessel_i.d from bessel_i.c
making bessel_j.d from bessel_j.c
making bessel_k.d from bessel_k.c
making bessel_y.d from bessel_y.c
making choose.d from choose.c
making snorm.d from snorm.c
making sexp.d from sexp.c
making dgamma.d from dgamma.c
making pgamma.d from pgamma.c
making qgamma.d from qgamma.c
making rgamma.d from rgamma.c
making dbeta.d from dbeta.c
making pbeta.d from pbeta.c
making qbeta.d from qbeta.c
making rbeta.d from rbeta.c
making dunif.d from dunif.c
making punif.d from punif.c
making qunif.d from qunif.c
making runif.d from runif.c
making dnorm.d from dnorm.c
making pnorm.d from pnorm.c
making qnorm.d from qnorm.c
making rnorm.d from rnorm.c
making dlnorm.d from dlnorm.c

==> 1275.reply.1 <==
From p.dalgaard@biostat.ku.dk  Tue Jan 22 16:29:23 2002
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA20580;
	Tue, 22 Jan 2002 16:29:22 +0100 (MET)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id g0MFRjp00671;
	Tue, 22 Jan 2002 16:27:45 +0100
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: wtautz@math.uwaterloo.ca
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] compile problem with bessel_i.c on IRIX64 flexor 6.5 10100655 IP35 (uname -a) (PR#1275)
References: <200201221505.QAA20274@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 22 Jan 2002 16:27:45 +0100
In-Reply-To: <200201221505.QAA20274@pubhealth.ku.dk>
Message-ID: <x2elki4d8u.fsf@blueberry.kubism.ku.dk>
Lines: 37
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

wtautz@math.uwaterloo.ca writes:

> I have included the full configure/make output:
> (the particular error regarding bessel_i.c is at
> the END of the report). 
...
> bessel_i.c: In function `I_bessel':
> bessel_i.c:468: internal error--unrecognizable insn:
> (insn 1418 1417 673 (set:DF (reg/v:DF 101)
>         (if_then_else:DF (ne (reg:DI 416)
>                 (const_int 0 [0x0]))
>             (reg/v:DF 101)
>             (reg:DF 415))) -1 (insn_list 1417 (nil))
>     (expr_list:REG_DEAD (reg:DI 416)
>         (nil)))
> *** Error code 1 (bu21)
> *** Error code 1 (bu21)
> *** Error code 1 (bu21)
> *** Error code 1 (bu21)
> *** Error code 1 (bu21)

That looks like a problem in the gcc compiler suite. You might try
upgrading the compiler. Sometimes changing compiler flags (you would
only need to do it for the offending module) does the trick. 

Another possibility is that gcc is generating code that the system
assembler doesn't understand (this is happening with gcc 3 on
Solaris). If so, then you might install GNU binutils.

If none of this helps, I'm afraid that you need to take it up with the
GCC authors since it is not an R problem.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

==> 1275.followup.1 <==
From wtautz@math.uwaterloo.ca  Tue Jan 22 16:48:52 2002
Received: from mfcf.math.uwaterloo.ca (wtautz@mfcf.math.uwaterloo.ca [129.97.216.156])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA20899;
	Tue, 22 Jan 2002 16:48:49 +0100 (MET)
Received: from localhost (wtautz@localhost)
	by mfcf.math.uwaterloo.ca (8.9.3/8.9.3) with SMTP id KAA14370;
	Tue, 22 Jan 2002 10:48:18 -0500 (EST)
X-Authentication-Warning: mfcf.math: wtautz owned process doing -bs
Date: Tue, 22 Jan 2002 10:48:18 -0500 (EST)
From: Walter Tautz <wtautz@math.uwaterloo.ca>
Reply-To: Walter Tautz <wtautz@math.uwaterloo.ca>
To: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk,
        Walter Tautz <wtautz@math.uwaterloo.ca>
Subject: Re: [Rd] compile problem with bessel_i.c on IRIX64 flexor 6.5 10100655 IP35 (uname -a) (PR#1275)
In-Reply-To: <x2elki4d8u.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.SOL.3.96.1020122103116.3015L-100000@mfcf.math.uwaterloo.ca>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII



On 22 Jan 2002, Peter Dalgaard BSA wrote:

> wtautz@math.uwaterloo.ca writes:
> 
> > I have included the full configure/make output:
> > (the particular error regarding bessel_i.c is at
> > the END of the report). 
> ...
> > bessel_i.c: In function `I_bessel':
> > bessel_i.c:468: internal error--unrecognizable insn:
> > (insn 1418 1417 673 (set:DF (reg/v:DF 101)
> >         (if_then_else:DF (ne (reg:DI 416)
> >                 (const_int 0 [0x0]))
> >             (reg/v:DF 101)
> >             (reg:DF 415))) -1 (insn_list 1417 (nil))
> >     (expr_list:REG_DEAD (reg:DI 416)
> >         (nil)))
> > *** Error code 1 (bu21)
> > *** Error code 1 (bu21)
> > *** Error code 1 (bu21)
> > *** Error code 1 (bu21)
> > *** Error code 1 (bu21)
> 
> That looks like a problem in the gcc compiler suite. You might try
> upgrading the compiler. Sometimes changing compiler flags (you would
> only need to do it for the offending module) does the trick. 
> 
> Another possibility is that gcc is generating code that the system
> assembler doesn't understand (this is happening with gcc 3 on
> Solaris). If so, then you might install GNU binutils.
> 

I neglected to mention that 
gcc -v gives:

gcc version 2.95.3 20010315 (release)



Here is a more verbose output if that helps:




Reading specs from /.software/arch/gcc-2.95.3/distribution/lib/gcc-lib/mips-sgi-irix6.5/2.95.3/specs
gcc version 2.95.3 20010315 (release)
 /.software/arch/gcc-2.95.3/distribution/lib/gcc-lib/mips-sgi-irix6.5/2.95.3/cpp0 -lang-c -v -I. -I../../src/include -I../../src/include -D__GNUC__=2 -D__GNUC_MINOR__=95 -Dunix -Dmips -Dsgi -Dhost_mips -DMIPSEB -D_MIPSEB -DSYSTYPE_SVR4 -D_LONGLONG -D_SVR4
_SOURCE -D_MODERN_C -D__DSO__ -D__unix__ -D__mips__ -D__sgi__ -D__host_mips__ -D__MIPSEB__ -D_MIPSEB -D__SYSTYPE_SVR4__ -D_LONGLONG -D_SVR4_SOURCE -D_MODERN_C -D__DSO__ -D__unix -D__mips -D__sgi -D__host_mips -D__MIPSEB -D__SYSTYPE_SVR4 -Asystem(unix) -As
ystem(svr4) -Acpu(mips) -Amachine(sgi) -D__CHAR_UNSIGNED__ -D__OPTIMIZE__ -g -D__LANGUAGE_C -D_LANGUAGE_C -DLANGUAGE_C -D__SIZE_TYPE__=long unsigned int -D__PTRDIFF_TYPE__=long int -D__LONG_MAX__=9223372036854775807L -D__EXTENSIONS__ -D_SGI_SOURCE -D_MIPS
_FPSET=32 -D_MIPS_ISA=_MIPS_ISA_MIPS3 -D_ABI64=3 -D_MIPS_SIM=_ABI64 -D_MIPS_SZINT=32 -D_MIPS_SZLONG=64 -D_MIPS_SZPTR=64 -D_COMPILER_VERSION=601 -U__mips -D__mips=3 -D__mips64 -DHAVE_CONFIG_H bessel_i.c /var/tmp/ccyhjiCa.i
GNU CPP version 2.95.3 20010315 (release) [AL 1.1, MM 40] SGI running IRIX 6.x
#include "..." search starts here:
#include <...> search starts here:
 .
 ../../src/include
 /.software/arch/gcc-2.95.3/distribution/lib/gcc-lib/mips-sgi-irix6.5/2.95.3/../../../../mips-sgi-irix6.5/include
 /.software/arch/gcc-2.95.3/distribution/lib/gcc-lib/mips-sgi-irix6.5/2.95.3/include
 /usr/include
End of search list.
The following default directories have been omitted from the search path:
 /.software/arch/gcc-2.95.3/distribution/lib/gcc-lib/mips-sgi-irix6.5/2.95.3/../../../../include/g++-3
 /usr/local/include
End of omitted list.
 /.software/arch/gcc-2.95.3/distribution/lib/gcc-lib/mips-sgi-irix6.5/2.95.3/cc1 /var/tmp/ccyhjiCa.i -quiet -dumpbase bessel_i.c -mabi=64 -g -O2 -version -o /var/tmp/ccKOSzid.s
GNU C version 2.95.3 20010315 (release) (mips-sgi-irix6.5) compiled by GNU C version 2.95.3 20010315 (release).
bessel_i.c: In function `I_bessel':
bessel_i.c:468: internal error--unrecognizable insn:
(insn 1418 1417 673 (set:DF (reg/v:DF 101)
        (if_then_else:DF (ne (reg:DI 416)
                (const_int 0 [0x0]))
            (reg/v:DF 101)
            (reg:DF 415))) -1 (insn_list 1417 (nil))
    (expr_list:REG_DEAD (reg:DI 416)
        (nil)))


==> 1275.audit <==
Thu Jan 24 15:40:40 2002	ripley	moved from incoming to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1289 *
Subject: R 1.4.0 build fails on AIX
From: lio@hpss1.ccs.ornl.gov
Date: Wed, 30 Jan 2002 14:10:30 +0100 (MET)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1289 <==
From lio@hpss1.ccs.ornl.gov  Wed Jan 30 14:10:31 2002
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id OAA19022
	for <R-bugs@biostat.ku.dk>; Wed, 30 Jan 2002 14:10:30 +0100 (MET)
Date: Wed, 30 Jan 2002 14:10:30 +0100 (MET)
From: lio@hpss1.ccs.ornl.gov
Message-Id: <200201301310.OAA19022@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: R 1.4.0 build fails on AIX

Full_Name: Daniel L. Million
Version: 1.4.0
OS: AIX 5.1 and 4.3.3
Submission from: (NULL) (160.91.192.125)


Is there any guidance available on building R on AIX?  Specifically, which C 
compiler to use?  We have AIX XL Fortran version 7.1.1.  We also have AIX 
Visual Age C version 5.0.2.  We also have gcc available.

I have tried building with "cc" (the default AIX compiler) and "gcc".  During
the "make", C compilation in src/library/methods/src completes, and then I 
see this:

mkdir ../../../../library/methods/libs
dumping R code in package `methods'
make: 1254-059 The signal code from the last command is 11.

Apparently the make is running R.bin, which coredumps with a segmentation
violation.

Do I need to be using a thread-safe compiler (e.g., "cc_r") for this build?
Any clues at all as to how to get around this?

Thanks.

Dan Million


==> 1289.followup.1 <==
From tlumley@u.washington.edu  Wed Jan 30 17:46:32 2002
Received: from jason04.u.washington.edu (jason04.u.washington.edu [140.142.8.53])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA23476
	for <R-bugs@biostat.ku.dk>; Wed, 30 Jan 2002 17:46:31 +0100 (MET)
Received: from homer40.u.washington.edu (homer40.u.washington.edu [140.142.16.6])
	by jason04.u.washington.edu (8.12.1+UW01.12/8.12.1+UW02.01) with ESMTP id g0UGjs9Y020226;
	Wed, 30 Jan 2002 08:45:54 -0800
Received: from localhost (tlumley@localhost)
	by homer40.u.washington.edu (8.12.1+UW01.12/8.12.1+UW02.01) with ESMTP id g0UGjru1095332;
	Wed, 30 Jan 2002 08:45:53 -0800
Date: Wed, 30 Jan 2002 08:45:53 -0800 (PST)
From: Thomas Lumley <tlumley@u.washington.edu>
To: lio@hpss1.ccs.ornl.gov
cc: r-devel@stat.math.ethz.ch, <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] R 1.4.0 build fails on AIX (PR#1289)
In-Reply-To: <200201301310.OAA19034@pubhealth.ku.dk>
Message-ID: <Pine.A41.4.44.0201300827470.74956-100000@homer40.u.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Wed, 30 Jan 2002 lio@hpss1.ccs.ornl.gov wrote:

> Full_Name: Daniel L. Million
> Version: 1.4.0
> OS: AIX 5.1 and 4.3.3
> Submission from: (NULL) (160.91.192.125)
>
>
> Is there any guidance available on building R on AIX?  Specifically, which C
> compiler to use?  We have AIX XL Fortran version 7.1.1.  We also have AIX
> Visual Age C version 5.0.2.  We also have gcc available.
>
> I have tried building with "cc" (the default AIX compiler) and "gcc".  During
> the "make", C compilation in src/library/methods/src completes, and then I
> see this:
>
> mkdir ../../../../library/methods/libs
> dumping R code in package `methods'
> make: 1254-059 The signal code from the last command is 11.
>
> Apparently the make is running R.bin, which coredumps with a segmentation
> violation.
>
> Do I need to be using a thread-safe compiler (e.g., "cc_r") for this build?
> Any clues at all as to how to get around this?


I have successfully built most recent versions of R including 1.4.0 with
gcc/g77 and with "C for AIX version 5"/"XL Fortran for AIX" on AIX 4.3. I
haven't been able to mix the GNU and IBM compilers, but I haven't tried
recently.  Last week I compiled R-patched successfully using gcc/g77. I
didn't have to do anything special, but AIX has often been source of
configuration bugs.

You could try not building the methods package: edit  Makeconf in the top
R/ directory and remove methods from R_PKGS.

Also, I think that it's possible to have the methods package build in the
usual source form rather than as a saved image. I don't know how, but John
Chambers or Duncan Temple Lang may be able to help.

These wouldn't actually fix the problem, but would enable you to compile
everything else.

I'll try again with the AIX compilers and the new R 1.4.1. It's possible
that there have been some changes since I last tried, since I usually do
this shortly before a release.

	-thomas



==> 1289.followup.2 <==
From lio@hpss1.ccs.ornl.gov  Wed Jan 30 20:49:57 2002
Received: from hpss1.ccs.ornl.gov (hpss1.ccs.ornl.gov [160.91.192.125])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA24914
	for <R-bugs@biostat.ku.dk>; Wed, 30 Jan 2002 20:49:56 +0100 (MET)
Received: from localhost (lio@localhost)
	by hpss1.ccs.ornl.gov (AIX4.3/8.9.3/8.9.1) with ESMTP id OAA18340;
	Wed, 30 Jan 2002 14:49:04 -0500
Date: Wed, 30 Jan 2002 14:49:04 -0500 (EST)
From: Dan Million <lio@hpss1.ccs.ornl.gov>
To: Thomas Lumley <tlumley@u.washington.edu>
cc: <r-devel@stat.math.ethz.ch>, <R-bugs@biostat.ku.dk>,
        Dan Million <lio@hpss1.ccs.ornl.gov>
Subject: Re: [Rd] R 1.4.0 build fails on AIX (PR#1289)
In-Reply-To: <Pine.A41.4.44.0201300827470.74956-100000@homer40.u.washington.edu>
Message-ID: <Pine.A41.4.31.0201301446540.16064-100000@hpss1.ccs.ornl.gov>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Wed, 30 Jan 2002, Thomas Lumley wrote:

> On Wed, 30 Jan 2002 lio@hpss1.ccs.ornl.gov wrote:
>
> > Full_Name: Daniel L. Million
> > Version: 1.4.0
> > OS: AIX 5.1 and 4.3.3
> > Submission from: (NULL) (160.91.192.125)
> >
> >
> > Is there any guidance available on building R on AIX?  Specifically, which C
> > compiler to use?  We have AIX XL Fortran version 7.1.1.  We also have AIX
> > Visual Age C version 5.0.2.  We also have gcc available.
> >
> > I have tried building with "cc" (the default AIX compiler) and "gcc".  During
> > the "make", C compilation in src/library/methods/src completes, and then I
> > see this:
> >
> > mkdir ../../../../library/methods/libs
> > dumping R code in package `methods'
> > make: 1254-059 The signal code from the last command is 11.
> >
> > Apparently the make is running R.bin, which coredumps with a segmentation
> > violation.
> >
> > Do I need to be using a thread-safe compiler (e.g., "cc_r") for this build?
> > Any clues at all as to how to get around this?
>
>
> I have successfully built most recent versions of R including 1.4.0 with
> gcc/g77 and with "C for AIX version 5"/"XL Fortran for AIX" on AIX 4.3. I
> haven't been able to mix the GNU and IBM compilers, but I haven't tried
> recently.  Last week I compiled R-patched successfully using gcc/g77. I
> didn't have to do anything special, but AIX has often been source of
> configuration bugs.
>
> You could try not building the methods package: edit  Makeconf in the top
> R/ directory and remove methods from R_PKGS.
>
> Also, I think that it's possible to have the methods package build in the
> usual source form rather than as a saved image. I don't know how, but John
> Chambers or Duncan Temple Lang may be able to help.
>
> These wouldn't actually fix the problem, but would enable you to compile
> everything else.
>
> I'll try again with the AIX compilers and the new R 1.4.1. It's possible
> that there have been some changes since I last tried, since I usually do
> this shortly before a release.
>
> 	-thomas

Thanks for the reply.  I tried building without the modules package, and
got past that point.  Now the build fails trying to link tcltk.so.  Seems
the tclConfig.sh on my host refers to a file that does not exist
(/opt/freeware/src/packages/BUILD/tcltk-8.3.3/tcl8.3.3/unix/lib.exp).

I'll freely admit to being clueless about most of this.  I don't know
anything about R; I'm just a sysadmin trying to build/install it for a
user who needs it.

Dan



==> 1289.followup.3 <==
From tlumley@u.washington.edu  Wed Jan 30 21:18:08 2002
Received: from jason03.u.washington.edu (jason03.u.washington.edu [140.142.8.11])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA25053
	for <R-bugs@biostat.ku.dk>; Wed, 30 Jan 2002 21:18:07 +0100 (MET)
Received: from homer04.u.washington.edu (homer04.u.washington.edu [140.142.15.38])
	by jason03.u.washington.edu (8.12.1+UW01.12/8.12.1+UW02.01) with ESMTP id g0UKHUPE052646;
	Wed, 30 Jan 2002 12:17:30 -0800
Received: from localhost (tlumley@localhost)
	by homer04.u.washington.edu (8.12.1+UW01.12/8.12.1+UW02.01) with ESMTP id g0UKHTUO036174;
	Wed, 30 Jan 2002 12:17:29 -0800
Date: Wed, 30 Jan 2002 12:17:29 -0800 (PST)
From: Thomas Lumley <tlumley@u.washington.edu>
To: Dan Million <lio@hpss1.ccs.ornl.gov>
cc: r-devel@stat.math.ethz.ch, <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] R 1.4.0 build fails on AIX (PR#1289)
In-Reply-To: <Pine.A41.4.31.0201301446540.16064-100000@hpss1.ccs.ornl.gov>
Message-ID: <Pine.A41.4.44.0201301155360.117500-100000@homer04.u.washington.edu>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Wed, 30 Jan 2002, Dan Million wrote:

> Thanks for the reply.  I tried building without the modules package, and
> got past that point.  Now the build fails trying to link tcltk.so.  Seems
> the tclConfig.sh on my host refers to a file that does not exist
> (/opt/freeware/src/packages/BUILD/tcltk-8.3.3/tcl8.3.3/unix/lib.exp).
>
> I'll freely admit to being clueless about most of this.  I don't know
> anything about R; I'm just a sysadmin trying to build/install it for a
> user who needs it.

Our autodetection of tcl/tk is less reliable than most stuff, partly
because the tclConfig.sh and similar files are sometimes inaccurate.  If
your users don't need tcl/tk (which is a fairly low-level set of
facilities for writing GUIs) you can again remove tcltk from the R_PKGS
line of Makeconf, or reconfigure
   ./configure --without-tcltk

If your users do need this package then you (or they) need to track down
where tcl and tk lurk and provide this information to R. Probably the
easiest way would be to install a new version of Tcl and Tk, which should
produce an honest set of configuration files.

	-thomas


==> 1289.followup.4 <==
From lio@hpss1.ccs.ornl.gov  Thu Jan 31 19:36:53 2002
Received: from hpss1.ccs.ornl.gov (hpss1.ccs.ornl.gov [160.91.192.125])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id TAA08024
	for <R-bugs@biostat.ku.dk>; Thu, 31 Jan 2002 19:36:52 +0100 (MET)
Received: from localhost (lio@localhost)
	by hpss1.ccs.ornl.gov (AIX4.3/8.9.3/8.9.1) with ESMTP id NAA24034;
	Thu, 31 Jan 2002 13:36:00 -0500
Date: Thu, 31 Jan 2002 13:36:00 -0500 (EST)
From: Dan Million <lio@hpss1.ccs.ornl.gov>
To: Thomas Lumley <tlumley@u.washington.edu>
cc: <r-devel@stat.math.ethz.ch>, <R-bugs@biostat.ku.dk>,
        Dan Million <lio@hpss1.ccs.ornl.gov>
Subject: Re: [Rd] R 1.4.0 build fails on AIX (PR#1289)
In-Reply-To: <Pine.A41.4.44.0201301155360.117500-100000@homer04.u.washington.edu>
Message-ID: <Pine.A41.4.31.0201311327400.23486-100000@hpss1.ccs.ornl.gov>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Wed, 30 Jan 2002, Thomas Lumley wrote:

> On Wed, 30 Jan 2002, Dan Million wrote:
>
> > Thanks for the reply.  I tried building without the modules package, and
> > got past that point.  Now the build fails trying to link tcltk.so.  Seems
> > the tclConfig.sh on my host refers to a file that does not exist
> > (/opt/freeware/src/packages/BUILD/tcltk-8.3.3/tcl8.3.3/unix/lib.exp).
>
> Our autodetection of tcl/tk is less reliable than most stuff, partly
> because the tclConfig.sh and similar files are sometimes inaccurate.  If
> your users don't need tcl/tk (which is a fairly low-level set of
> facilities for writing GUIs) you can again remove tcltk from the R_PKGS
> line of Makeconf, or reconfigure
>    ./configure --without-tcltk
>
> If your users do need this package then you (or they) need to track down
> where tcl and tk lurk and provide this information to R. Probably the
> easiest way would be to install a new version of Tcl and Tk, which should
> produce an honest set of configuration files.

I installed and built the Tcl/Tk source RPM, and now the file that R wants
is there.  By skipping the "modules" packages, the build gets all the way
to the end.

"make check" fails rather quickly:

    running code in `base-Ex.R' .../bin/sh: 51598 Illegal
	instruction(coredump)
    make: 1254-004 The error code from the last command is 1.

When I try to run R, I get the opening info and then a "> " prompt.
I can type simple commands like help(), but whenever I type q() to
quit, I get a coredump.  This is consistent with what I saw earlier when
the build was trying to load "modules".  The stack trace in the coredump
contains this:

Segmentation fault in spin_lock_global_ppc_mp at 0xd0106644 ($t1)
0xd0106644 (spin_lock_global_ppc_mp+0x24) 7ce5192d     stwcx.   r7,r5,r3
(dbx) where
spin_lock_global_ppc_mp() at 0xd0106644
_rec_mutex_lock(??) at 0xd0170d48
__ct__Q2_3std7_LockitFi(??, ??) at 0xd0bb3a18
__dt__Q2_3std6_WinitFv(??, ??) at 0xd0bdad18
__srterm__7__Fv() at 0xd0bcbe04
exit(??) at 0xd0177c40
Rstd_CleanUp(0x3, 0x0, 0x1), line 529 in "sys-std.c"

It almost looks like R is working OK until it calls "exit", and then it
blows up.

Dan



==> 1289.audit <==
Fri Feb  1 21:55:34 2002	ripley	moved from incoming to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1291 *
Subject: Installation problem : SunOS
From: brendan_mcmahon@prusec.com
Date: Thu, 31 Jan 2002 18:00:55 +0100 (MET)
--looks like gcc compiled under different OS version.
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1291 <==
From brendan_mcmahon@prusec.com  Thu Jan 31 18:00:56 2002
Received: from blueberry.kubism.ku.dk (blueberry [130.225.108.193])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA07547
	for <R-bugs@biostat.ku.dk>; Thu, 31 Jan 2002 18:00:55 +0100 (MET)
Date: Thu, 31 Jan 2002 18:00:55 +0100 (MET)
From: brendan_mcmahon@prusec.com
Message-Id: <200201311700.SAA07547@pubhealth.ku.dk>
To: R-bugs@biostat.ku.dk
Subject: Installation problem : SunOS

Full_Name: Brendan McMahon
Version: 1.3
OS: SunOS
Submission from: (NULL) (12.42.50.51)



Probably just a configuration problem but ... fails to compile.
configure completed without a problem.
Any help appreciated!!

SunOS flexdev1 5.7 Generic_106541-11 sun4u sparc SUNW,Ultra-5_10

`Makedeps' is up to date.
gcc -I. -I../../src/include -I../../src/include -I/usr/local/include
-DHAVE_CONFIG_H   -g -O2 -c arithmetic.c -o arithmetic.o
arithmetic.c:58: warning: `struct exception' declared inside parameter list
arithmetic.c:58: warning: its scope is only this definition or declaration,
arithmetic.c:58: warning: which is probably not what you want.
arithmetic.c: In function `matherr':
arithmetic.c:60: dereferencing pointer to incomplete type
arithmetic.c:61: `DOMAIN' undeclared (first use this function)
arithmetic.c:61: (Each undeclared identifier is reported only once
arithmetic.c:61: for each function it appears in.)
arithmetic.c:62: `SING' undeclared (first use this function)
arithmetic.c:65: `OVERFLOW' undeclared (first use this function)
arithmetic.c:68: `UNDERFLOW' undeclared (first use this function)
arithmetic.c:69: dereferencing pointer to incomplete type
arithmetic.c: In function `do_math1':
arithmetic.c:984: `acosh' undeclared (first use this function)
arithmetic.c:985: `asinh' undeclared (first use this function)
arithmetic.c:986: `atanh' undeclared (first use this function)
*** Error code 1
make: Fatal error: Command failed for target `arithmetic.o'
Current working directory /export/home/flexapp/R/R-1.3.0/src/main
*** Error code 1
make: Fatal error: Command failed for target `R'

==> 1291.followup.1 <==
From ripley@stats.ox.ac.uk  Thu Jan 31 18:46:28 2002
Received: from toucan.stats.ox.ac.uk (toucan.stats.ox.ac.uk [163.1.20.20])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id SAA07809
	for <R-bugs@biostat.ku.dk>; Thu, 31 Jan 2002 18:46:28 +0100 (MET)
Received: from gannet.stats (IDENT:root@gannet.stats [163.1.20.127])
	by toucan.stats.ox.ac.uk (8.9.0/8.9.0) with ESMTP id RAA10317;
	Thu, 31 Jan 2002 17:45:57 GMT
Received: from localhost (ripley@localhost)
	by gannet.stats (8.11.3/8.11.3) with ESMTP id g0VHjv312467;
	Thu, 31 Jan 2002 17:45:57 GMT
X-Authentication-Warning: gannet.stats: ripley owned process doing -bs
Date: Thu, 31 Jan 2002 17:45:57 +0000 (GMT)
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
X-X-Sender:  <ripley@gannet.stats>
To: <brendan_mcmahon@prusec.com>
cc: <R-bugs@biostat.ku.dk>
Subject: Re: [Rd] Installation problem : SunOS (PR#1291)
In-Reply-To: <200201311700.SAA07558@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.31.0201311742120.12426-100000@gannet.stats>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII

On Thu, 31 Jan 2002 brendan_mcmahon@prusec.com wrote:

> Full_Name: Brendan McMahon
> Version: 1.3
> OS: SunOS
> Submission from: (NULL) (12.42.50.51)
>
>
>
> Probably just a configuration problem but ... fails to compile.
> configure completed without a problem.

We need to know your compiler system. This is I seem to remember a symptom
of using gcc made on SunOS 5.5 under 5.6/7, so if this is gcc, was it
built under 5.7?

BTW, R is now at 1.4.1, not 1.3.0.

> Any help appreciated!!
>
> SunOS flexdev1 5.7 Generic_106541-11 sun4u sparc SUNW,Ultra-5_10
>
> `Makedeps' is up to date.
> gcc -I. -I../../src/include -I../../src/include -I/usr/local/include
> -DHAVE_CONFIG_H   -g -O2 -c arithmetic.c -o arithmetic.o
> arithmetic.c:58: warning: `struct exception' declared inside parameter list
> arithmetic.c:58: warning: its scope is only this definition or declaration,
> arithmetic.c:58: warning: which is probably not what you want.
> arithmetic.c: In function `matherr':
> arithmetic.c:60: dereferencing pointer to incomplete type
> arithmetic.c:61: `DOMAIN' undeclared (first use this function)
> arithmetic.c:61: (Each undeclared identifier is reported only once
> arithmetic.c:61: for each function it appears in.)
> arithmetic.c:62: `SING' undeclared (first use this function)
> arithmetic.c:65: `OVERFLOW' undeclared (first use this function)
> arithmetic.c:68: `UNDERFLOW' undeclared (first use this function)
> arithmetic.c:69: dereferencing pointer to incomplete type
> arithmetic.c: In function `do_math1':
> arithmetic.c:984: `acosh' undeclared (first use this function)
> arithmetic.c:985: `asinh' undeclared (first use this function)
> arithmetic.c:986: `atanh' undeclared (first use this function)
> *** Error code 1
> make: Fatal error: Command failed for target `arithmetic.o'
> Current working directory /export/home/flexapp/R/R-1.3.0/src/main
> *** Error code 1
> make: Fatal error: Command failed for target `R'
>
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


==> 1291.audit <==
Fri Feb  1 21:53:20 2002	ripley	changed notes
Fri Feb  1 21:53:20 2002	ripley	foobar
Fri Feb  1 21:53:20 2002	ripley	moved from incoming to System-specific
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Directory:  TooMuchAtOnce

none

Directory:  Windows

none

Directory:  incoming

* PR# 1240 *
Subject:  R CMD check 
From: hoffmann@wsl.ch
Date: Fri, 4 Jan 2002 12:51:15 +0100 (MET)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1240 <==
From postmaster@franz.stat.wisc.edu  Fri Jan  4 12:51:47 2002
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id MAA05227
	for <r-bugs@biostat.ku.dk>; Fri, 4 Jan 2002 12:51:46 +0100 (MET)
Received: from wsl.ch (really [193.134.202.3]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m16MSsY-000IahC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Fri, 4 Jan 2002 05:51:18 -0600 (CST) 
Received: from fluke.wsl.ch (fluke [193.134.202.9])
	by wsl.ch (8.10.2+Sun/8.10.2) with ESMTP id g04BpFl02538
	for <r-bugs@r-project.org>; Fri, 4 Jan 2002 12:51:15 +0100 (MET)
Received: (from hoffmann@localhost)
	by fluke.wsl.ch (8.9.3+Sun/8.9.3) id MAA12045;
	Fri, 4 Jan 2002 12:51:15 +0100 (MET)
Date: Fri, 4 Jan 2002 12:51:15 +0100 (MET)
Message-Id: <200201041151.MAA12045@fluke.wsl.ch>
From: hoffmann@wsl.ch
To: r-bugs@r-project.org
Cc: hoffmann@fluke.wsl.ch
Subject:  R CMD check 

SunOS fluke 5.8 Generic_108528-07 sun4u sparc SUNW,Ultra-Enterprise

R-1.4.0

Running from the command line 

R CMD check chlib

results in the log file 00check.log:

* using log directory `/home/woodstock/hoffmann/R/Sources/chlib.Rcheck'
* checking for file `chlib/DESCRIPTION' ... OK
* checking package directory ... OK
* checking for sufficient/correct file permissions ... WARNING
*   Found the following text files with incorrect permissions:
*     ./R/cbind.dimnames.r
*     ./R/clean.na.r
*     ./R/invgauss.r
*     ./R/my.table.r
*     ./R/negbingof.r
*     ./R/numberof.r
*     ./R/poisgam.r
*     ./R/progress.meter.r
*     ./R/qnorm.appr.r
*     ./R/qres.r
*     ./R/rowSums.r
*     ./R/S.princomp.r
*     ./R/select.range.r
*     ./R/shapiro.wilk.test.r
*     ./R/smoothed.df.r
*     ./R/tri.r
*     ./R/tweedie.r
*     ./R/tweedief.r
*     ./R/weighted.mean1.r
*     ./R/zzz.R
*     ./R/weighted.median.r
*     ./R/plotCI.Rd
*     ./man/cbind.dimnames.Rd
*     ./man/chlib-internal.Rd
*     ./man/clean.na.Rd
*     ./man/eql.Rd
*     ./man/invgauss.Rd
*     ./man/my.table.Rd
*     ./man/negbingof.Rd
*     ./man/numberof.Rd
*     ./man/poisgam.Rd
*     ./man/progress.meter.Rd
*     ./man/qnorm.appr.Rd
*     ./man/qres.Rd
*     ./man/remove.dup.rows.Rd
*     ./man/rowSums.Rd
*     ./man/S.princomp.Rd
*     ./man/select.range.Rd
*     ./man/shapiro.wilk.test.Rd
*     ./man/smoothed.df.Rd
*     ./man/tri.Rd
*     ./man/tweedie.Rd
*     ./man/tweedief.Rd
*     ./man/weighted.mean1.Rd
*     ./man/weighted.median.Rd
*   Please fix permissions.
* checking DESCRIPTION Package field ... OK
* checking DESCRIPTION Version field ... OK
* checking DESCRIPTION License field ... OK
* checking DESCRIPTION Description field ... OK
* checking DESCRIPTION Title field ... OK
* checking DESCRIPTION Author field ... OK
* checking DESCRIPTION Maintainer field ... OK
* checking DESCRIPTION Depends field ... OK
* checking R files for syntax errors ... OK
* checking R files for library.dynam ...

I ran chmod 666 * on all the mentioned files, to no avail.



--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.7
 arch = sparc
 os = solaris2.7
 system = sparc, solaris2.7
 status = 
 major = 1
 minor = 4.0
 year = 2001
 month = 12
 day = 19
 language = R

Search Path:
 .GlobalEnv, package:MASS, package:prlib, package:pllib, package:mathlib, package:mva, package:strlib, package:chlib, Autoloads, package:base

==> 1240.followup.1 <==
From postmaster@franz.stat.wisc.edu  Fri Jan  4 13:34:32 2002
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id NAA06120
	for <r-bugs@biostat.ku.dk>; Fri, 4 Jan 2002 13:34:31 +0100 (MET)
Received: from wsl.ch (really [193.134.202.3]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m16MTXv-000IZ3C@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Fri, 4 Jan 2002 06:34:03 -0600 (CST) 
Received: from cudesch (cudesch [193.134.202.113])
	by wsl.ch (8.10.2+Sun/8.10.2) with SMTP id g04CXtl04083;
	Fri, 4 Jan 2002 13:33:55 +0100 (MET)
Message-Id: <3.0.6.32.20020104133334.00df4060@mail.wsl.ch>
X-Sender: hoffmann@mail.wsl.ch
X-Mailer: QUALCOMM Windows Eudora Light Version 3.0.6 (32)
Date: Fri, 04 Jan 2002 13:33:34 +0100
To: =?iso-8859-1?Q?G=F6ran?= =?iso-8859-1?Q?_Brostr=F6m?= <gb@stat.umu.se>,
        <hoffmann@wsl.ch>
From: Christian Hoffmann <christian.hoffmann@wsl.ch>
Subject: Re: [Rd] R CMD check (PR#1240)
Cc: r-bugs@r-project.org
In-Reply-To: <Pine.LNX.4.33.0201041308180.2833-100000@tal.stat.umu.se>
References: <200201041151.MAA05237@pubhealth.ku.dk>
Mime-Version: 1.0
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: 8bit
X-MIME-Autoconverted: from quoted-printable to 8bit by pubhealth.ku.dk id NAA06120

Göran,

After  chmod 644 * I got some success:

hoffmann@fluke:~/R/Sources >R CMD check chlib
* checking for working latex ... OK
* using log directory `/home/woodstock/hoffmann/R/Sources/chlib.Rcheck'

Installing *binary* package `chlib' ...
 DONE (chlib)

DONE (INSTALL)

* checking for file `chlib/DESCRIPTION' ... OK
* checking package directory ... OK
* checking for sufficient/correct file permissions ... OK
* checking DESCRIPTION Package field ... OK
* checking DESCRIPTION Version field ... OK
* checking DESCRIPTION License field ... OK
* checking DESCRIPTION Description field ... OK
* checking DESCRIPTION Title field ... OK
* checking DESCRIPTION Author field ... OK
* checking DESCRIPTION Maintainer field ... OK
* checking DESCRIPTION Depends field ... OK
* checking R files for syntax errors ... OK
* checking R files for library.dynam ...Error: cannot open file
`/home/woodstock/hoffmann/R/Sources/chlib.Rcheck/chlib/R/chlib' for reading
at /usr/local/lib/R/bin/check line 522.

What can this be?

Thanks for help

--christian

At 13:10 04.01.2002 +0100, Göran Broström wrote:
>I asked the same question some days ago. I have:
>
>-rw-r--r--    1 gb       gb           4070 Dec 30 10:13 statistics.c
>
>which works. Maybe 644? Check archives, I have lost the answer I got.
>
>Göran
>



Version:
 platform = sparc-sun-solaris2.7
 arch = sparc
 os = solaris2.7
 system = sparc, solaris2.7
 status = 
 major = 1
 minor = 4.0
 year = 2001
 month = 12
 day = 19
 language = R

Search Path:
 .GlobalEnv, package:MASS, package:prlib, package:pllib, package:mathlib,
package:mva, package:strlib, package:chlib, Autoloads, package:base

Dr.sc.math.Christian W. Hoffmann
Mathematics and Statistical Computing
Landscape Modeling and Web Applications
Swiss Federal Research Institute WSL 
Zuercherstrasse 111
CH-8903 Birmensdorf, Switzerland
phone: ++41-1-739 22 77    fax: ++41-1-739 22 15
e-mail: christian.hoffmann_at_wsl.ch__prevent_spamming
www: http://www.wsl.ch/staff/christian.hoffmann/


==> 1240.followup.2 <==
From postmaster@franz.stat.wisc.edu  Fri Jan  4 14:20:52 2002
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id OAA07212
	for <r-bugs@biostat.ku.dk>; Fri, 4 Jan 2002 14:20:51 +0100 (MET)
Received: from tal.stat.umu.se (really [130.239.56.32]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m16MUGm-000IZ3C@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Fri, 4 Jan 2002 07:20:24 -0600 (CST) 
Received: from localhost (gb@localhost)
	by tal.stat.umu.se (8.11.6/8.11.6) with ESMTP id g04DIB903273;
	Fri, 4 Jan 2002 14:18:11 +0100
X-Authentication-Warning: tal.stat.umu.se: gb owned process doing -bs
Date: Fri, 4 Jan 2002 14:18:11 +0100 (CET)
From: =?iso-8859-1?Q?G=F6ran_Brostr=F6m?= <gb@stat.umu.se>
To: Christian Hoffmann <christian.hoffmann@wsl.ch>
cc: <hoffmann@wsl.ch>, <r-bugs@r-project.org>
Subject: Re: [Rd] R CMD check (PR#1240)
In-Reply-To: <3.0.6.32.20020104133334.00df4060@mail.wsl.ch>
Message-ID: <Pine.LNX.4.33.0201041416500.3268-100000@tal.stat.umu.se>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=iso-8859-1
Content-Transfer-Encoding: 8BIT

Christian,

The answer I got from Thomas was 644 for files and 755 for directories.
It worked for me.

Göran

On Fri, 4 Jan 2002, Christian Hoffmann wrote:

> Göran,
> 
> After  chmod 644 * I got some success:
> 
> hoffmann@fluke:~/R/Sources >R CMD check chlib
> * checking for working latex ... OK
> * using log directory `/home/woodstock/hoffmann/R/Sources/chlib.Rcheck'
> 
> Installing *binary* package `chlib' ...
>  DONE (chlib)
> 
> DONE (INSTALL)
> 
> * checking for file `chlib/DESCRIPTION' ... OK
> * checking package directory ... OK
> * checking for sufficient/correct file permissions ... OK
> * checking DESCRIPTION Package field ... OK
> * checking DESCRIPTION Version field ... OK
> * checking DESCRIPTION License field ... OK
> * checking DESCRIPTION Description field ... OK
> * checking DESCRIPTION Title field ... OK
> * checking DESCRIPTION Author field ... OK
> * checking DESCRIPTION Maintainer field ... OK
> * checking DESCRIPTION Depends field ... OK
> * checking R files for syntax errors ... OK
> * checking R files for library.dynam ...Error: cannot open file
> `/home/woodstock/hoffmann/R/Sources/chlib.Rcheck/chlib/R/chlib' for reading
> at /usr/local/lib/R/bin/check line 522.
> 
> What can this be?
> 
> Thanks for help
> 
> --christian
> 
> At 13:10 04.01.2002 +0100, Göran Broström wrote:
> >I asked the same question some days ago. I have:
> >
> >-rw-r--r--    1 gb       gb           4070 Dec 30 10:13 statistics.c
> >
> >which works. Maybe 644? Check archives, I have lost the answer I got.
> >
> >Göran
> >
> 
> 
> 
> Version:
>  platform = sparc-sun-solaris2.7
>  arch = sparc
>  os = solaris2.7
>  system = sparc, solaris2.7
>  status = 
>  major = 1
>  minor = 4.0
>  year = 2001
>  month = 12
>  day = 19
>  language = R
> 
> Search Path:
>  .GlobalEnv, package:MASS, package:prlib, package:pllib, package:mathlib,
> package:mva, package:strlib, package:chlib, Autoloads, package:base
> 
> Dr.sc.math.Christian W. Hoffmann
> Mathematics and Statistical Computing
> Landscape Modeling and Web Applications
> Swiss Federal Research Institute WSL 
> Zuercherstrasse 111
> CH-8903 Birmensdorf, Switzerland
> phone: ++41-1-739 22 77    fax: ++41-1-739 22 15
> e-mail: christian.hoffmann_at_wsl.ch__prevent_spamming
> www: http://www.wsl.ch/staff/christian.hoffmann/
> 

-- 
 Göran Broström                      tel: +46 90 786 5223
 professor                           fax: +46 90 786 6614
 Department of Statistics            http://www.stat.umu.se/egna/gb/
 Umeå University
 SE-90187 Umeå, Sweden             e-mail: gb@stat.umu.se


==> 1240.reply.1 <==
From hornik@ci.tuwien.ac.at  Fri Jan  4 22:01:18 2002
Received: from mr.tuwien.ac.at (mr.tuwien.ac.at [128.130.2.10])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA11883
	for <R-bugs@biostat.ku.dk>; Fri, 4 Jan 2002 22:01:18 +0100 (MET)
Received: from mithrandir.hornik.net (b76.dialin.tuwien.ac.at [192.35.240.206])
	by mr.tuwien.ac.at (8.12.0/8.12.0) with ESMTP id g04L0nNh012455;
	Fri, 4 Jan 2002 22:00:50 +0100 (MET)
Received: from hornik by mithrandir.hornik.net with local (Exim 3.33 #1 (Debian))
	id 16MaNQ-0005nr-00; Fri, 04 Jan 2002 20:51:40 +0100
From: Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit
Message-ID: <15414.1996.510707.189484@mithrandir.hornik.net>
Date: Fri, 4 Jan 2002 20:51:40 +0100
To: christian.hoffmann@wsl.ch
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] R CMD check (PR#1240)
In-Reply-To: <200201041234.NAA06142@pubhealth.ku.dk>
References: <200201041234.NAA06142@pubhealth.ku.dk>
X-Mailer: VM 6.99 under Emacs 20.7.2
Reply-To: Kurt.Hornik@ci.tuwien.ac.at
Sender: Kurt Hornik <hornik@mithrandir.hornik.net>

>>>>> christian hoffmann writes:

> Göran,
> After  chmod 644 * I got some success:

> hoffmann@fluke:~/R/Sources >R CMD check chlib
> * checking for working latex ... OK
> * using log directory `/home/woodstock/hoffmann/R/Sources/chlib.Rcheck'

> Installing *binary* package `chlib' ...
>  DONE (chlib)

Why does it say *binary* package?
R CMD check is meant for sources ...

-k
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1283 *
Subject: max/min of NULL gives MININT/MAXINT instead of -INF/+INF
From: "Warnes, Gregory R" <gregory_r_warnes@groton.pfizer.com>
Date: Fri, 25 Jan 2002 14:36:52 -0500
--this was on purpose (type preserving); R 1.4.1 at least documents this
--We currently plan to return -/+ Inf from 1.5.0 on		-- MMä
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1283 <==
From gregory_r_warnes@groton.pfizer.com  Fri Jan 25 20:38:27 2002
Received: from mailrelay5.pfizer.com (ns2.pfizer.com [192.77.198.2])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id UAA05647
	for <r-bugs@biostat.ku.dk>; Fri, 25 Jan 2002 20:38:24 +0100 (MET)
Received: from gsun34.pfizer.com (localhost [127.0.0.1])
	by mailrelay5.pfizer.com (Switch-2.1.3/Switch-2.1.0) with ESMTP id g0PJbLl27214
	for <r-bugs@biostat.ku.dk>; Fri, 25 Jan 2002 14:37:21 -0500 (EST)
Received: from groexms01.pfizer.com (localhost [127.0.0.1])
	by gsun34.pfizer.com (Pro-8.9.3/Pro-8.9.3) with ESMTP id OAA02493
	for <r-bugs@biostat.ku.dk>; Fri, 25 Jan 2002 14:40:18 -0500 (EST)
Received: from groexcncr01.pfizer.com (unverified) by groexms01.pfizer.com
 (Content Technologies SMTPRS 4.2.1) with ESMTP id <T58aa7c947dac1e08e227a@groexms01.pfizer.com> for <r-bugs@biostat.ku.dk>;
 Fri, 25 Jan 2002 14:36:53 -0500
Received: by groexcncr01.pfizer.com with Internet Mail Service (5.5.2654.89)
	id <DNZZLDDR>; Fri, 25 Jan 2002 14:36:53 -0500
Message-ID: <5429125E11E4D411AF7300805FE603A8040DE54D@groexmbcr02.pfizer.com>
From: "Warnes, Gregory R" <gregory_r_warnes@groton.pfizer.com>
To: "'R-bugs'" <r-bugs@biostat.ku.dk>
Subject: max/min of NULL gives MININT/MAXINT instead of -INF/+INF
Date: Fri, 25 Jan 2002 14:36:52 -0500
MIME-Version: 1.0
X-Mailer: Internet Mail Service (5.5.2654.89)
Content-Type: text/plain; charset="windows-1252"

R Version 1.4.0 Patched (2002-01-23)
Solaris 5.8

I just noticed that max(NULL) gives a strange result:

	> max(NULL)
	[1] -2147483647
	Warning message: 
	no finite arguments to min/max; returning extreme. in: max(...,
na.rm = na.rm) 

I discovered this when I did something like

	max(object$element)

for an incorrect element name.  The warning  message was helpful, but I was
still surprised to get a negative integer from this operation.  

In playing around, I see that using numeric summary operations on NULL or
numeric(0) gives inconsistent results:

For NULL:

	> max(NULL)
	[1] -2147483647
	Warning message: 
	no finite arguments to min/max; returning extreme. in: max(...,
na.rm = na.rm) 

	> min(NULL)
	[1] 2147483647
	Warning message: 
	no finite arguments to min/max; returning extreme. in: min(...,
na.rm = na.rm) 

	> mean(NULL)
	[1] NA
	Warning message: 
	argument is not numeric or logical: returning NA in:
mean.default(NULL) 

	> sum(NULL)
	[1] 0

	> range(NULL)
	[1] NA NA
 

For numeric(0):

	> max(numeric(0))
	[1] -Inf
	Warning message: 
	no finite arguments to min/max; returning extreme. in: max(...,
na.rm = na.rm) 

	> min(numeric(0))
	[1] Inf
	Warning message: 
	no finite arguments to min/max; returning extreme. in: min(...,
na.rm = na.rm) 

	> mean(numeric(0))
	[1] NaN

	> sum(numeric(0))
	[1] 0
	
	> range(numeric(0))
	[1] NA NA


I'm not sure that it really makes sense return the extremes when min/max are
called with numeric(0) or NULL arguments.  It seems that returning NA in all
of these cases (including sum) would be best, since such operations usually
indicate an error of some sort.

Still, if one insists that min/max should return the extremes, when they
operate on NULL they should at least return the floating point +INF / -INF
so that things don't get really strange when they get compared with floating
point numbers.

-Greg






LEGAL NOTICE
Unless expressly stated otherwise, this message is confidential and may be privileged. It is intended for the addressee(s) only. Access to this E-mail by anyone else is unauthorized. If you are not an addressee, any disclosure or copying of the contents of this E-mail or any action taken (or not taken) in reliance on it is unauthorized and may be unlawful. If you are not an addressee, please inform the sender immediately.

==> 1283.audit <==
Wed Jan 30 15:45:27 2002	maechler	changed notes
Wed Jan 30 15:45:27 2002	maechler	foobar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1284 *
Subject: make check fails when R_HOME env var set
From: "Warnes, Gregory R" <gregory_r_warnes@groton.pfizer.com>
Date: Fri, 25 Jan 2002 15:08:33 -0500
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1284 <==
From gregory_r_warnes@groton.pfizer.com  Fri Jan 25 21:10:43 2002
Received: from mailrelay5.pfizer.com (ns2.pfizer.com [192.77.198.2])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id VAA05804
	for <r-bugs@biostat.ku.dk>; Fri, 25 Jan 2002 21:10:42 +0100 (MET)
Received: from gsun34.pfizer.com (localhost [127.0.0.1])
	by mailrelay5.pfizer.com (Switch-2.1.3/Switch-2.1.0) with ESMTP id g0PK9Zl22034
	for <r-bugs@biostat.ku.dk>; Fri, 25 Jan 2002 15:09:36 -0500 (EST)
Received: from groexms02.pfizer.com (localhost [127.0.0.1])
	by gsun34.pfizer.com (Pro-8.9.3/Pro-8.9.3) with ESMTP id PAA24508
	for <r-bugs@biostat.ku.dk>; Fri, 25 Jan 2002 15:12:26 -0500 (EST)
Received: from groexcncr05.pfizer.com (unverified) by groexms02.pfizer.com
 (Content Technologies SMTPRS 4.2.1) with ESMTP id <T58aa99a12eac1e08e4230@groexms02.pfizer.com> for <r-bugs@biostat.ku.dk>;
 Fri, 25 Jan 2002 15:08:37 -0500
Received: by groexcncr05.pfizer.com with Internet Mail Service (5.5.2654.89)
	id <DR9BHZ80>; Fri, 25 Jan 2002 15:08:36 -0500
Message-ID: <5429125E11E4D411AF7300805FE603A8040DE550@groexmbcr02.pfizer.com>
From: "Warnes, Gregory R" <gregory_r_warnes@groton.pfizer.com>
To: "'R-bugs'" <r-bugs@biostat.ku.dk>
Subject: make check fails when R_HOME env var set
Date: Fri, 25 Jan 2002 15:08:33 -0500
MIME-Version: 1.0
X-Mailer: Internet Mail Service (5.5.2654.89)
Content-Type: text/plain; charset="windows-1252"

	
When the R_HOME environment variable is set, R issues a warning messages
when it starts up.  When doing 'make check' this causes the check for
eval-etc.R to fail:
	
	[...]
	make[3]: Leaving directory
`/Volumes/app/R/src/R-1.4.0_patched_2002-01-24/tests'
	running strict specific tests
	make[3]: Entering directory
`/Volumes/app/R/src/R-1.4.0_patched_2002-01-24/tests'
	running code in `eval-etc.R' ... OK
	comparing `eval-etc.Rout' to `./eval-etc.Rout.save' ...1d0
	< WARNING: ignoring environment value of R_HOME
	make[3]: *** [eval-etc.Rout] Error 1
	make[3]: Leaving directory
`/Volumes/app/R/src/R-1.4.0_patched_2002-01-24/tests'
	make[2]: *** [test-Specific] Error 2
	make[2]: Leaving directory
`/Volumes/app/R/src/R-1.4.0_patched_2002-01-24/tests'
	make[1]: *** [test-all-basics] Error 1
	make[1]: Leaving directory
`/Volumes/app/R/src/R-1.4.0_patched_2002-01-24/tests'
	make: *** [check] Error 2

This is, of course easily worked around by unsetting R_HOME and removing it
from the shell startup scripts, but this is incovienient when R_HOME needs
to be set for other reasons (e.g. to allow the Python interface to R
'RSPython' to find the R code it needs).

It already appears that the version strings are filtered out when testing
for difference between the versions.  Is it possible to filter out the
environment variable warning message as well? 

-Greg


LEGAL NOTICE
Unless expressly stated otherwise, this message is confidential and may be privileged. It is intended for the addressee(s) only. Access to this E-mail by anyone else is unauthorized. If you are not an addressee, any disclosure or copying of the contents of this E-mail or any action taken (or not taken) in reliance on it is unauthorized and may be unlawful. If you are not an addressee, please inform the sender immediately.

==> 1284.followup.1 <==
From andy_liaw@merck.com  Fri Jan 25 22:16:52 2002
Received: from usryws03.merck.com (bugs.merck.com [155.91.6.30])
	by pubhealth.ku.dk (8.9.3/8.9.1) with SMTP id WAA06024
	for <R-bugs@biostat.ku.dk>; Fri, 25 Jan 2002 22:16:51 +0100 (MET)
Received: from 155.91.2.6 by usryws03.merck.com with ESMTP (SMTP Relay (
 MMS v4.7)); Fri, 25 Jan 2002 16:14:03 -0500
X-Server-Uuid: 7a42c1b6-0774-11d5-89f7-00508bcf402e
Return-receipt-to: andy_liaw@merck.com
Received: from usrygw03.merck.com (usrygw03.merck.com [54.3.102.169]) by
 mmh1.merck.com (PMDF V6.0-24 #37353) with ESMTP id
 <01KDHSZM7BII00VYOE@mmh1.merck.com>; Fri, 25 Jan 2002 16:15:47 -0500 (
 EST)
Received: by usrygw03.merck.com with Internet Mail Service (5.5.2653.19)
 id <C0XGJCCA>; Fri, 25 Jan 2002 16:15:47 -0500
Content-return: allowed
Date: Fri, 25 Jan 2002 16:15:45 -0500
From: "Liaw, Andy" <andy_liaw@merck.com>
Subject: RE: [Rd] make check fails when R_HOME env var set (PR#1284)
To: "'gregory_r_warnes@groton.pfizer.com'"
	<gregory_r_warnes@groton.pfizer.com>,
        r-devel@stat.math.ethz.ch
cc: R-bugs@biostat.ku.dk
Message-ID: <51F9C42DA15CD311BD220008C707D81903DC850B@usrymx10.merck.com>
MIME-Version: 1.0
X-Mailer: Internet Mail Service (5.5.2653.19)
X-WSS-ID: 104F1511222452-02-01
Content-Type: text/plain; 
 charset=us-ascii
Content-Transfer-Encoding: 7bit

I also fell into that trap a couple of times, but it doesn't really bother
me, since it's, IMHO, a real minor inconvenience.

(In bash, under Linux:)  Would the following work?  Haven't tried...

  R_HOME="" make check

Andy

> -----Original Message-----
> From: gregory_r_warnes@groton.pfizer.com
> [mailto:gregory_r_warnes@groton.pfizer.com]
> Sent: Friday, January 25, 2002 3:11 PM
> To: r-devel@stat.math.ethz.ch
> Cc: R-bugs@biostat.ku.dk
> Subject: [Rd] make check fails when R_HOME env var set (PR#1284)
> 
> 
> 	
> When the R_HOME environment variable is set, R issues a 
> warning messages
> when it starts up.  When doing 'make check' this causes the check for
> eval-etc.R to fail:
> 	
> 	[...]
> 	make[3]: Leaving directory
> `/Volumes/app/R/src/R-1.4.0_patched_2002-01-24/tests'
> 	running strict specific tests
> 	make[3]: Entering directory
> `/Volumes/app/R/src/R-1.4.0_patched_2002-01-24/tests'
> 	running code in `eval-etc.R' ... OK
> 	comparing `eval-etc.Rout' to `./eval-etc.Rout.save' ...1d0
> 	< WARNING: ignoring environment value of R_HOME
> 	make[3]: *** [eval-etc.Rout] Error 1
> 	make[3]: Leaving directory
> `/Volumes/app/R/src/R-1.4.0_patched_2002-01-24/tests'
> 	make[2]: *** [test-Specific] Error 2
> 	make[2]: Leaving directory
> `/Volumes/app/R/src/R-1.4.0_patched_2002-01-24/tests'
> 	make[1]: *** [test-all-basics] Error 1
> 	make[1]: Leaving directory
> `/Volumes/app/R/src/R-1.4.0_patched_2002-01-24/tests'
> 	make: *** [check] Error 2
> 
> This is, of course easily worked around by unsetting R_HOME 
> and removing it
> from the shell startup scripts, but this is incovienient when 
> R_HOME needs
> to be set for other reasons (e.g. to allow the Python interface to R
> 'RSPython' to find the R code it needs).
> 
> It already appears that the version strings are filtered out 
> when testing
> for difference between the versions.  Is it possible to filter out the
> environment variable warning message as well? 
> 
> -Greg
> 
> 
> LEGAL NOTICE
> Unless expressly stated otherwise, this message is 
> confidential and may be privileged. It is intended for the 
> addressee(s) only. Access to this E-mail by anyone else is 
> unauthorized. If you are not an addressee, any disclosure or 
> copying of the contents of this E-mail or any action taken 
> (or not taken) in reliance on it is unauthorized and may be 
> unlawful. If you are not an addressee, please inform the 
> sender immediately.
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.
> -.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read 
> http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: 
> r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._.
> _._._._._._._._._
> 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1299 *
Subject: testing
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 07 Feb 2002 16:54:23 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1299 <==
From postmaster@franz.stat.wisc.edu Thu Feb  7 16:54:57 2002
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA05568
	for <r-bugs@biostat.ku.dk>; Thu, 7 Feb 2002 16:54:56 +0100 (MET)
Received: from pubhealth.ku.dk (really [192.38.18.10]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m16YqsR-000IbFC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Thu, 7 Feb 2002 09:54:23 -0600 (CST) 
Received: from blueberry.kubism.ku.dk (blueberry [192.38.19.4])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA05564
	for <r-bugs@r-project.org>; Thu, 7 Feb 2002 16:54:37 +0100 (MET)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id g17FsOS00474;
	Thu, 7 Feb 2002 16:54:24 +0100
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: r-bugs@r-project.org
Subject: testing
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 07 Feb 2002 16:54:23 +0100
Message-ID: <x27kppe18w.fsf@blueberry.kubism.ku.dk>
Lines: 6
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Length: 295
Status: RO

Just testing the email interface...
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1300 *
Subject: FW: layout and piechart diameter problem
From: "Warnes, Gregory R" <gregory_r_warnes@groton.pfizer.com>
Date: Thu, 7 Feb 2002 11:05:15 -0500 
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1300 <==
From gregory_r_warnes@groton.pfizer.com Thu Feb  7 17:06:56 2002
Received: from mailrelay1.pfizer.com (ns2.pfizer.com [192.77.198.2])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id RAA05738
	for <r-bugs@biostat.ku.dk>; Thu, 7 Feb 2002 17:06:55 +0100 (MET)
Received: from gsun56.pfizer.com (localhost [127.0.0.1])
	by mailrelay1.pfizer.com (8.9.3/Pro-8.9.3) with ESMTP id LAA25035
	for <r-bugs@biostat.ku.dk>; Thu, 7 Feb 2002 11:05:53 -0500 (EST)
Received: from groexms02.pfizer.com (localhost [127.0.0.1])
	by gsun56.pfizer.com (Pro-8.9.3/Pro-8.9.3) with ESMTP id LAA08185
	for <r-bugs@biostat.ku.dk>; Thu, 7 Feb 2002 11:07:32 -0500 (EST)
Received: from groexcncr01.pfizer.com (unverified) by groexms02.pfizer.com
 (Content Technologies SMTPRS 4.2.1) with ESMTP id <T58ecad88b1ac1e08e42e9@groexms02.pfizer.com> for <r-bugs@biostat.ku.dk>;
 Thu, 7 Feb 2002 11:05:17 -0500
Received: by groexcncr01.pfizer.com with Internet Mail Service (5.5.2654.89)
	id <1KVC00AM>; Thu, 7 Feb 2002 11:05:17 -0500
Message-ID: <5429125E11E4D411AF7300805FE603A8040DE623@groexmbcr02.pfizer.com>
From: "Warnes, Gregory R" <gregory_r_warnes@groton.pfizer.com>
To: "'R-bugs'" <r-bugs@biostat.ku.dk>
Subject: FW: layout and piechart diameter problem
Date: Thu, 7 Feb 2002 11:05:15 -0500 
MIME-Version: 1.0
X-Mailer: Internet Mail Service (5.5.2654.89)
Content-Type: text/plain; charset="windows-1252"
Content-Length: 2315
Status: R


Third try...

>  -----Original Message-----
> From: 	Warnes, Gregory R  
> Sent:	Tuesday, February 05, 2002 4:12 PM
> To:	'R-bugs'
> Subject:	layout and piechart diameter problem
> 
> 
> I've been using layout to create some graphics pages which include pie
> charts.   (NB: No piechart arguments please, the main chart on the page is
> a proper bar chart representing the same information.)
> 
> When I plot pie charts in a column, the piechart at the top of a column is
> always smaller than the others:  
> 
> For example:
> 
> 	layout( matrix(c(1,1,2,
>                        1,1,3,
>                        1,1,4), ncol=3, byrow=T))
> 	for(i in 1:4) piechart( 1:3 )
> 
> In column 3, the first piechart has a radius something like 2/3 of the
> others.
> 
> This also happens for:
> 
> 	layout( matrix(c(1,2,
>                        1,3,
>                        1,4), ncol=2, byrow=T))
> 	for(i in 1:4) piechart( 1:3 )
> 
> 
> For this: 
> 
> 	layout( matrix(c(1,3,
>                        1,4,
>                        2,5), ncol=2, byrow=T))
> 	for(i in 1:5) piechart( 1:3 )
> 
> the piechart at the bottom left is smaller than the three in the second
> column:
> 
> 
> This occurs both on the x11 and postscript devices, although it is less
> noticeable on the latter.  It doesn't seem happen for 'hist' or 'plot'. As
> I've only recently started using layout, I don't know if this occurs with
> other plotting devices or commands.  
> 
> -Greg
> 
> ------
> 
> > version
>          _                   
> platform sparc-sun-solaris2.8
> arch     sparc               
> os       solaris2.8          
> system   sparc, solaris2.8   
> status                       
> major    1                   
> minor    4.1                 
> year     2002                
> month    01                  
> day      30                  
> language R                   
> 
> 


LEGAL NOTICE
Unless expressly stated otherwise, this message is confidential and may be privileged. It is intended for the addressee(s) only. Access to this E-mail by anyone else is unauthorized. If you are not an addressee, any disclosure or copying of the contents of this E-mail or any action taken (or not taken) in reliance on it is unauthorized and may be unlawful. If you are not an addressee, please inform the sender immediately.


==> 1300.followup.1 <==
From ligges@amadeus.statistik.uni-dortmund.de  Thu Feb  7 22:54:23 2002
Received: from nx5.HRZ.Uni-Dortmund.DE (nx5.HRZ.Uni-Dortmund.DE [129.217.131.21])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA07015
	for <R-bugs@biostat.ku.dk>; Thu, 7 Feb 2002 22:54:23 +0100 (MET)
Received: from amadeus.statistik.uni-dortmund.de by nx5.HRZ.Uni-Dortmund.DE
          via smtp-local with ESMTP; Thu, 7 Feb 2002 22:53:27 +0100
Received: from statistik.uni-dortmund.de (dial-142015.HRZ.Uni-Dortmund.DE [129.217.142.15])
	by amadeus.statistik.uni-dortmund.de (8.10.2+Sun/8.10.2) with ESMTP id g17LrPS08216;
	Thu, 7 Feb 2002 22:53:25 +0100 (MET)
Message-ID: <3C62F7A1.8BF78BAC@statistik.uni-dortmund.de>
Date: Thu, 07 Feb 2002 22:54:41 +0100
From: Uwe Ligges <ligges@statistik.uni-dortmund.de>
X-Mailer: Mozilla 4.79 [en] (Windows NT 5.0; U)
X-Accept-Language: en
MIME-Version: 1.0
To: gregory_r_warnes@groton.pfizer.com
CC: R-bugs@biostat.ku.dk
Subject: Re: [Rd] FW: layout and piechart diameter problem (PR#1300)
References: <200202071812.TAA06359@pubhealth.ku.dk>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

gregory_r_warnes@groton.pfizer.com wrote:
> 
> Third try...
> 
> >  -----Original Message-----
> > From:         Warnes, Gregory R
> > Sent: Tuesday, February 05, 2002 4:12 PM
> > To:   'R-bugs'
> > Subject:      layout and piechart diameter problem
> >
> >
> > I've been using layout to create some graphics pages which include pie
> > charts.   (NB: No piechart arguments please, the main chart on the page is
> > a proper bar chart representing the same information.)
> >
> > When I plot pie charts in a column, the piechart at the top of a column is
> > always smaller than the others:
> >
> > For example:
> >
> >       layout( matrix(c(1,1,2,
> >                        1,1,3,
> >                        1,1,4), ncol=3, byrow=T))
> >       for(i in 1:4) piechart( 1:3 )
> >
> > In column 3, the first piechart has a radius something like 2/3 of the
> > others.
> >
> > This also happens for:
> >
> >       layout( matrix(c(1,2,
> >                        1,3,
> >                        1,4), ncol=2, byrow=T))
> >       for(i in 1:4) piechart( 1:3 )
> >
> >
> > For this:
> >
> >       layout( matrix(c(1,3,
> >                        1,4,
> >                        2,5), ncol=2, byrow=T))
> >       for(i in 1:5) piechart( 1:3 )
> >
> > the piechart at the bottom left is smaller than the three in the second
> > column:
> >
> >
> > This occurs both on the x11 and postscript devices, although it is less
> > noticeable on the latter.  It doesn't seem happen for 'hist' or 'plot'. As
> > I've only recently started using layout, I don't know if this occurs with
> > other plotting devices or commands.

Probably only if the functions are making use of par("pin") (and friends
?) as piechart() does:

layout(matrix(c(1,1,2, 1,1,3, 1,1,4), ncol=3, byrow=TRUE))
par("pin")
plot(1); par("pin")  # Here it goes wrong for the next plot.
plot(1); par("pin")
plot(1); par("pin")
plot(1)


Uwe Ligges

==> 1300.followup.2 <==
From ligges@amadeus.statistik.uni-dortmund.de  Thu Feb  7 22:59:11 2002
Received: from nx5.HRZ.Uni-Dortmund.DE (nx5.HRZ.Uni-Dortmund.DE [129.217.131.21])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA07044
	for <R-bugs@biostat.ku.dk>; Thu, 7 Feb 2002 22:59:11 +0100 (MET)
Received: from amadeus.statistik.uni-dortmund.de by nx5.HRZ.Uni-Dortmund.DE
          via smtp-local with ESMTP; Thu, 7 Feb 2002 22:58:27 +0100
Received: from statistik.uni-dortmund.de (dial-142015.HRZ.Uni-Dortmund.DE [129.217.142.15])
	by amadeus.statistik.uni-dortmund.de (8.10.2+Sun/8.10.2) with ESMTP id g17LwQS08237;
	Thu, 7 Feb 2002 22:58:26 +0100 (MET)
Message-ID: <3C62F8CE.85E07095@statistik.uni-dortmund.de>
Date: Thu, 07 Feb 2002 22:59:42 +0100
From: Uwe Ligges <ligges@statistik.uni-dortmund.de>
X-Mailer: Mozilla 4.79 [en] (Windows NT 5.0; U)
X-Accept-Language: en
MIME-Version: 1.0
To: gregory_r_warnes@groton.pfizer.com, R-bugs@biostat.ku.dk
Subject: Re: [Rd] FW: layout and piechart diameter problem (PR#1300)
References: <200202071812.TAA06359@pubhealth.ku.dk> <3C62F7A1.8BF78BAC@statistik.uni-dortmund.de>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit



Uwe Ligges wrote:
> 
> gregory_r_warnes@groton.pfizer.com wrote:
> >
> > Third try...
> >
> > >  -----Original Message-----
> > > From:         Warnes, Gregory R
> > > Sent: Tuesday, February 05, 2002 4:12 PM
> > > To:   'R-bugs'
> > > Subject:      layout and piechart diameter problem
> > >
> > >
> > > I've been using layout to create some graphics pages which include pie
> > > charts.   (NB: No piechart arguments please, the main chart on the page is
> > > a proper bar chart representing the same information.)
> > >
> > > When I plot pie charts in a column, the piechart at the top of a column is
> > > always smaller than the others:
> > >
> > > For example:
> > >
> > >       layout( matrix(c(1,1,2,
> > >                        1,1,3,
> > >                        1,1,4), ncol=3, byrow=T))
> > >       for(i in 1:4) piechart( 1:3 )
> > >
> > > In column 3, the first piechart has a radius something like 2/3 of the
> > > others.
> > >
> > > This also happens for:
> > >
> > >       layout( matrix(c(1,2,
> > >                        1,3,
> > >                        1,4), ncol=2, byrow=T))
> > >       for(i in 1:4) piechart( 1:3 )
> > >
> > >
> > > For this:
> > >
> > >       layout( matrix(c(1,3,
> > >                        1,4,
> > >                        2,5), ncol=2, byrow=T))
> > >       for(i in 1:5) piechart( 1:3 )
> > >
> > > the piechart at the bottom left is smaller than the three in the second
> > > column:
> > >
> > >
> > > This occurs both on the x11 and postscript devices, although it is less
> > > noticeable on the latter.  It doesn't seem happen for 'hist' or 'plot'. As
> > > I've only recently started using layout, I don't know if this occurs with
> > > other plotting devices or commands.
> 
> Probably only if the functions are making use of par("pin") (and friends
> ?) as piechart() does:
> 
> layout(matrix(c(1,1,2, 1,1,3, 1,1,4), ncol=3, byrow=TRUE))
> par("pin")
> plot(1); par("pin")  # Here it goes wrong for the next plot.
> plot(1); par("pin")
> plot(1); par("pin")
> plot(1)

And let me add, it is everytime the second one:

layout(matrix(c(1,3, 1,4, 2,5), ncol=2, byrow=TRUE))
for(i in 1:5) piechart( 1:3 )

layout(matrix(c(1,2, 1,4, 3,5), ncol=2, byrow=TRUE))
for(i in 1:5) piechart( 1:3 )

layout(matrix(c(1,3, 1,2, 4,5), ncol=2, byrow=TRUE))
for(i in 1:5) piechart( 1:3 )

Uwe
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1301 *
Subject: incorrect handling of arrays of list elements
From: =?iso-8859-1?Q?Jens=20Oehlschl=E4gel?= <joehl@web.de>
Date: Thu, 7 Feb 2002 13:43:19 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1301 <==
From postmaster@franz.stat.wisc.edu Thu Feb  7 13:44:21 2002
Received: from franz.stat.wisc.edu (root@franz.stat.wisc.edu [128.105.174.95])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id NAA03067
	for <r-bugs@biostat.ku.dk>; Thu, 7 Feb 2002 13:44:19 +0100 (MET)
Received: from mailgate5.cinetic.de (really [217.72.192.165]) by franz.stat.wisc.edu
	via smail with esmtp
	id <m16Yntt-000IbwC@franz.stat.wisc.edu> (Debian Smail3.2.0.114)
	for <r-bugs@r-project.org>; Thu, 7 Feb 2002 06:43:41 -0600 (CST) 
Received: from web.de (fmomail02.dlan.cinetic.de [172.20.1.46])
	by mailgate5.cinetic.de (8.11.2/8.11.2/SuSE Linux 8.11.0-0.4) with SMTP id g17ChIv06907
	for r-bugs@r-project.org; Thu, 7 Feb 2002 13:43:19 +0100
Date: Thu, 7 Feb 2002 13:43:19 +0100
Message-Id: <200202071243.g17ChIv06907@mailgate5.cinetic.de>
MIME-Version: 1.0
Organization: http://freemail.web.de/
From: =?iso-8859-1?Q?Jens=20Oehlschl=E4gel?= <joehl@web.de>
To: r-bugs@r-project.org
Subject: incorrect handling of arrays of list elements
Precedence: fm-user
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
Content-Length: 3304
Status: RO



After checking with the prototype I hope the following to justifies a bug-report:

# you find pure replication syntax at the end


> # the prototype allows for the following, which fails in R
> matrix(vector("list", 6), 3, 2)
Error in matrix(vector("list", 6), 3, 2) : 
        Unimplemented feature in copyVector
> 
> # however the desired object seems to be legally in R as we get the same via
> tt <- vector("list", 6)
> dim(tt) <- c(3,2)
> tt
     [,1]   [,2]  
[1,] "NULL" "NULL"
[2,] "NULL" "NULL"
[3,] "NULL" "NULL"
> 
> # preparing to show further problems
> tt[[1,1]] <- letters
> tt
     [,1]           [,2]  
[1,] "Character,26" "NULL"
[2,] "NULL"         "NULL"
[3,] "NULL"         "NULL"
> 
> # works fine
> tt[[1,1]]
 [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k" "l" "m" "n" "o" "p" "q" "r" "s" "t" "u" "v" "w" "x" "y" "z"
> 
> # the prototype allows subscripting and assigning to subscripted such objects 
> 
> # erroneously NULL in R
> tt[1,1]
[[1]]
NULL

> 
> # erroneously NULL in R
> tt[1,]
[[1]]
NULL

[[2]]
NULL

> 
> # erroneously NULL in R
> tt[, 1]
[[1]]
NULL

[[2]]
NULL

[[3]]
NULL

> 
> # erroneously NULL in R
> tt[,]
     [,1]   [,2]  
[1,] "NULL" "NULL"
[2,] "NULL" "NULL"
[3,] "NULL" "NULL"
> 
> # fine in R
> tt[]
     [,1]           [,2]  
[1,] "Character,26" "NULL"
[2,] "NULL"         "NULL"
[3,] "NULL"         "NULL"
> 
> # fine in R
> tt[cbind(1,1)]
[[1]]
 [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k" "l" "m" "n" "o" "p" "q" "r" "s" "t" "u" "v" "w" "x" "y" "z"

> 
> # of course the same problems in assignments 
> tt[1,1] <- tt[1,1]
Error: incompatible types in subset assignment
> tt[1,1] <- list(letters)
Error: incompatible types in subset assignment
> tt[1,] <- tt[1,]
Error: incompatible types in subset assignment
> tt[,1] <- tt[,1]
Error: incompatible types in subset assignment
> tt[,] <- tt[,]
Error: incompatible types in subset assignment
> 
> # and again fine
> tt[[1]] <- tt[[1]] 
> tt[] <- tt[]
> tt[cbind(1,1)] <- tt[cbind(1,1)] 
> 


# the prototype allows for the following, which fails in R
matrix(vector("list", 6), 3, 2)

# however the desired object seems to be legally in R as we get the same via
tt <- vector("list", 6)
dim(tt) <- c(3,2)
tt

# preparing to show further problems
tt[[1,1]] <- letters
tt

# works fine
tt[[1,1]]

# the prototype allows subscripting and assigning to subscripted such objects 

# erroneously NULL in R
tt[1,1]

# erroneously NULL in R
tt[1,]

# erroneously NULL in R
tt[, 1]

# erroneously NULL in R
tt[,]

# fine in R
tt[]

# fine in R
tt[cbind(1,1)]

# of course the same problems in assignments 
tt[1,1] <- tt[1,1]
tt[1,1] <- list(letters)
tt[1,] <- tt[1,]
tt[,1] <- tt[,1]
tt[,] <- tt[,]

# and again fine
tt[[1]] <- tt[[1]] 
tt[] <- tt[]
tt[cbind(1,1)] <- tt[cbind(1,1)] 



> version
         _              
platform i386-pc-mingw32
arch     x86            
os       Win32          
system   x86, Win32     
status                  
major    1              
minor    4.1            
year     2002           
month    01             
day      30             
language R 



Best regards

Jens Oehlschlaegel

________________________________________________________________
Keine verlorenen Lotto-Quittungen, keine vergessenen Gewinne mehr! 
Beim WEB.DE Lottoservice: http://tippen2.web.de/?x=13



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1302 *
Subject: Re: [R] expressions in legends
From: Uwe Ligges <ligges@statistik.uni-dortmund.de>
Date: Mon, 04 Feb 2002 16:42:46 +0100
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1302 <==
From ligges@amadeus.statistik.uni-dortmund.de Mon Feb  4 16:44:57 2002
Received: from nx5.HRZ.Uni-Dortmund.DE (nx5.HRZ.Uni-Dortmund.DE [129.217.131.21])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id QAA09885
	for <R-bugs@biostat.ku.dk>; Mon, 4 Feb 2002 16:44:55 +0100 (MET)
Received: from amadeus.statistik.uni-dortmund.de by nx5.HRZ.Uni-Dortmund.DE
          via smtp-local with ESMTP; Mon, 4 Feb 2002 16:42:17 +0100
Received: from statistik.uni-dortmund.de ([129.217.207.201])
	by amadeus.statistik.uni-dortmund.de (8.10.2+Sun/8.10.2) with ESMTP id g14FgBS29122;
	Mon, 4 Feb 2002 16:42:16 +0100 (MET)
Message-ID: <3C5EABF6.B655CC6@statistik.uni-dortmund.de>
Date: Mon, 04 Feb 2002 16:42:46 +0100
From: Uwe Ligges <ligges@statistik.uni-dortmund.de>
Organization: Fachbereich Statistik, Universitaet Dortmund
X-Mailer: Mozilla 4.79 [en] (WinNT; U)
X-Accept-Language: en
MIME-Version: 1.0
To: robut@forest.go.th
CC: r-bugs <R-bugs@biostat.ku.dk>
Subject: Re: [R] expressions in legends
References: <15452.63984.437100.628110@gargle.gargle.HOWL>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Content-Length: 1413
Status: RO

Robert Cunningham wrote:
> 
> Dear R-users,
> 
> A few days ago I met the problem of using text produced with
> expression() in legend() being elevated relative to text produced
> without the expression() so that the alignment with pch and lty is
> also messed up. After ferreting through the help I finally came across
> an answer, the adj argument of legend(). You can see and example of
> this in the Math expressions example section of ?legends. Of course,
> many users would, I am sure, overlook this option and 'put up' with
> the mis-aligned legend. I wonder why expression() causes this problem
> and whether anything can be done about it (other that the adj hack).
> 
> For those unaware of the problem paste this example into your R.
> 
> plot(1:10,1:10)
> legend(1,10,"Non expression_species",pch=21,lty=1,bty='n')
> legend(5,10,expression(italic("Expression species")),pch=21,lty=1,bty='n',col=2)
> legend(8.1,10,expression(italic("E. species")),pch=21,lty=1,bty='n',col=2,adj=c(0,0.6))
> 
> The first legend key is ordinary text, the second expression(italic())
> with no adjustment, the third with the adjustment.


This looks like a bug, so moved to r-bugs.

Let's simplify your example:

 plot(1:10)
 text(5, 10, "No expression ", adj=1)
 text(5, 10, expression(" expression"), adj=0)

So the bug is in text(), not in legend.
I'll try to investigate the problem later this day / week.

Uwe Ligges

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1303 *
Subject: failure of http://r-bugs.biostat.ku.dk/cgi-bin/R
From: Dimitri PAPADOPOULOS-ORFANOS <papadopo@shfj.cea.fr>
Date: Mon, 4 Feb 2002 13:43:21 +0100 (MET)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1303 <==
From papadopo@shfj.cea.fr Mon Feb  4 13:47:47 2002
Received: from nenuphar.saclay.cea.fr (nenuphar.saclay.cea.fr [132.166.192.7])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id NAA07260
	for <r-bugs@biostat.ku.dk>; Mon, 4 Feb 2002 13:47:46 +0100 (MET)
Received: from muguet.saclay.cea.fr (muguet.saclay.cea.fr [132.166.192.6])
	by nenuphar.saclay.cea.fr (8.9.1a/8.9.1/CEAnet-relay-5.0.D20+Y2K) with ESMTP id NAA26576
	for <r-bugs@biostat.ku.dk>; Mon, 4 Feb 2002 13:48:18 +0100 (MET)
Received: from pendragon-int.shfj.cea.fr (pendragon.shfj.cea.fr [132.166.81.1])
	by muguet.saclay.cea.fr (8.9.1a/8.9.1/CEAnet-relay-5.2.D20+Y2K) with SMTP id NAA18431
	for <r-bugs@biostat.ku.dk>; Mon, 4 Feb 2002 13:47:14 +0100 (MET)
Received: by pendragon-int.shfj.cea.fr; id NAA05074; Mon, 8 Feb 1999 13:41:48 +0100
Received: from uriens.shfj.cea.fr(193.48.23.6) by pendragon-int.shfj.cea.fr via smap (3.2)
	id xma005064; Mon, 8 Feb 99 13:41:28 +0100
Received: from nestor.shfj.cea.fr by shfj.cea.fr
	(8.6.10/PROTO-CEANET-3.0) with ESMTP id NAA20803
	for <r-bugs@biostat.ku.dk>; Mon, 4 Feb 2002 13:43:20 +0100
Received: from nestor (nestor [193.48.23.36])
	by nestor.shfj.cea.fr (8.10.2+Sun/8.10.2) with SMTP id g14ChLx18445
	for <r-bugs@biostat.ku.dk>; Mon, 4 Feb 2002 13:43:21 +0100 (MET)
Message-Id: <200202041243.g14ChLx18445@nestor.shfj.cea.fr>
Date: Mon, 4 Feb 2002 13:43:21 +0100 (MET)
From: Dimitri PAPADOPOULOS-ORFANOS <papadopo@shfj.cea.fr>
Reply-To: Dimitri PAPADOPOULOS-ORFANOS <papadopo@shfj.cea.fr>
Subject: failure of http://r-bugs.biostat.ku.dk/cgi-bin/R
To: r-bugs@biostat.ku.dk
MIME-Version: 1.0
Content-Type: TEXT/plain; charset=us-ascii
Content-MD5: m1ytw9rCwzd2ueY6o5np5Q==
X-Mailer: dtmail 1.3.0 @(#)CDE Version 1.4.2 SunOS 5.8 sun4u sparc 
Content-Length: 301
Status: RO

Hi,

The following script

	http://r-bugs.biostat.ku.dk/cgi-bin/R

fails with the following error

	The system encountered a fatal error
	After command: 
	Received: 
	The last error code was: No route to host 

	Web interface using JitterBug.

when trying to submit a new bug.

Best Regards,
Dimitri


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* PR# 1304 *
Subject: R loads uncorrect readline library
From: Dimitri PAPADOPOULOS-ORFANOS <papadopo@shfj.cea.fr>
Date: Mon, 4 Feb 2002 13:40:48 +0100 (MET)
-- no notes --
~~~~~~~~~~ original reports follow ~~~~~~~~~~
==> 1304 <==
From papadopo@shfj.cea.fr Mon Feb  4 13:45:18 2002
Received: from nenuphar.saclay.cea.fr (nenuphar.saclay.cea.fr [132.166.192.7])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id NAA07214
	for <r-bugs@biostat.ku.dk>; Mon, 4 Feb 2002 13:45:17 +0100 (MET)
Received: from muguet.saclay.cea.fr (muguet.saclay.cea.fr [132.166.192.6])
	by nenuphar.saclay.cea.fr (8.9.1a/8.9.1/CEAnet-relay-5.0.D20+Y2K) with ESMTP id NAA25368
	for <r-bugs@biostat.ku.dk>; Mon, 4 Feb 2002 13:45:49 +0100 (MET)
Received: from pendragon-int.shfj.cea.fr (pendragon.shfj.cea.fr [132.166.81.1])
	by muguet.saclay.cea.fr (8.9.1a/8.9.1/CEAnet-relay-5.2.D20+Y2K) with SMTP id NAA17055
	for <r-bugs@biostat.ku.dk>; Mon, 4 Feb 2002 13:44:45 +0100 (MET)
Received: by pendragon-int.shfj.cea.fr; id NAA04947; Mon, 8 Feb 1999 13:39:18 +0100
Received: from uriens.shfj.cea.fr(193.48.23.6) by pendragon-int.shfj.cea.fr via smap (3.2)
	id xma004921; Mon, 8 Feb 99 13:38:55 +0100
Received: from nestor.shfj.cea.fr by shfj.cea.fr
	(8.6.10/PROTO-CEANET-3.0) with ESMTP id NAA20773
	for <r-bugs@biostat.ku.dk>; Mon, 4 Feb 2002 13:40:48 +0100
Received: from nestor (nestor [193.48.23.36])
	by nestor.shfj.cea.fr (8.10.2+Sun/8.10.2) with SMTP id g14Cemx18440
	for <r-bugs@biostat.ku.dk>; Mon, 4 Feb 2002 13:40:48 +0100 (MET)
Message-Id: <200202041240.g14Cemx18440@nestor.shfj.cea.fr>
Date: Mon, 4 Feb 2002 13:40:48 +0100 (MET)
From: Dimitri PAPADOPOULOS-ORFANOS <papadopo@shfj.cea.fr>
Reply-To: Dimitri PAPADOPOULOS-ORFANOS <papadopo@shfj.cea.fr>
Subject: R loads uncorrect readline library
To: r-bugs@biostat.ku.dk
MIME-Version: 1.0
Content-Type: TEXT/plain; charset=us-ascii
Content-MD5: J2MCstkY4h2GiC3k8HIw6A==
X-Mailer: dtmail 1.3.0 @(#)CDE Version 1.4.2 SunOS 5.8 sun4u sparc 
Content-Length: 544
Status: RO

Hello,

We have built R 1.4.1 on Red Hat 7.1 for use on both Red Hat 7.1 and 7.2.

Running R on Red Hat 7.2 fails with the following error message:

$ R
/usr/local/r-1.4.1/lib/R/bin/R.bin: error while loading shared libraries: 
libreadline.so.4.1: cannot open shared object file: No such file or directory
$ 

This is because Red Hat 7.1 provides readline-4.1 while Red Hat 7.2. provides
readline-4.2. Both are supposed to be binary compatible.

R should attempt to load  libreadline.so.4 instead of libreadline.so.4.1.

Best regards,
Dimitri



==> 1304.reply.1 <==
From p.dalgaard@biostat.ku.dk  Thu Feb  7 22:26:30 2002
Received: from blueberry.kubism.ku.dk (blueberry [192.38.19.4])
	by pubhealth.ku.dk (8.9.3/8.9.1) with ESMTP id WAA06949;
	Thu, 7 Feb 2002 22:26:29 +0100 (MET)
Received: (from pd@localhost)
	by blueberry.kubism.ku.dk (8.11.2/8.11.2) id g17LQGK01282;
	Thu, 7 Feb 2002 22:26:16 +0100
X-Authentication-Warning: blueberry.kubism.ku.dk: pd set sender to p.dalgaard@biostat.ku.dk using -f
Sender: pd@pubhealth.ku.dk
To: papadopo@shfj.cea.fr
Cc: r-devel@stat.math.ethz.ch, R-bugs@biostat.ku.dk
Subject: Re: [Rd] R loads uncorrect readline library (PR#1304)
References: <200202071817.TAA06501@pubhealth.ku.dk>
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 07 Feb 2002 22:26:15 +0100
In-Reply-To: <200202071817.TAA06501@pubhealth.ku.dk>
Message-ID: <x23d0dasqw.fsf@blueberry.kubism.ku.dk>
Lines: 29
User-Agent: Gnus/5.0808 (Gnus v5.8.8) Emacs/20.7
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

papadopo@shfj.cea.fr writes:

> Hello,
> 
> We have built R 1.4.1 on Red Hat 7.1 for use on both Red Hat 7.1 and 7.2.
> 
> Running R on Red Hat 7.2 fails with the following error message:
> 
> $ R
> /usr/local/r-1.4.1/lib/R/bin/R.bin: error while loading shared libraries: 
> libreadline.so.4.1: cannot open shared object file: No such file or directory
> $ 
> 
> This is because Red Hat 7.1 provides readline-4.1 while Red Hat 7.2. provides
> readline-4.2. Both are supposed to be binary compatible.
> 
> R should attempt to load  libreadline.so.4 instead of libreadline.so.4.1.

A build issue, rather than a bug in R as such. This is what happens
when you build against libreadline on RH7.1.

RedHat supplies the readline41-4.1-10 package in 7.2 for
compatibility, which is the preferred workaround.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
