#!/usr/bin/perl

$skip=1;    
while(<>){
    if(/^\s+/){
	$comment .= $_ unless $skip;
    }
    else{
	if($file){
	    $comment =~ s/[\s]*$//s;
	    if($oldcomment eq $comment){
		print "  $file\n";
	    }
	    else{
		print "\n$date, $author\n";
		print "$comment\n  $file\n";
		$oldcomment=$comment;
	    }
	    $comment="";
	}
	if(/ R (date-stamp|BUGS),/){
	    $skip=1;
	    $file="";
	}
	else{
	    if(/^(.* UTC \d{4}) (.*) (\S+)$/){
		$date = $1;
		$file = $2;
		$author = $3;
		$skip=0;
	    }
	}
    }
}

