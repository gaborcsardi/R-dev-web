#! /home/Hornik/tmp/R/bin/Rscript
### -*- R -*-

## <FIXME>
## Once /usr/bin/Rscript is 3.2.0 or better: Change to
##   #! /usr/bin/Rscript
## and clean up.
## </FIXME>

all <- FALSE
drop <- FALSE
full <- FALSE

dir <- normalizePath(file.path("~", "tmp", "CRAN"))

args <- commandArgs(trailingOnly = TRUE)
if(any(ind <- args %in% c("-a", "--all"))) {
    all <- TRUE
    args <- args[!ind]
}
if(any(ind <- args %in% c("-d", "--drop"))) {
    drop <- TRUE
    args <- args[!ind]
}
if(any(ind <- args %in% c("-f", "--full"))) {
    full <- TRUE
    args <- args[!ind]
}

if(length(args)) {
    dir <- args[1L]
}

old <- tools:::CRAN_check_details("r-devel-linux-x86_64-debian-gcc")

changes <- tools:::check_packages_in_dir_changes(dir, old,
                                                 outputs = full,
                                                 sources = all)
if(drop)
    changes <- changes[changes$Check != "installed package size", ]

print(changes)
