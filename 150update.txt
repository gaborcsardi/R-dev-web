Updating packages for 1.5.0
===========================

Package maintainers should be aware of the following changes to appear
in 1.5.0.   Some necessitate changes in many packages.

This document is `work in progress' until Feature freeze for 1.5.0 on
April 8th.


NA strings
----------

Missing values in strings are handled much more consistently, and a
lot of sloppy coding will now fail (or give different answers).

- If you meant "NA" to indicate the missing value, use
  as.character(NA) (or just NA where coercion will occur.)

- The test x == "NA" should be rewritten as is.na(x).

- If missing values can occur, do not use x == "some string". 
  A suitable replacement is x %in% "some string".

- Code such as all(names(x) == ans.names)) (from apply) will fail if
  any name might be missing.  Use identical(names(x), ans.names)
  instead (which incidentally is more efficient).

Although all the examples have used ==, the same considerations apply to
the other logical operators != < <= > >=.

The way missing strings print has been altered, so test output may
need to be updated.


Saving data
-----------

The recommended way to distribute data has been via  .rda files
obtained with save(ascii=TRUE).  As from 1.5.0 we can assume that
XDR loading and compression are available on all platforms.

The default save format was changed in 1.4.0.  We now recommend that
data is distributed in version 2 XDR format files (as given by
save() in 1.4.0 or later), *and* that large data files are distributed
in compressed format (save(compress=TRUE)).
