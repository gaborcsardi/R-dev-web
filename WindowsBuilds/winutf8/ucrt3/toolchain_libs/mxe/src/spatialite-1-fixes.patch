diff -Nru libspatialite-5.0.1-orig/configure libspatialite-5.0.1-patched/configure
--- libspatialite-5.0.1-orig/configure	2021-02-07 10:53:46.000000000 -0500
+++ libspatialite-5.0.1-patched/configure	2021-09-10 02:48:08.864272481 -0400
@@ -758,6 +758,7 @@
 docdir
 oldincludedir
 includedir
+runstatedir
 localstatedir
 sharedstatedir
 sysconfdir
@@ -869,6 +870,7 @@
 sysconfdir='${prefix}/etc'
 sharedstatedir='${prefix}/com'
 localstatedir='${prefix}/var'
+runstatedir='${localstatedir}/run'
 includedir='${prefix}/include'
 oldincludedir='/usr/include'
 docdir='${datarootdir}/doc/${PACKAGE_TARNAME}'
@@ -1121,6 +1123,15 @@
   | -silent | --silent | --silen | --sile | --sil)
     silent=yes ;;
 
+  -runstatedir | --runstatedir | --runstatedi | --runstated \
+  | --runstate | --runstat | --runsta | --runst | --runs \
+  | --run | --ru | --r)
+    ac_prev=runstatedir ;;
+  -runstatedir=* | --runstatedir=* | --runstatedi=* | --runstated=* \
+  | --runstate=* | --runstat=* | --runsta=* | --runst=* | --runs=* \
+  | --run=* | --ru=* | --r=*)
+    runstatedir=$ac_optarg ;;
+
   -sbindir | --sbindir | --sbindi | --sbind | --sbin | --sbi | --sb)
     ac_prev=sbindir ;;
   -sbindir=* | --sbindir=* | --sbindi=* | --sbind=* | --sbin=* \
@@ -1258,7 +1269,7 @@
 for ac_var in	exec_prefix prefix bindir sbindir libexecdir datarootdir \
 		datadir sysconfdir sharedstatedir localstatedir includedir \
 		oldincludedir docdir infodir htmldir dvidir pdfdir psdir \
-		libdir localedir mandir
+		libdir localedir mandir runstatedir
 do
   eval ac_val=\$$ac_var
   # Remove trailing slashes.
@@ -1411,6 +1422,7 @@
   --sysconfdir=DIR        read-only single-machine data [PREFIX/etc]
   --sharedstatedir=DIR    modifiable architecture-independent data [PREFIX/com]
   --localstatedir=DIR     modifiable single-machine data [PREFIX/var]
+  --runstatedir=DIR       modifiable per-process data [LOCALSTATEDIR/run]
   --libdir=DIR            object code libraries [EPREFIX/lib]
   --includedir=DIR        C header files [PREFIX/include]
   --oldincludedir=DIR     C header files for non-gcc [/usr/include]
@@ -18208,10 +18220,10 @@
 
 done
 
-  CPPFLAGS="$CPPFLAGS_SAVE"
+  CPPFLAGS="$CPPFLAGS_SAVE -I`$GEOSCONFIG --includes`"
   # Ensure we can link against libgeos_c
   LIBS_SAVE="$LIBS"
-  LIBS="$GEOS_LDFLAGS"
+  LIBS="$GEOS_LDFLAGS `$GEOSCONFIG --clibs`"
   { $as_echo "$as_me:${as_lineno-$LINENO}: checking for library containing GEOSCoveredBy" >&5
 $as_echo_n "checking for library containing GEOSCoveredBy... " >&6; }
 if ${ac_cv_search_GEOSCoveredBy+:} false; then :
@@ -18271,7 +18283,7 @@
 fi
 
   LIBS="$LIBS_SAVE"
-  LIBS="$LIBS $GEOS_LDFLAGS -lgeos_c"
+  LIBS="$LIBS $GEOS_LDFLAGS `$GEOSCONFIG --clibs`"
 
   #-----------------------------------------------------------------------
   #   --enable-controlpoints
@@ -18876,7 +18888,7 @@
     ac_res="none required"
   else
     ac_res=-l$ac_lib
-    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
+    LIBS="-l$ac_lib -lbz2 $ac_func_search_save_LIBS"
   fi
   if ac_fn_c_try_link "$LINENO"; then :
   ac_cv_search_unzLocateFile=$ac_res
@@ -18905,6 +18917,7 @@
   as_fn_error $? "'libminizip' is required but it doesn't seem to be installed on this system." "$LINENO" 5
 fi
 
+  LIBS="$LIBS -lbz2"
   $as_echo "#define ENABLE_MINIZIP 1" >>confdefs.h
 
 fi
@@ -20927,9 +20940,7 @@
     { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
 $as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
 as_fn_error $? "Something went wrong bootstrapping makefile fragments
-    for automatic dependency tracking.  If GNU make was not used, consider
-    re-running the configure script with MAKE=\"gmake\" (or whatever is
-    necessary).  You can also try re-running configure with the
+    for automatic dependency tracking.  Try re-running configure with the
     '--disable-dependency-tracking' option to at least be able to build
     the package (albeit without support for automatic dependency tracking).
 See \`config.log' for more details" "$LINENO" 5; }
diff -Nru libspatialite-5.0.1-orig/configure.ac libspatialite-5.0.1-patched/configure.ac
--- libspatialite-5.0.1-orig/configure.ac	2021-02-07 10:53:46.000000000 -0500
+++ libspatialite-5.0.1-patched/configure.ac	2021-09-10 02:47:21.575519946 -0400
@@ -340,18 +340,18 @@
   GEOS_LDFLAGS=`$GEOSCONFIG --ldflags`
   GEOS_CFLAGS=-I`$GEOSCONFIG --includes`
   AC_SUBST([GEOS_LDFLAGS])
-  AC_SUBST([GEOS_CFLAGS])	
+  AC_SUBST([GEOS_CFLAGS])
   # Ensure that we can parse geos_c.h
   CPPFLAGS_SAVE="$CPPFLAGS"
   CPPFLAGS="$GEOS_CFLAGS"
   AC_CHECK_HEADERS([geos_c.h],, [AC_MSG_ERROR([could not find geos_c.h - you may need to specify the directory of a geos-config file using --with-geosconfig])])
-  CPPFLAGS="$CPPFLAGS_SAVE"	
+  CPPFLAGS="$CPPFLAGS_SAVE -I`$GEOSCONFIG --includes`"
   # Ensure we can link against libgeos_c
   LIBS_SAVE="$LIBS"
-  LIBS="$GEOS_LDFLAGS"
+  LIBS="$GEOS_LDFLAGS `$GEOSCONFIG --clibs`"
   AC_SEARCH_LIBS(GEOSCoveredBy,geos_c,,AC_MSG_ERROR([could not find libgeos_c (or obsolete 'libgeos_c' < v.3.3.0 found) - you may need to specify the directory of a geos-config file using --with-geosconfig]))
   LIBS="$LIBS_SAVE"
-  LIBS="$LIBS $GEOS_LDFLAGS -lgeos_c"
+  LIBS="$LIBS $GEOS_LDFLAGS `$GEOSCONFIG --clibs`"
 
   #-----------------------------------------------------------------------
   #   --enable-controlpoints
@@ -442,7 +442,8 @@
   [], [enable_minizip=yes])
 if test x"$enable_minizip" != "xno"; then
   AC_CHECK_HEADERS(minizip/unzip.h,, [AC_MSG_ERROR([cannot find minizip/unzip.h, bailing out])])
-  AC_SEARCH_LIBS(unzLocateFile, minizip,,AC_MSG_ERROR(['libminizip' is required but it doesn't seem to be installed on this system.]))
+  AC_SEARCH_LIBS(unzLocateFile, minizip,,AC_MSG_ERROR(['libminizip' is required but it doesn't seem to be installed on this system.]), -lbz2)
+  LIBS="$LIBS -lbz2"
   AC_DEFINE(ENABLE_MINIZIP)
 fi
 
diff -Nru libspatialite-5.0.1-orig/spatialite.pc.in libspatialite-5.0.1-patched/spatialite.pc.in
--- libspatialite-5.0.1-orig/spatialite.pc.in	2021-02-07 10:53:46.000000000 -0500
+++ libspatialite-5.0.1-patched/spatialite.pc.in	2021-09-09 12:10:17.401817191 -0400
@@ -8,5 +8,5 @@
 Name: spatialite
 Description: Spatial SQL database engine based on SQLite
 Version: @VERSION@
-Libs: -L${libdir} -lspatialite @LIBS@ @LIBXML2_LIBS@ -lm
+Libs: -L${libdir} -lspatialite -lgeos_c -lgeos -lxml2 -lws2_32 -lstdc++ -lm
 Cflags: -I${includedir}
diff -Nru libspatialite-5.0.1-orig/src/gaiageo/gg_shape.c libspatialite-5.0.1-patched/src/gaiageo/gg_shape.c
--- libspatialite-5.0.1-orig/src/gaiageo/gg_shape.c	2021-02-07 10:53:46.000000000 -0500
+++ libspatialite-5.0.1-patched/src/gaiageo/gg_shape.c	2021-09-09 15:01:31.966060696 -0400
@@ -58,7 +58,7 @@
 #endif
 
 #ifdef _WIN32
-#include <Windows.h>
+#include <windows.h>
 #endif
 
 #if OMIT_ICONV == 0		/* if ICONV is disabled no SHP support is available */
diff -Nru libspatialite-5.0.1-orig/src/shapefiles/shapefiles.c libspatialite-5.0.1-patched/src/shapefiles/shapefiles.c
--- libspatialite-5.0.1-orig/src/shapefiles/shapefiles.c	2021-02-07 10:53:46.000000000 -0500
+++ libspatialite-5.0.1-patched/src/shapefiles/shapefiles.c	2021-09-09 14:35:05.961431823 -0400
@@ -80,7 +80,7 @@
 #endif
 
 #ifdef ENABLE_MINIZIP		/* MINIZIP is enabled */
-#include <minizip/unzip.h>
+#include <unzip.h>
 #endif
 
 #if defined(_WIN32) && !defined(__MINGW32__)
diff -Nru libspatialite-5.0.1-orig/test/scandir4win.h libspatialite-5.0.1-patched/test/scandir4win.h
--- libspatialite-5.0.1-orig/test/scandir4win.h	2021-02-07 10:53:47.000000000 -0500
+++ libspatialite-5.0.1-patched/test/scandir4win.h	2021-09-09 15:01:02.693606492 -0400
@@ -11,7 +11,7 @@
 
 #ifdef _WIN32
 
-#include <Windows.h>
+#include <windows.h>
 #include <stdio.h>
 #include <sys/types.h>
 
