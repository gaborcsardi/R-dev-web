diff -Nru orig/curl/src/Makevars.ucrt patched/curl/src/Makevars.ucrt
--- orig/curl/src/Makevars.ucrt	1970-01-01 01:00:00.000000000 +0100
+++ patched/curl/src/Makevars.ucrt	2021-02-17 19:45:39.989747000 +0100
@@ -0,0 +1,13 @@
+PKG_LIBS= -lwinhttp -lcurl -lrtmp -lssl -lssh2 -lgcrypt -lcrypto -lgdi32 -lz -lzstd -lgdi32 -lcrypt32 -lidn2 -lunistring -liconv -lgpg-error -lws2_32 -lwldap32 -lwinmm
+
+PKG_CPPFLAGS= -DCURL_STATICLIB -DSTRICT_R_HEADERS
+
+all: clean  winlibs
+
+winlibs: clean
+	 echo '#include <curl/curl.h>' | $(CPP) $(PKG_CPPFLAGS) -std=gnu99 -xc - | grep "^[ \t]*CURLOPT_.*," | sed s/,// > ../tools/option_table.txt
+
+clean:
+	rm -f $(SHLIB) $(OBJECTS)
+
+.PHONY: all clean
diff -Nru orig/curl/src/winhttp32.def.in patched/curl/src/winhttp32.def.in
--- orig/curl/src/winhttp32.def.in	2019-12-01 09:17:46.000000000 +0100
+++ patched/curl/src/winhttp32.def.in	1970-01-01 01:00:00.000000000 +0100
@@ -1,37 +0,0 @@
-;
-; Definition file of WINHTTP.dll
-; Automatic generated by gendef
-; written by Kai Tietz 2008
-;
-LIBRARY "WINHTTP.dll"
-EXPORTS
-Private1@20
-SvchostPushServiceGlobals@4
-WinHttpAddRequestHeaders@16
-WinHttpAutoProxySvcMain@8
-WinHttpCheckPlatform@0
-WinHttpCloseHandle@4
-WinHttpConnect@16
-WinHttpCrackUrl@16
-WinHttpCreateUrl@16
-WinHttpDetectAutoProxyConfigUrl@8
-WinHttpGetDefaultProxyConfiguration@4
-WinHttpGetIEProxyConfigForCurrentUser@4
-WinHttpGetProxyForUrl@16
-WinHttpOpen@20
-WinHttpOpenRequest@28
-WinHttpQueryAuthSchemes@16
-WinHttpQueryDataAvailable@8
-WinHttpQueryHeaders@24
-WinHttpQueryOption@16
-WinHttpReadData@16
-WinHttpReceiveResponse@8
-WinHttpSendRequest@28
-WinHttpSetCredentials@24
-WinHttpSetDefaultProxyConfiguration@4
-WinHttpSetOption@16
-WinHttpSetStatusCallback@16
-WinHttpSetTimeouts@20
-WinHttpTimeFromSystemTime@8
-WinHttpTimeToSystemTime@8
-WinHttpWriteData@16
diff -Nru orig/curl/src/winhttp64.def.in patched/curl/src/winhttp64.def.in
--- orig/curl/src/winhttp64.def.in	2019-12-01 09:17:46.000000000 +0100
+++ patched/curl/src/winhttp64.def.in	1970-01-01 01:00:00.000000000 +0100
@@ -1,37 +0,0 @@
-;
-; Definition file of WINHTTP.dll
-; Automatic generated by gendef
-; written by Kai Tietz 2008
-;
-LIBRARY "WINHTTP.dll"
-EXPORTS
-Private1
-SvchostPushServiceGlobals
-WinHttpAddRequestHeaders
-WinHttpAutoProxySvcMain
-WinHttpCheckPlatform
-WinHttpCloseHandle
-WinHttpConnect
-WinHttpCrackUrl
-WinHttpCreateUrl
-WinHttpDetectAutoProxyConfigUrl
-WinHttpGetDefaultProxyConfiguration
-WinHttpGetIEProxyConfigForCurrentUser
-WinHttpGetProxyForUrl
-WinHttpOpen
-WinHttpOpenRequest
-WinHttpQueryAuthSchemes
-WinHttpQueryDataAvailable
-WinHttpQueryHeaders
-WinHttpQueryOption
-WinHttpReadData
-WinHttpReceiveResponse
-WinHttpSendRequest
-WinHttpSetCredentials
-WinHttpSetDefaultProxyConfiguration
-WinHttpSetOption
-WinHttpSetStatusCallback
-WinHttpSetTimeouts
-WinHttpTimeFromSystemTime
-WinHttpTimeToSystemTime
-WinHttpWriteData
